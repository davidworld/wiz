From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?a3ViZXJuZXRlc9Wq0qo=?=
Date: Date: Fri, 23 Jul 2021 05:50:16 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0000490029.548"

This is a multi-part message in MIME format.

------=_Next_Part_0000490029.548
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000163343.629"


------=_Next_Part_0000163343.629
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000163343.629
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A=0A=0A=
=0A=0A=0A<title>kubernetes=D5=AA=D2=AA</title>=0A    =0A<style id=
=3D"wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz=
-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '=E5=BE=
=AE=E8=BD=AF=E9=9B=85=E9=BB=91', 'Microsoft YaHei UI', SimSun, Si=
mHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;padding:=20=
20px 16px;padding: 1.25rem 1rem;}.wiz-editor-body h1,.wiz-editor-=
body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body=20=
h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625=
rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:=
20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-=
size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25re=
m;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-ed=
itor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6=20=
{font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wi=
z-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-edi=
tor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0=
;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-=
body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .C=
odeMirror pre {margin:0;}.wiz-editor-body ul,.wiz-editor-body ol=20=
{padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-lis=
t-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-l=
ist-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol=
.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-b=
ody blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :f=
irst-child {margin-top:0;}.wiz-editor-body blockquote > :last-chi=
ld {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100=
%;height:auto !important;margin:2px 0;}.wiz-editor-body table {bo=
rder-collapse:collapse;border:1px solid #bbbbbb;}.wiz-editor-body=
 td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse=
;border:1px solid #bbbbbb;min-height:28px;word-break:break-word;b=
ox-sizing: border-box;}.wiz-hide {display:none !important;}</styl=
e></head>=0A=0A<body class=3D"wiz-editor-body" spellcheck=3D"fals=
e" style=3D"opacity: 1;" ><div>=B0=B2=D7=B0=D6=B8=B6=A8=B0=E6=B1=BE=
=B5=C4k8s=D7=E9=BC=FE=A3=BA yum install -y <span><span class=3D"A=
pple-converted-space">&nbsp;</span>kubectl-1.12.0-0.x86_64&nbsp;<=
/span>kubelet-1.12.0-0.x86_64 kubeadm-1.12.0-0.x86_64</div><div><=
span style=3D"line-height: 1.7;">&nbsp;systemctl start kubelet&nb=
sp;</span><br></div><div><span>=B2=E9=BF=B4=C5=E4=D6=C3=CE=C4=BC=FE=
=D4=DA=C4=C4=C0=EF</span>&nbsp;systemctl status kubelet&nbsp;</di=
v><div>=B2=E9=BF=B4<span style=3D"color: rgb(64, 64, 64);">cgroup=
 drive<span>&nbsp;=CA=C7=B7=F1=D2=BB=D1=F9=A3=BA</span></span></d=
iv><div>docker info | grep -i cgroup</div><div>cat &nbsp; /usr/li=
b/systemd/system/kubelet.service.d/10-kubeadm.conf</div><div>=D0=DE=
=B8=C4=C5=E4=D6=C3=CE=C4=BC=FE=CE=AA=D2=BB=D6=C2 sed -i "s/cgroup=
-driver=3Dsystemd/cgroup-driver=3Dcgroupfs/g"&nbsp;<span><span cl=
ass=3D"Apple-converted-space">&nbsp;</span>/usr/lib/systemd/syste=
m/kubelet.service.d/10-kubeadm.conf</span></div><div>=B2=E9=BF=B4=
=B0=E6=B1=BE=A3=BA kubelet --version</div><div>=B9=D8=B1=D5swap:s=
wapoff -a&nbsp;</div><div>=B1=E0=BC=AD/etc/fstab=A3=AC=D7=A2=CA=CD=
=B5=F4=B0=FC=BA=ACswap=B5=C4=C4=C7=D2=BB=D0=D0</div><div><span>=B3=
=F5=CA=BC=BB=AF=CD=F8=C2=E7=A3=BA kubeadm init --kubernetes-versi=
on=3Dv1.12.0 --pod-network-cidr=3D10.244.0.0/16 &nbsp;--ignore-pr=
eflight-errors=3DSwap--apiserver-advertise-address=3D172.21.96.22=
</span><br></div><div><span>=B8=F9=BE=DD=B1=A8=B4=ED=D0=C5=CF=A2=B4=
=D3=BF=C9=D3=C3=B5=C4=B5=D8=D6=B7=CF=C2=D4=D8=B6=D4=D3=A6=B5=C4im=
age=A3=BA</span><span style=3D"line-height: 1.7;">docker pull mir=
rorgooglecontainers/kube-apiserver:v1.12.0</span></div><div><span=
><span>=D6=D8=D0=C2=B1=EA=CA=B6=CF=C2=D4=D8=B5=C4=BE=B5=CF=F1 doc=
ker tag docker.io/mirrorgooglecontainers/kube-apiserver:v1.12.0 k=
8s.gcr.io/kube-apiserver:v1.12.0</span></span></div><div><span><s=
pan>=D4=D9=B4=CE=B3=F5=CA=BC=BB=AF=CD=F8=C2=E7=B2=A2</span></span=
><span style=3D"line-height: 1.7;">=B1=A3=C1=F4=CC=ED=BC=D3=CD=F8=
=C2=E7=B5=C4=D0=C5=CF=A2 &nbsp;kubeadm join 172.21.96.22:6443 --t=
oken 8nl3um.d4lb5252k6ixtwuv --discovery-token-ca-cert-hash sha25=
6:c741473dd672c262b084829ac7a9a647570cc22c0eaf8e2358d3f29fdd77896=
0</span></div><div><br></div><div>=0A    =D3=C3=B0=A2=C0=EF=D4=C6=
<span style=3D"line-height: 1.7;"><a href=3D"http://mirrors.aliyu=
n.com/kubernetes/yum">http://mirrors.aliyun.com/kubernetes/yum</a=
></span></div><div><span style=3D""><span data-wiz-span=3D"data-w=
iz-span">vim /etc/sysconfig/kubelet</span></span><span style=3D"l=
ine-height: 1.7;"><span data-wiz-span=3D"data-wiz-span">&nbsp; &n=
bsp;&nbsp;</span></span><br></div><div><span style=3D"line-height=
: 1.7;"><span style=3D""><span data-wiz-span=3D"data-wiz-span">KU=
BELET_EXTRA_ARGS=3D"--fail-swap-on=3Dfalse"</span></span></span><=
/div><div>=B3=F5=CA=BC=BB=AF=CD=F8=C2=E7=A3=BA kubeadm init   --k=
ubernetes-version=3Dv1.12.0   --pod-network-cidr=3D10.244.0.0/16=20=
  --apiserver-advertise-address=3D172.21.96.22 --ignore-preflight=
-errors=3DSwap</div><div><span style=3D"line-height: 1.7;">mkdir=20=
-p $HOME/.kube</span></div><div>sudo cp -i /etc/kubernetes/admin.=
conf $HOME/.kube/config</div><div>sudo chown $(id -u):$(id -g) $H=
OME/.kube/config</div><div><span>=D6=D8=D6=C3=CD=F8=C2=E7 &nbsp;<=
/span>kubeadm reset</div><div>=B4=D3=BD=DA=B5=E3=BC=D3=C8=EB kube=
adm join ##=B8=F9=BE=DDmaster=BD=DA=B5=E3init=B5=C4=CA=B1=BA=F2=B4=
=F2=D3=A1=B5=C4=D0=C5=CF=A2</div><div>=B2=E9=BF=B4=BD=DA=B5=E3=C7=
=E9=BF=F6 kubectl get nodes</div><div>=B2=E9=BF=B4=CB=F9=D3=D0pod=
=C7=E9=BF=F6 kubectl get pods -n kube-system</div><div>=B2=E9=BF=B4=
pod=D0=C5=CF=A2 kubectl describe pod coredns  -n kube-system</div=
><div>=B2=E9=BF=B4=B7=FE=CE=F1=C8=D5=D6=BE journalctl -f -u kubel=
et.service</div><div>=CE=DE=CD=F8=C2=E7=CA=B1=BA=F2 kubectl apply=
 -f <a href=3D"https://raw.githubusercontent.com/coreos/flannel/m=
aster/Documentation/kube-flannel.yml">https://raw.githubuserconte=
nt.com/coreos/flannel/master/Documentation/kube-flannel.yml</a> <=
/div><div>docker pull <span>quay-mirror.qiniu.com/coreos</span>/f=
lannel:v0.11.0-amd64</div><div>docker tag  quay-mirror.qiniu.com/=
coreos/flannel:v0.11.0-amd64 quay.io/coreos/flannel:v0.11.0-amd64=
</div><div>=B4=B4=BD=A8=D7=D4=BC=BA=B5=C4=B2=D6=BF=E2=A3=BA</div>=
<div>docker pull registry</div><div>mkdir -p /bss/docker_registry=
</div><div>docker run -d -p 5000:5000 -v  /bss/docker_registry:/v=
ar/lib/registry registry</div><div>=B5=D8=D6=B7=CA=E4=C8=EB <a hr=
ef=3D"http://172.21.96.22:5000/v2/_catalog">http://172.21.96.22:5=
000/v2/_catalog</a>&nbsp;=CE=AA=D5=FD=B3=A3</div><div>=D0=E8=D2=AA=
=B0=D1=BE=B5=CF=F1push=BA=F3kubelet=B2=C5=BB=E1=C8=CF=B5=BD &nbsp=
; &nbsp;<span style=3D"line-height: 1.7;">&nbsp; docker push 172.=
21.96.22:5000/jkorder:1.0</span></div><div></div><div><span style=
=3D"line-height: 1.7;"><br></span></div><div><span data-wiz-span=3D=
"data-wiz-span">=B2=E9=BF=B4=B9=F6=B6=AF=C9=FD=BC=B6=D7=B4=CC=AC=20=
kubectl rollout status deployment jkorder</span></div><div><span=20=
data-wiz-span=3D"data-wiz-span">=B2=E9=BF=B4=B0=E6=B1=BE=C0=FA=CA=
=B7 kubectl rollout history deployment jkorder</span></div><div><=
span style=3D""><span data-wiz-span=3D"data-wiz-span">=BB=D6=B8=B4=
=B5=BD=C7=B0=D2=BB=B8=F6=B0=E6=B1=BE&nbsp;</span></span><span dat=
a-wiz-span=3D"data-wiz-span">kubectl rollout undo deployment jkor=
der&nbsp;--to-revision=3D1</span></div><div><br></div><div>slave=BD=
=DA=B5=E3=D6=D8=D6=C3cni=CD=F8=C2=E7=A3=BA</div><div>kubeadm rese=
t</div><div>systemctl stop kubelet</div><div>systemctl stop docke=
r</div><div>rm -rf /var/lib/cni/</div><div>rm -rf /var/lib/kubele=
t/*</div><div>rm -rf /etc/cni/</div><div>ifconfig cni0 down</div>=
<div>ifconfig flannel.1 down</div><div>ifconfig docker0 down</div=
><div>ip link delete cni0</div><div>ip link delete flannel.1</div=
><div>systemctl start docker</div><div>=B4=D3=B9=FA=C4=DA=CF=C2=D4=
=D8=D0=E8=D2=AA=B5=C4=BE=B5=CF=F1=B2=A2=B1=EA=BC=C7</div><div>doc=
ker pull mirrorgooglecontainers/kube-apiserver:v1.12.0</div><div>=
docker pull mirrorgooglecontainers/kube-controller-manager:v1.12.=
0</div><div>docker pull mirrorgooglecontainers/kube-scheduler:v1.=
12.0</div><div>docker pull mirrorgooglecontainers/kube-proxy:v1.1=
2.0</div><div>docker pull mirrorgooglecontainers/pause:3.1</div><=
div>docker pull mirrorgooglecontainers/etcd:3.2.24</div><div>dock=
er pull coredns/coredns:1.2.2</div><div>docker tag docker.io/mirr=
orgooglecontainers/kube-apiserver:v1.12.0 k8s.gcr.io/kube-apiserv=
er:v1.12.0</div><div>docker tag docker.io/mirrorgooglecontainers/=
kube-controller-manager:v1.12.0 k8s.gcr.io/kube-controller-manage=
r:v1.12.0</div><div>docker tag docker.io/mirrorgooglecontainers/k=
ube-scheduler:v1.12.0 k8s.gcr.io/kube-scheduler:v1.12.0</div><div=
>docker tag docker.io/mirrorgooglecontainers/kube-proxy:v1.12.0 k=
8s.gcr.io/kube-proxy:v1.12.0</div><div>docker tag docker.io/mirro=
rgooglecontainers/pause:3.1 k8s.gcr.io/pause:3.1</div><div>docker=
 tag docker.io/mirrorgooglecontainers/etcd:3.2.24 k8s.gcr.io/etcd=
:3.2.24</div><div>docker tag docker.io/coredns/coredns:1.2.2 k8s.=
gcr.io/coredns:1.2.2</div><div><br></div></body></html>=0A=0A=0A=0A=
=0A=0A=0A=0A=0A=0A

------=_Next_Part_0000163343.629--

------=_Next_Part_0000490029.548--

