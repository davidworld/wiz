From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?U3BhcmsgU1FM1LTC67fWzvbWrrrL0MTB97PM?=
Date: Date: Fri, 23 Jul 2021 05:50:53 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0000601452.717"

This is a multi-part message in MIME format.

------=_Next_Part_0000601452.717
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000200484.696"


------=_Next_Part_0000200484.696
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000200484.696
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!doctype html><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A=0A=0A=
=0A=0A=0A=0A=0A=0A<title>Spark SQL=D4=B4=C2=EB=B7=D6=CE=F6=D6=AE=BA=
=CB=D0=C4=C1=F7=B3=CC</title>=0A    =0A<style id=3D"wiz_custom_cs=
s">html, body {font-size: 12pt;}body {font-family: Helvetica, 'Hi=
ragino Sans GB', '=CE=A2=C8=ED=D1=C5=BA=DA', 'Microsoft YaHei UI'=
, SimSun, SimHei, arial, sans-serif;line-height: 1.6;margin: 0 au=
to;padding: 20px 16px;padding: 1.25rem 1rem;}h1, h2, h3, h4, h5,=20=
h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-=
weight: bold;}h1 {font-size:20pt;font-size:1.67rem;}h2 {font-size=
:18pt;font-size:1.5rem;}h3 {font-size:15pt;font-size:1.25rem;}h4=20=
{font-size:14pt;font-size:1.17rem;}h5 {font-size:12pt;font-size:1=
rem;}h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1re=
m 0;}div, p, ul, ol, dl, li {margin:0;}blockquote, table, pre, co=
de {margin:8px 0;}ul, ol {padding-left:32px;padding-left:2rem;}ol=
.wiz-list-level1 > li {list-style-type:decimal;}ol.wiz-list-level=
2 > li {list-style-type:lower-latin;}ol.wiz-list-level3 > li {lis=
t-style-type:lower-roman;}blockquote {padding:0 12px;padding:0 0.=
75rem;}blockquote > :first-child {margin-top:0;}blockquote > :las=
t-child {margin-bottom:0;}img {border:0;max-width:100%;height:aut=
o !important;margin:2px 0;}table {border-collapse:collapse;border=
:1px solid #bbbbbb;}td, th {padding:4px 8px;border-collapse:colla=
pse;border:1px solid #bbbbbb;min-height:28px;word-break:break-all=
;box-sizing: border-box;}.wiz-hide {display:none !important;}</st=
yle></head>=0A=0A<body class spellcheck=3D"false"><div><meta char=
set=3D"utf-8"><div style=3D"text-align:left;font-size:0.875rem;">=
<span style=3D"font-size:1.375rem;color:rgb(48, 87, 134);">Spark=20=
SQL=D4=B4=C2=EB=B7=D6=CE=F6=D6=AE=BA=CB=D0=C4=C1=F7=B3=CC</span><=
/div><div style=3D"text-align:center;font-size:0.875rem;"><span s=
tyle=3D"color:rgb(153, 153, 153);">=D7=F7=D5=DF=A3=BA</span><a hr=
ef=3D"http://my.csdn.net/u014388509"><span style=3D"color:rgb(85,=
 146, 193);">u014388509</span></a></div><div style=3D"text-align:=
left;font-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);"=
>&nbsp; &nbsp; /**&nbsp;</span><a href=3D"http://blog.csdn.net/oo=
psoom/article/details/38257749"><span style=3D"color:rgb(43, 145,=
 232);">Spark SQL=D4=B4=C2=EB=B7=D6=CE=F6=CF=B5=C1=D0=CE=C4=D5=C2=
</span></a><span style=3D"color:rgb(86, 95, 105);">*/</span></div=
><div style=3D"text-align:left;font-size:0.875rem;"><span style=3D=
"color:rgb(86, 95, 105);">&nbsp; &nbsp; =D7=D4=B4=D3=C8=A5=C4=EAS=
park Submit 2013 Michael Armbrust=B7=D6=CF=ED=C1=CB=CB=FB=B5=C4Ca=
talyst=A3=AC=B5=BD=D6=C1=BD=F11=C4=EA=B6=E0=C1=CB,Spark SQL=B5=C4=
=B9=B1=CF=D7=D5=DF=B4=D3=BC=B8=C8=CB=B5=BD=C1=CB=BC=B8=CA=AE=C8=CB=
=A3=AC=B6=F8=C7=D2=B7=A2=D5=B9=CB=D9=B6=C8=D2=EC=B3=A3=D1=B8=C3=CD=
=A3=AC=BE=BF=C6=E4=D4=AD=D2=F2=A3=AC=B8=F6=C8=CB=C8=CF=CE=AA=D3=D0=
=D2=D4=CF=C22=B5=E3=A3=BA</span></div><div style=3D"text-align:le=
ft;font-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);">&=
nbsp; &nbsp; 1=A1=A2=D5=FB=BA=CF=A3=BA=BD=ABSQL=C0=E0=D0=CD=B5=C4=
=B2=E9=D1=AF=D3=EF=D1=D4=D5=FB=BA=CF=B5=BD Spark =B5=C4=BA=CB=D0=C4=
RDD=B8=C5=C4=EE=C0=EF=A1=A3=D5=E2=D1=F9=BF=C9=D2=D4=D3=A6=D3=C3=D3=
=DA=B6=E0=D6=D6=C8=CE=CE=F1=A3=AC=C1=F7=B4=A6=C0=ED=A3=AC=C5=FA=B4=
=A6=C0=ED=A3=AC=B0=FC=C0=A8=BB=FA=C6=F7=D1=A7=CF=B0=C0=EF=B6=BC=BF=
=C9=D2=D4=D2=FD=C8=EBSql=A1=A3</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105=
);">&nbsp; &nbsp; 2=A1=A2=D0=A7=C2=CA=A3=BA=D2=F2=CE=AAShark=CA=DC=
=B5=BDhive=B5=C4=B1=E0=B3=CC=C4=A3=D0=CD=CF=DE=D6=C6=A3=AC=CE=DE=B7=
=A8=D4=D9=BC=CC=D0=F8=D3=C5=BB=AF=C0=B4=CA=CA=D3=A6Spark=C4=A3=D0=
=CD=C0=EF=A1=A3</span></div><div style=3D"text-align:left;font-si=
ze:0.875rem;"><span style=3D"color:rgb(86, 95, 105);">&nbsp; &nbs=
p; =C7=B0=D2=BB=B6=CE=CA=B1=BC=E4=B2=E2=CA=D4=B9=FD</span><a href=
=3D"http://blog.csdn.net/oopsoom/article/details/34438963"><span=20=
style=3D"color:rgb(43, 145, 232);">Shark</span></a><span style=3D=
"color:rgb(86, 95, 105);">=A3=AC=B2=A2=C7=D2=B6=D4</span><a href=3D=
"http://blog.csdn.net/oopsoom/article/details/37603261"><span sty=
le=3D"color:rgb(43, 145, 232);">Spark SQL</span></a><span style=3D=
"color:rgb(86, 95, 105);">=D2=B2=BD=F8=D0=D0=C1=CB=D2=BB=D0=A9=B2=
=E2=CA=D4=A3=AC=B5=AB=CA=C7=BB=B9=CA=C7=C8=CC=B2=BB=D7=A1=B6=D4Sp=
ark SQL=D2=BB=CC=BD=BE=BF=BE=B9=A3=AC=BE=CD=B4=D3=D4=B4=B4=FA=C2=EB=
=B5=C4=BD=C7=B6=C8=C0=B4=BF=B4=D2=BB=CF=C2Spark SQL=B5=C4=BA=CB=D0=
=C4=D6=B4=D0=D0=C1=F7=B3=CC=B0=C9=A1=A3</span></div><div style=3D=
"text-align:left;font-size:0.875rem;"><span style=3D"font-size:1.=
125rem;font-family:Tahoma;color:rgb(51, 51, 51);">=D2=BB=A1=A2=D2=
=FD=D7=D3</span></div><div style=3D"text-align:left;font-size:0.8=
75rem;"><span style=3D"color:rgb(86, 95, 105);">=CF=C8=C0=B4=BF=B4=
=D2=BB=B6=CE=BC=F2=B5=A5=B5=C4Spark SQL=B3=CC=D0=F2=A3=BA</span><=
/div><div style=3D"text-align:left;font-size:0.875rem;"><span sty=
le=3D"font-size:0.813rem;font-family:&quot;Courier New&quot;color=
:rgb(51, 51, 51);background-color:rgb(245, 245, 245);">1. val sql=
Context =3D new org.apache.spark.sql.SQLContext(sc)=0A2. import s=
qlContext._=0A3.case class Person(name: String, age: Int)=0A4.val=
 people =3D sc.textFile("examples/src/main/resources/people.txt")=
.map(_.split(",")).map(p =3D&gt; Person(p(0), p(1).trim.toInt))=0A=
5.people.registerAsTable("people")=0A6.val teenagers =3D sql("SEL=
ECT name FROM people WHERE age &gt;=3D 13 AND age &lt;=3D 19")=0A=
7.teenagers.map(t =3D&gt; "Name: " + t(0)).collect().foreach(prin=
tln)</span></div><div style=3D"text-align:left;font-size:0.875rem=
;"><br></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"color:rgb(86, 95, 105);">=B3=CC=D0=F2=C7=B0=C1=BD=BE=
=E41=BA=CD2=C9=FA=B3=C9SQLContext=A3=AC=B5=BC=C8=EBsqlContext=CF=C2=
=C3=E6=B5=C4all=A3=AC=D2=B2=BE=CD=CA=C7=D4=CB=D0=D0SparkSQL=B5=C4=
=C9=CF=CF=C2=CE=C4=BB=B7=BE=B3=A1=A3</span></div><div style=3D"te=
xt-align:left;font-size:0.875rem;"><span style=3D"color:rgb(86, 9=
5, 105);">=B3=CC=D0=F23=A3=AC4=C1=BD=BE=E4=CA=C7=BC=D3=D4=D8=CA=FD=
=BE=DD=D4=B4=D7=A2=B2=E1table</span></div><div style=3D"text-alig=
n:left;font-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105)=
;">=B5=DA6=BE=E4=CA=C7=D5=E6=D5=FD=B5=C4=C8=EB=BF=DA=A3=AC=CA=C7s=
ql=BA=AF=CA=FD=A3=AC=B4=AB=C8=EB=D2=BB=BE=E4sql=A3=AC=CF=C8=BB=E1=
=B7=B5=BB=D8=D2=BB=B8=F6SchemaRDD=A1=A3=D5=E2=D2=BB=B2=BD=CA=C7la=
zy=B5=C4=A3=AC=D6=B1=B5=BD=B5=DA=C6=DF=BE=E4=B5=C4collect=D5=E2=B8=
=F6action=D6=B4=D0=D0=CA=B1=A3=ACsql=B2=C5=BB=E1=D6=B4=D0=D0=A1=A3=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
br></div><div style=3D"text-align:left;font-size:0.875rem;"><span=
 style=3D"font-size:1.125rem;font-family:Tahoma;color:rgb(51, 51,=
 51);">&nbsp;=B6=FE=A1=A2SQLCOntext</span></div><div style=3D"tex=
t-align:left;font-size:0.875rem;"><span style=3D"color:rgb(86, 95=
, 105);">SQLContext=CA=C7=D6=B4=D0=D0SQL=B5=C4=C9=CF=CF=C2=CE=C4=B6=
=D4=CF=F3=A3=AC=CA=D7=CF=C8=C0=B4=BF=B4=D2=BB=CF=C2=CB=FCHold=B5=C4=
=D3=D0=C4=C4=D0=A9=B3=C9=D4=B1=A3=BA</span></div><div style=3D"te=
xt-align:left;font-size:0.875rem;"><span style=3D"font-size:1rem;=
font-family:Tahoma;color:rgb(51, 51, 51);">Catalog &nbsp;</span><=
/div><div style=3D"text-align:left;font-size:0.875rem;"><span sty=
le=3D"color:rgb(86, 95, 105);">&nbsp;=D2=BB=B8=F6=B4=E6=B4=A2&lt;=
tableName,logicalPlan&gt;=B5=C4map=BD=E1=B9=B9=A3=AC=B2=E9=D5=D2=B9=
=D8=CF=B5=B5=C4=C4=BF=C2=BC=A3=AC=D7=A2=B2=E1=B1=ED=A3=AC=D7=A2=CF=
=FA=B1=ED=A3=AC=B2=E9=D1=AF=B1=ED=BA=CD=C2=DF=BC=AD=BC=C6=BB=AE=B9=
=D8=CF=B5=B5=C4=C0=E0=A1=A3</span></div><div style=3D"text-align:=
left;"><img data-media-type=3D"image" src alt data-attr-org-src-i=
d=3D"69A0822AEB544BE7941C8A31D9FB408E"></div><div style=3D"text-a=
lign:left;font-size:0.875rem;"><br></div><div style=3D"text-align=
:left;font-size:0.875rem;"><span style=3D"font-size:1rem;font-fam=
ily:Tahoma;color:rgb(51, 51, 51);">SqlParser&nbsp;</span></div><d=
iv style=3D"text-align:left;font-size:0.875rem;"><span style=3D"c=
olor:rgb(86, 95, 105);">&nbsp;Parse =B4=AB=C8=EB=B5=C4sql=C0=B4=B6=
=D4=D3=EF=B7=A8=B7=D6=B4=CA=A3=AC=B9=B9=BD=A8=D3=EF=B7=A8=CA=F7=A3=
=AC=B7=B5=BB=D8=D2=BB=B8=F6logical plan</span></div><div style=3D=
"text-align:left;"><img data-media-type=3D"image" src alt data-at=
tr-org-src-id=3D"03673866D93F4ABFBBED7B58EDBDEA29"></div><div sty=
le=3D"text-align:left;font-size:0.875rem;"><br></div><div style=3D=
"margin-left:28px;text-align:left;font-size:0.875rem;"><span styl=
e=3D"font-size:1rem;font-family:Tahoma;color:rgb(51, 51, 51);">An=
alyzer&nbsp;</span></div><div style=3D"text-align:left;font-size:=
0.875rem;"><span style=3D"color:rgb(86, 95, 105);">&nbsp; logical=
 plan=B5=C4=D3=EF=B7=A8=B7=D6=CE=F6=C6=F7</span></div><div style=3D=
"text-align:left;"><img data-media-type=3D"image" src alt data-at=
tr-org-src-id=3D"5992336C7A3045A98CEB389BB13AFA63"></div><div sty=
le=3D"text-align:left;font-size:0.875rem;"><br></div><div style=3D=
"text-align:left;font-size:0.875rem;"><span style=3D"font-size:1r=
em;font-family:Tahoma;color:rgb(51, 51, 51);">Optimizer&nbsp;</sp=
an></div><div style=3D"text-align:left;font-size:0.875rem;"><span=
 style=3D"color:rgb(86, 95, 105);">&nbsp;logical Plan=B5=C4=D3=C5=
=BB=AF=C6=F7</span></div><div style=3D"text-align:left;"><img dat=
a-media-type=3D"image" src alt data-attr-org-src-id=3D"BAA1AD06B4=
D940559CE8C282AE9A2818"></div><div style=3D"text-align:left;font-=
size:0.875rem;"><br></div><div style=3D"text-align:left;font-size=
:0.875rem;"><span style=3D"font-size:1rem;font-family:Tahoma;colo=
r:rgb(51, 51, 51);">LogicalPlan&nbsp;</span></div><div style=3D"t=
ext-align:left;font-size:0.875rem;"><span style=3D"color:rgb(86,=20=
95, 105);">=C2=DF=BC=AD=BC=C6=BB=AE=A3=AC=D3=C9catalyst=B5=C4Tree=
Node=D7=E9=B3=C9=A3=AC=BF=C9=D2=D4=BF=B4=B5=BD=D3=D03=D6=D6=D3=EF=
=B7=A8=CA=F7</span></div><div style=3D"text-align:left;"><img dat=
a-media-type=3D"image" src alt data-attr-org-src-id=3D"04C0D4267B=
844E78B0733FBF496A1C7A"></div><div style=3D"text-align:left;font-=
size:0.875rem;"><br></div><div style=3D"text-align:left;font-size=
:0.875rem;"><span style=3D"font-size:1rem;font-family:Tahoma;colo=
r:rgb(51, 51, 51);">SparkPlanner&nbsp;</span></div><div style=3D"=
text-align:left;font-size:0.875rem;"><span style=3D"color:rgb(86,=
 95, 105);">=B0=FC=BA=AC=B2=BB=CD=AC=B2=DF=C2=D4=B5=C4=D3=C5=BB=AF=
=B2=DF=C2=D4=C0=B4=D3=C5=BB=AF=CE=EF=C0=ED=D6=B4=D0=D0=BC=C6=BB=AE=
</span></div><div style=3D"text-align:left;"><img data-media-type=
=3D"image" src alt data-attr-org-src-id=3D"1602D795BD464E50A96377=
3660592417"></div><div style=3D"text-align:left;font-size:0.875re=
m;"><br></div><div style=3D"text-align:left;font-size:0.875rem;">=
<span style=3D"font-size:1rem;font-family:Tahoma;color:rgb(51, 51=
, 51);">QueryExecution&nbsp;</span></div><div style=3D"text-align=
:left;font-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);=
">sql=D6=B4=D0=D0=B5=C4=BB=B7=BE=B3=C9=CF=CF=C2=CE=C4</span></div=
><div style=3D"text-align:left;"><img data-media-type=3D"image" s=
rc alt data-attr-org-src-id=3D"BAF49A394E8E47B69711E99ABF9762AA">=
</div><div style=3D"text-align:left;font-size:0.875rem;"><br></di=
v><div style=3D"text-align:left;font-size:0.875rem;"><span style=3D=
"color:rgb(86, 95, 105);">=BE=CD=CA=C7=D5=E2=D0=A9=B6=D4=CF=F3=D7=
=E9=B3=C9=C1=CBSpark SQL=B5=C4=D4=CB=D0=D0=CA=B1=A3=AC=BF=B4=C6=F0=
=C0=B4=BA=DC=BF=E1=A3=AC=D3=D0=BE=B2=CC=AC=B5=C4metadata=B4=E6=B4=
=A2=A3=AC=D3=D0=B7=D6=CE=F6=C6=F7=A1=A2=D3=C5=BB=AF=C6=F7=A1=A2=C2=
=DF=BC=AD=BC=C6=BB=AE=A1=A2=CE=EF=C0=ED=BC=C6=BB=AE=A1=A2=D6=B4=D0=
=D0=D4=CB=D0=D0=CA=B1=A1=A3</span></div><div style=3D"text-align:=
left;font-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);"=
>=C4=C7=D5=E2=D0=A9=B6=D4=CF=F3=CA=C7=D4=F5=C3=B4=CF=E0=BB=A5=D0=AD=
=D7=F7=C0=B4=D6=B4=D0=D0sql=D3=EF=BE=E4=B5=C4=C4=D8=A3=BF</span><=
/div><div style=3D"text-align:left;font-size:0.875rem;"><span sty=
le=3D"font-size:1.125rem;font-family:Tahoma;color:rgb(51, 51, 51)=
;">=C8=FD=A1=A2Spark SQL=D6=B4=D0=D0=C1=F7=B3=CC</span></div><div=
 style=3D"text-align:left;font-size:0.875rem;"><span style=3D"col=
or:rgb(86, 95, 105);">=BB=B0=B2=BB=B6=E0=CB=B5=A3=AC=CF=C8=C9=CF=CD=
=BC=A3=AC=D5=E2=B8=F6=CD=BC=CE=D2=D3=C3=D2=BB=B8=F6=D4=DA=CF=DF=D7=
=F7=CD=BC=B9=A4=BE=DFprocess on=BB=B0=B5=C4=A3=AC=BB=AD=B5=C4=B2=BB=
=BA=C3=A3=AC=CD=BC=C4=DC=B4=EF=D2=E2=BE=CD=D0=D0=A3=BA</span></di=
v><div style=3D"text-align:left;font-size:0.875rem;"><span style=3D=
"color:rgb(86, 95, 105);">&nbsp; &nbsp; &nbsp;&nbsp;</span></div>=
<div style=3D"text-align:left;"><img data-media-type=3D"image" sr=
c alt data-attr-org-src-id=3D"22DDED72BE20488BB8F9779A59B4C1A8"><=
/div><div style=3D"text-align:left;font-size:0.875rem;"><br></div=
><div style=3D"text-align:left;font-size:0.875rem;"><br></div><di=
v style=3D"text-align:left;font-size:0.875rem;"><span style=3D"co=
lor:rgb(86, 95, 105);">=BA=CB=D0=C4=D7=E9=BC=FE=B6=BC=CA=C7=C2=CC=
=C9=AB=B5=C4=B7=BD=BF=F2=A3=AC=C3=BF=D2=BB=B2=BD=C1=F7=B3=CC=B5=C4=
=BD=E1=B9=FB=B6=BC=CA=C7=C0=B6=C9=AB=B5=C4=BF=F2=BF=F2=A3=AC=B5=F7=
=D3=C3=B5=C4=B7=BD=B7=A8=CA=C7=B3=C8=C9=AB=B5=C4=BF=F2=BF=F2=A1=A3=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
br></div><div style=3D"text-align:left;font-size:0.875rem;"><span=
 style=3D"color:rgb(86, 95, 105);">=CF=C8=B8=C5=C0=A8=D2=BB=CF=C2=
=A3=AC=B4=F3=D6=C2=B5=C4=D6=B4=D0=D0=C1=F7=B3=CC=CA=C7=A3=BA</spa=
n></div><div style=3D"text-align:left;font-size:0.875rem;"><span=20=
style=3D"color:rgb(86, 95, 105);">Parse SQL -&gt; Analyze Logical=
 Plan -&gt; Optimize Logical Plan -&gt; Generate Physical Plan -&=
gt; Prepareed Spark Plan -&gt; Execute SQL -&gt; Generate RDD</sp=
an></div><div style=3D"text-align:left;font-size:0.875rem;"><br><=
/div><div style=3D"text-align:left;font-size:0.875rem;"><span sty=
le=3D"color:rgb(86, 95, 105);">=B8=FC=BE=DF=CC=E5=B5=C4=D6=B4=D0=D0=
=C1=F7=B3=CC=A3=BA</span></div><div style=3D"text-align:left;font=
-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);">&nbsp; &=
nbsp; &nbsp;sql or hql -&gt; sql parser(parse)=C9=FA=B3=C9 unreso=
lved logical plan -&gt; analyzer(analysis)=C9=FA=B3=C9analyzed lo=
gical plan &nbsp;-&gt; optimizer(optimize)optimized logical plan=20=
-&gt;&nbsp;spark planner(use strategies to plan)=C9=FA=B3=C9physi=
cal plan -&gt; =B2=C9=D3=C3=B2=BB=CD=ACStrategies=C9=FA=B3=C9spar=
k plan -&gt; spark plan(prepare) prepared spark plan -&gt; call t=
oRDD=A3=A8execute=A3=A8=A3=A9=BA=AF=CA=FD=B5=F7=D3=C3=A3=A9 =D6=B4=
=D0=D0sql=C9=FA=B3=C9RDD</span></div><div style=3D"text-align:lef=
t;font-size:0.875rem;"><br></div><div style=3D"text-align:left;fo=
nt-size:0.875rem;"><span style=3D"font-size:1rem;font-family:Taho=
ma;color:rgb(51, 51, 51);">3.1=A1=A2Parse SQL</span></div><div st=
yle=3D"text-align:left;font-size:0.875rem;"><span style=3D"color:=
rgb(86, 95, 105);">&nbsp;=BB=D8=B5=BD=BF=AA=CA=BC=B5=C4=B3=CC=D0=F2=
=A3=AC=CE=D2=C3=C7=B5=F7=D3=C3sql=BA=AF=CA=FD=A3=AC=C6=E4=CA=B5=CA=
=C7SQLContext=C0=EF=B5=C4sql=BA=AF=CA=FD=CB=FC=B5=C4=CA=B5=CF=D6=CA=
=C7new=D2=BB=B8=F6SchemaRDD=A3=AC=D4=DA=C9=FA=B3=C9=B5=C4=CA=B1=BA=
=F2=BE=CD=B5=F7=D3=C3parseSql=B7=BD=B7=A8=C1=CB=A1=A3</span></div=
><div style=3D"text-align:left;font-size:0.875rem;"><span style=3D=
"font-size:0.813rem;font-family:&quot;Courier New&quot;color:rgb(=
51, 51, 51);background-color:rgb(245, 245, 245);">	  /**=0A   * E=
xecutes a SQL query using Spark, returning the result as a Schema=
RDD.=0A   *=0A   * @group userf=0A   */=0A   def sql(sqlText: Str=
ing): SchemaRDD =3D new SchemaRDD(this, parseSql(sqlText))</span>=
</div><div style=3D"text-align:left;font-size:0.875rem;"><span st=
yle=3D"color:rgb(86, 95, 105);">&nbsp; &nbsp;=BD=E1=B9=FB=CA=C7=BB=
=E1=C9=FA=B3=C9=D2=BB=B8=F6=C2=DF=BC=AD=BC=C6=BB=AE</span></div><=
div style=3D"text-align:left;font-size:0.875rem;"><span style=3D"=
font-size:0.813rem;font-family:&quot;Courier New&quot;color:rgb(5=
1, 51, 51);background-color:rgb(245, 245, 245);">   @transient=0A=
  protected[sql] val parser =3D new catalyst.SqlParser  =0A=0A=0A=
  protected[sql] def parseSql(sql: String): LogicalPlan =3D parse=
r(sql)</span></div><div style=3D"text-align:left;font-size:0.875r=
em;"><span style=3D"font-size:1rem;font-family:Tahoma;color:rgb(5=
1, 51, 51);">&nbsp;3.2=A1=A2Analyze to Execution</span></div><div=
 style=3D"text-align:left;font-size:0.875rem;"><span style=3D"col=
or:rgb(86, 95, 105);">=B5=B1=CE=D2=C3=C7=B5=F7=D3=C3SchemaRDD=C0=EF=
=C3=E6=B5=C4collect=B7=BD=B7=A8=CA=B1=A3=AC=D4=F2=BB=E1=B3=F5=CA=BC=
=BB=AFQueryExecution=A3=AC=BF=AA=CA=BC=C6=F4=B6=AF=D6=B4=D0=D0=A1=
=A3</span></div><div style=3D"text-align:left;font-size:0.875rem;=
"><span style=3D"font-size:0.813rem;font-family:&quot;Courier New=
&quot;color:rgb(51, 51, 51);background-color:rgb(245, 245, 245);"=
> override def collect(): Array[Row] =3D queryExecution.executedP=
lan.executeCollect()</span></div><div style=3D"text-align:left;fo=
nt-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);">=CE=D2=
=C3=C7=BF=C9=D2=D4=BA=DC=C7=E5=CE=FA=B5=C4=BF=B4=B5=BD=D6=B4=D0=D0=
=B2=BD=D6=E8=A3=BA</span></div><div style=3D"text-align:left;font=
-size:0.875rem;"><span style=3D"font-size:0.813rem;font-family:&q=
uot;Courier New&quot;color:rgb(51, 51, 51);background-color:rgb(2=
45, 245, 245);">protected abstract class QueryExecution {=0A    d=
ef logical: LogicalPlan=0A=0A    lazy val analyzed =3D analyzer(l=
ogical)  //=CA=D7=CF=C8=B7=D6=CE=F6=C6=F7=BB=E1=B7=D6=CE=F6=C2=DF=
=BC=AD=BC=C6=BB=AE=0A    lazy val optimizedPlan =3D optimizer(ana=
lyzed) //=CB=E6=BA=F3=D3=C5=BB=AF=C6=F7=C8=A5=D3=C5=BB=AF=B7=D6=CE=
=F6=BA=F3=B5=C4=C2=DF=BC=AD=BC=C6=BB=AE=0A    // TODO: Don't just=
 pick the first one...=0A    lazy val sparkPlan =3D planner(optim=
izedPlan).next() //=B8=F9=BE=DD=B2=DF=C2=D4=C9=FA=B3=C9plan=CE=EF=
=C0=ED=BC=C6=BB=AE=0A    // executedPlan should not be used to in=
itialize any SparkPlan. It should be=0A    // only used for execu=
tion.=0A    lazy val executedPlan: SparkPlan =3D prepareForExecut=
ion(sparkPlan) //=D7=EE=BA=F3=C9=FA=B3=C9=D2=D1=BE=AD=D7=BC=B1=B8=
=BA=C3=B5=C4Spark Plan=0A=0A    /** Internal version of the RDD.=20=
Avoids copies and has no schema */=0A    lazy val toRdd: RDD[Row]=
 =3D executedPlan.execute() //=D7=EE=BA=F3=B5=F7=D3=C3toRDD=B7=BD=
=B7=A8=D6=B4=D0=D0=C8=CE=CE=F1=BD=AB=BD=E1=B9=FB=D7=AA=BB=BB=CE=AA=
RDD=0A=0A    protected def stringOrError[A](f: =3D&gt; A): String=
 =3D=0A      try f.toString catch { case e: Throwable =3D&gt; e.t=
oString }=0A=0A    def simpleString: String =3D stringOrError(exe=
cutedPlan)=0A=0A    override def toString: String =3D=0A      s""=
"=3D=3D Logical Plan =3D=3D=0A         |${stringOrError(analyzed)=
}=0A         |=3D=3D Optimized Logical Plan =3D=3D=0A         |${=
stringOrError(optimizedPlan)}=0A         |=3D=3D Physical Plan =3D=
=3D=0A         |${stringOrError(executedPlan)}=0A      """.stripM=
argin.trim=0A  }</span></div><div style=3D"text-align:left;font-s=
ize:0.875rem;"><br></div><div style=3D"text-align:left;font-size:=
0.875rem;"><span style=3D"color:rgb(86, 95, 105);">=D6=C1=B4=CB=D5=
=FB=B8=F6=C1=F7=B3=CC=BD=E1=CA=F8=A1=A3</span></div><div style=3D=
"text-align:left;font-size:0.875rem;"><span style=3D"font-size:1.=
125rem;font-family:Tahoma;color:rgb(51, 51, 51);">&nbsp; =CB=C4=A1=
=A2=D7=DC=BD=E1=A3=BA</span></div><div style=3D"text-align:left;f=
ont-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);">&nbsp=
; =CD=A8=B9=FD=B7=D6=CE=F6SQLContext=CE=D2=C3=C7=D6=AA=B5=C0=C1=CB=
Spark SQL=B6=BC=B0=FC=BA=AC=C1=CB=C4=C4=D0=A9=D7=E9=BC=FE=A3=ACSq=
lParser,Parser=A3=ACAnalyzer=A3=ACOptimizer=A3=ACLogicalPlan=A3=AC=
SparkPlanner=A3=A8=B0=FC=BA=ACPhysical Plan=A3=A9,QueryExecution.=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"color:rgb(86, 95, 105);">&nbsp; =CD=A8=B9=FD=B5=F7=CA=
=D4=B4=FA=C2=EB=A3=AC=D6=AA=B5=C0=C1=CBSpark SQL=B5=C4=D6=B4=D0=D0=
=C1=F7=B3=CC=A3=BA</span></div><div style=3D"text-align:left;font=
-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);">sql or h=
ql -&gt; sql parser(parse)=C9=FA=B3=C9 unresolved logical plan -&=
gt; analyzer(analysis)=C9=FA=B3=C9analyzed logical plan &nbsp;-&g=
t; optimizer(optimize)optimized logical plan -&gt;&nbsp;spark pla=
nner(use strategies to plan)=C9=FA=B3=C9physical plan -&gt; =B2=C9=
=D3=C3=B2=BB=CD=ACStrategies=C9=FA=B3=C9spark plan -&gt; spark pl=
an(prepare) prepared spark plan -&gt; call toRDD=A3=A8execute=A3=A8=
=A3=A9=BA=AF=CA=FD=B5=F7=D3=C3=A3=A9 =D6=B4=D0=D0sql=C9=FA=B3=C9R=
DD</span></div><div style=3D"text-align:left;font-size:0.875rem;"=
><span style=3D"color:rgb(86, 95, 105);">&nbsp;&nbsp;</span></div=
><div style=3D"text-align:left;font-size:0.875rem;"><span style=3D=
"color:rgb(86, 95, 105);">&nbsp; =CB=E6=BA=F3=BB=B9=BB=E1=B6=D4=C0=
=EF=C3=E6=B5=C4=C3=BF=B8=F6=D7=E9=BC=FE=B6=D4=CF=F3=BD=F8=D0=D0=D1=
=D0=BE=BF=A3=AC=BF=B4=BF=B4catalyst=BE=BF=BE=B9=D7=F6=C1=CB=C4=C4=
=D0=A9=D3=C5=BB=AF=A1=A3</span></div><div style=3D"text-align:lef=
t;font-size:0.875rem;"><span style=3D"color:rgb(86, 95, 105);">&n=
bsp;&nbsp;</span></div><div style=3D"text-align:left;font-size:0.=
875rem;"><span style=3D"color:rgb(86, 95, 105);">&nbsp; =A1=AA=A1=
=AAEOF=A1=AA=A1=AA</span></div><br></div></body></html>=0A=0A=0A=0A=
=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A

------=_Next_Part_0000200484.696--

------=_Next_Part_0000601452.717--

