From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?U3BhcmsgU1FMIM7vwO3WtNDQvMa7rrj3stnX98q1z9Y=?=
Date: Date: Fri, 23 Jul 2021 05:50:53 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0000600888.022"

This is a multi-part message in MIME format.

------=_Next_Part_0000600888.022
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000200296.617"


------=_Next_Part_0000200296.617
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000200296.617
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!doctype html><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A=0A=0A=
=0A=0A=0A=0A=0A=0A<title>Spark SQL =CE=EF=C0=ED=D6=B4=D0=D0=BC=C6=
=BB=AE=B8=F7=B2=D9=D7=F7=CA=B5=CF=D6</title>=0A    =0A<style id=3D=
"wiz_custom_css">html, body {font-size: 12pt;}body {font-family:=20=
Helvetica, 'Hiragino Sans GB', '=CE=A2=C8=ED=D1=C5=BA=DA', 'Micro=
soft YaHei UI', SimSun, SimHei, arial, sans-serif;line-height: 1.=
6;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}h1, h2=
, h3, h4, h5, h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;pa=
dding: 0;font-weight: bold;}h1 {font-size:20pt;font-size:1.67rem;=
}h2 {font-size:18pt;font-size:1.5rem;}h3 {font-size:15pt;font-siz=
e:1.25rem;}h4 {font-size:14pt;font-size:1.17rem;}h5 {font-size:12=
pt;font-size:1rem;}h6 {font-size:12pt;font-size:1rem;color: #7777=
77;margin: 1rem 0;}div, p, ul, ol, dl, li {margin:0;}blockquote,=20=
table, pre, code {margin:8px 0;}ul, ol {padding-left:32px;padding=
-left:2rem;}ol.wiz-list-level1 > li {list-style-type:decimal;}ol.=
wiz-list-level2 > li {list-style-type:lower-latin;}ol.wiz-list-le=
vel3 > li {list-style-type:lower-roman;}blockquote {padding:0 12p=
x;padding:0 0.75rem;}blockquote > :first-child {margin-top:0;}blo=
ckquote > :last-child {margin-bottom:0;}img {border:0;max-width:1=
00%;height:auto !important;margin:2px 0;}table {border-collapse:c=
ollapse;border:1px solid #bbbbbb;}td, th {padding:4px 8px;border-=
collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-b=
reak:break-all;box-sizing: border-box;}.wiz-hide {display:none !i=
mportant;}</style></head>=0A=0A<body class spellcheck=3D"false"><=
div><meta charset=3D"utf-8"><div style=3D"text-align:left;font-si=
ze:0.875rem;"><a href=3D"http://blog.csdn.net/pelick/article/deta=
ils/22748841" style=3D"font-size: 0.875rem; line-height: 1.6;"><s=
pan style=3D"font-size:1.125rem;font-weight:bold;">Spark SQL =CE=EF=
=C0=ED=D6=B4=D0=D0=BC=C6=BB=AE=B8=F7=B2=D9=D7=F7=CA=B5=CF=D6</spa=
n></a></div><div style=3D"text-align:right;font-size:0.875rem;"><=
span style=3D"font-size:0.75rem;font-family:Arial;color:rgb(153,=20=
153, 153);">=B1=EA=C7=A9=A3=BA&nbsp;</span><a href=3D"http://www.=
csdn.net/tag/Spark"><span style=3D"font-size:0.75rem;font-family:=
Arial;color:rgb(200, 131, 38);">Spark</span></a></div><div style=3D=
"text-align:right;font-size:0.875rem;"><span style=3D"font-size:0=
.75rem;font-family:Arial;color:rgb(153, 153, 153);">2014-04-01 18=
:44&nbsp;3908=C8=CB=D4=C4=B6=C1&nbsp;</span><a href=3D"http://blo=
g.csdn.net/pelick/article/details/22748841#comments"><span style=3D=
"font-size:0.75rem;font-family:Arial;color:rgb(200, 131, 38);">=C6=
=C0=C2=DB</span></a><span style=3D"font-size:0.75rem;font-family:=
Arial;color:rgb(153, 153, 153);">(2)&nbsp;</span><span style=3D"f=
ont-size:0.75rem;font-family:Arial;color:rgb(200, 131, 38);">=CA=D5=
=B2=D8</span><span style=3D"font-size:0.75rem;font-family:Arial;c=
olor:rgb(153, 153, 153);">&nbsp;</span><a href=3D"http://blog.csd=
n.net/pelick/article/details/22748841#report"><span style=3D"font=
-size:0.75rem;font-family:Arial;color:rgb(200, 131, 38);">=BE=D9=B1=
=A8</span></a></div><div style=3D"text-align:left;"><img data-med=
ia-type=3D"image" src alt data-attr-org-src-id=3D"C2ECDAFD3BA542E=
EBA949281DB72D44C"></div><div style=3D"text-align:left;font-size:=
0.875rem;"><span style=3D"color:rgb(51, 51, 51);">&nbsp;=B7=D6=C0=
=E0=A3=BA</span></div><div style=3D"text-align:left;font-size:0.8=
75rem;"><span style=3D"color:rgb(223, 52, 52);">Spark=A3=A839=A3=A9=
&nbsp;</span></div><div style=3D"text-align:left;"><img data-medi=
a-type=3D"image" src alt data-attr-org-src-id=3D"CDB73CC56FB844A1=
B50FB646C176398D"></div><div style=3D"text-align:left;font-size:0=
.875rem;"><span style=3D"color:rgb(102, 102, 102);">=B0=E6=C8=A8=C9=
=F9=C3=F7=A3=BA=B1=BE=CE=C4=CE=AA=B2=A9=D6=F7=D4=AD=B4=B4=CE=C4=D5=
=C2=A3=AC=CE=B4=BE=AD=B2=A9=D6=F7=D4=CA=D0=ED=B2=BB=B5=C3=D7=AA=D4=
=D8=A1=A3</span></div><div style=3D"text-align:right;font-size:0.=
875rem;"><span style=3D"font-size:0.75rem;background-color:rgb(23=
8, 238, 238);">=C4=BF=C2=BC</span><a href=3D"http://blog.csdn.net=
/pelick/article/details/22748841#"><span style=3D"font-size:0.75r=
em;color:rgb(0, 56, 132);background-color:rgb(238, 238, 238);">(?=
)[-]</span></a></div><ol class=3D"wiz-list-level1"><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Microsoft YaHei&quot;, STXih=
ei;color:rgb(0, 56, 132);font-weight:normal;font-style:normal;"><=
a href=3D"http://blog.csdn.net/pelick/article/details/22748841#t0=
"><span style=3D"font-size:0.75rem;color:rgb(0, 56, 132);backgrou=
nd-color:rgb(238, 238, 238);">SparkStrategy logical to physical</=
span></a></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Microsoft YaHei&quot;, STXihei;color:rgb(0, 56, 132);font-weight:=
normal;font-style:normal;"><a href=3D"http://blog.csdn.net/pelick=
/article/details/22748841#t1"><span style=3D"font-size:0.75rem;co=
lor:rgb(0, 56, 132);background-color:rgb(238, 238, 238);">SparkPl=
an</span></a></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Microsoft YaHei&quot;, STXihei;color:rgb(0, 56, 132);font-wei=
ght:normal;font-style:normal;"><a href=3D"http://blog.csdn.net/pe=
lick/article/details/22748841#t2"><span style=3D"font-size:0.75re=
m;color:rgb(0, 56, 132);background-color:rgb(238, 238, 238);">Lea=
fNode</span></a></li></ol><ul><ol class=3D"wiz-list-level2"><li s=
tyle=3D"text-align:left;font-size:0.75rem;list-style-position:ins=
ide;list-style-type:lower-alpha;font-family:&quot;Microsoft YaHei=
&quot;, STXihei;color:rgb(0, 56, 132);font-weight:normal;font-sty=
le:normal;"><a href=3D"http://blog.csdn.net/pelick/article/detail=
s/22748841#t3"><span style=3D"font-size:0.75rem;color:rgb(0, 56,=20=
132);background-color:rgb(238, 238, 238);">ExistingRdd</span></a>=
</li></ol></ul><ol class=3D"wiz-list-level1"><li style=3D"text-al=
ign:left;font-size:0.75rem;list-style-position:inside;list-style-=
type:decimal;font-family:&quot;Microsoft YaHei&quot;, STXihei;col=
or:rgb(0, 56, 132);font-weight:normal;font-style:normal;"><a href=
=3D"http://blog.csdn.net/pelick/article/details/22748841#t4"><spa=
n style=3D"font-size:0.75rem;color:rgb(0, 56, 132);background-col=
or:rgb(238, 238, 238);">UnaryNode</span></a></li></ol><ul><ol cla=
ss=3D"wiz-list-level2"><li style=3D"text-align:left;font-size:0.7=
5rem;list-style-position:inside;list-style-type:lower-alpha;font-=
family:&quot;Microsoft YaHei&quot;, STXihei;color:rgb(0, 56, 132)=
;font-weight:normal;font-style:normal;"><a href=3D"http://blog.cs=
dn.net/pelick/article/details/22748841#t5"><span style=3D"font-si=
ze:0.75rem;color:rgb(0, 56, 132);background-color:rgb(238, 238, 2=
38);">Aggregate</span></a></li><li style=3D"text-align:left;font-=
size:0.75rem;list-style-position:inside;list-style-type:lower-alp=
ha;font-family:&quot;Microsoft YaHei&quot;, STXihei;color:rgb(0,=20=
56, 132);font-weight:normal;font-style:normal;"><a href=3D"http:/=
/blog.csdn.net/pelick/article/details/22748841#t6"><span style=3D=
"font-size:0.75rem;color:rgb(0, 56, 132);background-color:rgb(238=
, 238, 238);">DebugNode</span></a></li><li style=3D"text-align:le=
ft;font-size:0.75rem;list-style-position:inside;list-style-type:l=
ower-alpha;font-family:&quot;Microsoft YaHei&quot;, STXihei;color=
:rgb(0, 56, 132);font-weight:normal;font-style:normal;"><a href=3D=
"http://blog.csdn.net/pelick/article/details/22748841#t7"><span s=
tyle=3D"font-size:0.75rem;color:rgb(0, 56, 132);background-color:=
rgb(238, 238, 238);">Exchange</span></a></li><li style=3D"text-al=
ign:left;font-size:0.75rem;list-style-position:inside;list-style-=
type:lower-alpha;font-family:&quot;Microsoft YaHei&quot;, STXihei=
;color:rgb(0, 56, 132);font-weight:normal;font-style:normal;"><a=20=
href=3D"http://blog.csdn.net/pelick/article/details/22748841#t8">=
<span style=3D"font-size:0.75rem;color:rgb(0, 56, 132);background=
-color:rgb(238, 238, 238);">Filter</span></a></li><li style=3D"te=
xt-align:left;font-size:0.75rem;list-style-position:inside;list-s=
tyle-type:lower-alpha;font-family:&quot;Microsoft YaHei&quot;, ST=
Xihei;color:rgb(0, 56, 132);font-weight:normal;font-style:normal;=
"><a href=3D"http://blog.csdn.net/pelick/article/details/22748841=
#t9"><span style=3D"font-size:0.75rem;color:rgb(0, 56, 132);backg=
round-color:rgb(238, 238, 238);">Generate</span></a></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:lower-alpha;font-family:&quot;Microsoft YaHei&qu=
ot;, STXihei;color:rgb(0, 56, 132);font-weight:normal;font-style:=
normal;"><a href=3D"http://blog.csdn.net/pelick/article/details/2=
2748841#t10"><span style=3D"font-size:0.75rem;color:rgb(0, 56, 13=
2);background-color:rgb(238, 238, 238);">Project</span></a></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:lower-alpha;font-family:&quot;Microsoft Y=
aHei&quot;, STXihei;color:rgb(0, 56, 132);font-weight:normal;font=
-style:normal;"><a href=3D"http://blog.csdn.net/pelick/article/de=
tails/22748841#t11"><span style=3D"font-size:0.75rem;color:rgb(0,=
 56, 132);background-color:rgb(238, 238, 238);">Sample</span></a>=
</li><li style=3D"text-align:left;font-size:0.75rem;list-style-po=
sition:inside;list-style-type:lower-alpha;font-family:&quot;Micro=
soft YaHei&quot;, STXihei;color:rgb(0, 56, 132);font-weight:norma=
l;font-style:normal;"><a href=3D"http://blog.csdn.net/pelick/arti=
cle/details/22748841#t12"><span style=3D"font-size:0.75rem;color:=
rgb(0, 56, 132);background-color:rgb(238, 238, 238);">Sort</span>=
</a></li><li style=3D"text-align:left;font-size:0.75rem;list-styl=
e-position:inside;list-style-type:lower-alpha;font-family:&quot;M=
icrosoft YaHei&quot;, STXihei;color:rgb(0, 56, 132);font-weight:n=
ormal;font-style:normal;"><a href=3D"http://blog.csdn.net/pelick/=
article/details/22748841#t13"><span style=3D"font-size:0.75rem;co=
lor:rgb(0, 56, 132);background-color:rgb(238, 238, 238);">StopAft=
er</span></a></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:lower-alpha;font-famil=
y:&quot;Microsoft YaHei&quot;, STXihei;color:rgb(0, 56, 132);font=
-weight:normal;font-style:normal;"><a href=3D"http://blog.csdn.ne=
t/pelick/article/details/22748841#t14"><span style=3D"font-size:0=
.75rem;color:rgb(0, 56, 132);background-color:rgb(238, 238, 238);=
">TopK</span></a></li></ol></ul><ol class=3D"wiz-list-level1"><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Microsoft YaHei&q=
uot;, STXihei;color:rgb(0, 56, 132);font-weight:normal;font-style=
:normal;"><a href=3D"http://blog.csdn.net/pelick/article/details/=
22748841#t15"><span style=3D"font-size:0.75rem;color:rgb(0, 56, 1=
32);background-color:rgb(238, 238, 238);">BinaryNode</span></a></=
li></ol><ul><ol class=3D"wiz-list-level2"><li style=3D"text-align=
:left;font-size:0.75rem;list-style-position:inside;list-style-typ=
e:lower-alpha;font-family:&quot;Microsoft YaHei&quot;, STXihei;co=
lor:rgb(0, 56, 132);font-weight:normal;font-style:normal;"><a hre=
f=3D"http://blog.csdn.net/pelick/article/details/22748841#t16"><s=
pan style=3D"font-size:0.75rem;color:rgb(0, 56, 132);background-c=
olor:rgb(238, 238, 238);">BroadcastNestedLoopJoin</span></a></li>=
<li style=3D"text-align:left;font-size:0.75rem;list-style-positio=
n:inside;list-style-type:lower-alpha;font-family:&quot;Microsoft=20=
YaHei&quot;, STXihei;color:rgb(0, 56, 132);font-weight:normal;fon=
t-style:normal;"><a href=3D"http://blog.csdn.net/pelick/article/d=
etails/22748841#t17"><span style=3D"font-size:0.75rem;color:rgb(0=
, 56, 132);background-color:rgb(238, 238, 238);">CartesianProduct=
</span></a></li><li style=3D"text-align:left;font-size:0.75rem;li=
st-style-position:inside;list-style-type:lower-alpha;font-family:=
&quot;Microsoft YaHei&quot;, STXihei;color:rgb(0, 56, 132);font-w=
eight:normal;font-style:normal;"><a href=3D"http://blog.csdn.net/=
pelick/article/details/22748841#t18"><span style=3D"font-size:0.7=
5rem;color:rgb(0, 56, 132);background-color:rgb(238, 238, 238);">=
SparkEquiInnerJoin</span></a></li></ol></ul><ol class=3D"wiz-list=
-level1"><li style=3D"text-align:left;font-size:0.75rem;list-styl=
e-position:inside;list-style-type:decimal;font-family:&quot;Micro=
soft YaHei&quot;, STXihei;color:rgb(0, 56, 132);font-weight:norma=
l;font-style:normal;"><a href=3D"http://blog.csdn.net/pelick/arti=
cle/details/22748841#t19"><span style=3D"font-size:0.75rem;color:=
rgb(0, 56, 132);background-color:rgb(238, 238, 238);">Other</span=
></a></li></ol><ul><ol class=3D"wiz-list-level2"><li style=3D"tex=
t-align:left;font-size:0.75rem;list-style-position:inside;list-st=
yle-type:lower-alpha;font-family:&quot;Microsoft YaHei&quot;, STX=
ihei;color:rgb(0, 56, 132);font-weight:normal;font-style:normal;"=
><a href=3D"http://blog.csdn.net/pelick/article/details/22748841#=
t20"><span style=3D"font-size:0.75rem;color:rgb(0, 56, 132);backg=
round-color:rgb(238, 238, 238);">Union</span></a></li></ol></ul><=
div style=3D"text-align:left;font-size:0.875rem;"><span style=3D"=
font-size:2rem;color:rgb(85, 85, 85);font-weight:bold;">SparkStra=
tegy: logical to physical</span></div><div style=3D"text-align:le=
ft;font-size:0.875rem;"><span style=3D"font-size:0.938rem;color:r=
gb(85, 85, 85);">Catalyst=D7=F7=CE=AA=D2=BB=B8=F6=CA=B5=CF=D6=CE=DE=
=B9=D8=B5=C4=B2=E9=D1=AF=D3=C5=BB=AF=BF=F2=BC=DC=A3=AC=D4=DA=D3=C5=
=BB=AF=BA=F3=B5=C4=C2=DF=BC=AD=D6=B4=D0=D0=BC=C6=BB=AE=B5=BD=D5=E6=
=D5=FD=B5=C4=CE=EF=C0=ED=D6=B4=D0=D0=BC=C6=BB=AE=D5=E2=B2=BF=B7=D6=
=D6=BB=CC=E1=B9=A9=C1=CB=BD=D3=BF=DA=A3=AC=C3=BB=D3=D0=CC=E1=B9=A9=
=CF=F1Analyzer=BA=CDOptimizer=C4=C7=D1=F9=B5=C4=CA=B5=CF=D6=A1=A3=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
br></div><div style=3D"text-align:left;font-size:0.875rem;"><span=
 style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=B1=BE=CE=C4=
=BD=E9=C9=DC=B5=C4=CA=C7Spark SQL=D7=E9=BC=FE=B8=F7=B8=F6=CE=EF=C0=
=ED=D6=B4=D0=D0=BC=C6=BB=AE=B5=C4=B2=D9=D7=F7=CA=B5=CF=D6=A1=A3=B0=
=D1=D3=C5=BB=AF=BA=F3=B5=C4=C2=DF=BC=AD=D6=B4=D0=D0=BC=C6=BB=AE=D3=
=B3=C9=E4=B5=BD=CE=EF=C0=ED=D6=B4=D0=D0=B2=D9=D7=F7=C0=E0=D5=E2=B2=
=BF=B7=D6=D3=C9SparkStrategies=C0=E0=CA=B5=CF=D6=A3=AC=C4=DA=B2=BF=
=BB=F9=D3=DACatalyst=CC=E1=B9=A9=B5=C4Strategy=BD=D3=BF=DA=A3=AC=CA=
=B5=CF=D6=C1=CB=D2=BB=D0=A9=B2=DF=C2=D4=A3=AC=D3=C3=D3=DA=B7=D6=B1=
=E6logicalPlan=D7=D3=C0=E0=B2=A2=CC=E6=BB=BB=CE=AA=BA=CF=CA=CA=B5=
=C4SparkPlan=D7=D3=C0=E0=A1=A3</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><br></div><div style=3D"text-align:l=
eft;font-size:0.875rem;"><br></div><div style=3D"text-align:left;=
font-size:0.875rem;"><span style=3D"font-size:0.938rem;color:rgb(=
85, 85, 85);">SparkPlan=BC=CC=B3=D0=CC=E5=CF=B5=C8=E7=CF=C2=A1=A3=
=BD=D3=CF=C2=C0=EF=BB=E1=BE=DF=CC=E5=BD=E9=C9=DC=C6=E4=D7=D3=C0=E0=
=B5=C4=CA=B5=CF=D6=A1=A3</span></div><div style=3D"text-align:lef=
t;"><img data-media-type=3D"image" src alt data-attr-org-src-id=3D=
"38EC5C2D5BE147FF99526B8C3E8E9DAB"></div><div style=3D"text-align=
:left;font-size:0.875rem;"><br></div><div style=3D"text-align:lef=
t;font-size:0.875rem;"><br></div><div style=3D"text-align:left;fo=
nt-size:0.875rem;"><br></div><div style=3D"text-align:left;font-s=
ize:0.875rem;"><span style=3D"font-size:2rem;color:rgb(85, 85, 85=
);font-weight:bold;">SparkPlan</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;co=
lor:rgb(85, 85, 85);">=D6=F7=D2=AA=C8=FD=B2=BF=B7=D6=A3=BALeafNod=
e=A1=A2UnaryNode=A1=A2BinaryNode</span></div><div style=3D"text-a=
lign:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;=
color:rgb(85, 85, 85);">=B8=F7=D7=D4=B5=C4=CA=B5=CF=D6=C0=E0=A3=BA=
</span></div><div style=3D"text-align:left;"><img data-media-type=
=3D"image" src alt data-attr-org-src-id=3D"435C31F70FC24E26A0898C=
0EA04BDC1E"></div><div style=3D"text-align:left;font-size:0.875re=
m;"><br></div><div style=3D"text-align:left;font-size:0.875rem;">=
<br></div><div style=3D"text-align:left;font-size:0.875rem;"><spa=
n style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=CC=E1=B9=A9=
=CB=C4=B8=F6=D0=E8=D2=AA=D7=D3=C0=E0=D6=D8=D4=D8=B5=C4=B7=BD=B7=A8=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(19=
2, 192, 192);background-color:rgb(248, 248, 248);font-weight:bold=
;">[java]</span><span style=3D"font-size:0.563rem;font-family:Ver=
dana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248)=
;">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article/de=
tails/22748841#"><span style=3D"font-size:0.563rem;font-family:Ve=
rdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248)=
;">view plain</span></a><span style=3D"font-size:0.563rem;font-fa=
mily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 2=
48, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/ar=
ticle/details/22748841#"><span style=3D"font-size:0.563rem;font-f=
amily:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 2=
48, 248);">copy</span></a></div><ol class=3D"wiz-list-level1"><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 130, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 130, 0);background-color:rgb(255, 255, 255);">//&nbsp;=
TODO:&nbsp;Move&nbsp;to&nbsp;`DistributedPlan`</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 130, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=20=
130, 0);background-color:rgb(248, 248, 248);">/**&nbsp;Specifies&=
nbsp;how&nbsp;data&nbsp;is&nbsp;partitioned&nbsp;across&nbsp;diff=
erent&nbsp;nodes&nbsp;in&nbsp;the&nbsp;cluster.&nbsp;*/</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(255, 255, 255);">def&nbsp;outputPartitioning:&nb=
sp;Partitioning&nbsp;=3D&nbsp;UnknownPartitioning(</span><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color=
:rgb(192, 0, 0);background-color:rgb(255, 255, 255);">0</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(255, 255, 255);">)&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 130, 0);background-color:rgb(255, 255, 255);">//&nbsp;TODO:&nbs=
p;WRONG&nbsp;WIDTH!</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:=
0.75rem;list-style-position:inside;list-style-type:decimal;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 130, 0);font-weight:nor=
mal;font-style:normal;"><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 130, 0);background-color:=
rgb(248, 248, 248);">/**&nbsp;Specifies&nbsp;any&nbsp;partition&n=
bsp;requirements&nbsp;on&nbsp;the&nbsp;input&nbsp;data&nbsp;for&n=
bsp;this&nbsp;operator.&nbsp;*/</span><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(248=
, 248, 248);">&nbsp;&nbsp;</span></li><li style=3D"text-align:lef=
t;font-size:0.75rem;list-style-position:inside;list-style-type:de=
cimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-=
weight:normal;font-style:normal;"><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(255, 25=
5, 255);">def&nbsp;requiredChildDistribution:&nbsp;Seq[Distributi=
on]&nbsp;=3D&nbsp;&nbsp;</span></li><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-we=
ight:normal;font-style:normal;"><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(248, 248,=
 248);">&nbsp;&nbsp;Seq.fill(children.size)(UnspecifiedDistributi=
on)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norm=
al;font-style:normal;"><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&=
nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.7=
5rem;list-style-position:inside;list-style-type:decimal;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;f=
ont-style:normal;"><span style=3D"font-size:0.75rem;font-family:&=
quot;Courier New&quot;background-color:rgb(248, 248, 248);">def&n=
bsp;execute():&nbsp;RDD[Row]&nbsp;&nbsp;</span></li><li style=3D"=
text-align:left;font-size:0.75rem;list-style-position:inside;list=
-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(=
0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(255, 255, 255);">def&nbsp;executeCollect():&nbsp;Array[Row=
]&nbsp;=3D&nbsp;execute().collect()&nbsp;&nbsp;</span></li></ol><=
div style=3D"text-align:left;font-size:0.875rem;"><br></div><div=20=
style=3D"text-align:left;font-size:0.875rem;"><span style=3D"font=
-size:0.938rem;color:rgb(85, 85, 85);">Distribution=BA=CDPartitio=
ning=C0=E0=D3=C3=D3=DA=B1=ED=CA=BE=CA=FD=BE=DD=B7=D6=B2=BC=C7=E9=BF=
=F6=A1=A3=D3=D0=D2=D4=CF=C2=BC=B8=C0=E0=A3=AC=BF=C9=D2=D4=CD=FB=CE=
=C4=C9=FA=D2=E5=A1=A3</span></div><div style=3D"text-align:left;"=
><img data-media-type=3D"image" src alt data-attr-org-src-id=3D"C=
85ED8C325BF4196B1DA7665CFD30B11"></div><div style=3D"text-align:l=
eft;font-size:0.875rem;"><br></div><div style=3D"text-align:left;=
font-size:0.875rem;"><br></div><div style=3D"text-align:left;font=
-size:0.875rem;"><span style=3D"font-size:2rem;color:rgb(85, 85,=20=
85);font-weight:bold;">LeafNode</span></div><div style=3D"text-al=
ign:left;font-size:0.875rem;"><br></div><div style=3D"text-align:=
left;font-size:0.875rem;"><span style=3D"font-size:1.5rem;color:r=
gb(85, 85, 85);font-weight:bold;">ExistingRdd</span></div><div st=
yle=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-s=
ize:0.938rem;color:rgb(85, 85, 85);">=CF=C8=BD=E9=C9=DC=CF=C2Row=BA=
=CDGenericRow=B5=C4=B8=C5=C4=EE=A1=A3</span></div><div style=3D"t=
ext-align:left;font-size:0.875rem;"><span style=3D"font-size:0.93=
8rem;color:rgb(85, 85, 85);">Row=CA=C7=D2=BB=D0=D0output=B6=D4=D3=
=A6=B5=C4=CA=FD=BE=DD=A3=AC=CC=E1=B9=A9getXXX(i: Int)=B7=BD=B7=A8=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(19=
2, 192, 192);background-color:rgb(248, 248, 248);font-weight:bold=
;">[java]</span><span style=3D"font-size:0.563rem;font-family:Ver=
dana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248)=
;">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article/de=
tails/22748841#"><span style=3D"font-size:0.563rem;font-family:Ve=
rdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248)=
;">view plain</span></a><span style=3D"font-size:0.563rem;font-fa=
mily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 2=
48, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/ar=
ticle/details/22748841#"><span style=3D"font-size:0.563rem;font-f=
amily:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 2=
48, 248);">copy</span></a></div><ol class=3D"wiz-list-level1"><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(255, 255, 255);">trait&nbsp;Row&nbsp;</span><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 102, 153);background-color:rgb(255, 255, 255);font-we=
ight:bold;">extends</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;Seq[Any]&nbsp;with&nbsp;Serializable&nbsp;&nbsp;</span></=
li></ol><div style=3D"text-align:left;font-size:0.875rem;"><span=20=
style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=D6=A7=B3=D6=CA=
=FD=BE=DD=C0=E0=D0=CD=B0=FC=C0=A8Int, Long, Double, Float, Boolea=
n, Short, Byte, String=A1=A3=D6=A7=B3=D6=B0=B4=D0=F2=CA=FD(ordina=
l)=B6=C1=C8=A1=C4=B3=D2=BB=B8=F6=C1=D0=B5=C4=D6=B5=A1=A3=B6=C1=C8=
=A1=C7=B0=D0=E8=D2=AA=D7=F6isNullAt(i: Int)=B5=C4=C5=D0=B6=CF=A1=A3=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=B6=D4=D3=
=A6=B5=C4=D3=D0=D2=BB=B8=F6MutableRow=C0=E0=A3=AC=CC=E1=B9=A9setX=
XX(i: Int, value: Any)=B7=BD=B7=A8=A1=A3=BF=C9=D2=D4=D0=DE=B8=C4(=
set)=C4=B3=D0=F2=CA=FD=C9=CF=B5=C4=D6=B5</span></div><div style=3D=
"text-align:left;font-size:0.875rem;"><br></div><div style=3D"tex=
t-align:left;font-size:0.875rem;"><span style=3D"font-size:0.938r=
em;color:rgb(85, 85, 85);">GenericRow=CA=C7Row=B5=C4=D2=BB=D6=D6=B7=
=BD=B1=E3=CA=B5=CF=D6=A3=AC=B4=E6=B5=C4=CA=C7=D2=BB=B8=F6=CA=FD=D7=
=E9</span></div><div style=3D"text-align:left;font-size:0.875rem;=
"><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb=
(192, 192, 192);background-color:rgb(248, 248, 248);font-weight:b=
old;">[java]</span><span style=3D"font-size:0.563rem;font-family:=
Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 2=
48);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article=
/details/22748841#"><span style=3D"font-size:0.563rem;font-family=
:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 2=
48);">view plain</span></a><span style=3D"font-size:0.563rem;font=
-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(248=
, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick=
/article/details/22748841#"><span style=3D"font-size:0.563rem;fon=
t-family:Verdana;color:rgb(12, 137, 207);background-color:rgb(248=
, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-level1">=
<li style=3D"text-align:left;font-size:0.75rem;list-style-positio=
n:inside;list-style-type:decimal;font-family:&quot;Courier New&qu=
ot;color:rgb(0, 102, 153);font-weight:bold;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);font-=
weight:bold;">class</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;GenericRow(</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-co=
lor:rgb(255, 255, 255);font-weight:bold;">protected</span><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(255, 255, 255);">[catalyst]&nbsp;val&nbsp;values=
:&nbsp;Array[Any])&nbsp;</span><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backgrou=
nd-color:rgb(255, 255, 255);font-weight:bold;">extends</span><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;b=
ackground-color:rgb(255, 255, 255);">&nbsp;Row&nbsp;&nbsp;</span>=
</li></ol><div style=3D"text-align:left;font-size:0.875rem;"><spa=
n style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=CB=F9=D2=D4=
=B6=D4=D3=A6=B5=C4=C8=A1=D6=B5=B2=D9=D7=F7=BA=CD=C5=D0=B6=CF=CA=C7=
=B7=F1=CE=AA=BF=D5=B2=D9=D7=F7=BB=E1=D7=AA=BB=AF=CE=AA=CA=FD=D7=E9=
=C9=CF=B5=C4=B6=A8=CE=BB=C8=A1=D6=B5=B2=D9=D7=F7=A1=A3</span></di=
v><div style=3D"text-align:left;font-size:0.875rem;"><span style=3D=
"font-size:0.938rem;color:rgb(85, 85, 85);">=CB=FC=D2=B2=D3=D0=D2=
=BB=B8=F6=B6=D4=D3=A6=B5=C4GenericMutableRow=C0=E0=A3=AC=BF=C9=D2=
=D4=D0=DE=B8=C4(set)=D6=B5=A1=A3</span></div><div style=3D"text-a=
lign:left;font-size:0.875rem;"><br></div><div style=3D"text-align=
:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;colo=
r:rgb(85, 85, 85);">ExistingRdd=D3=C3=D3=DA=B0=D1=B0=F3=B6=A8=C1=CB=
case class=B5=C4rdd=B5=C4=CA=FD=BE=DD=A3=AC=D7=AA=B1=E4=CE=AARDD[=
Row]=A3=AC=CD=AC=CA=B1=B7=B4=C9=E4=CC=E1=C8=A1=B3=F6case class=B5=
=C4=CA=F4=D0=D4(output)=A1=A3=D7=AA=BB=AF=B9=FD=B3=CC=B5=C4=B5=A5=
=C0=FD=C0=E0=BA=CD=B0=E9=C9=FA=B6=D4=CF=F3=C8=E7=CF=C2=A3=BA</spa=
n></div><div style=3D"text-align:left;font-size:0.875rem;"><span=20=
style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 19=
2, 192);background-color:rgb(248, 248, 248);font-weight:bold;">[j=
ava]</span><span style=3D"font-size:0.563rem;font-family:Verdana;=
color:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&n=
bsp;</span><a href=3D"http://blog.csdn.net/pelick/article/details=
/22748841#"><span style=3D"font-size:0.563rem;font-family:Verdana=
;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">vi=
ew plain</span></a><span style=3D"font-size:0.563rem;font-family:=
Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 2=
48);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article=
/details/22748841#"><span style=3D"font-size:0.563rem;font-family=
:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 2=
48);">copy</span></a></div><ol class=3D"wiz-list-level1"><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">object&nbsp;ExistingRdd&nbsp;{&nbsp;&n=
bsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;li=
st-style-position:inside;list-style-type:decimal;font-family:&quo=
t;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-sty=
le:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;=
def&nbsp;convertToCatalyst(a:&nbsp;Any):&nbsp;Any&nbsp;=3D&nbsp;a=
&nbsp;match&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align=
:left;font-size:0.75rem;list-style-position:inside;list-style-typ=
e:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);f=
ont-weight:normal;font-style:normal;"><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(255=
, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102,=
 153);background-color:rgb(255, 255, 255);font-weight:bold;">case=
</span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=
 New&quot;background-color:rgb(255, 255, 255);">&nbsp;s:&nbsp;Seq=
[Any]&nbsp;=3D&gt;&nbsp;s.map(convertToCatalyst)&nbsp;&nbsp;</spa=
n></li><li style=3D"text-align:left;font-size:0.75rem;list-style-=
position:inside;list-style-type:decimal;font-family:&quot;Courier=
 New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal=
;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nb=
sp;</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 102, 153);background-color:rgb(248, 248=
, 248);font-weight:bold;">case</span><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;background-color:rgb(248,=
 248, 248);">&nbsp;p:&nbsp;Product&nbsp;=3D&gt;&nbsp;</span><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-wei=
ght:bold;">new</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nb=
sp;GenericRow(p.productIterator.map(convertToCatalyst).toArray)&n=
bsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fo=
nt-style:normal;"><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;=
&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-col=
or:rgb(255, 255, 255);font-weight:bold;">case</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;other&nbsp;=3D&gt;&nbsp;other&nb=
sp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75r=
em;list-style-position:inside;list-style-type:decimal;font-family=
:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fon=
t-style:normal;"><span style=3D"font-size:0.75rem;font-family:&qu=
ot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&=
nbsp;}&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-s=
ize:0.75rem;list-style-position:inside;list-style-type:decimal;fo=
nt-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:n=
ormal;font-style:normal;"><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;color:rgb(0, 130, 0);background-color:rgb=
(255, 255, 255);">//&nbsp;=B0=D1RDD[A]=D3=B3=C9=E4=B3=C9=CE=AARDD=
[Row]=A3=ACmap&nbsp;A=D6=D0=C3=BF=D2=BB=D0=D0=CA=FD=BE=DD</span><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(248, 248, 248);">&nbsp;&nbsp;def&nbsp;productT=
oRowRdd[A&nbsp;&lt;:&nbsp;Product](data:&nbsp;RDD[A]):&nbsp;RDD[R=
ow]&nbsp;=3D&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-alig=
n:left;font-size:0.75rem;list-style-position:inside;list-style-ty=
pe:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);=
font-weight:normal;font-style:normal;"><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;background-color:rgb(25=
5, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 130=
, 0);background-color:rgb(255, 255, 255);">//&nbsp;TODO:&nbsp;Reu=
se&nbsp;the&nbsp;row,&nbsp;don't&nbsp;use&nbsp;map&nbsp;on&nbsp;t=
he&nbsp;product&nbsp;iterator.&nbsp;&nbsp;Maybe&nbsp;code&nbsp;ge=
n?</span><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</s=
pan></li><li style=3D"text-align:left;font-size:0.75rem;list-styl=
e-position:inside;list-style-type:decimal;font-family:&quot;Couri=
er New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:norm=
al;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&=
nbsp;data.map(r&nbsp;=3D&gt;&nbsp;</span><span style=3D"font-size=
:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153=
);background-color:rgb(248, 248, 248);font-weight:bold;">new</spa=
n><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;background-color:rgb(248, 248, 248);">&nbsp;GenericRow(r.pro=
ductIterator.map(convertToCatalyst).toArray):&nbsp;Row)&nbsp;&nbs=
p;</span></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style=
:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;}&=
nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.7=
5rem;list-style-position:inside;list-style-type:decimal;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;f=
ont-style:normal;"><span style=3D"font-size:0.75rem;font-family:&=
quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp=
;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem=
;list-style-position:inside;list-style-type:decimal;font-family:&=
quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-=
style:normal;"><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nb=
sp;def&nbsp;fromProductRdd[A&nbsp;&lt;:&nbsp;Product&nbsp;:&nbsp;=
TypeTag](productRdd:&nbsp;RDD[A])&nbsp;=3D&nbsp;{&nbsp;&nbsp;</sp=
an></li><li style=3D"text-align:left;font-size:0.75rem;list-style=
-position:inside;list-style-type:decimal;font-family:&quot;Courie=
r New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:norma=
l;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier Ne=
w&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&n=
bsp;ExistingRdd(ScalaReflection.attributesFor[A],&nbsp;productToR=
owRdd(productRdd))&nbsp;&nbsp;</span></li><li style=3D"text-align=
:left;font-size:0.75rem;list-style-position:inside;list-style-typ=
e:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);f=
ont-weight:normal;font-style:normal;"><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(255=
, 255, 255);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(248, 248, 248);">}&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0=
, 0);font-weight:normal;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"text-ali=
gn:left;font-size:0.75rem;list-style-position:inside;list-style-t=
ype:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 102,=20=
153);font-weight:bold;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 15=
3);background-color:rgb(248, 248, 248);font-weight:bold;">case</s=
pan><span style=3D"font-size:0.75rem;font-family:&quot;Courier Ne=
w&quot;background-color:rgb(248, 248, 248);">&nbsp;</span><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-weigh=
t:bold;">class</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nb=
sp;ExistingRdd(output:&nbsp;Seq[Attribute],&nbsp;rdd:&nbsp;RDD[Ro=
w])&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(24=
8, 248, 248);font-weight:bold;">extends</span><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;background-color=
:rgb(248, 248, 248);">&nbsp;LeafNode&nbsp;{&nbsp;&nbsp;</span></l=
i><li style=3D"text-align:left;font-size:0.75rem;list-style-posit=
ion:inside;list-style-type:decimal;font-family:&quot;Courier New&=
quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;def&nbsp;execu=
te()&nbsp;=3D&nbsp;rdd&nbsp;&nbsp;</span></li><li style=3D"text-a=
lign:left;font-size:0.75rem;list-style-position:inside;list-style=
-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=20=
0);font-weight:normal;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">}&nbsp;&nbsp;</span></li></ol><div style=3D"tex=
t-align:left;font-size:0.875rem;"><br></div><div style=3D"text-al=
ign:left;font-size:0.875rem;"><span style=3D"font-size:2rem;color=
:rgb(85, 85, 85);font-weight:bold;">UnaryNode</span></div><div st=
yle=3D"text-align:left;font-size:0.875rem;"><br></div><div style=3D=
"text-align:left;font-size:0.875rem;"><span style=3D"font-size:1.=
5rem;color:rgb(85, 85, 85);font-weight:bold;">Aggregate</span></d=
iv><div style=3D"text-align:left;font-size:0.875rem;"><span style=
=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=D2=FE=CA=BD=D7=AA=
=BB=BB=C9=F9=C3=F7=A3=AC=D5=EB=B6=D4=B1=BE=B5=D8=B7=D6=C7=F8=B5=C4=
RDD=A3=AC=C0=A9=B3=E4=C1=CB=D2=BB=D0=A9=B2=D9=D7=F7</span></div><=
div style=3D"text-align:left;font-size:0.875rem;"><span style=3D"=
font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);b=
ackground-color:rgb(248, 248, 248);font-weight:bold;">[java]</spa=
n><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb=
(192, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;</spa=
n><a href=3D"http://blog.csdn.net/pelick/article/details/22748841=
#"><span style=3D"font-size:0.563rem;font-family:Verdana;color:rg=
b(12, 137, 207);background-color:rgb(248, 248, 248);">view plain<=
/span></a><span style=3D"font-size:0.563rem;font-family:Verdana;c=
olor:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&nb=
sp;</span><a href=3D"http://blog.csdn.net/pelick/article/details/=
22748841#"><span style=3D"font-size:0.563rem;font-family:Verdana;=
color:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">cop=
y</span></a></div><ol class=3D"wiz-list-level1"><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 1=
30, 0);font-weight:normal;font-style:normal;"><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 130=
, 0);background-color:rgb(255, 255, 255);">/*&nbsp;Implicit&nbsp;=
conversions&nbsp;*/</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:=
0.75rem;list-style-position:inside;list-style-type:decimal;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 102, 153);font-weight:b=
old;font-style:normal;"><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-colo=
r:rgb(248, 248, 248);font-weight:bold;">import</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;org.apache.spark.rdd.PartitionLo=
calRDDFunctions._&nbsp;&nbsp;</span></li></ol><div style=3D"text-=
align:left;font-size:0.875rem;"><br></div><div style=3D"text-alig=
n:left;font-size:0.875rem;"><span style=3D"color:rgb(63, 95, 191)=
;">Groups input data by`groupingExpressions` and computes the `ag=
gregateExpressions` for each</span><span style=3D"color:rgb(85, 8=
5, 85);">&nbsp;</span><span style=3D"color:rgb(63, 95, 191);">gro=
up.</span></div><div style=3D"text-align:left;font-size:0.875rem;=
"><span style=3D"color:rgb(63, 95, 191);font-weight:bold;">@param=
</span><span style=3D"color:rgb(63, 95, 191);">&nbsp;child theinp=
ut data source.</span></div><div style=3D"text-align:left;font-si=
ze:0.875rem;"><span style=3D"font-size:0.563rem;font-family:Verda=
na;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248);f=
ont-weight:bold;">[java]</span><span style=3D"font-size:0.563rem;=
font-family:Verdana;color:rgb(192, 192, 192);background-color:rgb=
(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pe=
lick/article/details/22748841#"><span style=3D"font-size:0.563rem=
;font-family:Verdana;color:rgb(12, 137, 207);background-color:rgb=
(248, 248, 248);">view plain</span></a><span style=3D"font-size:0=
.563rem;font-family:Verdana;color:rgb(192, 192, 192);background-c=
olor:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csd=
n.net/pelick/article/details/22748841#"><span style=3D"font-size:=
0.563rem;font-family:Verdana;color:rgb(12, 137, 207);background-c=
olor:rgb(248, 248, 248);">copy</span></a></div><ol class=3D"wiz-l=
ist-level1"><li style=3D"text-align:left;font-size:0.75rem;list-s=
tyle-position:inside;list-style-type:decimal;font-family:&quot;Co=
urier New&quot;color:rgb(0, 102, 153);font-weight:bold;font-style=
:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255=
, 255);font-weight:bold;">case</span><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;background-color:rgb(255,=
 255, 255);">&nbsp;</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-co=
lor:rgb(255, 255, 255);font-weight:bold;">class</span><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(255, 255, 255);">&nbsp;Aggregate(&nbsp;&nbsp;</span>=
</li><li style=3D"text-align:left;font-size:0.75rem;list-style-po=
sition:inside;list-style-type:decimal;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp=
;partial:&nbsp;Boolean,&nbsp;&nbsp;</span></li><li style=3D"text-=
align:left;font-size:0.75rem;list-style-position:inside;list-styl=
e-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=
 0);font-weight:normal;font-style:normal;"><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;background-color:rg=
b(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;groupingExpressions:&n=
bsp;Seq[Expression],&nbsp;&nbsp;</span></li><li style=3D"text-ali=
gn:left;font-size:0.75rem;list-style-position:inside;list-style-t=
ype:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0)=
;font-weight:normal;font-style:normal;"><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(2=
48, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;aggregateExpressions:&nbs=
p;Seq[NamedExpression],&nbsp;&nbsp;</span></li><li style=3D"text-=
align:left;font-size:0.75rem;list-style-position:inside;list-styl=
e-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=
 0);font-weight:normal;font-style:normal;"><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;background-color:rg=
b(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;child:&nbsp;SparkPlan)=
(</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;color:rgb(100, 100, 100);background-color:rgb(255, 255=
, 255);">@transient</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;sc:&nbsp;SparkContext)&nbsp;&nbsp;</span></li></ol><div s=
tyle=3D"text-align:left;font-size:0.875rem;"><br></div><div style=
=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-size=
:0.938rem;color:rgb(85, 85, 85);">=D4=DA=B3=F5=CA=BC=BB=AF=B5=C4=CA=
=B1=BA=F2=A3=ACpartial=D5=E2=B8=F6=B2=CE=CA=FD=D3=C3=C0=B4=B1=EA=D6=
=BE=B1=BE=B4=CEAggregate=B2=D9=D7=F7=D6=BB=D4=DA=B1=BE=B5=D8=D7=F6=
=A3=AC=BB=B9=CA=C7=D2=AA=C8=A5=B5=BD=B7=FB=BA=CFgroupExpression=B5=
=C4=C6=E4=CB=FBpartition=C9=CF=B6=BC=D7=F6=A1=A3=B8=C3=C5=D0=B6=CF=
=C2=DF=BC=AD=C8=E7=CF=C2=A3=BA</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.563rem;fo=
nt-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(2=
48, 248, 248);font-weight:bold;">[java]</span><span style=3D"font=
-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);backg=
round-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://b=
log.csdn.net/pelick/article/details/22748841#"><span style=3D"fon=
t-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);backg=
round-color:rgb(248, 248, 248);">view plain</span></a><span style=
=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 19=
2);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"=
http://blog.csdn.net/pelick/article/details/22748841#"><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 20=
7);background-color:rgb(248, 248, 248);">copy</span></a></div><ol=
 class=3D"wiz-list-level1"><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norm=
al;font-style:normal;"><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">o=
verride&nbsp;def&nbsp;requiredChildDistribution&nbsp;=3D&nbsp;&nb=
sp;</span></li><li style=3D"text-align:left;font-size:0.75rem;lis=
t-style-position:inside;list-style-type:decimal;font-family:&quot=
;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-styl=
e:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&=
nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(=
248, 248, 248);font-weight:bold;">if</span><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;background-color:rg=
b(248, 248, 248);">&nbsp;(partial)&nbsp;{&nbsp;</span><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rg=
b(0, 130, 0);background-color:rgb(248, 248, 248);">//&nbsp;true,&=
nbsp;=CE=B4=D6=AA=B5=C4=B7=D6=B2=BC</span><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">&nbsp;&nbsp;</span></li><li style=3D"text-align=
:left;font-size:0.75rem;list-style-position:inside;list-style-typ=
e:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);f=
ont-weight:normal;font-style:normal;"><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(255=
, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnspecifiedDist=
ribution&nbsp;::&nbsp;Nil&nbsp;&nbsp;</span></li><li style=3D"tex=
t-align:left;font-size:0.75rem;list-style-position:inside;list-st=
yle-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0,=20=
0, 0);font-weight:normal;font-style:normal;"><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;background-color:=
rgb(248, 248, 248);">}&nbsp;</span><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);back=
ground-color:rgb(248, 248, 248);font-weight:bold;">else</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(248, 248, 248);">&nbsp;{&nbsp;&nbsp;</span><=
/li><li style=3D"text-align:left;font-size:0.75rem;list-style-pos=
ition:inside;list-style-type:decimal;font-family:&quot;Courier Ne=
w&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;">=
<span style=3D"font-size:0.75rem;font-family:&quot;Courier New&qu=
ot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 130, 0);background-color:rgb(255, 255, 255);">//&nbsp;=
=C8=E7=B9=FB=CE=AA=BF=D5=A3=AC=D4=F2=B7=D6=B2=BC=C7=E9=BF=F6=CA=C7=
=C8=AB=B2=BF=B5=C4tuple=D4=DA=D2=BB=B8=F6single&nbsp;partition=C0=
=EF</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</=
span></li><li style=3D"text-align:left;font-size:0.75rem;list-sty=
le-position:inside;list-style-type:decimal;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:nor=
mal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-col=
or:rgb(248, 248, 248);font-weight:bold;">if</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;background-c=
olor:rgb(248, 248, 248);">&nbsp;(groupingExpressions&nbsp;=3D=3D&=
nbsp;Nil)&nbsp;{&nbsp;&nbsp;&nbsp;</span></li><li style=3D"text-a=
lign:left;font-size:0.75rem;list-style-position:inside;list-style=
-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=20=
0);font-weight:normal;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;AllTuples&nbsp;::&nbsp;Nil&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;color:rgb(0, 130, 0);background-color:rgb(248, 248, 248);">//=
&nbsp;=B7=F1=D4=F2=CA=C7=BC=AF=C8=BA=B7=D6=B2=BC=B5=C4=A3=AC=B7=D6=
=B2=BC=B9=E6=D4=F2=C0=B4=D7=D4groupExpressions</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp=
;</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255,=20=
255);font-weight:bold;">else</span><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(255, 2=
55, 255);">&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align=
:left;font-size:0.75rem;list-style-position:inside;list-style-typ=
e:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);f=
ont-weight:normal;font-style:normal;"><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(248=
, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clu=
steredDistribution(groupingExpressions)&nbsp;::&nbsp;Nil&nbsp;&nb=
sp;</span></li><li style=3D"text-align:left;font-size:0.75rem;lis=
t-style-position:inside;list-style-type:decimal;font-family:&quot=
;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-styl=
e:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0=
, 0);font-weight:normal;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span><=
/li></ol><div style=3D"text-align:left;font-size:0.875rem;"><br><=
/div><div style=3D"text-align:left;font-size:0.875rem;"><span sty=
le=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=D7=EE=D6=D8=D2=AA=
=B5=C4execute()=B7=BD=B7=A8=A3=BA</span></div><div style=3D"text-=
align:left;font-size:0.875rem;"><span style=3D"font-size:0.563rem=
;font-family:Verdana;color:rgb(192, 192, 192);background-color:rg=
b(248, 248, 248);font-weight:bold;">[java]</span><span style=3D"f=
ont-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);ba=
ckground-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http:=
//blog.csdn.net/pelick/article/details/22748841#"><span style=3D"=
font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);ba=
ckground-color:rgb(248, 248, 248);">view plain</span></a><span st=
yle=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192,=
 192);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D=
"http://blog.csdn.net/pelick/article/details/22748841#"><span sty=
le=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 2=
07);background-color:rgb(248, 248, 248);">copy</span></a></div><o=
l class=3D"wiz-list-level1"><li style=3D"text-align:left;font-siz=
e:0.75rem;list-style-position:inside;list-style-type:decimal;font=
-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:nor=
mal;font-style:normal;"><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">=
def&nbsp;execute()&nbsp;=3D&nbsp;attachTree(</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;=
">this</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(255, 255, 255);">,&nbsp;</sp=
an><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;color:rgb(0, 0, 255);background-color:rgb(255, 255, 255);">=
"execute"</span><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(255, 255, 255);">)&nbsp;{=
&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.=
75rem;list-style-position:inside;list-style-type:decimal;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;=
font-style:normal;"><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbs=
p;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;color:rgb(0, 130, 0);background-color:rgb(248,=20=
248, 248);">//&nbsp;=D5=E2=C0=EF=BD=F8=D0=D0=C1=CB=D2=BB=B4=CE=D2=
=FE=CA=BD=D7=AA=BB=BB=A3=AC=C9=FA=B3=C9=C1=CBPartitionLocalRDDFun=
ctions</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp=
;</span></li><li style=3D"text-align:left;font-size:0.75rem;list-=
style-position:inside;list-style-type:decimal;font-family:&quot;C=
ourier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:=
normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;val=
&nbsp;grouped&nbsp;=3D&nbsp;child.execute().mapPartitions&nbsp;{&=
nbsp;iter&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"text-a=
lign:left;font-size:0.75rem;list-style-position:inside;list-style=
-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=20=
0);font-weight:normal;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;buildGrouping&=
nbsp;=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:r=
gb(248, 248, 248);font-weight:bold;">new</span><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(248, 248, 248);">&nbsp;Projection(groupingExpressions)&nbsp=
;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem=
;list-style-position:inside;list-style-type:decimal;font-family:&=
quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-=
style:normal;"><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nb=
sp;&nbsp;&nbsp;iter.map(row&nbsp;=3D&gt;&nbsp;(buildGrouping(row)=
,&nbsp;row.copy()))&nbsp;&nbsp;</span></li><li style=3D"text-alig=
n:left;font-size:0.75rem;list-style-position:inside;list-style-ty=
pe:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);=
font-weight:normal;font-style:normal;"><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;background-color:rgb(24=
8, 248, 248);">&nbsp;&nbsp;}.groupByKeyLocally()&nbsp;&nbsp;</spa=
n><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;color:rgb(0, 130, 0);background-color:rgb(248, 248, 248);">/=
/&nbsp;=D5=E2=C0=EF=C9=FA=B3=C9=B5=C4=BD=E1=B9=FB=CA=C7RDD[(K,&nb=
sp;Seq[V])]</span><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbs=
p;</span></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style=
:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;va=
l&nbsp;result&nbsp;=3D&nbsp;grouped.map&nbsp;{&nbsp;</span><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;col=
or:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-weig=
ht:bold;">case</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nb=
sp;(group,&nbsp;rows)&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li sty=
le=3D"text-align:left;font-size:0.75rem;list-style-position:insid=
e;list-style-type:decimal;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 130, 0);font-weight:normal;font-style:normal;"><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:=
rgb(0, 130, 0);background-color:rgb(255, 255, 255);">//&nbsp;=D5=E2=
=D2=BB=B2=BD=BB=E1=B0=D1aggregateExpressions=B6=D4=D3=A6=B5=BD=BE=
=DF=CC=E5=B5=C4spark=B7=BD=B7=A8=B6=BC=D5=D2=B3=F6=C0=B4</span><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><l=
i style=3D"text-align:left;font-size:0.75rem;list-style-position:=
inside;list-style-type:decimal;font-family:&quot;Courier New&quot=
;color:rgb(0, 130, 0);font-weight:normal;font-style:normal;"><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 130, 0);background-color:rgb(248, 248, 248);">//&nbsp=
;=BE=DF=CC=E5=D7=F6=B7=A8=CA=C7=B1=E9=C0=FAaggregateExpressions=A3=
=AC=B8=F7=D7=D4newInstance</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;background-color:rgb(248, 248=
, 248);">&nbsp;&nbsp;</span></li><li style=3D"text-align:left;fon=
t-size:0.75rem;list-style-position:inside;list-style-type:decimal=
;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weigh=
t:normal;font-style:normal;"><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;aggImplementations&nbsp;=3D=
&nbsp;createAggregateImplementations()&nbsp;&nbsp;</span></li><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li sty=
le=3D"text-align:left;font-size:0.75rem;list-style-position:insid=
e;list-style-type:decimal;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;</span><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 130, 0);background-color:rgb(255, 255, 255);">//&nbsp=
;Pull&nbsp;out&nbsp;all&nbsp;the&nbsp;functions&nbsp;so&nbsp;we&n=
bsp;can&nbsp;feed&nbsp;each&nbsp;row&nbsp;into&nbsp;them.</span><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;val&n=
bsp;aggFunctions&nbsp;=3D&nbsp;aggImplementations.flatMap(_&nbsp;=
collect&nbsp;{&nbsp;</span><span style=3D"font-size:0.75rem;font-=
family:&quot;Courier New&quot;color:rgb(0, 102, 153);background-c=
olor:rgb(248, 248, 248);font-weight:bold;">case</span><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(248, 248, 248);">&nbsp;f:&nbsp;AggregateFunction&nbs=
p;=3D&gt;&nbsp;f&nbsp;})&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0=
, 0);font-weight:normal;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"text-ali=
gn:left;font-size:0.75rem;list-style-position:inside;list-style-t=
ype:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0)=
;font-weight:normal;font-style:normal;"><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(2=
48, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;rows.foreach&nbsp;{&nbsp;=
row&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"text-align:l=
eft;font-size:0.75rem;list-style-position:inside;list-style-type:=
decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fon=
t-weight:normal;font-style:normal;"><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;background-color:rgb(255,=20=
255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggFunctions.fore=
ach(_.update(row))&nbsp;&nbsp;</span></li><li style=3D"text-align=
:left;font-size:0.75rem;list-style-position:inside;list-style-typ=
e:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);f=
ont-weight:normal;font-style:normal;"><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(248=
, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><l=
i style=3D"text-align:left;font-size:0.75rem;list-style-position:=
inside;list-style-type:decimal;font-family:&quot;Courier New&quot=
;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;buildR=
ow(aggImplementations.map(_.apply(group)))&nbsp;&nbsp;</span></li=
><li style=3D"text-align:left;font-size:0.75rem;list-style-positi=
on:inside;list-style-type:decimal;font-family:&quot;Courier New&q=
uot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(248, 248, 248);">&nbsp;&nbsp;}&nbsp;&nbsp;</=
span></li><li style=3D"text-align:left;font-size:0.75rem;list-sty=
le-position:inside;list-style-type:decimal;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:nor=
mal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span=
></li><li style=3D"text-align:left;font-size:0.75rem;list-style-p=
osition:inside;list-style-type:decimal;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;=
"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
color:rgb(0, 130, 0);background-color:rgb(248, 248, 248);">//&nbs=
p;TODO:&nbsp;THIS&nbsp;BREAKS&nbsp;PIPELINING,&nbsp;DOUBLE&nbsp;C=
OMPUTES&nbsp;THE&nbsp;ANSWER,&nbsp;AND&nbsp;USES&nbsp;TOO&nbsp;MU=
CH&nbsp;MEMORY...</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">=
&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.=
75rem;list-style-position:inside;list-style-type:decimal;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;=
font-style:normal;"><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbs=
p;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(255=
, 255, 255);font-weight:bold;">if</span><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(2=
55, 255, 255);">&nbsp;(groupingExpressions.isEmpty&nbsp;&amp;&amp=
;&nbsp;result.count&nbsp;=3D=3D&nbsp;</span><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;color:rgb(192, 0,=20=
0);background-color:rgb(255, 255, 255);">0</span><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(255, 255, 255);">)&nbsp;{&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;</span><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 130, 0);background-color:rgb(248, 248, 248);">//&nbsp;Wh=
en&nbsp;there&nbsp;is&nbsp;no&nbsp;output&nbsp;to&nbsp;the&nbsp;A=
ggregate&nbsp;operator,&nbsp;we&nbsp;still&nbsp;output&nbsp;an&nb=
sp;empty&nbsp;row.</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);"=
>&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0=
.75rem;list-style-position:inside;list-style-type:decimal;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal=
;font-style:normal;"><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&nb=
sp;&nbsp;&nbsp;&nbsp;val&nbsp;aggImplementations&nbsp;=3D&nbsp;cr=
eateAggregateImplementations()&nbsp;&nbsp;</span></li><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;sc.makeRDD(build=
Row(aggImplementations.map(_.apply(</span><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 15=
3);background-color:rgb(248, 248, 248);font-weight:bold;">null</s=
pan><span style=3D"font-size:0.75rem;font-family:&quot;Courier Ne=
w&quot;background-color:rgb(248, 248, 248);">)))&nbsp;::&nbsp;Nil=
)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0=
.75rem;list-style-position:inside;list-style-type:decimal;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal=
;font-style:normal;"><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&nb=
sp;&nbsp;}&nbsp;</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color=
:rgb(255, 255, 255);font-weight:bold;">else</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;background-c=
olor:rgb(255, 255, 255);">&nbsp;{&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;&n=
bsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;li=
st-style-position:inside;list-style-type:decimal;font-family:&quo=
t;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-sty=
le:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;=
}&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0=
.75rem;list-style-position:inside;list-style-type:decimal;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal=
;font-style:normal;"><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">}&n=
bsp;&nbsp;</span></li></ol><div style=3D"text-align:left;font-siz=
e:0.875rem;"><br></div><div style=3D"text-align:left;font-size:0.=
875rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);=
">AggregateExpression=BC=CC=B3=D0=CC=E5=CF=B5=C8=E7=CF=C2=A3=AC=D5=
=E2=B2=BF=B7=D6=B4=FA=C2=EB=D4=DACatalyst expressions=B0=FC=B5=C4=
aggregates.</span><a href=3D"http://lib.csdn.net/base/scala"><spa=
n style=3D"font-size:0.938rem;color:rgb(223, 52, 52);font-weight:=
bold;">Scala</span></a><span style=3D"font-size:0.938rem;color:rg=
b(85, 85, 85);">=C0=EF=A3=BA</span></div><div style=3D"text-align=
:left;"><img data-media-type=3D"image" src alt data-attr-org-src-=
id=3D"1AA4301C630747B98AC82DAA2708E769"></div><div style=3D"text-=
align:left;font-size:0.875rem;"><br></div><div style=3D"text-alig=
n:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;col=
or:rgb(85, 85, 85);">=CB=FB=B5=C4=B5=DA=D2=BB=C0=E0=CA=B5=CF=D6Ag=
gregateFunction=A3=AC=B4=F8=D2=BB=B8=F6update(input: Row)=B2=D9=D7=
=F7=A1=A3=D7=D3=C0=E0=B5=C4update=B2=D9=D7=F7=CA=C7=CA=B5=BC=CA=B6=
=D4Row=D6=B4=D0=D0=B1=E4=BB=AF=A1=A3</span></div><div style=3D"te=
xt-align:left;font-size:0.875rem;"><br></div><div style=3D"text-a=
lign:left;font-size:0.875rem;"><span style=3D"font-size:1.5rem;co=
lor:rgb(85, 85, 85);font-weight:bold;">DebugNode</span></div><div=
 style=3D"text-align:left;font-size:0.875rem;"><span style=3D"fon=
t-size:0.938rem;color:rgb(85, 85, 85);">DebugNode=CA=C7=B0=D1=B4=AB=
=BD=F8=C0=B4child SparkPlan=B5=F7=D3=C3execute()=D6=B4=D0=D0=A3=AC=
=C8=BB=BA=F3=B0=D1=BD=E1=B9=FBchildRdd=D6=F0=B8=F6=CA=E4=B3=F6=B2=
=E9=BF=B4</span></div><div style=3D"text-align:left;font-size:0.8=
75rem;"><span style=3D"font-size:0.563rem;font-family:Verdana;col=
or:rgb(192, 192, 192);background-color:rgb(248, 248, 248);font-we=
ight:bold;">[java]</span><span style=3D"font-size:0.563rem;font-f=
amily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248,=20=
248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/a=
rticle/details/22748841#"><span style=3D"font-size:0.563rem;font-=
family:Verdana;color:rgb(12, 137, 207);background-color:rgb(248,=20=
248, 248);">view plain</span></a><span style=3D"font-size:0.563re=
m;font-family:Verdana;color:rgb(192, 192, 192);background-color:r=
gb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/=
pelick/article/details/22748841#"><span style=3D"font-size:0.563r=
em;font-family:Verdana;color:rgb(12, 137, 207);background-color:r=
gb(248, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-le=
vel1"><li style=3D"text-align:left;font-size:0.75rem;list-style-p=
osition:inside;list-style-type:decimal;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 102, 153);font-weight:bold;font-style:norma=
l;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier Ne=
w&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255)=
;font-weight:bold;">case</span><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;background-color:rgb(255, 255,=20=
255);">&nbsp;</span><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:rg=
b(255, 255, 255);font-weight:bold;">class</span><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(255, 255, 255);">&nbsp;DebugNode(child:&nbsp;SparkPlan)&nb=
sp;</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255=
, 255);font-weight:bold;">extends</span><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(2=
55, 255, 255);">&nbsp;UnaryNode&nbsp;&nbsp;</span></li></ol><div=20=
style=3D"text-align:left;font-size:0.875rem;"><br></div><div styl=
e=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-siz=
e:1.5rem;color:rgb(85, 85, 85);font-weight:bold;">Exchange</span>=
</div><div style=3D"text-align:left;font-size:0.875rem;"><span st=
yle=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192,=
 192);background-color:rgb(248, 248, 248);font-weight:bold;">[jav=
a]</span><span style=3D"font-size:0.563rem;font-family:Verdana;co=
lor:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&nbs=
p;</span><a href=3D"http://blog.csdn.net/pelick/article/details/2=
2748841#"><span style=3D"font-size:0.563rem;font-family:Verdana;c=
olor:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">view=
 plain</span></a><span style=3D"font-size:0.563rem;font-family:Ve=
rdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248=
);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article/d=
etails/22748841#"><span style=3D"font-size:0.563rem;font-family:V=
erdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248=
);">copy</span></a></div><ol class=3D"wiz-list-level1"><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 102, 153);font-weight:bold;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;=
">case</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(255, 255, 255);">&nbsp;</spa=
n><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);f=
ont-weight:bold;">class</span><span style=3D"font-size:0.75rem;fo=
nt-family:&quot;Courier New&quot;background-color:rgb(255, 255, 2=
55);">&nbsp;Exchange(newPartitioning:&nbsp;Partitioning,&nbsp;chi=
ld:&nbsp;SparkPlan)&nbsp;</span><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backgro=
und-color:rgb(255, 255, 255);font-weight:bold;">extends</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(255, 255, 255);">&nbsp;UnaryNode&nbsp;&nbsp;=
</span></li></ol><div style=3D"text-align:left;font-size:0.875rem=
;"><br></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=CE=AA=C4=
=B3=B8=F6SparkPlan=A3=AC=CA=B5=CA=A9=D0=C2=B5=C4=B7=D6=C7=F8=B2=DF=
=C2=D4=A1=A3</span></div><div style=3D"text-align:left;font-size:=
0.875rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85=
);">execute()=B7=BD=B7=A8=A3=BA</span></div><div style=3D"text-al=
ign:left;font-size:0.875rem;"><span style=3D"font-size:0.563rem;f=
ont-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(=
248, 248, 248);font-weight:bold;">[java]</span><span style=3D"fon=
t-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);back=
ground-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://=
blog.csdn.net/pelick/article/details/22748841#"><span style=3D"fo=
nt-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);back=
ground-color:rgb(248, 248, 248);">view plain</span></a><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 1=
92);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D=
"http://blog.csdn.net/pelick/article/details/22748841#"><span sty=
le=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 2=
07);background-color:rgb(248, 248, 248);">copy</span></a></div><o=
l class=3D"wiz-list-level1"><li style=3D"text-align:left;font-siz=
e:0.75rem;list-style-position:inside;list-style-type:decimal;font=
-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:nor=
mal;font-style:normal;"><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">=
def&nbsp;execute()&nbsp;=3D&nbsp;attachTree(</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;=
">this</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(255, 255, 255);">&nbsp;,&nbs=
p;</span><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;color:rgb(0, 0, 255);background-color:rgb(255, 255, 2=
55);">"execute"</span><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">)&=
nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-s=
ize:0.75rem;list-style-position:inside;list-style-type:decimal;fo=
nt-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:n=
ormal;font-style:normal;"><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);=
">&nbsp;&nbsp;&nbsp;&nbsp;newPartitioning&nbsp;match&nbsp;{&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backgr=
ound-color:rgb(255, 255, 255);font-weight:bold;">case</span><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(255, 255, 255);">&nbsp;HashPartitioning(expres=
sions,&nbsp;numPartitions)&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><l=
i style=3D"text-align:left;font-size:0.75rem;list-style-position:=
inside;list-style-type:decimal;font-family:&quot;Courier New&quot=
;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 130, 0);background-color=
:rgb(248, 248, 248);">//&nbsp;=B0=D1expression=D7=F7=D3=C3=B5=BDr=
dd=C3=BF=B8=F6partition=B5=C4=C3=BF=B8=F6row=C9=CF</span><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backg=
round-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;val&nbsp;rdd&nbsp;=3D&nbsp;child.execute().mapPartition=
s&nbsp;{&nbsp;iter&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;val&nbsp;hashExpressions&nbsp;=3D&nbsp;</span=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;color:rgb(0, 102, 153);background-color:rgb(248, 248, 248);fo=
nt-weight:bold;">new</span><span style=3D"font-size:0.75rem;font-=
family:&quot;Courier New&quot;background-color:rgb(248, 248, 248)=
;">&nbsp;MutableProjection(expressions)&nbsp;&nbsp;</span></li><l=
i style=3D"text-align:left;font-size:0.75rem;list-style-position:=
inside;list-style-type:decimal;font-family:&quot;Courier New&quot=
;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;mutablePair&nbsp;=3D&nbsp;=
</span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=
 New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 2=
55);font-weight:bold;">new</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;background-color:rgb(255, 255=
, 255);">&nbsp;MutablePair[Row,&nbsp;Row]()&nbsp;</span><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:=
rgb(0, 130, 0);background-color:rgb(255, 255, 255);">//&nbsp;=CF=E0=
=B5=B1=D3=DATuple2</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);"=
>&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0=
.75rem;list-style-position:inside;list-style-type:decimal;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal=
;font-style:normal;"><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter.map=
(r&nbsp;=3D&gt;&nbsp;mutablePair.update(hashExpressions(r),&nbsp;=
r))&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norm=
al;font-style:normal;"><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</spa=
n></li><li style=3D"text-align:left;font-size:0.75rem;list-style-=
position:inside;list-style-type:decimal;font-family:&quot;Courier=
 New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal=
;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;part&nbsp;=3D&nbsp;</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
color:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-w=
eight:bold;">new</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&=
nbsp;HashPartitioner(numPartitions)&nbsp;&nbsp;</span></li><li st=
yle=3D"text-align:left;font-size:0.75rem;list-style-position:insi=
de;list-style-type:decimal;font-family:&quot;Courier New&quot;col=
or:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;color:rgb(0, 130, 0);background-color:rgb=
(255, 255, 255);">//&nbsp;=C9=FA=B3=C9ShuffledRDD</span><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=
=3D"text-align:left;font-size:0.75rem;list-style-position:inside;=
list-style-type:decimal;font-family:&quot;Courier New&quot;color:=
rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;val&nbsp;shuffled&nbsp;=3D&nbsp;</span><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=20=
102, 153);background-color:rgb(248, 248, 248);font-weight:bold;">=
new</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(248, 248, 248);">&nbsp;Shuffled=
RDD[Row,&nbsp;Row,&nbsp;MutablePair[Row,&nbsp;Row]](rdd,&nbsp;par=
t)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:=
0.75rem;list-style-position:inside;list-style-type:decimal;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norma=
l;font-style:normal;"><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shuffled.setSeriali=
zer(</span><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 25=
5, 255);font-weight:bold;">new</span><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;background-color:rgb(255,=
 255, 255);">&nbsp;SparkSqlSerializer(</span><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102,=
 153);background-color:rgb(255, 255, 255);font-weight:bold;">new<=
/span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(255, 255, 255);">&nbsp;SparkConf(</=
span><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255=
);font-weight:bold;">false</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;background-color:rgb(255, 255=
, 255);">)))&nbsp;&nbsp;</span></li><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-we=
ight:normal;font-style:normal;"><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(248, 248,=
 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shuffled.=
map(_._2)&nbsp;</span><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 130, 0);background-color:rg=
b(248, 248, 248);">//&nbsp;=CA=E4=B3=F6Tuple2=C0=EF=B5=C4=B5=DA=B6=
=FE=B8=F6=D6=B5</span><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&n=
bsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fo=
nt-style:normal;"><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backgr=
ound-color:rgb(248, 248, 248);font-weight:bold;">case</span><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(248, 248, 248);">&nbsp;RangePartitioning(sorti=
ngExpressions,&nbsp;numPartitions)&nbsp;=3D&gt;&nbsp;&nbsp;</span=
></li><li style=3D"text-align:left;font-size:0.75rem;list-style-p=
osition:inside;list-style-type:decimal;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;=
"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;color:rgb(0, 130, 0);backgrou=
nd-color:rgb(255, 255, 255);">//&nbsp;TODO:&nbsp;RangePartitioner=
&nbsp;should&nbsp;take&nbsp;an&nbsp;Ordering.</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;implicit&nbsp;val&nbsp;ordering&nbsp;=3D&nbsp;</span><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;col=
or:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-weig=
ht:bold;">new</span><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbs=
p;RowOrdering(sortingExpressions)&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;val&nbsp;rdd&nbsp;=3D&nbsp;child.execute().mapPartitions&nb=
sp;{&nbsp;iter&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;val&nbsp;mutablePair&nbsp;=3D&nbsp;</span><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 102, 153);background-color:rgb(255, 255, 255);font-wei=
ght:bold;">new</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&nb=
sp;MutablePair[Row,&nbsp;Null](</span><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);b=
ackground-color:rgb(255, 255, 255);font-weight:bold;">null</span>=
<span style=3D"font-size:0.75rem;font-family:&quot;Courier New&qu=
ot;background-color:rgb(255, 255, 255);">,&nbsp;</span><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:r=
gb(0, 102, 153);background-color:rgb(255, 255, 255);font-weight:b=
old;">null</span><span style=3D"font-size:0.75rem;font-family:&qu=
ot;Courier New&quot;background-color:rgb(255, 255, 255);">)&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter.map(row&nb=
sp;=3D&gt;&nbsp;mutablePair.update(row,&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(248, 248, 248);font-weight:bold;=
">null</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(248, 248, 248);">))&nbsp;&nb=
sp;</span></li><li style=3D"text-align:left;font-size:0.75rem;lis=
t-style-position:inside;list-style-type:decimal;font-family:&quot=
;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-styl=
e:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li s=
tyle=3D"text-align:left;font-size:0.75rem;list-style-position:ins=
ide;list-style-type:decimal;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;val&nbsp;part&nbsp;=3D&nbsp;</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=
 102, 153);background-color:rgb(248, 248, 248);font-weight:bold;"=
>new</span><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;background-color:rgb(248, 248, 248);">&nbsp;RangePa=
rtitioner(numPartitions,&nbsp;rdd,&nbsp;ascending&nbsp;=3D&nbsp;<=
/span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 102, 153);background-color:rgb(248, 248, 24=
8);font-weight:bold;">true</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;background-color:rgb(248, 248=
, 248);">)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;fo=
nt-size:0.75rem;list-style-position:inside;list-style-type:decima=
l;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weig=
ht:normal;font-style:normal;"><span style=3D"font-size:0.75rem;fo=
nt-family:&quot;Courier New&quot;background-color:rgb(255, 255, 2=
55);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;sh=
uffled&nbsp;=3D&nbsp;</span><span style=3D"font-size:0.75rem;font=
-family:&quot;Courier New&quot;color:rgb(0, 102, 153);background-=
color:rgb(255, 255, 255);font-weight:bold;">new</span><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(255, 255, 255);">&nbsp;ShuffledRDD[Row,&nbsp;Null,&n=
bsp;MutablePair[Row,&nbsp;Null]](rdd,&nbsp;part)&nbsp;&nbsp;</spa=
n></li><li style=3D"text-align:left;font-size:0.75rem;list-style-=
position:inside;list-style-type:decimal;font-family:&quot;Courier=
 New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal=
;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;shuffled.setSerializer(</span><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color=
:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-weight=
:bold;">new</span><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;=
SparkSqlSerializer(</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-co=
lor:rgb(248, 248, 248);font-weight:bold;">new</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;SparkConf(</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=
 102, 153);background-color:rgb(248, 248, 248);font-weight:bold;"=
>false</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(248, 248, 248);">)))&nbsp;&n=
bsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;li=
st-style-position:inside;list-style-type:decimal;font-family:&quo=
t;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-sty=
le:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shuffled.map(_._1)&nbsp;&nbsp=
;</span></li><li style=3D"text-align:left;font-size:0.75rem;list-=
style-position:inside;list-style-type:decimal;font-family:&quot;C=
ourier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:=
normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</s=
pan></li><li style=3D"text-align:left;font-size:0.75rem;list-styl=
e-position:inside;list-style-type:decimal;font-family:&quot;Couri=
er New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:norm=
al;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-colo=
r:rgb(255, 255, 255);font-weight:bold;">case</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;SinglePartition&nbsp;=3D&gt;&nbs=
p;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75re=
m;list-style-position:inside;list-style-type:decimal;font-family:=
&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font=
-style:normal;"><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;child.execute().coalesce(=
</span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=
 New&quot;color:rgb(192, 0, 0);background-color:rgb(248, 248, 248=
);">1</span><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(248, 248, 248);">,&nbsp;shuff=
le&nbsp;=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-colo=
r:rgb(248, 248, 248);font-weight:bold;">true</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">)&nbsp;&nbsp;</span></li><li style=3D"=
text-align:left;font-size:0.75rem;list-style-position:inside;list=
-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(=
0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0=
, 0);font-weight:normal;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;color:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-=
weight:bold;">case</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);"=
>&nbsp;_&nbsp;=3D&gt;&nbsp;sys.error(s</span><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 0, 2=
55);background-color:rgb(248, 248, 248);">"Exchange&nbsp;not&nbsp=
;implemented&nbsp;for&nbsp;$newPartitioning"</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">)&nbsp;&nbsp;</span></li><li style=3D"=
text-align:left;font-size:0.75rem;list-style-position:inside;list=
-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(=
0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</spa=
n><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;color:rgb(0, 130, 0);background-color:rgb(255, 255, 255);">/=
/&nbsp;TODO:&nbsp;Handle&nbsp;BroadcastPartitioning.</span><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li st=
yle=3D"text-align:left;font-size:0.75rem;list-style-position:insi=
de;list-style-type:decimal;font-family:&quot;Courier New&quot;col=
or:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nb=
sp;</span></li><li style=3D"text-align:left;font-size:0.75rem;lis=
t-style-position:inside;list-style-type:decimal;font-family:&quot=
;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-styl=
e:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;}=
&nbsp;&nbsp;</span></li></ol><div style=3D"text-align:left;font-s=
ize:0.875rem;"><br></div><div style=3D"text-align:left;font-size:=
0.875rem;"><span style=3D"font-size:1.5rem;color:rgb(85, 85, 85);=
font-weight:bold;">Filter</span></div><div style=3D"text-align:le=
ft;font-size:0.875rem;"><span style=3D"font-size:0.563rem;font-fa=
mily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 2=
48, 248);font-weight:bold;">[java]</span><span style=3D"font-size=
:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);background=
-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.c=
sdn.net/pelick/article/details/22748841#"><span style=3D"font-siz=
e:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);background=
-color:rgb(248, 248, 248);">view plain</span></a><span style=3D"f=
ont-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);ba=
ckground-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http:=
//blog.csdn.net/pelick/article/details/22748841#"><span style=3D"=
font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);ba=
ckground-color:rgb(248, 248, 248);">copy</span></a></div><ol clas=
s=3D"wiz-list-level1"><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 102, 153);font-weight:bold;=
font-style:normal;"><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:rg=
b(255, 255, 255);font-weight:bold;">case</span><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(255, 255, 255);">&nbsp;</span><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);bac=
kground-color:rgb(255, 255, 255);font-weight:bold;">class</span><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">&nbsp;Filter(condition:&n=
bsp;Expression,&nbsp;child:&nbsp;SparkPlan)&nbsp;</span><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:=
rgb(0, 102, 153);background-color:rgb(255, 255, 255);font-weight:=
bold;">extends</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&nb=
sp;UnaryNode&nbsp;&nbsp;</span></li><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-we=
ight:normal;font-style:normal;"><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(248, 248,=
 248);">&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font=
-size:0.75rem;list-style-position:inside;list-style-type:decimal;=
font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight=
:normal;font-style:normal;"><span style=3D"font-size:0.75rem;font=
-family:&quot;Courier New&quot;background-color:rgb(255, 255, 255=
);">def&nbsp;execute()&nbsp;=3D&nbsp;child.execute().mapPartition=
s&nbsp;{&nbsp;iter&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(248, 248, 248);">&nbsp;&nbsp;iter.filter(condition.apply(=
_).asInstanceOf[Boolean])&nbsp;&nbsp;</span></li><li style=3D"tex=
t-align:left;font-size:0.75rem;list-style-position:inside;list-st=
yle-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0,=20=
0, 0);font-weight:normal;font-style:normal;"><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;background-color:=
rgb(255, 255, 255);">}&nbsp;&nbsp;</span></li></ol><div style=3D"=
text-align:left;font-size:0.875rem;"><br></div><div style=3D"text=
-align:left;font-size:0.875rem;"><span style=3D"font-size:1.5rem;=
color:rgb(85, 85, 85);font-weight:bold;">Generate</span></div><di=
v style=3D"text-align:left;font-size:0.875rem;"><span style=3D"fo=
nt-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);bac=
kground-color:rgb(248, 248, 248);font-weight:bold;">[java]</span>=
<span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(1=
92, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;</span>=
<a href=3D"http://blog.csdn.net/pelick/article/details/22748841#"=
><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(=
12, 137, 207);background-color:rgb(248, 248, 248);">view plain</s=
pan></a><span style=3D"font-size:0.563rem;font-family:Verdana;col=
or:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&nbsp=
;</span><a href=3D"http://blog.csdn.net/pelick/article/details/22=
748841#"><span style=3D"font-size:0.563rem;font-family:Verdana;co=
lor:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">copy<=
/span></a></div><ol class=3D"wiz-list-level1"><li style=3D"text-a=
lign:left;font-size:0.75rem;list-style-position:inside;list-style=
-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 102=
, 153);font-weight:bold;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102,=20=
153);background-color:rgb(255, 255, 255);font-weight:bold;">case<=
/span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(255, 255, 255);">&nbsp;</span><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 102, 153);background-color:rgb(255, 255, 255);font-wei=
ght:bold;">class</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&=
nbsp;Generate(&nbsp;&nbsp;</span></li><li style=3D"text-align:lef=
t;font-size:0.75rem;list-style-position:inside;list-style-type:de=
cimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-=
weight:normal;font-style:normal;"><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(248, 24=
8, 248);">&nbsp;&nbsp;&nbsp;&nbsp;generator:&nbsp;Generator,&nbsp=
;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem=
;list-style-position:inside;list-style-type:decimal;font-family:&=
quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-=
style:normal;"><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nb=
sp;&nbsp;&nbsp;join:&nbsp;Boolean,&nbsp;&nbsp;</span></li><li sty=
le=3D"text-align:left;font-size:0.75rem;list-style-position:insid=
e;list-style-type:decimal;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;outer:&nbsp=
;Boolean,&nbsp;&nbsp;</span></li><li style=3D"text-align:left;fon=
t-size:0.75rem;list-style-position:inside;list-style-type:decimal=
;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weigh=
t:normal;font-style:normal;"><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;&nbsp;&nbsp;&nbsp;child:&nbsp;SparkPlan)&nbsp;&nbsp;</=
span></li><li style=3D"text-align:left;font-size:0.75rem;list-sty=
le-position:inside;list-style-type:decimal;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:nor=
mal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;color:rgb(0, 102, 153);background-color:rgb(248, 248, 248);fo=
nt-weight:bold;">extends</span><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;background-color:rgb(248, 248,=20=
248);">&nbsp;UnaryNode&nbsp;&nbsp;</span></li></ol><div style=3D"=
text-align:left;font-size:0.875rem;"><br></div><div style=3D"text=
-align:left;font-size:0.875rem;"><span style=3D"font-size:0.938re=
m;color:rgb(85, 85, 85);">=CA=D7=CF=C8=A3=ACGenerator=CA=C7=B1=ED=
=B4=EF=CA=BD=B5=C4=D7=D3=C0=E0=A3=AC=BC=CC=B3=D0=BD=E1=B9=B9=C8=E7=
=CF=C2</span></div><div style=3D"text-align:left;"><img data-medi=
a-type=3D"image" src alt data-attr-org-src-id=3D"3C5134FBE9A34178=
92C2DA7D524FF635"></div><div style=3D"text-align:left;font-size:0=
.875rem;"><br></div><div style=3D"text-align:left;font-size:0.875=
rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">G=
enerator=B5=C4=D7=F7=D3=C3=CA=C7=B0=D1input=B5=C4row=B4=A6=C0=ED=BA=
=F3=CA=E4=B3=F60=B8=F6=BB=F2=B6=E0=B8=F6rows=A3=ACmakeOutput()=B5=
=C4=B2=DF=C2=D4=D3=C9=D7=D3=C0=E0=CA=B5=CF=D6=A1=A3</span></div><=
div style=3D"text-align:left;font-size:0.875rem;"><span style=3D"=
font-size:0.938rem;color:rgb(85, 85, 85);">Explode=C0=E0=D7=F6=B7=
=A8=CA=C7=BD=AB=CA=E4=C8=EB=B5=C4input array=C0=EF=B5=C4=C3=BF=D2=
=BB=B8=F6value=A3=A8=BF=C9=C4=DC=CA=C7ArrayType=A3=AC=BF=C9=C4=DC=
=CA=C7MapType=A3=A9=A3=AC=B1=E4=B3=C9=D2=BB=B8=F6GenericRow(Array=
(v))=A3=AC=CA=E4=B3=F6=BE=CD=CA=C7=D2=BB=B8=F6</span></div><div s=
tyle=3D"text-align:left;font-size:0.875rem;"><br></div><div style=
=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-size=
:0.938rem;color:rgb(85, 85, 85);">=BB=D8=B5=BDGenerate=B2=D9=D7=F7=
=A3=AC</span></div><div style=3D"text-align:left;font-size:0.875r=
em;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">jo=
in=B2=BC=B6=FB=D6=B5=D3=C3=D3=DA=D6=B8=B6=A8=D7=EE=BA=F3=CA=E4=B3=
=F6=B5=C4=BD=E1=B9=FB=CA=C7=B7=F1=D2=AA=BA=CD=CA=E4=C8=EB=B5=C4=D4=
=ADtuple=CF=D4=CA=BE=D7=F6join</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;co=
lor:rgb(85, 85, 85);">outer=B2=BC=B6=FB=D6=B5=D6=BB=D3=D0=D4=DAjo=
in=CE=AAtrue=B5=C4=CA=B1=BA=F2=B2=C5=C9=FA=D0=A7=A3=AC=C7=D2outer=
=CE=AAtrue=B5=C4=CA=B1=BA=F2=A3=AC=C3=BF=B8=F6input=B5=C4row=B6=BC=
=D6=C1=C9=D9=BB=E1=B1=BB=D7=F7=CE=AA=D2=BB=B4=CEoutput</span></di=
v><div style=3D"text-align:left;font-size:0.875rem;"><br></div><d=
iv style=3D"text-align:left;font-size:0.875rem;"><span style=3D"f=
ont-size:0.938rem;color:rgb(85, 85, 85);">=D7=DC=CC=E5=C9=CF=A3=AC=
Generate=B2=D9=D7=F7=C0=E0=CB=C6FP=C0=EF=B5=C4flatMap=B2=D9=D7=F7=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(19=
2, 192, 192);background-color:rgb(248, 248, 248);font-weight:bold=
;">[java]</span><span style=3D"font-size:0.563rem;font-family:Ver=
dana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248)=
;">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article/de=
tails/22748841#"><span style=3D"font-size:0.563rem;font-family:Ve=
rdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248)=
;">view plain</span></a><span style=3D"font-size:0.563rem;font-fa=
mily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 2=
48, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/ar=
ticle/details/22748841#"><span style=3D"font-size:0.563rem;font-f=
amily:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 2=
48, 248);">copy</span></a></div><ol class=3D"wiz-list-level1"><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(255, 255, 255);">def&nbsp;execute()&nbsp;=3D&nbs=
p;{&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norm=
al;font-style:normal;"><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&=
nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(=
248, 248, 248);font-weight:bold;">if</span><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;background-color:rg=
b(248, 248, 248);">&nbsp;(join)&nbsp;{&nbsp;&nbsp;</span></li><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;child.e=
xecute().mapPartitions&nbsp;{&nbsp;iter&nbsp;=3D&gt;&nbsp;&nbsp;<=
/span></li><li style=3D"text-align:left;font-size:0.75rem;list-st=
yle-position:inside;list-style-type:decimal;font-family:&quot;Cou=
rier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:no=
rmal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=
 New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;val&nbsp;nullValues&nbsp;=3D&nbsp;Seq.fill(gen=
erator.output.size)(Literal(</span><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);back=
ground-color:rgb(248, 248, 248);font-weight:bold;">null</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(248, 248, 248);">))&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;color:rgb(0, 130, 0);background-color:rgb(255, 2=
55, 255);">//&nbsp;Used&nbsp;to&nbsp;produce&nbsp;rows&nbsp;with&=
nbsp;no&nbsp;matches&nbsp;when&nbsp;outer&nbsp;=3D&nbsp;true.</sp=
an><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></=
li><li style=3D"text-align:left;font-size:0.75rem;list-style-posi=
tion:inside;list-style-type:decimal;font-family:&quot;Courier New=
&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;val&nbsp;outerProjection&nbsp;=3D&nbsp;&nbsp;</span></=
li><li style=3D"text-align:left;font-size:0.75rem;list-style-posi=
tion:inside;list-style-type:decimal;font-family:&quot;Courier New=
&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;fo=
nt-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backgroun=
d-color:rgb(255, 255, 255);font-weight:bold;">new</span><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(255, 255, 255);">&nbsp;Projection(child.output&nbs=
p;++&nbsp;nullValues,&nbsp;child.output)&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li s=
tyle=3D"text-align:left;font-size:0.75rem;list-style-position:ins=
ide;list-style-type:decimal;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;val&nbsp;joinProjection&nbsp;=3D&nbsp;&nbsp;</span></li><li st=
yle=3D"text-align:left;font-size:0.75rem;list-style-position:insi=
de;list-style-type:decimal;font-family:&quot;Courier New&quot;col=
or:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:r=
gb(248, 248, 248);font-weight:bold;">new</span><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(248, 248, 248);">&nbsp;Projection(child.output&nbsp;++&nbsp=
;generator.output,&nbsp;child.output&nbsp;++&nbsp;generator.outpu=
t)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:=
0.75rem;list-style-position:inside;list-style-type:decimal;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norma=
l;font-style:normal;"><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;joinedRow&nbsp;=3D&nbs=
p;</span><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255,=
 255);font-weight:bold;">new</span><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(255, 2=
55, 255);">&nbsp;JoinedRow&nbsp;&nbsp;</span></li><li style=3D"te=
xt-align:left;font-size:0.75rem;list-style-position:inside;list-s=
tyle-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0,=
 0, 0);font-weight:normal;font-style:normal;"><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;background-color=
:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li style=3D"text-a=
lign:left;font-size:0.75rem;list-style-position:inside;list-style=
-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=20=
0);font-weight:normal;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter.flatMa=
p&nbsp;{row&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0=
, 0);font-weight:normal;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;val&nbsp;outputRows&nbsp;=3D&nbsp;generator(row)&nbsp;&nbsp;</=
span></li><li style=3D"text-align:left;font-size:0.75rem;list-sty=
le-position:inside;list-style-type:decimal;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:nor=
mal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);ba=
ckground-color:rgb(255, 255, 255);font-weight:bold;">if</span><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(255, 255, 255);">&nbsp;(outer&nbsp;&amp;&amp=
;&nbsp;outputRows.isEmpty)&nbsp;{&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;outerProjection(row)&nbsp;::&nbsp;Nil&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;=
">else</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(255, 255, 255);">&nbsp;{&nbs=
p;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75re=
m;list-style-position:inside;list-style-type:decimal;font-family:=
&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font=
-style:normal;"><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outputRows.ma=
p(or&nbsp;=3D&gt;&nbsp;joinProjection(joinedRow(row,&nbsp;or)))&n=
bsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fo=
nt-style:normal;"><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></l=
i><li style=3D"text-align:left;font-size:0.75rem;list-style-posit=
ion:inside;list-style-type:decimal;font-family:&quot;Courier New&=
quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;}&nbsp;&nbsp;</span></li><li style=3D"text-align:left;f=
ont-size:0.75rem;list-style-position:inside;list-style-type:decim=
al;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-wei=
ght:normal;font-style:normal;"><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;background-color:rgb(255, 255,=20=
255);">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li style=
=3D"text-align:left;font-size:0.75rem;list-style-position:inside;=
list-style-type:decimal;font-family:&quot;Courier New&quot;color:=
rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;}&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(248, 248, 248);font-weight:bold;=
">else</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(248, 248, 248);">&nbsp;{&nbs=
p;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75re=
m;list-style-position:inside;list-style-type:decimal;font-family:=
&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font=
-style:normal;"><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&n=
bsp;&nbsp;&nbsp;child.execute().mapPartitions(iter&nbsp;=3D&gt;&n=
bsp;iter.flatMap(generator))&nbsp;&nbsp;</span></li><li style=3D"=
text-align:left;font-size:0.75rem;list-style-position:inside;list=
-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(=
0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(248, 248, 248);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li=20=
style=3D"text-align:left;font-size:0.75rem;list-style-position:in=
side;list-style-type:decimal;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backg=
round-color:rgb(255, 255, 255);">}&nbsp;&nbsp;</span></li></ol><d=
iv style=3D"text-align:left;font-size:0.875rem;"><br></div><div s=
tyle=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-=
size:1.5rem;color:rgb(85, 85, 85);font-weight:bold;">Project</spa=
n></div><div style=3D"text-align:left;font-size:0.875rem;"><span=20=
style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 19=
2, 192);background-color:rgb(248, 248, 248);font-weight:bold;">[j=
ava]</span><span style=3D"font-size:0.563rem;font-family:Verdana;=
color:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&n=
bsp;</span><a href=3D"http://blog.csdn.net/pelick/article/details=
/22748841#"><span style=3D"font-size:0.563rem;font-family:Verdana=
;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">vi=
ew plain</span></a><span style=3D"font-size:0.563rem;font-family:=
Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 2=
48);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article=
/details/22748841#"><span style=3D"font-size:0.563rem;font-family=
:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 2=
48);">copy</span></a></div><ol class=3D"wiz-list-level1"><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 102, 153);font-weight:bold;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:r=
gb(0, 102, 153);background-color:rgb(255, 255, 255);font-weight:b=
old;">case</span><span style=3D"font-size:0.75rem;font-family:&qu=
ot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;<=
/span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 25=
5);font-weight:bold;">class</span><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(255, 25=
5, 255);">&nbsp;Project(projectList:&nbsp;Seq[NamedExpression],&n=
bsp;child:&nbsp;SparkPlan)&nbsp;</span><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);=
background-color:rgb(255, 255, 255);font-weight:bold;">extends</s=
pan><span style=3D"font-size:0.75rem;font-family:&quot;Courier Ne=
w&quot;background-color:rgb(255, 255, 255);">&nbsp;UnaryNode&nbsp=
;&nbsp;</span></li></ol><div style=3D"text-align:left;font-size:0=
.875rem;"><br></div><div style=3D"text-align:left;font-size:0.875=
rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">p=
roject=B5=C4=D6=B4=D0=D0=A3=BA</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.563rem;fo=
nt-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(2=
48, 248, 248);font-weight:bold;">[java]</span><span style=3D"font=
-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);backg=
round-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://b=
log.csdn.net/pelick/article/details/22748841#"><span style=3D"fon=
t-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);backg=
round-color:rgb(248, 248, 248);">view plain</span></a><span style=
=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 19=
2);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"=
http://blog.csdn.net/pelick/article/details/22748841#"><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 20=
7);background-color:rgb(248, 248, 248);">copy</span></a></div><ol=
 class=3D"wiz-list-level1"><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norm=
al;font-style:normal;"><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">d=
ef&nbsp;execute()&nbsp;=3D&nbsp;child.execute().mapPartitions&nbs=
p;{&nbsp;iter&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"te=
xt-align:left;font-size:0.75rem;list-style-position:inside;list-s=
tyle-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0,=
 0, 0);font-weight:normal;font-style:normal;"><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;background-color=
:rgb(248, 248, 248);">&nbsp;&nbsp;</span><span style=3D"font-size=
:0.75rem;font-family:&quot;Courier New&quot;color:rgb(100, 100, 1=
00);background-color:rgb(248, 248, 248);">@transient</span><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(248, 248, 248);">&nbsp;val&nbsp;reusableProject=
ion&nbsp;=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-col=
or:rgb(248, 248, 248);font-weight:bold;">new</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;MutableProjection(projectList)&n=
bsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fo=
nt-style:normal;"><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;=
&nbsp;iter.map(reusableProjection)&nbsp;&nbsp;</span></li><li sty=
le=3D"text-align:left;font-size:0.75rem;list-style-position:insid=
e;list-style-type:decimal;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(248, 248, 248);">}&nbsp;&nbsp;</span></li></ol><div=20=
style=3D"text-align:left;font-size:0.875rem;"><br></div><div styl=
e=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-siz=
e:0.938rem;color:rgb(85, 85, 85);">MutableProjection=C0=E0=CA=C7R=
ow =3D&gt; Row=B5=C4=BC=CC=B3=D0=C0=E0=A3=AC=CB=FC=B9=B9=D4=EC=B5=
=C4=CA=B1=BA=F2=BD=D3=CA=D5=D2=BB=B8=F6Seq[Expression]=A3=AC=BB=B9=
=D4=CA=D0=ED=BD=D3=CA=D5=D2=BB=B8=F6inputSchema: Seq[Attribute]=A1=
=A3MutableProjection=D3=C3=D3=DA=B8=F9=BE=DD=B1=ED=B4=EF=CA=BD=A3=
=A8=BA=CDSchema=A3=AC=C8=E7=B9=FB=D3=D0Schema=B5=C4=BB=B0=A3=A9=B0=
=D1Row=D3=B3=C9=E4=B3=C9=D0=C2=B5=C4Row=A3=AC=B8=C4=B1=E4=C4=DA=B2=
=BF=B5=C4column=A1=A3</span></div><div style=3D"text-align:left;f=
ont-size:0.875rem;"><br></div><div style=3D"text-align:left;font-=
size:0.875rem;"><span style=3D"font-size:1.5rem;color:rgb(85, 85,=
 85);font-weight:bold;">Sample</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.563rem;fo=
nt-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(2=
48, 248, 248);font-weight:bold;">[java]</span><span style=3D"font=
-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);backg=
round-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://b=
log.csdn.net/pelick/article/details/22748841#"><span style=3D"fon=
t-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);backg=
round-color:rgb(248, 248, 248);">view plain</span></a><span style=
=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 19=
2);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"=
http://blog.csdn.net/pelick/article/details/22748841#"><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 20=
7);background-color:rgb(248, 248, 248);">copy</span></a></div><ol=
 class=3D"wiz-list-level1"><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 102, 153);font-weight:=
bold;font-style:normal;"><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-col=
or:rgb(255, 255, 255);font-weight:bold;">case</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;</span><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153)=
;background-color:rgb(255, 255, 255);font-weight:bold;">class</sp=
an><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(255, 255, 255);">&nbsp;Sample(fraction=
:&nbsp;Double,&nbsp;withReplacement:&nbsp;Boolean,&nbsp;seed:&nbs=
p;Int,&nbsp;child:&nbsp;SparkPlan)&nbsp;&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;=
">extends</span><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;Un=
aryNode&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-=
size:0.75rem;list-style-position:inside;list-style-type:decimal;f=
ont-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:=
normal;font-style:normal;"><span style=3D"font-size:0.75rem;font-=
family:&quot;Courier New&quot;background-color:rgb(248, 248, 248)=
;">&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norm=
al;font-style:normal;"><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">d=
ef&nbsp;execute()&nbsp;=3D&nbsp;child.execute().sample(withReplac=
ement,&nbsp;fraction,&nbsp;seed)&nbsp;&nbsp;</span></li></ol><div=
 style=3D"text-align:left;font-size:0.875rem;"><br></div><div sty=
le=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-si=
ze:0.938rem;color:rgb(85, 85, 85);">RDD=B5=C4sample=B2=D9=D7=F7=A3=
=BA</span></div><div style=3D"text-align:left;font-size:0.875rem;=
"><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb=
(192, 192, 192);background-color:rgb(248, 248, 248);font-weight:b=
old;">[java]</span><span style=3D"font-size:0.563rem;font-family:=
Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 2=
48);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article=
/details/22748841#"><span style=3D"font-size:0.563rem;font-family=
:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 2=
48);">view plain</span></a><span style=3D"font-size:0.563rem;font=
-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(248=
, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick=
/article/details/22748841#"><span style=3D"font-size:0.563rem;fon=
t-family:Verdana;color:rgb(12, 137, 207);background-color:rgb(248=
, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-level1">=
<li style=3D"text-align:left;font-size:0.75rem;list-style-positio=
n:inside;list-style-type:decimal;font-family:&quot;Courier New&qu=
ot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;b=
ackground-color:rgb(255, 255, 255);">def&nbsp;sample(withReplacem=
ent:&nbsp;Boolean,&nbsp;fraction:&nbsp;Double,&nbsp;seed:&nbsp;In=
t):&nbsp;RDD[T]&nbsp;=3D&nbsp;{&nbsp;&nbsp;</span></li><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(248, 248, 248);">&nbsp;&nbsp;require(fraction&nbsp;&gt;=3D=
&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;color:rgb(192, 0, 0);background-color:rgb(248, 24=
8, 248);">0.0</span><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;background-color:rgb(248, 248, 248);">,&nb=
sp;</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 0, 255);background-color:rgb(248, 248,=20=
248);">"Invalid&nbsp;fraction&nbsp;value:&nbsp;"</span><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(248, 248, 248);">&nbsp;+&nbsp;fraction)&nbsp;&nbsp;=
</span></li><li style=3D"text-align:left;font-size:0.75rem;list-s=
tyle-position:inside;list-style-type:decimal;font-family:&quot;Co=
urier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:n=
ormal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</sp=
an><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);=
font-weight:bold;">if</span><span style=3D"font-size:0.75rem;font=
-family:&quot;Courier New&quot;background-color:rgb(255, 255, 255=
);">&nbsp;(withReplacement)&nbsp;{&nbsp;&nbsp;</span></li><li sty=
le=3D"text-align:left;font-size:0.75rem;list-style-position:insid=
e;list-style-type:decimal;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;</span><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-we=
ight:bold;">new</span><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&n=
bsp;PartitionwiseSampledRDD[T,&nbsp;T](</span><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102=
, 153);background-color:rgb(248, 248, 248);font-weight:bold;">thi=
s</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(248, 248, 248);">,&nbsp;</span><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;color:rgb(0, 102, 153);background-color:rgb(248, 248, 248);font-=
weight:bold;">new</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">=
&nbsp;PoissonSampler[T](fraction),&nbsp;seed)&nbsp;&nbsp;</span><=
/li><li style=3D"text-align:left;font-size:0.75rem;list-style-pos=
ition:inside;list-style-type:decimal;font-family:&quot;Courier Ne=
w&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;">=
<span style=3D"font-size:0.75rem;font-family:&quot;Courier New&qu=
ot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;}&nbsp;</spa=
n><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);f=
ont-weight:bold;">else</span><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-we=
ight:normal;font-style:normal;"><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(248, 248,=
 248);">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);=
background-color:rgb(248, 248, 248);font-weight:bold;">new</span>=
<span style=3D"font-size:0.75rem;font-family:&quot;Courier New&qu=
ot;background-color:rgb(248, 248, 248);">&nbsp;PartitionwiseSampl=
edRDD[T,&nbsp;T](</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-colo=
r:rgb(248, 248, 248);font-weight:bold;">this</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">,&nbsp;</span><span style=3D"font-size=
:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153=
);background-color:rgb(248, 248, 248);font-weight:bold;">new</spa=
n><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;background-color:rgb(248, 248, 248);">&nbsp;BernoulliSampler=
[T](fraction),&nbsp;seed)&nbsp;&nbsp;</span></li><li style=3D"tex=
t-align:left;font-size:0.75rem;list-style-position:inside;list-st=
yle-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0,=20=
0, 0);font-weight:normal;font-style:normal;"><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;background-color:=
rgb(255, 255, 255);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li sty=
le=3D"text-align:left;font-size:0.75rem;list-style-position:insid=
e;list-style-type:decimal;font-family:&quot;Courier New&quot;colo=
r:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(248, 248, 248);">}&nbsp;&nbsp;</span></li></ol><div=20=
style=3D"text-align:left;font-size:0.875rem;"><span style=3D"font=
-size:0.938rem;color:rgb(85, 85, 85);">=C9=FA=B3=C9=B5=C4Partitio=
nwiseSampledRDD=BB=E1=D4=DA</span><span style=3D"font-size:0.938r=
em;color:rgb(85, 85, 85);background-color:rgb(255, 255, 0);">=B8=B8=
RDD=B5=C4=C3=BF=B8=F6partition=B6=BC=D1=A1=C8=A1=D1=F9=B1=BE</spa=
n><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=A1=A3=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">PossionS=
ampler=BA=CDBernoulliSampler=CA=C7RandomSampler=B5=C4=C1=BD=D6=D6=
=CA=B5=CF=D6=A1=A3</span></div><div style=3D"text-align:left;font=
-size:0.875rem;"><br></div><div style=3D"text-align:left;font-siz=
e:0.875rem;"><span style=3D"font-size:1.5rem;color:rgb(85, 85, 85=
);font-weight:bold;">Sort</span></div><div style=3D"text-align:le=
ft;font-size:0.875rem;"><span style=3D"font-size:0.563rem;font-fa=
mily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 2=
48, 248);font-weight:bold;">[java]</span><span style=3D"font-size=
:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);background=
-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.c=
sdn.net/pelick/article/details/22748841#"><span style=3D"font-siz=
e:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);background=
-color:rgb(248, 248, 248);">view plain</span></a><span style=3D"f=
ont-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);ba=
ckground-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http:=
//blog.csdn.net/pelick/article/details/22748841#"><span style=3D"=
font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);ba=
ckground-color:rgb(248, 248, 248);">copy</span></a></div><ol clas=
s=3D"wiz-list-level1"><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 102, 153);font-weight:bold;=
font-style:normal;"><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:rg=
b(255, 255, 255);font-weight:bold;">case</span><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(255, 255, 255);">&nbsp;</span><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);bac=
kground-color:rgb(255, 255, 255);font-weight:bold;">class</span><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">&nbsp;Sort(&nbsp;&nbsp;</=
span></li><li style=3D"text-align:left;font-size:0.75rem;list-sty=
le-position:inside;list-style-type:decimal;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:nor=
mal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;=
&nbsp;sortOrder:&nbsp;Seq[SortOrder],&nbsp;&nbsp;</span></li><li=20=
style=3D"text-align:left;font-size:0.75rem;list-style-position:in=
side;list-style-type:decimal;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backg=
round-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;global:&=
nbsp;Boolean,&nbsp;&nbsp;</span></li><li style=3D"text-align:left=
;font-size:0.75rem;list-style-position:inside;list-style-type:dec=
imal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-w=
eight:normal;font-style:normal;"><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;background-color:rgb(248, 248=
, 248);">&nbsp;&nbsp;&nbsp;&nbsp;child:&nbsp;SparkPlan)&nbsp;&nbs=
p;</span></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style=
:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</=
span><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255=
);font-weight:bold;">extends</span><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(255, 2=
55, 255);">&nbsp;UnaryNode&nbsp;&nbsp;</span></li></ol><div style=
=3D"text-align:left;font-size:0.875rem;"><br></div><div style=3D"=
text-align:left;font-size:0.875rem;"><span style=3D"font-size:0.9=
38rem;color:rgb(85, 85, 85);">=B6=D4=B7=D6=B2=BC=D3=D0=D2=AA=C7=F3=
=A3=BA</span></div><div style=3D"text-align:left;font-size:0.875r=
em;"><span style=3D"font-size:0.563rem;font-family:Verdana;color:=
rgb(192, 192, 192);background-color:rgb(248, 248, 248);font-weigh=
t:bold;">[java]</span><span style=3D"font-size:0.563rem;font-fami=
ly:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248=
, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/arti=
cle/details/22748841#"><span style=3D"font-size:0.563rem;font-fam=
ily:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248=
, 248);">view plain</span></a><span style=3D"font-size:0.563rem;f=
ont-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(=
248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pel=
ick/article/details/22748841#"><span style=3D"font-size:0.563rem;=
font-family:Verdana;color:rgb(12, 137, 207);background-color:rgb(=
248, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-level=
1"><li style=3D"text-align:left;font-size:0.75rem;list-style-posi=
tion:inside;list-style-type:decimal;font-family:&quot;Courier New=
&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">override&nbsp;def&nbsp;re=
quiredChildDistribution&nbsp;=3D&nbsp;&nbsp;</span></li><li style=
=3D"text-align:left;font-size:0.75rem;list-style-position:inside;=
list-style-type:decimal;font-family:&quot;Courier New&quot;color:=
rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;</span><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102=
, 153);background-color:rgb(248, 248, 248);font-weight:bold;">if<=
/span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(248, 248, 248);">&nbsp;(global)&nbs=
p;OrderedDistribution(sortOrder)&nbsp;::&nbsp;Nil&nbsp;&nbsp;&nbs=
p;</span></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Courier New&quot;color:rgb(0, 102, 153);font-weight:bold;font-sty=
le:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 2=
55, 255);font-weight:bold;">else</span><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;background-color:rgb(25=
5, 255, 255);">&nbsp;UnspecifiedDistribution&nbsp;::&nbsp;Nil&nbs=
p;&nbsp;</span></li></ol><div style=3D"text-align:left;font-size:=
0.875rem;"><br></div><div style=3D"text-align:left;font-size:0.87=
5rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=
SortOrder=C0=E0=CA=C7UnaryExpression=B5=C4=CA=B5=CF=D6=A3=AC=B6=A8=
=D2=E5=C1=CBtuple=C5=C5=D0=F2=B5=C4=B2=DF=C2=D4=A3=A8=B5=DD=D4=F6=
=BB=F2=B5=DD=BC=F5=A3=A9=A1=A3=B8=C3=C0=E0=D6=BB=CA=C7=CE=AAchild=
 expression=C3=C7=C9=F9=C3=F7=C1=CB=C5=C5=D0=F2=B2=DF=C2=D4=A1=A3=
=D6=AE=CB=F9=D2=D4=BC=CC=B3=D0Expression=A3=AC=CA=C7=CE=AA=C1=CB=C4=
=DC=D3=B0=CF=EC=B5=BD=D7=D3=CA=F7=A1=A3</span></div><div style=3D=
"text-align:left;font-size:0.875rem;"><span style=3D"font-size:0.=
563rem;font-family:Verdana;color:rgb(192, 192, 192);background-co=
lor:rgb(248, 248, 248);font-weight:bold;">[java]</span><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 1=
92);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D=
"http://blog.csdn.net/pelick/article/details/22748841#"><span sty=
le=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 2=
07);background-color:rgb(248, 248, 248);">view plain</span></a><s=
pan style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192=
, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;</span><a=
 href=3D"http://blog.csdn.net/pelick/article/details/22748841#"><=
span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12=
, 137, 207);background-color:rgb(248, 248, 248);">copy</span></a>=
</div><ol class=3D"wiz-list-level1"><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);fon=
t-weight:bold;font-style:normal;"><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backg=
round-color:rgb(255, 255, 255);font-weight:bold;">case</span><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;b=
ackground-color:rgb(255, 255, 255);">&nbsp;</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=
 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;"=
>class</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(255, 255, 255);">&nbsp;SortO=
rder(child:&nbsp;Expression,&nbsp;direction:&nbsp;SortDirection)&=
nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 2=
55, 255);font-weight:bold;">extends</span><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(255, 255, 255);">&nbsp;UnaryExpression&nbsp;&nbsp;</span></li></=
ol><div style=3D"text-align:left;font-size:0.875rem;"><br></div><=
div style=3D"text-align:left;font-size:0.875rem;"><span style=3D"=
font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);b=
ackground-color:rgb(248, 248, 248);font-weight:bold;">[java]</spa=
n><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb=
(192, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;</spa=
n><a href=3D"http://blog.csdn.net/pelick/article/details/22748841=
#"><span style=3D"font-size:0.563rem;font-family:Verdana;color:rg=
b(12, 137, 207);background-color:rgb(248, 248, 248);">view plain<=
/span></a><span style=3D"font-size:0.563rem;font-family:Verdana;c=
olor:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&nb=
sp;</span><a href=3D"http://blog.csdn.net/pelick/article/details/=
22748841#"><span style=3D"font-size:0.563rem;font-family:Verdana;=
color:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">cop=
y</span></a></div><ol class=3D"wiz-list-level1"><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 1=
30, 0);font-weight:normal;font-style:normal;"><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 130=
, 0);background-color:rgb(255, 255, 255);">//&nbsp;RowOrdering=BC=
=CC=B3=D0Ordering[Row]</span><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-si=
ze:0.75rem;list-style-position:inside;list-style-type:decimal;fon=
t-family:&quot;Courier New&quot;color:rgb(100, 100, 100);font-wei=
ght:normal;font-style:normal;"><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;color:rgb(100, 100, 100);backgr=
ound-color:rgb(248, 248, 248);">@transient</span><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li style=3D"tex=
t-align:left;font-size:0.75rem;list-style-position:inside;list-st=
yle-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0,=20=
0, 0);font-weight:normal;font-style:normal;"><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;background-color:=
rgb(255, 255, 255);">&nbsp;&nbsp;lazy&nbsp;val&nbsp;ordering&nbsp=
;=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&qu=
ot;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(2=
55, 255, 255);font-weight:bold;">new</span><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;background-color:rg=
b(255, 255, 255);">&nbsp;RowOrdering(sortOrder)&nbsp;&nbsp;</span=
></li><li style=3D"text-align:left;font-size:0.75rem;list-style-p=
osition:inside;list-style-type:decimal;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;=
"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></l=
i><li style=3D"text-align:left;font-size:0.75rem;list-style-posit=
ion:inside;list-style-type:decimal;font-family:&quot;Courier New&=
quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;def&nbsp;execu=
te()&nbsp;=3D&nbsp;attachTree(</span><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);ba=
ckground-color:rgb(255, 255, 255);font-weight:bold;">this</span><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">,&nbsp;</span><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rg=
b(0, 0, 255);background-color:rgb(255, 255, 255);">"sort"</span><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">)&nbsp;{&nbsp;&nbsp;</spa=
n></li><li style=3D"text-align:left;font-size:0.75rem;list-style-=
position:inside;list-style-type:decimal;font-family:&quot;Courier=
 New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal=
;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nb=
sp;</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 130, 0);background-color:rgb(248, 248,=20=
248);">//&nbsp;TODO:&nbsp;Optimize&nbsp;sorting&nbsp;operation?</=
span><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span>=
</li><li style=3D"text-align:left;font-size:0.75rem;list-style-po=
sition:inside;list-style-type:decimal;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp=
;child.execute()&nbsp;&nbsp;</span></li><li style=3D"text-align:l=
eft;font-size:0.75rem;list-style-position:inside;list-style-type:=
decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fon=
t-weight:normal;font-style:normal;"><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;background-color:rgb(248,=20=
248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.mapPartitions(it=
erator&nbsp;=3D&gt;&nbsp;iterator.map(_.copy()).toArray.sorted(or=
dering).iterator,&nbsp;&nbsp;</span></li><li style=3D"text-align:=
left;font-size:0.75rem;list-style-position:inside;list-style-type=
:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fo=
nt-weight:normal;font-style:normal;"><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;background-color:rgb(255,=
 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pres=
ervesPartitioning&nbsp;=3D&nbsp;</span><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);=
background-color:rgb(255, 255, 255);font-weight:bold;">true</span=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;background-color:rgb(255, 255, 255);">)&nbsp;&nbsp;</span></l=
i><li style=3D"text-align:left;font-size:0.75rem;list-style-posit=
ion:inside;list-style-type:decimal;font-family:&quot;Courier New&=
quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;}&nbsp;&nbsp;<=
/span></li></ol><div style=3D"text-align:left;font-size:0.875rem;=
"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=D3=D0=
=D2=BB=B4=CE=D2=FE=CA=BD=D7=AA=BB=BB=B9=FD=B3=CC=A3=AC.sorted=CA=C7=
array=D7=D4=B4=F8=B5=C4=D2=BB=B8=F6=B7=BD=B7=A8=A3=AC=D2=F2=CE=AA=
ordering=CA=C7RowOrdering=C0=E0=A3=AC=B8=C3=C0=E0=BC=CC=B3=D0Orde=
ring[T]=A3=AC=CA=C7</span><a href=3D"http://lib.csdn.net/base/sca=
la"><span style=3D"font-size:0.938rem;color:rgb(223, 52, 52);font=
-weight:bold;">scala</span></a><span style=3D"font-size:0.938rem;=
color:rgb(85, 85, 85);">.math.Ordering[T]=C0=E0=A1=A3</span></div=
><div style=3D"text-align:left;font-size:0.875rem;"><br></div><di=
v style=3D"text-align:left;font-size:0.875rem;"><span style=3D"fo=
nt-size:1.5rem;color:rgb(85, 85, 85);font-weight:bold;">StopAfter=
</span></div><div style=3D"text-align:left;font-size:0.875rem;"><=
span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(19=
2, 192, 192);background-color:rgb(248, 248, 248);font-weight:bold=
;">[java]</span><span style=3D"font-size:0.563rem;font-family:Ver=
dana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248)=
;">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article/de=
tails/22748841#"><span style=3D"font-size:0.563rem;font-family:Ve=
rdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248)=
;">view plain</span></a><span style=3D"font-size:0.563rem;font-fa=
mily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 2=
48, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/ar=
ticle/details/22748841#"><span style=3D"font-size:0.563rem;font-f=
amily:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 2=
48, 248);">copy</span></a></div><ol class=3D"wiz-list-level1"><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 102, 153);font-weight:bold;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 102, 153);background-color:rgb(255, 255, 255);font-wei=
ght:bold;">case</span><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&n=
bsp;</span><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 25=
5, 255);font-weight:bold;">class</span><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;background-color:rgb(25=
5, 255, 255);">&nbsp;StopAfter(limit:&nbsp;Int,&nbsp;child:&nbsp;=
SparkPlan)(</span><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;color:rgb(100, 100, 100);background-color:rg=
b(255, 255, 255);">@transient</span><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;background-color:rgb(255,=20=
255, 255);">&nbsp;sc:&nbsp;SparkContext)&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;=
">extends</span><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;Un=
aryNode&nbsp;&nbsp;</span></li></ol><div style=3D"text-align:left=
;font-size:0.875rem;"><br></div><div style=3D"text-align:left;fon=
t-size:0.875rem;"><span style=3D"font-size:0.938rem;color:rgb(85,=
 85, 85);">StopAfter=CA=B5=D6=CA=C9=CF=CA=C7=D2=BB=B4=CElimit=B2=D9=
=D7=F7</span></div><div style=3D"text-align:left;font-size:0.875r=
em;"><span style=3D"font-size:0.563rem;font-family:Verdana;color:=
rgb(192, 192, 192);background-color:rgb(248, 248, 248);font-weigh=
t:bold;">[java]</span><span style=3D"font-size:0.563rem;font-fami=
ly:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248=
, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/arti=
cle/details/22748841#"><span style=3D"font-size:0.563rem;font-fam=
ily:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248=
, 248);">view plain</span></a><span style=3D"font-size:0.563rem;f=
ont-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(=
248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pel=
ick/article/details/22748841#"><span style=3D"font-size:0.563rem;=
font-family:Verdana;color:rgb(12, 137, 207);background-color:rgb(=
248, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-level=
1"><li style=3D"text-align:left;font-size:0.75rem;list-style-posi=
tion:inside;list-style-type:decimal;font-family:&quot;Courier New=
&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">override&nbsp;def&nbsp;ex=
ecuteCollect()&nbsp;=3D&nbsp;child.execute().map(_.copy()).take(l=
imit)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-si=
ze:0.75rem;list-style-position:inside;list-style-type:decimal;fon=
t-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:no=
rmal;font-style:normal;"><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);"=
>def&nbsp;execute()&nbsp;=3D&nbsp;sc.makeRDD(executeCollect(),&nb=
sp;</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;color:rgb(192, 0, 0);background-color:rgb(248, 248,=20=
248);">1</span><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;background-color:rgb(248, 248, 248);">)&nbsp;</=
span><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 130, 0);background-color:rgb(248, 248, 248);=
">//&nbsp;=C9=E8=D6=C3=B2=A2=D0=D0=B6=C8=CE=AA1</span><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgrou=
nd-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li></ol><div s=
tyle=3D"text-align:left;font-size:0.875rem;"><br></div><div style=
=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-size=
:0.938rem;color:rgb(85, 85, 85);">makeRDD=CA=B5=D6=CA=C9=CF=B5=F7=
=D3=C3=B5=C4=CA=C7new ParallelCollectionRDD[T]=B5=C4=B2=D9=D7=F7=A3=
=AC=B4=CB=B4=A6=B5=C4seq=CE=AAtabke()=B7=B5=BB=D8=B5=C4Array[T]=A3=
=AC=B6=F8numSlices=CE=AA1=A3=BA</span></div><div style=3D"text-al=
ign:left;font-size:0.875rem;"><span style=3D"font-size:0.563rem;f=
ont-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(=
248, 248, 248);font-weight:bold;">[java]</span><span style=3D"fon=
t-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);back=
ground-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://=
blog.csdn.net/pelick/article/details/22748841#"><span style=3D"fo=
nt-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);back=
ground-color:rgb(248, 248, 248);">view plain</span></a><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 1=
92);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D=
"http://blog.csdn.net/pelick/article/details/22748841#"><span sty=
le=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 2=
07);background-color:rgb(248, 248, 248);">copy</span></a></div><o=
l class=3D"wiz-list-level1"><li style=3D"text-align:left;font-siz=
e:0.75rem;list-style-position:inside;list-style-type:decimal;font=
-family:&quot;Courier New&quot;color:rgb(0, 130, 0);font-weight:n=
ormal;font-style:normal;"><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;color:rgb(0, 130, 0);background-colo=
r:rgb(255, 255, 255);">/**&nbsp;Distribute&nbsp;a&nbsp;local&nbsp=
;Scala&nbsp;collection&nbsp;to&nbsp;form&nbsp;an&nbsp;RDD.&nbsp;*=
/</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</sp=
an></li><li style=3D"text-align:left;font-size:0.75rem;list-style=
-position:inside;list-style-type:decimal;font-family:&quot;Courie=
r New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:norma=
l;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier Ne=
w&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;def&nbsp=
;parallelize[T:&nbsp;ClassTag](seq:&nbsp;Seq[T],&nbsp;numSlices:&=
nbsp;Int&nbsp;=3D&nbsp;defaultParallelism):&nbsp;RDD[T]&nbsp;=3D&=
nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-s=
ize:0.75rem;list-style-position:inside;list-style-type:decimal;fo=
nt-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:n=
ormal;font-style:normal;"><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backgr=
ound-color:rgb(255, 255, 255);font-weight:bold;">new</span><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(255, 255, 255);">&nbsp;ParallelCollectionRDD[T]=
(</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255,=20=
255);font-weight:bold;">this</span><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(255, 2=
55, 255);">,&nbsp;seq,&nbsp;numSlices,&nbsp;Map[Int,&nbsp;Seq[Str=
ing]]())&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font=
-size:0.75rem;list-style-position:inside;list-style-type:decimal;=
font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight=
:normal;font-style:normal;"><span style=3D"font-size:0.75rem;font=
-family:&quot;Courier New&quot;background-color:rgb(248, 248, 248=
);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></li></ol><div style=3D"text-=
align:left;font-size:0.875rem;"><br></div><div style=3D"text-alig=
n:left;font-size:0.875rem;"><span style=3D"font-size:1.5rem;color=
:rgb(85, 85, 85);font-weight:bold;">TopK</span></div><div style=3D=
"text-align:left;font-size:0.875rem;"><span style=3D"font-size:0.=
563rem;font-family:Verdana;color:rgb(192, 192, 192);background-co=
lor:rgb(248, 248, 248);font-weight:bold;">[java]</span><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 1=
92);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D=
"http://blog.csdn.net/pelick/article/details/22748841#"><span sty=
le=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 2=
07);background-color:rgb(248, 248, 248);">view plain</span></a><s=
pan style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192=
, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;</span><a=
 href=3D"http://blog.csdn.net/pelick/article/details/22748841#"><=
span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12=
, 137, 207);background-color:rgb(248, 248, 248);">copy</span></a>=
</div><ol class=3D"wiz-list-level1"><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);fon=
t-weight:bold;font-style:normal;"><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backg=
round-color:rgb(255, 255, 255);font-weight:bold;">case</span><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;b=
ackground-color:rgb(255, 255, 255);">&nbsp;</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=
 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;"=
>class</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(255, 255, 255);">&nbsp;TopK(=
limit:&nbsp;Int,&nbsp;sortOrder:&nbsp;Seq[SortOrder],&nbsp;child:=
&nbsp;SparkPlan)&nbsp;&nbsp;</span></li><li style=3D"text-align:l=
eft;font-size:0.75rem;list-style-position:inside;list-style-type:=
decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fon=
t-weight:normal;font-style:normal;"><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;background-color:rgb(248,=20=
248, 248);">(</span><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;color:rgb(100, 100, 100);background-color:=
rgb(248, 248, 248);">@transient</span><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(248=
, 248, 248);">&nbsp;sc:&nbsp;SparkContext)&nbsp;</span><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:r=
gb(0, 102, 153);background-color:rgb(248, 248, 248);font-weight:b=
old;">extends</span><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbs=
p;UnaryNode&nbsp;&nbsp;</span></li></ol><div style=3D"text-align:=
left;font-size:0.875rem;"><br></div><div style=3D"text-align:left=
;font-size:0.875rem;"><span style=3D"font-size:0.938rem;color:rgb=
(85, 85, 85);">=BF=C9=D2=D4=B0=D1TopK=C0=ED=BD=E2=CE=AA=C0=E0=CB=C6=
Sort=BA=CDStopAfter=B5=C4=BD=E1=BA=CF=A3=AC</span></div><div styl=
e=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-siz=
e:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);backgroun=
d-color:rgb(248, 248, 248);font-weight:bold;">[java]</span><span=20=
style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 19=
2, 192);background-color:rgb(248, 248, 248);">&nbsp;</span><a hre=
f=3D"http://blog.csdn.net/pelick/article/details/22748841#"><span=
 style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 13=
7, 207);background-color:rgb(248, 248, 248);">view plain</span></=
a><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb=
(192, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;</spa=
n><a href=3D"http://blog.csdn.net/pelick/article/details/22748841=
#"><span style=3D"font-size:0.563rem;font-family:Verdana;color:rg=
b(12, 137, 207);background-color:rgb(248, 248, 248);">copy</span>=
</a></div><ol class=3D"wiz-list-level1"><li style=3D"text-align:l=
eft;font-size:0.75rem;list-style-position:inside;list-style-type:=
decimal;font-family:&quot;Courier New&quot;color:rgb(100, 100, 10=
0);font-weight:normal;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;color:rgb(100, 100,=20=
100);background-color:rgb(255, 255, 255);">@transient</span><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li s=
tyle=3D"text-align:left;font-size:0.75rem;list-style-position:ins=
ide;list-style-type:decimal;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(248, 248, 248);">lazy&nbsp;val&nbsp;ordering&nbsp;=
=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(24=
8, 248, 248);font-weight:bold;">new</span><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">&nbsp;RowOrdering(sortOrder)&nbsp;&nbsp;</span>=
</li><li style=3D"text-align:left;font-size:0.75rem;list-style-po=
sition:inside;list-style-type:decimal;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li=
><li style=3D"text-align:left;font-size:0.75rem;list-style-positi=
on:inside;list-style-type:decimal;font-family:&quot;Courier New&q=
uot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(248, 248, 248);">override&nbsp;def&nbsp;exec=
uteCollect()&nbsp;=3D&nbsp;child.execute().map(_.copy()).takeOrde=
red(limit)(ordering)&nbsp;&nbsp;</span></li><li style=3D"text-ali=
gn:left;font-size:0.75rem;list-style-position:inside;list-style-t=
ype:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0)=
;font-weight:normal;font-style:normal;"><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(2=
55, 255, 255);">def&nbsp;execute()&nbsp;=3D&nbsp;sc.makeRDD(execu=
teCollect(),&nbsp;</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;color:rgb(192, 0, 0);background-color=
:rgb(255, 255, 255);">1</span><span style=3D"font-size:0.75rem;fo=
nt-family:&quot;Courier New&quot;background-color:rgb(255, 255, 2=
55);">)&nbsp;&nbsp;</span></li></ol><div style=3D"text-align:left=
;font-size:0.875rem;"><br></div><div style=3D"text-align:left;fon=
t-size:0.875rem;"><span style=3D"font-size:0.938rem;color:rgb(85,=
 85, 85);">takeOrdered(num)(sorting)=CA=B5=BC=CA=B4=A5=B7=A2=B5=C4=
=CA=C7RDD=B5=C4top()()=B2=D9=D7=F7</span></div><div style=3D"text=
-align:left;font-size:0.875rem;"><span style=3D"font-size:0.563re=
m;font-family:Verdana;color:rgb(192, 192, 192);background-color:r=
gb(248, 248, 248);font-weight:bold;">[java]</span><span style=3D"=
font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);b=
ackground-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http=
://blog.csdn.net/pelick/article/details/22748841#"><span style=3D=
"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);b=
ackground-color:rgb(248, 248, 248);">view plain</span></a><span s=
tyle=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192=
, 192);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=
=3D"http://blog.csdn.net/pelick/article/details/22748841#"><span=20=
style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137=
, 207);background-color:rgb(248, 248, 248);">copy</span></a></div=
><ol class=3D"wiz-list-level1"><li style=3D"text-align:left;font-=
size:0.75rem;list-style-position:inside;list-style-type:decimal;f=
ont-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:=
normal;font-style:normal;"><span style=3D"font-size:0.75rem;font-=
family:&quot;Courier New&quot;background-color:rgb(255, 255, 255)=
;">def&nbsp;top(num:&nbsp;Int)(implicit&nbsp;ord:&nbsp;Ordering[T=
]):&nbsp;Array[T]&nbsp;=3D&nbsp;{&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;mapPartitions&nbsp;{=
&nbsp;items&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0=
, 0);font-weight:normal;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;queue&=
nbsp;=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:r=
gb(255, 255, 255);font-weight:bold;">new</span><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(255, 255, 255);">&nbsp;BoundedPriorityQueue[T](num)&nbsp;&n=
bsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;li=
st-style-position:inside;list-style-type:decimal;font-family:&quo=
t;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-sty=
le:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;queue&nbsp;++=3D&nbsp;items&nbsp;&nbsp;</span><=
/li><li style=3D"text-align:left;font-size:0.75rem;list-style-pos=
ition:inside;list-style-type:decimal;font-family:&quot;Courier Ne=
w&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;">=
<span style=3D"font-size:0.75rem;font-family:&quot;Courier New&qu=
ot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;Iterator.single(queue)&nbsp;&nbsp;</span></li><li style=3D"=
text-align:left;font-size:0.75rem;list-style-position:inside;list=
-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(=
0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;}.reduce&nbsp;{&nbsp;(q=
ueue1,&nbsp;queue2)&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=
=3D"text-align:left;font-size:0.75rem;list-style-position:inside;=
list-style-type:decimal;font-family:&quot;Courier New&quot;color:=
rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue1&n=
bsp;++=3D&nbsp;queue2&nbsp;&nbsp;</span></li><li style=3D"text-al=
ign:left;font-size:0.75rem;list-style-position:inside;list-style-=
type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0=
);font-weight:normal;font-style:normal;"><span style=3D"font-size=
:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(=
248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue1&nbsp;&nbsp;=
</span></li><li style=3D"text-align:left;font-size:0.75rem;list-s=
tyle-position:inside;list-style-type:decimal;font-family:&quot;Co=
urier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:n=
ormal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbs=
p;}.toArray.sorted(ord.reverse)&nbsp;&nbsp;</span></li><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(248, 248, 248);">&nbsp;}&nbsp;&nbsp;</span></li></ol><div=
 style=3D"text-align:left;font-size:0.875rem;"><br></div><div sty=
le=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-si=
ze:0.938rem;color:rgb(85, 85, 85);">BoundedPriorityQueue=CA=C7</s=
pan><a href=3D"http://lib.csdn.net/base/spark"><span style=3D"fon=
t-size:0.938rem;color:rgb(223, 52, 52);font-weight:bold;">Spark</=
span></a><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85);=
">&nbsp;util=B0=FC=C0=EF=B5=C4=D2=BB=B8=F6</span><a href=3D"http:=
//lib.csdn.net/base/datastructure"><span style=3D"font-size:0.938=
rem;color:rgb(223, 52, 52);font-weight:bold;">=CA=FD=BE=DD=BD=E1=B9=
=B9</span></a><span style=3D"font-size:0.938rem;color:rgb(85, 85,=
 85);">=A3=AC=B0=FC=D7=B0=C1=CBPriorityQueue=A3=AC=CB=FB=B5=C4=D3=
=C5=BB=AF=B5=E3=D4=DA=D3=DA=CF=DE=D6=C6=C1=CB=D3=C5=CF=C8=B6=D3=C1=
=D0=B5=C4=B4=F3=D0=A1=A3=AC=B1=C8=C8=E7=D4=DA=CC=ED=BC=D3=D4=AA=CB=
=D8=B5=C4=CA=B1=BA=F2=A3=AC=C8=E7=B9=FB=B3=AC=B3=F6size=C1=CB=A3=AC=
=BE=CD=BB=E1=BD=F8=D0=D0=B6=D4=B6=D1=BD=F8=D0=D0=B1=C8=BD=CF=BA=CD=
=CC=E6=BB=BB=A1=A3=CA=CA=BA=CFTopK=B5=C4=B3=A1=BE=B0=A1=A3</span>=
</div><div style=3D"text-align:left;font-size:0.875rem;"><span st=
yle=3D"font-size:0.938rem;color:rgb(85, 85, 85);">=CB=F9=D2=D4=C3=
=BF=B8=F6partition=D4=DA=C5=C5=D0=F2=C7=B0=A3=AC=D6=BB=BB=E1=B2=FA=
=C9=FA=D2=BB=B8=F6num=B4=F3=D0=A1=B5=C4BPQ(=D7=EE=BA=F3=D6=BB=D0=E8=
=D2=AA=D1=A1Top num=B8=F6)=A3=AC=BA=CF=B2=A2=D6=AE=BA=F3=B2=C5=D7=
=F6=D5=E6=D5=FD=B5=C4=C5=C5=D0=F2=A3=AC=D7=EE=BA=F3=D1=A1=B3=F6=C7=
=B0num=B8=F6=A1=A3</span></div><div style=3D"text-align:left;font=
-size:0.875rem;"><br></div><div style=3D"text-align:left;font-siz=
e:0.875rem;"><span style=3D"font-size:2rem;color:rgb(85, 85, 85);=
font-weight:bold;">BinaryNode</span></div><div style=3D"text-alig=
n:left;font-size:0.875rem;"><br></div><div style=3D"text-align:le=
ft;font-size:0.875rem;"><span style=3D"font-size:1.5rem;color:rgb=
(85, 85, 85);font-weight:bold;">BroadcastNestedLoopJoin</span></d=
iv><div style=3D"text-align:left;font-size:0.875rem;"><span style=
=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 19=
2);background-color:rgb(248, 248, 248);font-weight:bold;">[java]<=
/span><span style=3D"font-size:0.563rem;font-family:Verdana;color=
:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;<=
/span><a href=3D"http://blog.csdn.net/pelick/article/details/2274=
8841#"><span style=3D"font-size:0.563rem;font-family:Verdana;colo=
r:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">view pl=
ain</span></a><span style=3D"font-size:0.563rem;font-family:Verda=
na;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248);"=
>&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article/deta=
ils/22748841#"><span style=3D"font-size:0.563rem;font-family:Verd=
ana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 248);"=
>copy</span></a></div><ol class=3D"wiz-list-level1"><li style=3D"=
text-align:left;font-size:0.75rem;list-style-position:inside;list=
-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(=
0, 102, 153);font-weight:bold;font-style:normal;"><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=
 102, 153);background-color:rgb(255, 255, 255);font-weight:bold;"=
>case</span><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(255, 255, 255);">&nbsp;</span=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);fo=
nt-weight:bold;">class</span><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;BroadcastNestedLoopJoin(&nbsp;&nbsp;</span></li><li st=
yle=3D"text-align:left;font-size:0.75rem;list-style-position:insi=
de;list-style-type:decimal;font-family:&quot;Courier New&quot;col=
or:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;streamed:&=
nbsp;SparkPlan,&nbsp;broadcast:&nbsp;SparkPlan,&nbsp;joinType:&nb=
sp;JoinType,&nbsp;condition:&nbsp;Option[Expression])&nbsp;&nbsp;=
</span></li><li style=3D"text-align:left;font-size:0.75rem;list-s=
tyle-position:inside;list-style-type:decimal;font-family:&quot;Co=
urier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:n=
ormal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbs=
p;&nbsp;(</span><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;color:rgb(100, 100, 100);background-color:rgb(=
255, 255, 255);">@transient</span><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(255, 25=
5, 255);">&nbsp;sc:&nbsp;SparkContext)&nbsp;&nbsp;</span></li><li=
 style=3D"text-align:left;font-size:0.75rem;list-style-position:i=
nside;list-style-type:decimal;font-family:&quot;Courier New&quot;=
color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 102, 153);background-color:rgb(248, 248, 248);font-weight:bold;=
">extends</span><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;Bi=
naryNode&nbsp;&nbsp;</span></li></ol><div style=3D"text-align:lef=
t;font-size:0.875rem;"><br></div><div style=3D"text-align:left;fo=
nt-size:0.875rem;"><span style=3D"font-size:0.938rem;color:rgb(85=
, 85, 85);">=B1=C8=BD=CF=B8=B4=D4=D3=B5=C4=D2=BB=B4=CEjoin=B2=D9=D7=
=F7=A3=AC=B2=D9=D7=F7=C8=E7=CF=C2=A3=AC</span></div><div style=3D=
"text-align:left;font-size:0.875rem;"><span style=3D"font-size:0.=
563rem;font-family:Verdana;color:rgb(192, 192, 192);background-co=
lor:rgb(248, 248, 248);font-weight:bold;">[java]</span><span styl=
e=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192, 1=
92);background-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D=
"http://blog.csdn.net/pelick/article/details/22748841#"><span sty=
le=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12, 137, 2=
07);background-color:rgb(248, 248, 248);">view plain</span></a><s=
pan style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192=
, 192, 192);background-color:rgb(248, 248, 248);">&nbsp;</span><a=
 href=3D"http://blog.csdn.net/pelick/article/details/22748841#"><=
span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb(12=
, 137, 207);background-color:rgb(248, 248, 248);">copy</span></a>=
</div><ol class=3D"wiz-list-level1"><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-we=
ight:normal;font-style:normal;"><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(255, 255,=
 255);">def&nbsp;execute()&nbsp;=3D&nbsp;{&nbsp;&nbsp;</span></li=
><li style=3D"text-align:left;font-size:0.75rem;list-style-positi=
on:inside;list-style-type:decimal;font-family:&quot;Courier New&q=
uot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color=
:rgb(0, 130, 0);background-color:rgb(248, 248, 248);">//&nbsp;=CF=
=C8=BD=AB=D0=E8=D2=AA=B9=E3=B2=A5=B5=C4SparkPlan=D6=B4=D0=D0=BA=F3=
=BD=F8=D0=D0=D2=BB=B4=CEbroadcast=B2=D9=D7=F7</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li style=3D"t=
ext-align:left;font-size:0.75rem;list-style-position:inside;list-=
style-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0=
, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(255, 255, 255);">&nbsp;&nbsp;val&nbsp;broadcastedRelation&n=
bsp;=3D&nbsp;&nbsp;&nbsp;</span></li><li style=3D"text-align:left=
;font-size:0.75rem;list-style-position:inside;list-style-type:dec=
imal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-w=
eight:normal;font-style:normal;"><span style=3D"font-size:0.75rem=
;font-family:&quot;Courier New&quot;background-color:rgb(248, 248=
, 248);">&nbsp;&nbsp;sc.broadcast(broadcast.execute().map(_.copy(=
)).collect().toIndexedSeq)&nbsp;&nbsp;</span></li><li style=3D"te=
xt-align:left;font-size:0.75rem;list-style-position:inside;list-s=
tyle-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0,=
 0, 0);font-weight:normal;font-style:normal;"><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;background-color=
:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"text-a=
lign:left;font-size:0.75rem;list-style-position:inside;list-style=
-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=20=
0);font-weight:normal;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">&nbsp;&nbsp;val&nbsp;streamedPlusMatches&nbsp;=3D=
&nbsp;streamed.execute().mapPartitions&nbsp;{&nbsp;streamedIter&n=
bsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"text-align:left;f=
ont-size:0.75rem;list-style-position:inside;list-style-type:decim=
al;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-wei=
ght:normal;font-style:normal;"><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;background-color:rgb(255, 255,=20=
255);">&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;matchedRows&nbsp;=3D&nbsp=
;</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255,=20=
255);font-weight:bold;">new</span><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(255, 25=
5, 255);">&nbsp;mutable.ArrayBuffer[Row]&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;val&n=
bsp;includedBroadcastTuples&nbsp;=3D&nbsp;&nbsp;&nbsp;&nbsp;</spa=
n></li><li style=3D"text-align:left;font-size:0.75rem;list-style-=
position:inside;list-style-type:decimal;font-family:&quot;Courier=
 New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal=
;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:=
rgb(255, 255, 255);font-weight:bold;">new</span><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(255, 255, 255);">&nbsp;mutable.BitSet(broadcastedRelation.=
value.size)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;f=
ont-size:0.75rem;list-style-position:inside;list-style-type:decim=
al;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-wei=
ght:normal;font-style:normal;"><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;background-color:rgb(248, 248,=20=
248);">&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;joinedRow&nbsp;=3D&nbsp;<=
/span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 102, 153);background-color:rgb(248, 248, 24=
8);font-weight:bold;">new</span><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(248, 248,=
 248);">&nbsp;JoinedRow&nbsp;&nbsp;</span></li><li style=3D"text-=
align:left;font-size:0.75rem;list-style-position:inside;list-styl=
e-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=
 0);font-weight:normal;font-style:normal;"><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;background-color:rg=
b(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></l=
i><li style=3D"text-align:left;font-size:0.75rem;list-style-posit=
ion:inside;list-style-type:decimal;font-family:&quot;Courier New&=
quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;st=
reamedIter.foreach&nbsp;{&nbsp;streamedRow&nbsp;=3D&gt;&nbsp;&nbs=
p;</span></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style=
:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;var&nbsp;i&nbsp;=3D&nbsp;</span><span style=
=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rg=
b(192, 0, 0);background-color:rgb(255, 255, 255);">0</span><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li st=
yle=3D"text-align:left;font-size:0.75rem;list-style-position:insi=
de;list-style-type:decimal;font-family:&quot;Courier New&quot;col=
or:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;var&nbsp;matched&nbsp;=3D&nbsp;</span><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153)=
;background-color:rgb(248, 248, 248);font-weight:bold;">false</sp=
an><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></=
li><li style=3D"text-align:left;font-size:0.75rem;list-style-posi=
tion:inside;list-style-type:decimal;font-family:&quot;Courier New=
&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(248,=
 248, 248);font-weight:bold;">while</span><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">&nbsp;(i&nbsp;&lt;&nbsp;broadcastedRelation.val=
ue.size)&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:le=
ft;font-size:0.75rem;list-style-position:inside;list-style-type:d=
ecimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font=
-weight:normal;font-style:normal;"><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(255, 2=
55, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;color:rgb(0, 130, 0);background-color:rgb(255, 255, 255);">//=
&nbsp;TODO:&nbsp;One&nbsp;bitset&nbsp;per&nbsp;partition&nbsp;ins=
tead&nbsp;of&nbsp;per&nbsp;row.</span><span style=3D"font-size:0.=
75rem;font-family:&quot;Courier New&quot;background-color:rgb(255=
, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"text-align:lef=
t;font-size:0.75rem;list-style-position:inside;list-style-type:de=
cimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-=
weight:normal;font-style:normal;"><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(248, 24=
8, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbs=
p;broadcastedRow&nbsp;=3D&nbsp;broadcastedRelation.value(i)&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102,=
 153);background-color:rgb(255, 255, 255);font-weight:bold;">if</=
span><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;background-color:rgb(255, 255, 255);">&nbsp;(boundConditi=
on(joinedRow(streamedRow,&nbsp;broadcastedRow)).asInstanceOf[Bool=
ean])&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:left;=
font-size:0.75rem;list-style-position:inside;list-style-type:deci=
mal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-we=
ight:normal;font-style:normal;"><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(248, 248,=
 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;matchedRows&nbsp;+=3D&nbsp;buildRow(streamedRow&nbsp;++&nbsp;b=
roadcastedRow)&nbsp;&nbsp;</span></li><li style=3D"text-align:lef=
t;font-size:0.75rem;list-style-position:inside;list-style-type:de=
cimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-=
weight:normal;font-style:normal;"><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(255, 25=
5, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;matched&nbsp;=3D&nbsp;</span><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backg=
round-color:rgb(255, 255, 255);font-weight:bold;">true</span><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;b=
ackground-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li=20=
style=3D"text-align:left;font-size:0.75rem;list-style-position:in=
side;list-style-type:decimal;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backg=
round-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;includedBroadcastTuples&nbsp;+=3D&nbs=
p;i&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size=
:0.75rem;list-style-position:inside;list-style-type:decimal;font-=
family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:norm=
al;font-style:normal;"><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</spa=
n></li><li style=3D"text-align:left;font-size:0.75rem;list-style-=
position:inside;list-style-type:decimal;font-family:&quot;Courier=
 New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal=
;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;+=3D&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(1=
92, 0, 0);background-color:rgb(248, 248, 248);">1</span><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li style=
=3D"text-align:left;font-size:0.75rem;list-style-position:inside;=
list-style-type:decimal;font-family:&quot;Courier New&quot;color:=
rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&=
nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.7=
5rem;list-style-position:inside;list-style-type:decimal;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;f=
ont-style:normal;"><span style=3D"font-size:0.75rem;font-family:&=
quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp=
;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem=
;list-style-position:inside;list-style-type:decimal;font-family:&=
quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-=
style:normal;"><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backg=
round-color:rgb(255, 255, 255);font-weight:bold;">if</span><span=20=
style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;bac=
kground-color:rgb(255, 255, 255);">&nbsp;(!matched&nbsp;&amp;&amp=
;&nbsp;(joinType&nbsp;=3D=3D&nbsp;LeftOuter&nbsp;||&nbsp;joinType=
&nbsp;=3D=3D&nbsp;FullOuter))&nbsp;{&nbsp;&nbsp;</span></li><li s=
tyle=3D"text-align:left;font-size:0.75rem;list-style-position:ins=
ide;list-style-type:decimal;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;matchedRows&nbsp;+=3D&nbsp;buildRow(streamedRow&nb=
sp;++&nbsp;Array.fill(right.output.size)(</span><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 1=
02, 153);background-color:rgb(248, 248, 248);font-weight:bold;">n=
ull</span><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(248, 248, 248);">))&nbsp;&nbsp;=
</span></li><li style=3D"text-align:left;font-size:0.75rem;list-s=
tyle-position:inside;list-style-type:decimal;font-family:&quot;Co=
urier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:n=
ormal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li style=3D"text-al=
ign:left;font-size:0.75rem;list-style-position:inside;list-style-=
type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0=
);font-weight:normal;font-style:normal;"><span style=3D"font-size=
:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(=
248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li=
><li style=3D"text-align:left;font-size:0.75rem;list-style-positi=
on:inside;list-style-type:decimal;font-family:&quot;Courier New&q=
uot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;Ite=
rator((matchedRows,&nbsp;includedBroadcastTuples))&nbsp;&nbsp;</s=
pan></li><li style=3D"text-align:left;font-size:0.75rem;list-styl=
e-position:inside;list-style-type:decimal;font-family:&quot;Couri=
er New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:norm=
al;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;}&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbs=
p;</span></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style=
:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;va=
l&nbsp;includedBroadcastTuples&nbsp;=3D&nbsp;streamedPlusMatches.=
map(_._2)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;fon=
t-size:0.75rem;list-style-position:inside;list-style-type:decimal=
;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weigh=
t:normal;font-style:normal;"><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;&nbsp;val&nbsp;allIncludedBroadcastTuples&nbsp;=3D&nbs=
p;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75re=
m;list-style-position:inside;list-style-type:decimal;font-family:=
&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font=
-style:normal;"><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&n=
bsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color=
:rgb(248, 248, 248);font-weight:bold;">if</span><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(248, 248, 248);">&nbsp;(includedBroadcastTuples.count&nbsp=
;=3D=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;color:rgb(192, 0, 0);background-color:rgb(=
248, 248, 248);">0</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);"=
>)&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:left;fon=
t-size:0.75rem;list-style-position:inside;list-style-type:decimal=
;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weigh=
t:normal;font-style:normal;"><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 1=
02, 153);background-color:rgb(255, 255, 255);font-weight:bold;">n=
ew</span><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;background-color:rgb(255, 255, 255);">&nbsp;scala.col=
lection.mutable.BitSet(broadcastedRelation.value.size)&nbsp;&nbsp=
;</span></li><li style=3D"text-align:left;font-size:0.75rem;list-=
style-position:inside;list-style-type:decimal;font-family:&quot;C=
ourier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:=
normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nb=
sp;&nbsp;}&nbsp;</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color=
:rgb(248, 248, 248);font-weight:bold;">else</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;background-c=
olor:rgb(248, 248, 248);">&nbsp;{&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;st=
reamedPlusMatches.map(_._2).reduce(_&nbsp;++&nbsp;_)&nbsp;&nbsp;<=
/span></li><li style=3D"text-align:left;font-size:0.75rem;list-st=
yle-position:inside;list-style-type:decimal;font-family:&quot;Cou=
rier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:no=
rmal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=
 New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp=
;&nbsp;}&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font=
-size:0.75rem;list-style-position:inside;list-style-type:decimal;=
font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight=
:normal;font-style:normal;"><span style=3D"font-size:0.75rem;font=
-family:&quot;Courier New&quot;background-color:rgb(255, 255, 255=
);">&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-siz=
e:0.75rem;list-style-position:inside;list-style-type:decimal;font=
-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:nor=
mal;font-style:normal;"><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">=
&nbsp;&nbsp;val&nbsp;rightOuterMatches:&nbsp;Seq[Row]&nbsp;=3D&nb=
sp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75r=
em;list-style-position:inside;list-style-type:decimal;font-family=
:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fon=
t-style:normal;"><span style=3D"font-size:0.75rem;font-family:&qu=
ot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&=
nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-colo=
r:rgb(255, 255, 255);font-weight:bold;">if</span><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(255, 255, 255);">&nbsp;(joinType&nbsp;=3D=3D&nbsp;RightOu=
ter&nbsp;||&nbsp;joinType&nbsp;=3D=3D&nbsp;FullOuter)&nbsp;{&nbsp=
;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem=
;list-style-position:inside;list-style-type:decimal;font-family:&=
quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-=
style:normal;"><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;broadcastedRelation.value.zipWithIndex=
.filter&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:lef=
t;font-size:0.75rem;list-style-position:inside;list-style-type:de=
cimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-=
weight:normal;font-style:normal;"><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(255, 25=
5, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>=
<span style=3D"font-size:0.75rem;font-family:&quot;Courier New&qu=
ot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);fon=
t-weight:bold;">case</span><span style=3D"font-size:0.75rem;font-=
family:&quot;Courier New&quot;background-color:rgb(255, 255, 255)=
;">&nbsp;(row,&nbsp;i)&nbsp;=3D&gt;&nbsp;!allIncludedBroadcastTup=
les.contains(i)&nbsp;&nbsp;</span></li><li style=3D"text-align:le=
ft;font-size:0.75rem;list-style-position:inside;list-style-type:d=
ecimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font=
-weight:normal;font-style:normal;"><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(248, 2=
48, 248);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.map&nbsp;{&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-s=
tyle:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 130,=
 0);background-color:rgb(255, 255, 255);">//&nbsp;TODO:&nbsp;Use&=
nbsp;projection.</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&=
nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.7=
5rem;list-style-position:inside;list-style-type:decimal;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;f=
ont-style:normal;"><span style=3D"font-size:0.75rem;font-family:&=
quot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0,=
 102, 153);background-color:rgb(248, 248, 248);font-weight:bold;"=
>case</span><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(248, 248, 248);">&nbsp;(row,&=
nbsp;_)&nbsp;=3D&gt;&nbsp;buildRow(Vector.fill(left.output.size)(=
</span><span style=3D"font-size:0.75rem;font-family:&quot;Courier=
 New&quot;color:rgb(0, 102, 153);background-color:rgb(248, 248, 2=
48);font-weight:bold;">null</span><span style=3D"font-size:0.75re=
m;font-family:&quot;Courier New&quot;background-color:rgb(248, 24=
8, 248);">)&nbsp;++&nbsp;row)&nbsp;&nbsp;</span></li><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nb=
sp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75r=
em;list-style-position:inside;list-style-type:decimal;font-family=
:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fon=
t-style:normal;"><span style=3D"font-size:0.75rem;font-family:&qu=
ot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&=
nbsp;&nbsp;&nbsp;}&nbsp;</span><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;color:rgb(0, 102, 153);backgrou=
nd-color:rgb(248, 248, 248);font-weight:bold;">else</span><span s=
tyle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;back=
ground-color:rgb(248, 248, 248);">&nbsp;{&nbsp;&nbsp;</span></li>=
<li style=3D"text-align:left;font-size:0.75rem;list-style-positio=
n:inside;list-style-type:decimal;font-family:&quot;Courier New&qu=
ot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;b=
ackground-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;Vector()&nbsp;&nbsp;</span></li><li style=3D"text-align:l=
eft;font-size:0.75rem;list-style-position:inside;list-style-type:=
decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fon=
t-weight:normal;font-style:normal;"><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;background-color:rgb(248,=20=
248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li=20=
style=3D"text-align:left;font-size:0.75rem;list-style-position:in=
side;list-style-type:decimal;font-family:&quot;Courier New&quot;c=
olor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span st=
yle=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backg=
round-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><li styl=
e=3D"text-align:left;font-size:0.75rem;list-style-position:inside=
;list-style-type:decimal;font-family:&quot;Courier New&quot;color=
:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(248, 248, 248);">&nbsp;&nbsp;</span><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 130=
, 0);background-color:rgb(248, 248, 248);">//&nbsp;TODO:&nbsp;Bre=
aks&nbsp;lineage.</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">=
&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.=
75rem;list-style-position:inside;list-style-type:decimal;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;=
font-style:normal;"><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbs=
p;&nbsp;sc.union(&nbsp;&nbsp;</span></li><li style=3D"text-align:=
left;font-size:0.75rem;list-style-position:inside;list-style-type=
:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fo=
nt-weight:normal;font-style:normal;"><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;background-color:rgb(248,=
 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;streamedPlusMatches.flatMap(=
_._1),&nbsp;sc.makeRDD(rightOuterMatches))&nbsp;&nbsp;</span></li=
><li style=3D"text-align:left;font-size:0.75rem;list-style-positi=
on:inside;list-style-type:decimal;font-family:&quot;Courier New&q=
uot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(255, 255, 255);">}&nbsp;&nbsp;</span></li></=
ol><div style=3D"text-align:left;font-size:0.875rem;"><br></div><=
div style=3D"text-align:left;font-size:0.875rem;"><span style=3D"=
font-size:1.5rem;color:rgb(85, 85, 85);font-weight:bold;">Cartesi=
anProduct</span></div><div style=3D"text-align:left;font-size:0.8=
75rem;"><span style=3D"font-size:0.563rem;font-family:Verdana;col=
or:rgb(192, 192, 192);background-color:rgb(248, 248, 248);font-we=
ight:bold;">[java]</span><span style=3D"font-size:0.563rem;font-f=
amily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248,=20=
248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/a=
rticle/details/22748841#"><span style=3D"font-size:0.563rem;font-=
family:Verdana;color:rgb(12, 137, 207);background-color:rgb(248,=20=
248, 248);">view plain</span></a><span style=3D"font-size:0.563re=
m;font-family:Verdana;color:rgb(192, 192, 192);background-color:r=
gb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/=
pelick/article/details/22748841#"><span style=3D"font-size:0.563r=
em;font-family:Verdana;color:rgb(12, 137, 207);background-color:r=
gb(248, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-le=
vel1"><li style=3D"text-align:left;font-size:0.75rem;list-style-p=
osition:inside;list-style-type:decimal;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 102, 153);font-weight:bold;font-style:norma=
l;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier Ne=
w&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255)=
;font-weight:bold;">case</span><span style=3D"font-size:0.75rem;f=
ont-family:&quot;Courier New&quot;background-color:rgb(255, 255,=20=
255);">&nbsp;</span><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;color:rgb(0, 102, 153);background-color:rg=
b(255, 255, 255);font-weight:bold;">class</span><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(255, 255, 255);">&nbsp;CartesianProduct(left:&nbsp;SparkPl=
an,&nbsp;right:&nbsp;SparkPlan)&nbsp;</span><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102,=20=
153);background-color:rgb(255, 255, 255);font-weight:bold;">exten=
ds</span><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;background-color:rgb(255, 255, 255);">&nbsp;BinaryNod=
e&nbsp;&nbsp;</span></li></ol><div style=3D"text-align:left;font-=
size:0.875rem;"><br></div><div style=3D"text-align:left;font-size=
:0.875rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 8=
5);">=B5=F7=D3=C3=B5=C4=CA=C7RDD=B5=C4=B5=D1=BF=A8=B6=FB=BB=FD=B2=
=D9=D7=F7=A3=AC</span></div><div style=3D"text-align:left;font-si=
ze:0.875rem;"><span style=3D"font-size:0.563rem;font-family:Verda=
na;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248);f=
ont-weight:bold;">[java]</span><span style=3D"font-size:0.563rem;=
font-family:Verdana;color:rgb(192, 192, 192);background-color:rgb=
(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pe=
lick/article/details/22748841#"><span style=3D"font-size:0.563rem=
;font-family:Verdana;color:rgb(12, 137, 207);background-color:rgb=
(248, 248, 248);">view plain</span></a><span style=3D"font-size:0=
.563rem;font-family:Verdana;color:rgb(192, 192, 192);background-c=
olor:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csd=
n.net/pelick/article/details/22748841#"><span style=3D"font-size:=
0.563rem;font-family:Verdana;color:rgb(12, 137, 207);background-c=
olor:rgb(248, 248, 248);">copy</span></a></div><ol class=3D"wiz-l=
ist-level1"><li style=3D"text-align:left;font-size:0.75rem;list-s=
tyle-position:inside;list-style-type:decimal;font-family:&quot;Co=
urier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:n=
ormal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(255, 255, 255);">def&nbsp;execute=
()&nbsp;=3D&nbsp;&nbsp;&nbsp;</span></li><li style=3D"text-align:=
left;font-size:0.75rem;list-style-position:inside;list-style-type=
:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fo=
nt-weight:normal;font-style:normal;"><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;background-color:rgb(248,=
 248, 248);">&nbsp;&nbsp;left.execute().map(_.copy()).cartesian(r=
ight.execute().map(_.copy())).map&nbsp;{&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;</spa=
n><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);f=
ont-weight:bold;">case</span><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;(l:&nbsp;Row,&nbsp;r:&nbsp;Row)&nbsp;=3D&gt;&nbsp;buil=
dRow(l&nbsp;++&nbsp;r)&nbsp;&nbsp;</span></li><li style=3D"text-a=
lign:left;font-size:0.75rem;list-style-position:inside;list-style=
-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0,=20=
0);font-weight:normal;font-style:normal;"><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></li></ol><div=20=
style=3D"text-align:left;font-size:0.875rem;"><br></div><div styl=
e=3D"text-align:left;font-size:0.875rem;"><span style=3D"font-siz=
e:1.5rem;color:rgb(85, 85, 85);font-weight:bold;">SparkEquiInnerJ=
oin</span></div><div style=3D"text-align:left;font-size:0.875rem;=
"><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb=
(192, 192, 192);background-color:rgb(248, 248, 248);font-weight:b=
old;">[java]</span><span style=3D"font-size:0.563rem;font-family:=
Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 2=
48);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article=
/details/22748841#"><span style=3D"font-size:0.563rem;font-family=
:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 2=
48);">view plain</span></a><span style=3D"font-size:0.563rem;font=
-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(248=
, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick=
/article/details/22748841#"><span style=3D"font-size:0.563rem;fon=
t-family:Verdana;color:rgb(12, 137, 207);background-color:rgb(248=
, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-level1">=
<li style=3D"text-align:left;font-size:0.75rem;list-style-positio=
n:inside;list-style-type:decimal;font-family:&quot;Courier New&qu=
ot;color:rgb(0, 102, 153);font-weight:bold;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);font-=
weight:bold;">case</span><span style=3D"font-size:0.75rem;font-fa=
mily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);"=
>&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot;=
Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(255,=
 255, 255);font-weight:bold;">class</span><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(255, 255, 255);">&nbsp;SparkEquiInnerJoin(&nbsp;&nbsp;</span></l=
i><li style=3D"text-align:left;font-size:0.75rem;list-style-posit=
ion:inside;list-style-type:decimal;font-family:&quot;Courier New&=
quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;le=
ftKeys:&nbsp;Seq[Expression],&nbsp;&nbsp;</span></li><li style=3D=
"text-align:left;font-size:0.75rem;list-style-position:inside;lis=
t-style-type:decimal;font-family:&quot;Courier New&quot;color:rgb=
(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D"f=
ont-size:0.75rem;font-family:&quot;Courier New&quot;background-co=
lor:rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;rightKeys:&nbsp;=
Seq[Expression],&nbsp;&nbsp;</span></li><li style=3D"text-align:l=
eft;font-size:0.75rem;list-style-position:inside;list-style-type:=
decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fon=
t-weight:normal;font-style:normal;"><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;background-color:rgb(248,=20=
248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;left:&nbsp;SparkPlan,&nbsp;&n=
bsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;li=
st-style-position:inside;list-style-type:decimal;font-family:&quo=
t;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-sty=
le:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;=
&nbsp;&nbsp;right:&nbsp;SparkPlan)&nbsp;</span><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 10=
2, 153);background-color:rgb(255, 255, 255);font-weight:bold;">ex=
tends</span><span style=3D"font-size:0.75rem;font-family:&quot;Co=
urier New&quot;background-color:rgb(255, 255, 255);">&nbsp;Binary=
Node&nbsp;&nbsp;</span></li></ol><div style=3D"text-align:left;fo=
nt-size:0.875rem;"><br></div><div style=3D"text-align:left;font-s=
ize:0.875rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85=
, 85);">=B8=C3join=B2=D9=D7=F7=CA=CA=D3=C3=D3=DAleft=BA=CDright=C1=
=BD=B2=BF=B7=D6partition=D2=BB=D1=F9=B4=F3=C7=D2=CC=E1=B9=A9=B8=F7=
=D7=D4keys=B5=C4=C7=E9=BF=F6=A1=A3</span></div><div style=3D"text=
-align:left;font-size:0.875rem;"><span style=3D"font-size:0.938re=
m;color:rgb(85, 85, 85);">=BB=F9=B1=BE=C9=CF=BF=B4=B4=FA=C2=EB=BE=
=CD=BF=C9=D2=D4=C1=CB=A3=AC=C3=BB=D3=D0=CA=B2=C3=B4=BF=C9=D2=D4=CB=
=B5=C3=F7=B5=C4=A3=AC=D7=F6local join=B5=C4=CA=B1=BA=F2=BD=E8=D6=FA=
=B5=C4=CA=C7PartitionLocalRDDFunctions=C0=EF=B5=C4=B7=BD=B7=A8=A1=
=A3</span></div><div style=3D"text-align:left;font-size:0.875rem;=
"><span style=3D"font-size:0.563rem;font-family:Verdana;color:rgb=
(192, 192, 192);background-color:rgb(248, 248, 248);font-weight:b=
old;">[java]</span><span style=3D"font-size:0.563rem;font-family:=
Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 2=
48);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article=
/details/22748841#"><span style=3D"font-size:0.563rem;font-family=
:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 2=
48);">view plain</span></a><span style=3D"font-size:0.563rem;font=
-family:Verdana;color:rgb(192, 192, 192);background-color:rgb(248=
, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick=
/article/details/22748841#"><span style=3D"font-size:0.563rem;fon=
t-family:Verdana;color:rgb(12, 137, 207);background-color:rgb(248=
, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-level1">=
<li style=3D"text-align:left;font-size:0.75rem;list-style-positio=
n:inside;list-style-type:decimal;font-family:&quot;Courier New&qu=
ot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><spa=
n style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;b=
ackground-color:rgb(255, 255, 255);">def&nbsp;execute()&nbsp;=3D&=
nbsp;attachTree(</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 102, 153);background-color=
:rgb(255, 255, 255);font-weight:bold;">this</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;background-c=
olor:rgb(255, 255, 255);">,&nbsp;</span><span style=3D"font-size:=
0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 0, 255);b=
ackground-color:rgb(255, 255, 255);">"execute"</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">)&nbsp;{&nbsp;&nbsp;</span></li><li st=
yle=3D"text-align:left;font-size:0.75rem;list-style-position:insi=
de;list-style-type:decimal;font-family:&quot;Courier New&quot;col=
or:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(248, 248, 248);">&nbsp;&nbsp;val&nbsp;leftWithKeys&=
nbsp;=3D&nbsp;left.execute().mapPartitions&nbsp;{&nbsp;iter&nbsp;=
=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-=
size:0.75rem;list-style-position:inside;list-style-type:decimal;f=
ont-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:=
normal;font-style:normal;"><span style=3D"font-size:0.75rem;font-=
family:&quot;Courier New&quot;background-color:rgb(255, 255, 255)=
;">&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;generateLeftKeys&nbsp;=3D&nbs=
p;</span><span style=3D"font-size:0.75rem;font-family:&quot;Couri=
er New&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255,=
 255);font-weight:bold;">new</span><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(255, 2=
55, 255);">&nbsp;Projection(leftKeys,&nbsp;left.output)&nbsp;</sp=
an><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;color:rgb(0, 130, 0);background-color:rgb(255, 255, 255);">=
//&nbsp;=B4=AB=C8=EB=C1=CBSchema</span><span style=3D"font-size:0=
.75rem;font-family:&quot;Courier New&quot;background-color:rgb(25=
5, 255, 255);">&nbsp;&nbsp;</span></li><li style=3D"text-align:le=
ft;font-size:0.75rem;list-style-position:inside;list-style-type:d=
ecimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font=
-weight:normal;font-style:normal;"><span style=3D"font-size:0.75r=
em;font-family:&quot;Courier New&quot;background-color:rgb(248, 2=
48, 248);">&nbsp;&nbsp;&nbsp;&nbsp;iter.map(row&nbsp;=3D&gt;&nbsp=
;(generateLeftKeys(row),&nbsp;row.copy()))&nbsp;&nbsp;</span></li=
><li style=3D"text-align:left;font-size:0.75rem;list-style-positi=
on:inside;list-style-type:decimal;font-family:&quot;Courier New&q=
uot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(255, 255, 255);">&nbsp;&nbsp;}&nbsp;&nbsp;</=
span></li><li style=3D"text-align:left;font-size:0.75rem;list-sty=
le-position:inside;list-style-type:decimal;font-family:&quot;Cour=
ier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:nor=
mal;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier=20=
New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span=
></li><li style=3D"text-align:left;font-size:0.75rem;list-style-p=
osition:inside;list-style-type:decimal;font-family:&quot;Courier=20=
New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;=
"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&=
quot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;val&nbsp;r=
ightWithKeys&nbsp;=3D&nbsp;right.execute().mapPartitions&nbsp;{&n=
bsp;iter&nbsp;=3D&gt;&nbsp;&nbsp;</span></li><li style=3D"text-al=
ign:left;font-size:0.75rem;list-style-position:inside;list-style-=
type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0=
);font-weight:normal;font-style:normal;"><span style=3D"font-size=
:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb(=
248, 248, 248);">&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;generateRightKe=
ys&nbsp;=3D&nbsp;</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 102, 153);background-colo=
r:rgb(248, 248, 248);font-weight:bold;">new</span><span style=3D"=
font-size:0.75rem;font-family:&quot;Courier New&quot;background-c=
olor:rgb(248, 248, 248);">&nbsp;Projection(rightKeys,&nbsp;right.=
output)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-=
size:0.75rem;list-style-position:inside;list-style-type:decimal;f=
ont-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:=
normal;font-style:normal;"><span style=3D"font-size:0.75rem;font-=
family:&quot;Courier New&quot;background-color:rgb(255, 255, 255)=
;">&nbsp;&nbsp;&nbsp;&nbsp;iter.map(row&nbsp;=3D&gt;&nbsp;(genera=
teRightKeys(row),&nbsp;row.copy()))&nbsp;&nbsp;</span></li><li st=
yle=3D"text-align:left;font-size:0.75rem;list-style-position:insi=
de;list-style-type:decimal;font-family:&quot;Courier New&quot;col=
or:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgro=
und-color:rgb(248, 248, 248);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></=
li><li style=3D"text-align:left;font-size:0.75rem;list-style-posi=
tion:inside;list-style-type:decimal;font-family:&quot;Courier New=
&quot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><=
span style=3D"font-size:0.75rem;font-family:&quot;Courier New&quo=
t;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li><=
li style=3D"text-align:left;font-size:0.75rem;list-style-position=
:inside;list-style-type:decimal;font-family:&quot;Courier New&quo=
t;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span=
 style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;ba=
ckground-color:rgb(248, 248, 248);">&nbsp;&nbsp;</span><span styl=
e=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;color:r=
gb(0, 130, 0);background-color:rgb(248, 248, 248);">//&nbsp;Do&nb=
sp;the&nbsp;join.</span><span style=3D"font-size:0.75rem;font-fam=
ily:&quot;Courier New&quot;background-color:rgb(248, 248, 248);">=
&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.=
75rem;list-style-position:inside;list-style-type:decimal;font-fam=
ily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;=
font-style:normal;"><span style=3D"font-size:0.75rem;font-family:=
&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&nbs=
p;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;color:rgb(0, 130, 0);background-color:rgb(255,=20=
255, 255);">//&nbsp;joinLocally=CA=C7PartitionLocalRDDFunctions=B5=
=C4=B7=BD=B7=A8</span><span style=3D"font-size:0.75rem;font-famil=
y:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&n=
bsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fo=
nt-style:normal;"><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;=
&nbsp;val&nbsp;joined&nbsp;=3D&nbsp;filterNulls(leftWithKeys).joi=
nLocally(filterNulls(rightWithKeys))&nbsp;&nbsp;</span></li><li s=
tyle=3D"text-align:left;font-size:0.75rem;list-style-position:ins=
ide;list-style-type:decimal;font-family:&quot;Courier New&quot;co=
lor:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span sty=
le=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;backgr=
ound-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0=
, 130, 0);background-color:rgb(255, 255, 255);">//&nbsp;Drop&nbsp=
;join&nbsp;keys&nbsp;and&nbsp;merge&nbsp;input&nbsp;tuples.</span=
><span style=3D"font-size:0.75rem;font-family:&quot;Courier New&q=
uot;background-color:rgb(255, 255, 255);">&nbsp;&nbsp;</span></li=
><li style=3D"text-align:left;font-size:0.75rem;list-style-positi=
on:inside;list-style-type:decimal;font-family:&quot;Courier New&q=
uot;color:rgb(0, 0, 0);font-weight:normal;font-style:normal;"><sp=
an style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot;=
background-color:rgb(248, 248, 248);">&nbsp;&nbsp;joined.map&nbsp=
;{&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(248=
, 248, 248);font-weight:bold;">case</span><span style=3D"font-siz=
e:0.75rem;font-family:&quot;Courier New&quot;background-color:rgb=
(248, 248, 248);">&nbsp;(_,&nbsp;(leftTuple,&nbsp;rightTuple))&nb=
sp;=3D&gt;&nbsp;buildRow(leftTuple&nbsp;++&nbsp;rightTuple)&nbsp;=
}&nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0=
.75rem;list-style-position:inside;list-style-type:decimal;font-fa=
mily:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal=
;font-style:normal;"><span style=3D"font-size:0.75rem;font-family=
:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">}&n=
bsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75=
rem;list-style-position:inside;list-style-type:decimal;font-famil=
y:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;fo=
nt-style:normal;"><span style=3D"font-size:0.75rem;font-family:&q=
uot;Courier New&quot;background-color:rgb(248, 248, 248);">&nbsp;=
&nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;=
list-style-position:inside;list-style-type:decimal;font-family:&q=
uot;Courier New&quot;color:rgb(0, 130, 0);font-weight:normal;font=
-style:normal;"><span style=3D"font-size:0.75rem;font-family:&quo=
t;Courier New&quot;color:rgb(0, 130, 0);background-color:rgb(255,=
 255, 255);">/**</span><span style=3D"font-size:0.75rem;font-fami=
ly:&quot;Courier New&quot;background-color:rgb(255, 255, 255);">&=
nbsp;</span></li><li style=3D"text-align:left;font-size:0.75rem;l=
ist-style-position:inside;list-style-type:decimal;font-family:&qu=
ot;Courier New&quot;color:rgb(0, 130, 0);font-weight:normal;font-=
style:normal;"><span style=3D"font-size:0.75rem;font-family:&quot=
;Courier New&quot;color:rgb(0, 130, 0);background-color:rgb(248,=20=
248, 248);">&nbsp;*&nbsp;Filters&nbsp;any&nbsp;rows&nbsp;where&nb=
sp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;join&nbsp;keys&nbsp;is&nbsp=
;null,&nbsp;ensuring&nbsp;three-valued</span><span style=3D"font-=
size:0.75rem;font-family:&quot;Courier New&quot;background-color:=
rgb(248, 248, 248);">&nbsp;</span></li><li style=3D"text-align:le=
ft;font-size:0.75rem;list-style-position:inside;list-style-type:d=
ecimal;font-family:&quot;Courier New&quot;color:rgb(0, 130, 0);fo=
nt-weight:normal;font-style:normal;"><span style=3D"font-size:0.7=
5rem;font-family:&quot;Courier New&quot;color:rgb(0, 130, 0);back=
ground-color:rgb(255, 255, 255);">&nbsp;*&nbsp;logic&nbsp;for&nbs=
p;the&nbsp;equi-join&nbsp;conditions.</span><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(255, 255, 255);">&nbsp;</span></li><li style=3D"text-align:lef=
t;font-size:0.75rem;list-style-position:inside;list-style-type:de=
cimal;font-family:&quot;Courier New&quot;color:rgb(0, 130, 0);fon=
t-weight:normal;font-style:normal;"><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;color:rgb(0, 130, 0);backg=
round-color:rgb(248, 248, 248);">&nbsp;*/</span><span style=3D"fo=
nt-size:0.75rem;font-family:&quot;Courier New&quot;background-col=
or:rgb(248, 248, 248);">&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 1=
02, 153);font-weight:bold;font-style:normal;"><span style=3D"font=
-size:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102=
, 153);background-color:rgb(255, 255, 255);font-weight:bold;">pro=
tected</span><span style=3D"font-size:0.75rem;font-family:&quot;C=
ourier New&quot;background-color:rgb(255, 255, 255);">&nbsp;def&n=
bsp;filterNulls(rdd:&nbsp;RDD[(Row,&nbsp;Row)])&nbsp;=3D&nbsp;&nb=
sp;</span></li><li style=3D"text-align:left;font-size:0.75rem;lis=
t-style-position:inside;list-style-type:decimal;font-family:&quot=
;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-styl=
e:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;r=
dd.filter&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:l=
eft;font-size:0.75rem;list-style-position:inside;list-style-type:=
decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);fon=
t-weight:normal;font-style:normal;"><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;background-color:rgb(255,=20=
255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 1=
53);background-color:rgb(255, 255, 255);font-weight:bold;">case</=
span><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;background-color:rgb(255, 255, 255);">&nbsp;(key:&nbsp;Se=
q[_],&nbsp;_)&nbsp;=3D&gt;&nbsp;!key.exists(_&nbsp;=3D=3D&nbsp;</=
span><span style=3D"font-size:0.75rem;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255=
);font-weight:bold;">null</span><span style=3D"font-size:0.75rem;=
font-family:&quot;Courier New&quot;background-color:rgb(255, 255,=
 255);">)&nbsp;&nbsp;</span></li><li style=3D"text-align:left;fon=
t-size:0.75rem;list-style-position:inside;list-style-type:decimal=
;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weigh=
t:normal;font-style:normal;"><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(248, 248, 24=
8);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></li></ol><div style=3D"text=
-align:left;font-size:0.875rem;"><br></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;co=
lor:rgb(85, 85, 85);">PartitionLocalRDDFunctions=B7=BD=B7=A8=C8=E7=
=CF=C2=A3=AC=B8=C3=B2=D9=D7=F7=B2=A2=B2=BB=D2=FD=C8=EBshuffle=B2=D9=
=D7=F7=A1=A3=C1=BD=B8=F6RDD=B5=C4partition=CA=FD=C4=BF=D0=E8=D2=AA=
=CF=E0=B5=C8=A1=A3</span></div><div style=3D"text-align:left;font=
-size:0.875rem;"><span style=3D"font-size:0.563rem;font-family:Ve=
rdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 248=
);font-weight:bold;">[java]</span><span style=3D"font-size:0.563r=
em;font-family:Verdana;color:rgb(192, 192, 192);background-color:=
rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net=
/pelick/article/details/22748841#"><span style=3D"font-size:0.563=
rem;font-family:Verdana;color:rgb(12, 137, 207);background-color:=
rgb(248, 248, 248);">view plain</span></a><span style=3D"font-siz=
e:0.563rem;font-family:Verdana;color:rgb(192, 192, 192);backgroun=
d-color:rgb(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.=
csdn.net/pelick/article/details/22748841#"><span style=3D"font-si=
ze:0.563rem;font-family:Verdana;color:rgb(12, 137, 207);backgroun=
d-color:rgb(248, 248, 248);">copy</span></a></div><ol class=3D"wi=
z-list-level1"><li style=3D"text-align:left;font-size:0.75rem;lis=
t-style-position:inside;list-style-type:decimal;font-family:&quot=
;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-styl=
e:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cou=
rier New&quot;background-color:rgb(255, 255, 255);">def&nbsp;join=
Locally[W](other:&nbsp;RDD[(K,&nbsp;W)]):&nbsp;RDD[(K,&nbsp;(V,&n=
bsp;W))]&nbsp;=3D&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text=
-align:left;font-size:0.75rem;list-style-position:inside;list-sty=
le-type:decimal;font-family:&quot;Courier New&quot;color:rgb(0, 0=
, 0);font-weight:normal;font-style:normal;"><span style=3D"font-s=
ize:0.75rem;font-family:&quot;Courier New&quot;background-color:r=
gb(248, 248, 248);">&nbsp;&nbsp;cogroupLocally(other).flatMapValu=
es&nbsp;{&nbsp;&nbsp;</span></li><li style=3D"text-align:left;fon=
t-size:0.75rem;list-style-position:inside;list-style-type:decimal=
;font-family:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weigh=
t:normal;font-style:normal;"><span style=3D"font-size:0.75rem;fon=
t-family:&quot;Courier New&quot;background-color:rgb(255, 255, 25=
5);">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=3D"font-size:0.75=
rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 153);bac=
kground-color:rgb(255, 255, 255);font-weight:bold;">case</span><s=
pan style=3D"font-size:0.75rem;font-family:&quot;Courier New&quot=
;background-color:rgb(255, 255, 255);">&nbsp;(vs,&nbsp;ws)&nbsp;=3D=
&gt;&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&qu=
ot;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb(2=
55, 255, 255);font-weight:bold;">for</span><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;background-color:rg=
b(255, 255, 255);">&nbsp;(v&nbsp;&lt;-&nbsp;vs.iterator;&nbsp;w&n=
bsp;&lt;-&nbsp;ws.iterator)&nbsp;yield&nbsp;(v,&nbsp;w)&nbsp;&nbs=
p;</span></li><li style=3D"text-align:left;font-size:0.75rem;list=
-style-position:inside;list-style-type:decimal;font-family:&quot;=
Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;font-style=
:normal;"><span style=3D"font-size:0.75rem;font-family:&quot;Cour=
ier New&quot;background-color:rgb(248, 248, 248);">&nbsp;&nbsp;}&=
nbsp;&nbsp;</span></li><li style=3D"text-align:left;font-size:0.7=
5rem;list-style-position:inside;list-style-type:decimal;font-fami=
ly:&quot;Courier New&quot;color:rgb(0, 0, 0);font-weight:normal;f=
ont-style:normal;"><span style=3D"font-size:0.75rem;font-family:&=
quot;Courier New&quot;background-color:rgb(255, 255, 255);">}&nbs=
p;&nbsp;</span></li></ol><div style=3D"text-align:left;font-size:=
0.875rem;"><br></div><div style=3D"text-align:left;font-size:0.87=
5rem;"><span style=3D"font-size:2rem;color:rgb(85, 85, 85);font-w=
eight:bold;">Other</span></div><div style=3D"text-align:left;font=
-size:0.875rem;"><span style=3D"font-size:1.5rem;color:rgb(85, 85=
, 85);font-weight:bold;">Union</span></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;co=
lor:rgb(85, 85, 85);">=B8=C3=B2=D9=D7=F7=D6=B1=BD=D3=BC=CC=B3=D0S=
parkPlan</span></div><div style=3D"text-align:left;font-size:0.87=
5rem;"><span style=3D"font-size:0.563rem;font-family:Verdana;colo=
r:rgb(192, 192, 192);background-color:rgb(248, 248, 248);font-wei=
ght:bold;">[java]</span><span style=3D"font-size:0.563rem;font-fa=
mily:Verdana;color:rgb(192, 192, 192);background-color:rgb(248, 2=
48, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/ar=
ticle/details/22748841#"><span style=3D"font-size:0.563rem;font-f=
amily:Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 2=
48, 248);">view plain</span></a><span style=3D"font-size:0.563rem=
;font-family:Verdana;color:rgb(192, 192, 192);background-color:rg=
b(248, 248, 248);">&nbsp;</span><a href=3D"http://blog.csdn.net/p=
elick/article/details/22748841#"><span style=3D"font-size:0.563re=
m;font-family:Verdana;color:rgb(12, 137, 207);background-color:rg=
b(248, 248, 248);">copy</span></a></div><ol class=3D"wiz-list-lev=
el1"><li style=3D"text-align:left;font-size:0.75rem;list-style-po=
sition:inside;list-style-type:decimal;font-family:&quot;Courier N=
ew&quot;color:rgb(0, 102, 153);font-weight:bold;font-style:normal=
;"><span style=3D"font-size:0.75rem;font-family:&quot;Courier New=
&quot;color:rgb(0, 102, 153);background-color:rgb(255, 255, 255);=
font-weight:bold;">case</span><span style=3D"font-size:0.75rem;fo=
nt-family:&quot;Courier New&quot;background-color:rgb(255, 255, 2=
55);">&nbsp;</span><span style=3D"font-size:0.75rem;font-family:&=
quot;Courier New&quot;color:rgb(0, 102, 153);background-color:rgb=
(255, 255, 255);font-weight:bold;">class</span><span style=3D"fon=
t-size:0.75rem;font-family:&quot;Courier New&quot;background-colo=
r:rgb(255, 255, 255);">&nbsp;Union(children:&nbsp;Seq[SparkPlan])=
(</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;color:rgb(100, 100, 100);background-color:rgb(255, 255=
, 255);">@transient</span><span style=3D"font-size:0.75rem;font-f=
amily:&quot;Courier New&quot;background-color:rgb(255, 255, 255);=
">&nbsp;sc:&nbsp;SparkContext)&nbsp;</span><span style=3D"font-si=
ze:0.75rem;font-family:&quot;Courier New&quot;color:rgb(0, 102, 1=
53);background-color:rgb(255, 255, 255);font-weight:bold;">extend=
s</span><span style=3D"font-size:0.75rem;font-family:&quot;Courie=
r New&quot;background-color:rgb(255, 255, 255);">&nbsp;SparkPlan&=
nbsp;&nbsp;</span></li></ol><div style=3D"text-align:left;font-si=
ze:0.875rem;"><br></div><div style=3D"text-align:left;font-size:0=
.875rem;"><span style=3D"font-size:0.938rem;color:rgb(85, 85, 85)=
;">=D3=C3=B4=AB=C8=EB=B5=C4SparkPlan=BC=AF=BA=CF=B8=F7=D7=D4=B5=C4=
RDD=D6=B4=D0=D0=BD=E1=B9=FB=C9=FA=B3=C9=D2=BB=B8=F6UnionRDD</span=
></div><div style=3D"text-align:left;font-size:0.875rem;"><span s=
tyle=3D"font-size:0.563rem;font-family:Verdana;color:rgb(192, 192=
, 192);background-color:rgb(248, 248, 248);font-weight:bold;">[ja=
va]</span><span style=3D"font-size:0.563rem;font-family:Verdana;c=
olor:rgb(192, 192, 192);background-color:rgb(248, 248, 248);">&nb=
sp;</span><a href=3D"http://blog.csdn.net/pelick/article/details/=
22748841#"><span style=3D"font-size:0.563rem;font-family:Verdana;=
color:rgb(12, 137, 207);background-color:rgb(248, 248, 248);">vie=
w plain</span></a><span style=3D"font-size:0.563rem;font-family:V=
erdana;color:rgb(192, 192, 192);background-color:rgb(248, 248, 24=
8);">&nbsp;</span><a href=3D"http://blog.csdn.net/pelick/article/=
details/22748841#"><span style=3D"font-size:0.563rem;font-family:=
Verdana;color:rgb(12, 137, 207);background-color:rgb(248, 248, 24=
8);">copy</span></a></div><ol class=3D"wiz-list-level1"><li style=
=3D"text-align:left;font-size:0.75rem;list-style-position:inside;=
list-style-type:decimal;font-family:&quot;Courier New&quot;color:=
rgb(0, 0, 0);font-weight:normal;font-style:normal;"><span style=3D=
"font-size:0.75rem;font-family:&quot;Courier New&quot;background-=
color:rgb(255, 255, 255);">def&nbsp;execute()&nbsp;=3D&nbsp;sc.un=
ion(children.map(_.execute()))&nbsp;&nbsp;</span></li></ol><div s=
tyle=3D"text-align:left;font-size:0.875rem;"><br></div><div style=
=3D"text-align:left;font-size:0.875rem;"><br></div><div style=3D"=
text-align:left;font-size:0.875rem;"><br></div><div style=3D"text=
-align:left;font-size:0.875rem;"><br></div><div style=3D"text-ali=
gn:left;font-size:0.875rem;"><span style=3D"font-size:0.938rem;co=
lor:rgb(85, 85, 85);">=C8=AB=CE=C4=CD=EA :)</span></div><br></div=
></body></html>=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=
=0A=0A=0A=0A=0A=0A=0A

------=_Next_Part_0000200296.617--

------=_Next_Part_0000600888.022--

