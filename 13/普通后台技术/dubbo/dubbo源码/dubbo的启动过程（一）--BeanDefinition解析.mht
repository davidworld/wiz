From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?ZHViYm+1xMb0tq+5/bPMo6jSu6OpLS1CZWFuRGVmaW5pdGlvbr3izvY=?=
Date: Date: Fri, 23 Jul 2021 05:55:47 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0001482468.000"

This is a multi-part message in MIME format.

------=_Next_Part_0001482468.000
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000494156.212"


------=_Next_Part_0000494156.212
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000494156.212
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A<titl=
e>dubbo=B5=C4=C6=F4=B6=AF=B9=FD=B3=CC=A3=A8=D2=BB=A3=A9--BeanDefi=
nition=BD=E2=CE=F6</title>=0A    =0A<style id=3D"wiz_custom_css">=
html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-f=
amily: Helvetica, 'Hiragino Sans GB', '=E5=BE=AE=E8=BD=AF=E9=9B=85=
=E9=BB=91', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-ser=
if;line-height: 1.7;margin: 0 auto;padding: 20px 16px;padding: 1.=
25rem 1rem;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-b=
ody h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h=
6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-w=
eight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67re=
m;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-edi=
tor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h=
4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-si=
ze:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-=
size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wi=
z-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-edit=
or-body dl,.wiz-editor-body li {margin:8px 0;}.wiz-editor-body bl=
ockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-=
body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin=
:0;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;pa=
dding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-s=
tyle-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list=
-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li=
 {list-style-type:lower-roman;}.wiz-editor-body blockquote {paddi=
ng: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-to=
p:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}=
.wiz-editor-body img {border:0;max-width:100%;height:auto !import=
ant;margin:2px 0;}.wiz-editor-body table {border-collapse:collaps=
e;border:1px solid #bbbbbb;}.wiz-editor-body td,.wiz-editor-body=20=
th {padding:4px 8px;border-collapse:collapse;border:1px solid #bb=
bbbb;min-height:28px;word-break:break-word;box-sizing: border-box=
;}.wiz-hide {display:none !important;}</style></head>=0A=0A<body=20=
class=3D"wiz-editor-body"  spellcheck=3D"false"><div></div><h1 cl=
ass=3D"h2 mb-3" id=3D"sf-article_title" style=3D"font-size: 2rem;=
 color: rgb(33, 37, 41);"><a class=3D"text-body" href=3D"https://=
segmentfault.com/a/1190000021421978" style=3D"text-decoration: no=
ne;">dubbo=B5=C4=C6=F4=B6=AF=B9=FD=B3=CC=A3=A8=D2=BB=A3=A9--BeanD=
efinition=BD=E2=CE=F6</a></h1><div class=3D"m-n1" style=3D"color:=
rgb(33, 37, 41)"><a class=3D"m-1 badge-tag" href=3D"https://segme=
ntfault.com/t/dubbo" data-toggle=3D"popover" data-placement=3D"to=
p" data-original-title=3D"dubbo" data-id=3D"1040000000257318" sty=
le=3D"color:rgb(0, 150, 94);background-color:rgba(0, 150, 94, 0.1=
);text-decoration:none;font-size:0.875rem;">dubbo</a><a class=3D"=
m-1 badge-tag" href=3D"https://segmentfault.com/t/java" data-togg=
le=3D"popover" data-img=3D"https://avatar-static.segmentfault.com=
/512/342/51234253-1040000000089449_big64" data-placement=3D"top"=20=
data-original-title=3D"java" data-id=3D"1040000000089449" style=3D=
"color:rgb(0, 150, 94);background-color:rgba(0, 150, 94, 0.1);tex=
t-decoration:none;font-size:0.875rem;"><img src=3D"0.250341660149=
73436.png"><span>&nbsp;</span>java</a><a class=3D"m-1 badge-tag"=20=
href=3D"https://segmentfault.com/t/%E6%BA%90%E7%A0%81%E5%88%86%E6=
%9E%90" data-toggle=3D"popover" data-placement=3D"top" data-origi=
nal-title=3D"=D4=B4=C2=EB=B7=D6=CE=F6" data-id=3D"104000000247974=
1" style=3D"color:rgb(0, 150, 94);background-color:rgba(0, 150, 9=
4, 0.1);text-decoration:none;font-size:0.875rem;">=D4=B4=C2=EB=B7=
=D6=CE=F6</a></div><div class=3D"font-size-14" style=3D"color:rgb=
(33, 37, 41);font-size:0.875rem"><span class=3D"text-secondary ml=
-2" style=3D"color:rgb(108, 117, 125) !important;">&nbsp;=D4=C4=B6=
=C1=D4=BC 21 =B7=D6=D6=D3</span></div><article class=3D"article f=
mt article-content" data-id=3D"1190000021421978" style=3D"color:=20=
rgb(33, 37, 41);"><blockquote>=D7=A2=A3=BA=D4=B4=C2=EB=B0=E6=B1=BE=
=CA=C72.7.4.1</blockquote><p>=D4=DA=D6=AE=C7=B0<a href=3D"https:/=
/segmentfault.com/a/1190000020689625" style=3D"color:rgb(0, 150,=20=
94);text-decoration:none;">spring=D1=A7=CF=B0</a>=D6=D0=A3=AC=CE=D2=
=C3=C7=D6=AA=B5=C0=A3=ACspring=C8=DD=C6=F7=C6=F4=B6=AF=B5=C4=CA=B1=
=BA=F2=A3=AC=BB=E1=CF=C8=C9=FA=B3=C9<code style=3D"font-size: 0.8=
75rem; color: rgb(232, 62, 140);">BeanDefinition</code>=A3=AC=D5=E2=
=B8=F6=B2=BD=D6=E8=CA=C7=D4=DA<a href=3D"https://segmentfault.com=
/a/1190000020986124#item-1-2" style=3D"color:rgb(0, 150, 94);text=
-decoration:none;">obtainFreshBeanFactory</a>=A3=A8=CE=D2=C3=C7=D5=
=E2=C0=EF=CA=C7=D3=C3=D7=A2=BD=E2=BD=B2=B5=C4=A3=AC=CB=F9=D2=D4=D3=
=D0=B5=E3=B2=BB=D2=BB=D1=F9=A3=A9=D6=D0=A1=A3dubbo=D4=DA=CF=EE=C4=
=BF=D6=D0=A3=AC=C5=E4=D6=C3=C1=CB<code style=3D"font-size: 0.875r=
em; color: rgb(232, 62, 140);">META-INF/spring.handler</code>=A3=AC=
=C4=DA=C8=DD=C8=E7=CF=C2=A3=BA</p><pre class=3D"hljs elixir" styl=
e=3D"font-size: 0.875rem; color: rgb(51, 51, 51); background: rgb=
(233, 236, 239);"><code>http\<span class=3D"hljs-symbol" style=3D=
"color:rgb(153, 0, 115);">://dubbo</span>.apache.org/schema/dubbo=
=3Dorg.apache.dubbo.config.spring.schema.DubboNamespaceHandler=0A=
http\<span class=3D"hljs-symbol" style=3D"color:rgb(153, 0, 115);=
">://code</span>.alibabatech.com/schema/dubbo=3Dorg.apache.dubbo.=
config.spring.schema.DubboNamespaceHandler</code></pre><p>dubbo=B5=
=C4<code style=3D"font-size: 0.875rem; color: rgb(232, 62, 140);"=
>BeanDefinitionParser</code>=B5=C4=BC=D3=D4=D8=D4=DA<code style=3D=
"font-size: 0.875rem; color: rgb(232, 62, 140);">DubboNamespaceHa=
ndler</code>=C0=E0=D6=D0=A3=AC=CD=A8=B9=FD<code style=3D"font-siz=
e: 0.875rem; color: rgb(232, 62, 140);">DubboBeanDefinitionParser=
</code>=BD=E2=CE=F6<code style=3D"font-size: 0.875rem; color: rgb=
(232, 62, 140);">BeanDefinition</code>=A1=A3</p><pre class=3D"hlj=
s cpp" style=3D"font-size: 0.875rem; color: rgb(51, 51, 51); back=
ground: rgb(233, 236, 239);"><code><span class=3D"hljs-function">=
<span class=3D"hljs-keyword">public</span> <span class=3D"hljs-ke=
yword">void</span> <span class=3D"hljs-title" style=3D"color:rgb(=
153, 0, 0);">init</span><span class=3D"hljs-params">()</span> </s=
pan>{  =0A    registerBeanDefinitionParser(<span class=3D"hljs-st=
ring" style=3D"color:rgb(221, 17, 68);">"application"</span>, <sp=
an class=3D"hljs-keyword">new</span> DubboBeanDefinitionParser(Ap=
plicationConfig.<span class=3D"hljs-keyword">class</span>, <span=20=
class=3D"hljs-literal" style=3D"color:teal;">true</span>));  =0A=20=
   registerBeanDefinitionParser(<span class=3D"hljs-string" style=
=3D"color:rgb(221, 17, 68);">"module"</span>, <span class=3D"hljs=
-keyword">new</span> DubboBeanDefinitionParser(ModuleConfig.<span=
 class=3D"hljs-keyword">class</span>, <span class=3D"hljs-literal=
" style=3D"color:teal;">true</span>));  =0A    registerBeanDefini=
tionParser(<span class=3D"hljs-string" style=3D"color:rgb(221, 17=
, 68);">"registry"</span>, <span class=3D"hljs-keyword">new</span=
> DubboBeanDefinitionParser(RegistryConfig.<span class=3D"hljs-ke=
yword">class</span>, <span class=3D"hljs-literal" style=3D"color:=
teal;">true</span>));  =0A    registerBeanDefinitionParser(<span=20=
class=3D"hljs-string" style=3D"color:rgb(221, 17, 68);">"config-c=
enter"</span>, <span class=3D"hljs-keyword">new</span> DubboBeanD=
efinitionParser(ConfigCenterBean.<span class=3D"hljs-keyword">cla=
ss</span>, <span class=3D"hljs-literal" style=3D"color:teal;">tru=
e</span>));  =0A    registerBeanDefinitionParser(<span class=3D"h=
ljs-string" style=3D"color:rgb(221, 17, 68);">"metadata-report"</=
span>, <span class=3D"hljs-keyword">new</span> DubboBeanDefinitio=
nParser(MetadataReportConfig.<span class=3D"hljs-keyword">class</=
span>, <span class=3D"hljs-literal" style=3D"color:teal;">true</s=
pan>));  =0A    registerBeanDefinitionParser(<span class=3D"hljs-=
string" style=3D"color:rgb(221, 17, 68);">"monitor"</span>, <span=
 class=3D"hljs-keyword">new</span> DubboBeanDefinitionParser(Moni=
torConfig.<span class=3D"hljs-keyword">class</span>, <span class=3D=
"hljs-literal" style=3D"color:teal;">true</span>));  =0A    regis=
terBeanDefinitionParser(<span class=3D"hljs-string" style=3D"colo=
r:rgb(221, 17, 68);">"metrics"</span>, <span class=3D"hljs-keywor=
d">new</span> DubboBeanDefinitionParser(MetricsConfig.<span class=
=3D"hljs-keyword">class</span>, <span class=3D"hljs-literal" styl=
e=3D"color:teal;">true</span>));  =0A    registerBeanDefinitionPa=
rser(<span class=3D"hljs-string" style=3D"color:rgb(221, 17, 68);=
">"provider"</span>, <span class=3D"hljs-keyword">new</span> Dubb=
oBeanDefinitionParser(ProviderConfig.<span class=3D"hljs-keyword"=
>class</span>, <span class=3D"hljs-literal" style=3D"color:teal;"=
>true</span>));  =0A    registerBeanDefinitionParser(<span class=3D=
"hljs-string" style=3D"color:rgb(221, 17, 68);">"consumer"</span>=
, <span class=3D"hljs-keyword">new</span> DubboBeanDefinitionPars=
er(ConsumerConfig.<span class=3D"hljs-keyword">class</span>, <spa=
n class=3D"hljs-literal" style=3D"color:teal;">true</span>));  =0A=
    registerBeanDefinitionParser(<span class=3D"hljs-string" styl=
e=3D"color:rgb(221, 17, 68);">"protocol"</span>, <span class=3D"h=
ljs-keyword">new</span> DubboBeanDefinitionParser(ProtocolConfig.=
<span class=3D"hljs-keyword">class</span>, <span class=3D"hljs-li=
teral" style=3D"color:teal;">true</span>));  =0A    registerBeanD=
efinitionParser(<span class=3D"hljs-string" style=3D"color:rgb(22=
1, 17, 68);">"service"</span>, <span class=3D"hljs-keyword">new</=
span> DubboBeanDefinitionParser(ServiceBean.<span class=3D"hljs-k=
eyword">class</span>, <span class=3D"hljs-literal" style=3D"color=
:teal;">true</span>));  =0A    registerBeanDefinitionParser(<span=
 class=3D"hljs-string" style=3D"color:rgb(221, 17, 68);">"referen=
ce"</span>, <span class=3D"hljs-keyword">new</span> DubboBeanDefi=
nitionParser(ReferenceBean.<span class=3D"hljs-keyword">class</sp=
an>, <span class=3D"hljs-literal" style=3D"color:teal;">false</sp=
an>));  =0A    registerBeanDefinitionParser(<span class=3D"hljs-s=
tring" style=3D"color:rgb(221, 17, 68);">"annotation"</span>, <sp=
an class=3D"hljs-keyword">new</span> AnnotationBeanDefinitionPars=
er());  =0A}</code></pre><p>=BE=DF=CC=E5=B5=C4=BD=E2=CE=F6=D4=DA<=
code style=3D"font-size: 0.875rem; color: rgb(232, 62, 140);">Dub=
boBeanDefinitionParser</code>=B5=C4<code style=3D"font-size: 0.87=
5rem; color: rgb(232, 62, 140);">parse()</code>=D6=D0=A1=A3</p><p=
re style=3D"font-size: 0.875rem; background-color: rgb(233, 236,=20=
239);"><code>private static BeanDefinition parse(Element element,=
 ParserContext parserContext, Class&lt;?&gt; beanClass, boolean r=
equired) {=0A    RootBeanDefinition beanDefinition =3D new RootBe=
anDefinition();=0A    beanDefinition.setBeanClass(beanClass);=0A=20=
   beanDefinition.setLazyInit(false);=0A    String id =3D element=
.getAttribute("id");=0A    // =C3=BB=D3=D0id=A3=AC=CD=A8=B9=FDnam=
e=A1=A2ProtocolConfig=A1=A2interface=A1=A2beanClass=B8=B3=D6=B5=B8=
=F8id=0A    if (StringUtils.isEmpty(id) &amp;&amp; required) {=0A=
        // =BB=F1=C8=A1=C3=FB=B3=C6=0A        String generatedBea=
nName =3D element.getAttribute("name");=0A        if (StringUtils=
.isEmpty(generatedBeanName)) {=0A            // =C8=E7=B9=FB=CA=C7=
ProtocolConfig=A3=AC=C3=FB=B3=C6=B6=A8=D2=E5=CE=AAdubbo=0A      =20=
     if (ProtocolConfig.class.equals(beanClass)) {=0A           =20=
    generatedBeanName =3D "dubbo";=0A            } else {=0A    =20=
           // =C8=E7=B9=FB=B2=BB=CA=C7ProtocolConfig=A3=AC=C3=FB=B3=
=C6=B6=A8=D2=E5=CE=AAinterface=B5=C4=D6=B5=0A                gene=
ratedBeanName =3D element.getAttribute("interface");=0A         =20=
  }=0A        }=0A        // =C8=E7=B9=FB=B2=BB=CA=C7ProtocolConf=
ig=C7=D2=C3=BB=D3=D0interface=CA=F4=D0=D4=A3=AC=D3=C3=C0=E0=C3=FB=
=0A        if (StringUtils.isEmpty(generatedBeanName)) {=0A     =20=
      generatedBeanName =3D beanClass.getName();=0A        }=0A =20=
      id =3D generatedBeanName;=0A        int counter =3D 2;=0A =20=
      while (parserContext.getRegistry().containsBeanDefinition(i=
d)) {=0A            id =3D generatedBeanName + (counter++);=0A  =20=
     }=0A    }=0A    // =D7=A2=B2=E1beanDefinition=B2=A2=D4=F6=BC=
=D3id=B5=C4=CA=F4=D0=D4=D6=B5=0A    if (StringUtils.isNotEmpty(id=
)) {=0A        if (parserContext.getRegistry().containsBeanDefini=
tion(id)) {=0A            throw new IllegalStateException("Duplic=
ate spring bean id " + id);=0A        }=0A        parserContext.g=
etRegistry().registerBeanDefinition(id, beanDefinition);=0A     =20=
  beanDefinition.getPropertyValues().addPropertyValue("id", id);=0A=
    }=0A    // =B8=F8=BE=DF=D3=D0protocol=CA=F4=D0=D4=B5=C4=B8=B3=
=D6=B5=0A    if (ProtocolConfig.class.equals(beanClass)) {=0A   =20=
    for (String name : parserContext.getRegistry().getBeanDefinit=
ionNames()) {=0A            BeanDefinition definition =3D parserC=
ontext.getRegistry().getBeanDefinition(name);=0A            Prope=
rtyValue property =3D definition.getPropertyValues().getPropertyV=
alue("protocol");=0A            if (property !=3D null) {=0A    =20=
           Object value =3D property.getValue();=0A             =20=
  if (value instanceof ProtocolConfig &amp;&amp; id.equals(((Prot=
ocolConfig) value).getName())) {=0A                    definition=
.getPropertyValues().addPropertyValue("protocol", new RuntimeBean=
Reference(id));=0A                }=0A            }=0A        }=0A=
    } else if (ServiceBean.class.equals(beanClass)) {=0A        /=
/ =C8=E7=B9=FB=D3=D0class=CA=F4=D0=D4=A3=AC=D4=F2=B4=B4=BD=A8=D0=C2=
=B5=C4BeanDefinition=A3=AC=B2=A2=D6=D8=D6=C3ref=0A        String=20=
className =3D element.getAttribute("class");=0A        if (String=
Utils.isNotEmpty(className)) {=0A            RootBeanDefinition c=
lassDefinition =3D new RootBeanDefinition();=0A            classD=
efinition.setBeanClass(ReflectUtils.forName(className));=0A     =20=
      classDefinition.setLazyInit(false);=0A            // =BD=E2=
=CE=F6=D7=D3=CA=F4=D0=D4=0A            parseProperties(element.ge=
tChildNodes(), classDefinition);=0A            // =D6=D8=D6=C3ref=
=0A            beanDefinition.getPropertyValues().addPropertyValu=
e("ref", new BeanDefinitionHolder(classDefinition, id + "Impl"));=
=0A        }=0A    } else if (ProviderConfig.class.equals(beanCla=
ss)) {=0A        // =BD=E2=CE=F6Provider=D7=D3=BD=DA=B5=E3=B5=C4s=
ervice=B1=EA=C7=A9=A3=AC=B2=A2=B8=F8service=B8=B3=D6=B5provider=B5=
=C4=CA=F4=D0=D4=0A        parseNested(element, parserContext, Ser=
viceBean.class, true, "service", "provider", id, beanDefinition);=
=0A    } else if (ConsumerConfig.class.equals(beanClass)) {=0A  =20=
     // =BD=E2=CE=F6Consumer=D7=D3=BD=DA=B5=E3=B5=C4reference=B1=EA=
=C7=A9=A3=AC=B2=A2=B8=F8reference=B8=B3=D6=B5consumer=B5=C4=CA=F4=
=D0=D4=0A        parseNested(element, parserContext, ReferenceBea=
n.class, false, "reference", "consumer", id, beanDefinition);=0A=20=
   }=0A    Set&lt;String&gt; props =3D new HashSet&lt;&gt;();=0A=20=
   ManagedMap parameters =3D null;=0A    for (Method setter : bea=
nClass.getMethods()) {=0A        String name =3D setter.getName()=
;=0A        if (name.length() &gt; 3 &amp;&amp; name.startsWith("=
set")=0A                &amp;&amp; Modifier.isPublic(setter.getMo=
difiers())=0A                &amp;&amp; setter.getParameterTypes(=
).length =3D=3D 1) {=0A            Class&lt;?&gt; type =3D setter=
.getParameterTypes()[0];=0A            String beanProperty =3D na=
me.substring(3, 4).toLowerCase() + name.substring(4);=0A        =20=
   String property =3D StringUtils.camelToSplitName(beanProperty,=
 "-");=0A            props.add(property);=0A            // check=20=
the setter/getter whether match=0A            Method getter =3D n=
ull;=0A            try {=0A                getter =3D beanClass.g=
etMethod("get" + name.substring(3), new Class&lt;?&gt;[0]);=0A  =20=
         } catch (NoSuchMethodException e) {=0A                tr=
y {=0A                    getter =3D beanClass.getMethod("is" + n=
ame.substring(3), new Class&lt;?&gt;[0]);=0A                } cat=
ch (NoSuchMethodException e2) {=0A                    // ignore,=20=
there is no need any log here since some class implement the inte=
rface: EnvironmentAware,=0A                    // ApplicationAwar=
e, etc. They only have setter method, otherwise will cause the er=
ror log during application start up.=0A                }=0A     =20=
      }=0A            if (getter =3D=3D null=0A                 =20=
  || !Modifier.isPublic(getter.getModifiers())=0A               =20=
    || !type.equals(getter.getReturnType())) {=0A               =20=
continue;=0A            }=0A            if ("parameters".equals(p=
roperty)) {=0A                // =BD=E2=CE=F6=B2=CE=CA=FDdubbo:pa=
rameters=CA=F4=D0=D4=0A                parameters =3D parseParame=
ters(element.getChildNodes(), beanDefinition);=0A            } el=
se if ("methods".equals(property)) {=0A                // =BD=E2=CE=
=F6=B7=BD=B7=A8dubbo:method=CA=F4=D0=D4=0A                parseMe=
thods(id, element.getChildNodes(), beanDefinition, parserContext)=
;=0A            } else if ("arguments".equals(property)) {=0A   =20=
            // =BD=E2=CE=F6=B7=BD=B7=A8=B2=CE=CA=FDarguments=CA=F4=
=D0=D4=0A                parseArguments(id, element.getChildNodes=
(), beanDefinition, parserContext);=0A            } else {=0A   =20=
            String value =3D element.getAttribute(property);=0A =20=
              if (value !=3D null) {=0A                    value=20=
=3D value.trim();=0A                    if (value.length() &gt; 0=
) {=0A                        // =B5=E3=B6=D4=B5=E3=B5=C4=C7=E9=BF=
=F6=0A                        if ("registry".equals(property) &am=
p;&amp; RegistryConfig.NO_AVAILABLE.equalsIgnoreCase(value)) {=0A=
                            RegistryConfig registryConfig =3D new=
 RegistryConfig();=0A                            registryConfig.s=
etAddress(RegistryConfig.NO_AVAILABLE);=0A                      =20=
     beanDefinition.getPropertyValues().addPropertyValue(beanProp=
erty, registryConfig);=0A                        } else if ("prov=
ider".equals(property) || "registry".equals(property) || ("protoc=
ol".equals(property) &amp;&amp; AbstractServiceConfig.class.isAss=
ignableFrom(beanClass))) {=0A                            /**=0A =20=
                           * For 'provider' 'protocol' 'registry'=
, keep literal value (should be id/name) and set the value to 're=
gistryIds' 'providerIds' protocolIds'=0A                        =20=
    * The following process should make sure each id refers to th=
e corresponding instance, here's how to find the instance for dif=
ferent use cases:=0A                             * 1. Spring, che=
ck existing bean by id, see{@link ServiceBean#afterPropertiesSet(=
)}; then try to use id to find configs defined in remote Config C=
enter=0A                             * 2. API, directly use id to=
 find configs defined in remote Config Center; if all config inst=
ances are defined locally, please use {@link ServiceConfig#setReg=
istries(List)}=0A                             */=0A             =20=
              beanDefinition.getPropertyValues().addPropertyValue=
(beanProperty + "Ids", value);=0A                        } else {=
=0A                            Object reference;=0A             =20=
              if (isPrimitive(type)) {=0A                       =20=
        if ("async".equals(property) &amp;&amp; "false".equals(va=
lue)=0A                                        || "timeout".equal=
s(property) &amp;&amp; "0".equals(value)=0A                     =20=
                  || "delay".equals(property) &amp;&amp; "0".equa=
ls(value)=0A                                        || "version".=
equals(property) &amp;&amp; "0.0.0".equals(value)=0A            =20=
                           || "stat".equals(property) &amp;&amp;=20=
"-1".equals(value)=0A                                        || "=
reliable".equals(property) &amp;&amp; "false".equals(value)) {=0A=
                                    // backward compatibility for=
 the default value in old version's xsd=0A                      =20=
             value =3D null;=0A                                }=0A=
                                reference =3D value;=0A         =20=
                  } else if (ONRETURN.equals(property) || ONTHROW=
.equals(property) || ONINVOKE.equals(property)) {=0A            =20=
                   int index =3D value.lastIndexOf(".");=0A     =20=
                          String ref =3D value.substring(0, index=
);=0A                                String method =3D value.subs=
tring(index + 1);=0A                                reference =3D=
 new RuntimeBeanReference(ref);=0A                              =20=
 beanDefinition.getPropertyValues().addPropertyValue(property + M=
ETHOD, method);=0A                            } else {=0A       =20=
                        if ("ref".equals(property) &amp;&amp; par=
serContext.getRegistry().containsBeanDefinition(value)) {=0A    =20=
                               BeanDefinition refBean =3D parserC=
ontext.getRegistry().getBeanDefinition(value);=0A               =20=
                    if (!refBean.isSingleton()) {=0A            =20=
                           throw new IllegalStateException("The e=
xported service ref " + value + " must be singleton! Please set t=
he " + value + " bean scope to singleton, eg: &lt;bean id=3D\"" +=
 value + "\" scope=3D\"singleton\" ...&gt;");=0A                =20=
                   }=0A                                }=0A     =20=
                          reference =3D new RuntimeBeanReference(=
value);=0A                            }=0A                      =20=
     beanDefinition.getPropertyValues().addPropertyValue(beanProp=
erty, reference);=0A                        }=0A                =20=
   }=0A                }=0A            }=0A        }=0A    }=0A =20=
  NamedNodeMap attributes =3D element.getAttributes();=0A    int=20=
len =3D attributes.getLength();=0A    for (int i =3D 0; i &lt; le=
n; i++) {=0A        Node node =3D attributes.item(i);=0A        S=
tring name =3D node.getLocalName();=0A        if (!props.contains=
(name)) {=0A            if (parameters =3D=3D null) {=0A        =20=
       parameters =3D new ManagedMap();=0A            }=0A      =20=
     String value =3D node.getNodeValue();=0A            paramete=
rs.put(name, new TypedStringValue(value, String.class));=0A     =20=
  }=0A    }=0A    if (parameters !=3D null) {=0A        beanDefin=
ition.getPropertyValues().addPropertyValue("parameters", paramete=
rs);=0A    }=0A    return beanDefinition;=0A}</code></pre><p>=D2=D4=
=C9=CF=BE=CD=B0=D1ApplicationConfig=A1=A2ModuleConfig=A1=A2Regist=
ryConfig=B5=C8=B6=D4=D3=A6=B5=C4BeanDefinition=D7=A2=B2=E1=B5=BDs=
pring=D6=D0=A1=A3</p><br></article><div style=3D"color:gray"><sma=
ll>=C0=B4=D4=B4=A3=BA&nbsp;<a href=3D"https://segmentfault.com/a/=
1190000021421978?utm_source=3Dtag-newest">https://segmentfault.co=
m/a/1190000021421978?utm_source=3Dtag-newest</a></small></div></b=
ody></html>=0A=0A=0A=0A=0A=0A=0A=0A

------=_Next_Part_0000494156.212--

------=_Next_Part_0001482468.000
Content-Type: image/png;
	name="0.25034166014973436.png"
Content-Transfer-Encoding: base64
Content-ID: <0.25034166014973436.png>
Content-Location: 0.25034166014973436.png

iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEsElEQVRYR8WWa0wUVxiGvzOX3dmZWVwWRFhgFdRiSyrSmpJW0tj2h7dWDWlsgwEDGC2tphfbpiZN1PSHNNE2MdFqRQSq1KRNlLY0xF4tbYJRY41oXUyKArLgshfZ2dndmTPnNLsJDbG2y65UJpk/853vfZ/znXcmg2CaLzRV/qfslvy1vvBAsnpTBtCRa1tkM6etWfJn/65kIKYMoNOZXSwKwp6ne2+smBaAHx6avQcQzXrO1V89LQBni5zU6/EVr/QpVx84wLnC2QFZDX7/8LDvxWTMY2vvKwO9Er9IkiznEcu5HG5fcUzQJfElJtG6tMDj2wcANBFQygC9M+WtmRbTPkWP/OZ0q+U9aTAvzZJxglD2jzm3b1clMh6vpwTgzrB+aJb4d5WwctTp0WpvZsk7BE7aqRD0/Nzh4Y7Jmqd0BN/l5VWWMvh4NKqczB1RKobsljdk2f6xxxtYODcUupyMeUoAv8yf350XCZUVDgzFp9eXmxEQooYrZzRQlqx5SgA/zys4LWNcvPjGQG5M4Px8J50VCATyPWPpDwSgMy/7iRzZcrbkWl98At2FjnMFOLpYDQWbCrxaXbIQKYXQ5Zix32sWc5/qc6+9kG5a6JCkS2ZgoFul+St9vsFkIFICiBn0OLLaJU39vGBUOTE0U/xAMovvXwBu6bODw2f+V4BHV72XfrmjwR8zGcywbs/zBneP2IQqxHHbs0aVRyaaZ2w49BqDSMjTXN/8b1CTm8Cmjo9YoHmIGhdxSPkS2tZfnyjYlr9gW+XAtb0Tnzle3l2qCNkcFm07hUiw1NdU7bgXREKAjM3H9KDk5AxVbTSI3gscCslYpY4xN5NJIoKGDbuJN1kpRk6VYex+yRKgNNQ40LLtq3FD0ysnqYzVzb7G9Z/eDZEQINYgbjy+ErO2Eg2hWQCGHXjWAlgLA8OowDABoMwtiOAr0Lj6x3vt0vpmJyV+d2moueb3lABiTZa646+HTTYPfLKqLZmQ8Vs6bgtRX0vwcNU7KR3BeFP6ppauMXlOuRHW+hEyRlmgKgYKDMdaCSFZgGgOQwEIRjvh4IpdUN9Zw+JwpVkP7lObq7++vxBO6Ga2/rSF6Fohw1GZUIMAZRVAqB+wdgYOvXApvnR1uxUywQFNa1yJpjWpDPwt8urpo6AEdkDruv5/CNe2F03GMOUMxBvrO/tF2ZofiapAdOwHDmmgU1EQBCvH8kB0OqL63U/CZ+v6Eu18vP7fE6jvbACgMiDmKhxYdiDetOmbZ8DELQeKnIB1EyA2CgA3AUMXNK749m7j9Noj5f6mul+TykB6dWu5bs3sCgHrovuXLZjsbiauE2uaHhNZdu0dZC3SD1e8lBSAWHEoJ81uaYggpkTl7HM0YAkAGgMEfgCkIAQhSgDHf/koMQGLZECGBQDxgGgQSOyGXtCiB+FIRQ+/8dQxSbuzN9C64WJqGahqlYC3LeFkUQdMeMogKxhgNigmZob1RanmhZA6HBefIZYBJo8jhl9Eo8Ys4HmPjL1vK4crr9zfd6D2SDkHUA6AbICQAJTwlBAzA1RgTJzJQAyiCIUJpSOGoV/X7gQ7wl+8dSvR8SX3GiZSS6E+7QB/AVIm2jC53pzAAAAAAElFTkSuQmCC

------=_Next_Part_0001482468.000--

