From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?RmxpbmsgMS43LjLStc7xv8nQ0NDUt9bO9sH3yr3K/b7d1LTC67fWzvY=?=
Date: Date: Fri, 23 Jul 2021 05:54:34 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0001263843.074"

This is a multi-part message in MIME format.

------=_Next_Part_0001263843.074
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000421281.719"


------=_Next_Part_0000421281.719
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000421281.719
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A=0A<t=
itle>Flink 1.7.2=D2=B5=CE=F1=BF=C9=D0=D0=D0=D4=B7=D6=CE=F6=C1=F7=CA=
=BD=CA=FD=BE=DD=D4=B4=C2=EB=B7=D6=CE=F6</title>=0A    =0A<style i=
d=3D"wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wi=
z-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '=E5=BE=
=AE=E8=BD=AF=E9=9B=85=E9=BB=91', 'Microsoft YaHei UI', SimSun, Si=
mHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;padding:=20=
20px 16px;padding: 1.25rem 1rem;}.wiz-editor-body h1,.wiz-editor-=
body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body=20=
h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625=
rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:=
20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-=
size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25re=
m;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-ed=
itor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6=20=
{font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wi=
z-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-edi=
tor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0=
;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-=
body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .C=
odeMirror pre {margin:0;}.wiz-editor-body ul,.wiz-editor-body ol=20=
{padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-lis=
t-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-l=
ist-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol=
.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-b=
ody blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :f=
irst-child {margin-top:0;}.wiz-editor-body blockquote > :last-chi=
ld {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100=
%;height:auto !important;margin:2px 0;}.wiz-editor-body table {bo=
rder-collapse:collapse;border:1px solid #bbbbbb;}.wiz-editor-body=
 td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse=
;border:1px solid #bbbbbb;min-height:28px;word-break:break-word;b=
ox-sizing: border-box;}.wiz-hide {display:none !important;}</styl=
e></head>=0A=0A<body class=3D"wiz-editor-body"  spellcheck=3D"fal=
se">=0A<div>=0A    </div><h1 style=3D"font-size: 2rem; color: rgb=
(36, 41, 46);"><font><font>Flink 1.7.2=D2=B5=CE=F1=BF=C9=D0=D0=D0=
=D4=B7=D6=CE=F6=C1=F7=CA=BD=CA=FD=BE=DD=D4=B4=C2=EB=B7=D6=CE=F6</=
font></font></h1><h2 style=3D"font-size: 1.5rem; color: rgb(36, 4=
1, 46);"><font><font>=D4=AD=CA=BC=C2=EB</font></font></h2><ul sty=
le=3D"color: rgb(36, 41, 46);"><li><a href=3D"https://github.com/=
opensourceteams/flink-maven-scala" style=3D"color:rgb(3, 102, 214=
);text-decoration:none;"><font><font>https://github.com/opensourc=
eteams/flink-maven-scala</font></font></a></li></ul><h2 style=3D"=
font-size: 1.5rem; color: rgb(36, 41, 46);"><font><font>=B8=C5=CA=
=F6</font></font></h2><ul style=3D"color: rgb(36, 41, 46);"><li><=
font><font>=D3=C9=D3=DAFlink=B5=C4ProcessTime=CA=C7=B0=B4Window=BD=
=D3=CA=D5=B5=BD=B5=C4=D4=B4=B7=A2=C9=E4=B9=FD=C0=B4=B5=C4=CA=FD=BE=
=DD=B5=C4=CA=B1=BC=E4=A3=AC=C0=B4=CB=E3=C1=CB=A3=AC=D2=B2=BE=CD=CA=
=C7=B0=B4Flink=B3=CC=D0=F2=BD=D3=CA=D5=B5=C4=CA=B1=BC=E4=C0=B4=BD=
=F8=D0=D0=BC=C6=CB=E3=A3=AC=B5=AB=CA=B5=BC=CA=D2=B5=CE=F1=A3=AC=B4=
=A6=C0=ED=B5=C4=CA=FD=BE=DD=CA=B1=A3=AC=C3=BF5=B7=D6=D6=D3=C4=DA=B5=
=C4=CA=FD=BE=DD=A3=AC=C3=BF1=D0=A1=CA=B1=C4=DA=B5=C4=CA=FD=BE=DD=BD=
=F8=D0=D0=B7=D6=CE=F6=A3=AC=CA=B5=BC=CA=CA=C7=D2=B5=CE=F1=D4=B4=B7=
=A2=C9=FA=B5=C4=CA=B1=BC=E4=C0=B4=D7=F6=CE=AA=CA=B5=BC=CA=CA=B1=BC=
=E4=A3=AC=CB=F9=D2=D4=D3=C3Flink=B5=C4EventTime=BA=CDWatermark=C0=
=B4=B4=A6=C0=ED=D5=E2=B8=F6=CE=CA=CC=E2</font></font></li><li><fo=
nt><font>=D6=B8=B6=A8Env=CE=AAEventTime</font></font></li><li><fo=
nt><font>=B5=F7=D6=C3=CA=FD=BE=DD=C1=F7assignTimestampsAndWaterma=
rks=BA=AF=CA=FD=A3=AC=D3=C9AssignerWithPeriodicWatermarks=D6=D0=B5=
=C4extractTimestamp=A3=A8=A3=A9=BA=AF=CA=FD=CC=E1=C8=A1=CA=B5=BC=CA=
=D2=B5=CE=F1=CA=B1=BC=E4=A3=ACgetCurrentWatermark=BB=F1=B5=C3=D7=EE=
=D0=C2=B5=C4=CA=B1=BC=E4=A3=AC=B4=CB=C8=B7=B6=A8=C3=BF=B8=F6=D4=AA=
=CB=D8=CB=E3=D2=BB=B4=CE=A3=AC=CA=B1=BC=E4=BC=E4=B8=F4+=D5=E2=C0=EF=
=C9=E8=D6=C3=B5=C4=D1=D3=B3=D9=CA=B1=BC=E4=A3=AC=BD=AB=BB=E1=BD=E1=
=CA=F8=C9=CF=D2=BB=B8=F6Window=A3=AC=D2=B2=BE=CD=CA=C7=B6=D4=D5=E2=
=B7=C5=D6=C3=B5=C4Window=BD=F8=D0=D0=B2=D9=D7=F7</font></font></l=
i><li><font><font>=B1=BE=B3=CC=D0=F2=D2=D4=D6=B8=B6=A8=D2=B5=CE=F1=
=CA=B1=BC=E4=A3=AC=C0=B4=D7=F6=CE=AA=CD=B3=BC=C6=CA=B1=BC=E4</fon=
t></font></li></ul><h2 style=3D"font-size: 1.5rem; color: rgb(36,=
 41, 46);"><font><font>=B3=CC=D0=F2</font></font></h2><pre style=3D=
"font-size: 0.85rem; color: rgb(36, 41, 46); background-color: rg=
b(246, 248, 250);"><code>package com.opensourceteams.module.bigda=
ta.flink.example.stream.worldcount.nc.eventtime=0A=0Aimport java.=
util.{Date, Properties}=0A=0Aimport com.alibaba.fastjson.JSON=0Ai=
mport com.opensourceteams.module.bigdata.flink.common.Configurati=
onUtil=0Aimport org.apache.flink.api.common.serialization.SimpleS=
tringSchema=0Aimport org.apache.flink.configuration.Configuration=
=0Aimport org.apache.flink.streaming.api.TimeCharacteristic=0Aimp=
ort org.apache.flink.streaming.api.functions.AssignerWithPeriodic=
Watermarks=0Aimport org.apache.flink.streaming.api.scala.StreamEx=
ecutionEnvironment=0Aimport org.apache.flink.streaming.api.scala.=
function.ProcessAllWindowFunction=0Aimport org.apache.flink.strea=
ming.api.watermark.Watermark=0Aimport org.apache.flink.streaming.=
api.windowing.time.Time=0Aimport org.apache.flink.streaming.api.w=
indowing.windows.TimeWindow=0Aimport org.apache.flink.streaming.c=
onnectors.kafka.FlinkKafkaConsumer=0Aimport org.apache.flink.util=
.Collector=0A=0A=0Aobject SockWordCountRun {=0A=0A=0A=0A  def mai=
n(args: Array[String]): Unit =3D {=0A=0A=0A    // get the executi=
on environment=0A   // val env: StreamExecutionEnvironment =3D St=
reamExecutionEnvironment.getExecutionEnvironment=0A=0A=0A    val=20=
configuration : Configuration =3D ConfigurationUtil.getConfigurat=
ion(true)=0A=0A    val env:StreamExecutionEnvironment =3D StreamE=
xecutionEnvironment.createLocalEnvironment(1,configuration)=0A=0A=
=0A    env.setStreamTimeCharacteristic(TimeCharacteristic.EventTi=
me)=0A=0A=0A=0A    import org.apache.flink.streaming.api.scala._=0A=
    val dataStream =3D env.socketTextStream("localhost", 1234, '\=
n')=0A=0A     // .setParallelism(3)=0A=0A=0A    dataStream.assign=
TimestampsAndWatermarks(new AssignerWithPeriodicWatermarks[String=
] {=0A=0A        val maxOutOfOrderness =3D  2 * 1000L // 3.5 seco=
nds=0A        var currentMaxTimestamp: Long =3D _=0A        var c=
urrentTimestamp: Long =3D _=0A=0A        override def getCurrentW=
atermark: Watermark =3D  new Watermark(currentMaxTimestamp - maxO=
utOfOrderness)=0A=0A        override def extractTimestamp(element=
: String, previousElementTimestamp: Long): Long =3D {=0A        =20=
 val jsonObject =3D JSON.parseObject(element)=0A=0A          val=20=
timestamp =3D jsonObject.getLongValue("extract_data_time")=0A   =20=
      currentMaxTimestamp =3D Math.max(timestamp, currentMaxTimes=
tamp)=0A          currentTimestamp =3D timestamp=0A=0A        /*=20=
 println("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3Dwatermark begin=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D")=0A          println()=0A          prin=
tln(new Date(currentMaxTimestamp - 20 * 1000))=0A          printl=
n(jsonObject)=0A          println("=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3Dwatermark end=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D")=0A          p=
rintln()*/=0A          timestamp=0A        }=0A=0A      })=0A   =20=
  .timeWindowAll(Time.seconds(3))=0A=0A      .process(new Process=
AllWindowFunction[String,String,TimeWindow]() {=0A      override=20=
def process(context: Context, elements: Iterable[String], out: Co=
llector[String]): Unit =3D {=0A=0A=0A        println()=0A       =20=
println("=BF=AA=CA=BC=CC=E1=BD=BBwindow")=0A        println(new D=
ate())=0A        for(e &lt;- elements) out.collect(e)=0A        p=
rintln("=BD=E1=CA=F8=CC=E1=BD=BBwindow")=0A        println(new Da=
te())=0A        println()=0A      }=0A    })=0A=0A      .print()=0A=
      //.setParallelism(3)=0A=0A=0A=0A=0A=0A    println("=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=D2=D4=CF=C2=CE=AA=D6=B4=D0=D0=BC=C6=BB=
=AE=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D")=0A    println("=D6=B4=D0=
=D0=B5=D8=D6=B7(firefox=D0=A7=B9=FB=B8=FC=BA=C3):https://flink.ap=
ache.org/visualizer")=0A    //=D6=B4=D0=D0=BC=C6=BB=AE=0A    prin=
tln(env.getStreamGraph.getStreamingPlanAsJSON)=0A    println("=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=D2=D4=C9=CF=CE=AA=D6=B4=D0=D0=BC=
=C6=BB=AE JSON=B4=AE=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D\n")=0A=0A=
=0A    env.execute("Socket =CB=AE=D3=A1=D7=F7=D2=B5")=0A=0A=0A=0A=
=0A=0A=0A    println("=BD=E1=CA=F8")=0A=0A  }=0A=0A=0A  // Data t=
ype for words with count=0A  case class WordWithCount(word: Strin=
g, count: Long){=0A    //override def toString: String =3D Thread=
.currentThread().getName + word + " : " + count=0A  }=0A=0A=0A  d=
ef getConfiguration(isDebug:Boolean =3D false):Configuration =3D=20=
{=0A=0A    val configuration : Configuration =3D new Configuratio=
n()=0A=0A    if(isDebug){=0A      val timeout =3D "100000 s"=0A =20=
    val timeoutHeartbeatPause =3D "1000000 s"=0A      configurati=
on.setString("akka.ask.timeout",timeout)=0A      configuration.se=
tString("akka.lookup.timeout",timeout)=0A      configuration.setS=
tring("akka.tcp.timeout",timeout)=0A      configuration.setString=
("akka.transport.heartbeat.interval",timeout)=0A      configurati=
on.setString("akka.transport.heartbeat.pause",timeoutHeartbeatPau=
se)=0A      configuration.setString("akka.watch.heartbeat.pause",=
timeout)=0A      configuration.setInteger("heartbeat.interval",10=
000000)=0A      configuration.setInteger("heartbeat.timeout",5000=
0000)=0A    }=0A=0A=0A    configuration=0A  }=0A=0A=0A}=0A=0A</co=
de></pre><h2 style=3D"font-size: 1.5rem; color: rgb(36, 41, 46);"=
><font><font>=CA=E4=C8=EB=CA=FD=BE=DD</font></font></h2><ul style=
=3D"color: rgb(36, 41, 46);"><li><font><font>=CF=C2=D2=BB=B4=CE=CA=
=E4=C8=EB=CA=FD=BE=DD=A3=AC=D6=BB=D2=AA=B1=C8=C9=CF=D2=BB=B4=CE=CA=
=E4=C8=EB=CA=FD=BE=DD=A3=AC=B4=F35=C3=EB=A3=AC=BE=CD=BF=C9=D2=D4=CA=
=E4=B3=F6=C9=CF=D2=BB=B4=B0=BF=DA=CA=FD=BE=DD=A3=AC=CA=B1=BC=E4=D2=
=D4data_time=B7=D6=B6=CE=CE=AA=D7=BC=A3=AC=D7=AA=B3=C9=B4=AE=D0=D0=
=B8=F1=CA=BD=CE=AAextract_data_time</font></font></li><li><font><=
font>nc -lk 123=C0=B4=CA=E4=C8=EB=CA=FD=BE=DD</font></font></li><=
/ul><pre style=3D"font-size: 0.85rem; color: rgb(36, 41, 46); bac=
kground-color: rgb(246, 248, 250);"><code>{"no":0,"extract_data_t=
ime":"2019-03-06 11:40:38","data_time":1551843638000,"message":"0=
  2019-03-06 11:40:38","send_data_string":"2019-03-06 21:03:43"}=0A=
{"no":1,"extract_data_time":"2019-03-06 11:40:39","data_time":155=
1843639000,"message":"1  2019-03-06 11:40:39","send_data_string":=
"2019-03-06 21:03:43"}=0A{"no":2,"extract_data_time":"2019-03-06=20=
11:40:40","data_time":1551843640000,"message":"2  2019-03-06 11:4=
0:40","send_data_string":"2019-03-06 21:03:43"}=0A{"no":3,"extrac=
t_data_time":"2019-03-06 11:40:41","data_time":1551843641000,"mes=
sage":"3  2019-03-06 11:40:41","send_data_string":"2019-03-06 21:=
03:43"}=0A{"no":4,"extract_data_time":"2019-03-06 11:40:42","data=
_time":1551843642000,"message":"4  2019-03-06 11:40:42","send_dat=
a_string":"2019-03-06 21:03:43"}=0A{"no":5,"extract_data_time":"2=
019-03-06 11:40:43","data_time":1551843643000,"message":"5  2019-=
03-06 11:40:43","send_data_string":"2019-03-06 21:03:43"}=0A{"no"=
:6,"extract_data_time":"2019-03-06 11:40:44","data_time":15518436=
44000,"message":"6  2019-03-06 11:40:44","send_data_string":"2019=
-03-06 21:03:43"}=0A{"no":7,"extract_data_time":"2019-03-06 11:40=
:45","data_time":1551843645000,"message":"7  2019-03-06 11:40:45"=
,"send_data_string":"2019-03-06 21:03:43"}=0A{"no":8,"extract_dat=
a_time":"2019-03-06 11:40:46","data_time":1551843646000,"message"=
:"8  2019-03-06 11:40:46","send_data_string":"2019-03-06 21:03:43=
"}=0A{"no":9,"extract_data_time":"2019-03-06 11:40:47","data_time=
":1551843647000,"message":"9  2019-03-06 11:40:47","send_data_str=
ing":"2019-03-06 21:03:43"}=0A{"no":10,"extract_data_time":"2019-=
03-06 11:40:48","data_time":1551843648000,"message":"10  2019-03-=
06 11:40:48","send_data_string":"2019-03-06 21:03:43"}=0A{"no":11=
,"extract_data_time":"2019-03-06 11:40:49","data_time":1551843649=
000,"message":"11  2019-03-06 11:40:49","send_data_string":"2019-=
03-06 21:03:43"}=0A{"no":12,"extract_data_time":"2019-03-06 11:40=
:50","data_time":1551843650000,"message":"12  2019-03-06 11:40:50=
","send_data_string":"2019-03-06 21:03:43"}=0A{"no":13,"extract_d=
ata_time":"2019-03-06 11:40:51","data_time":1551843651000,"messag=
e":"13  2019-03-06 11:40:51","send_data_string":"2019-03-06 21:03=
:43"}=0A{"no":14,"extract_data_time":"2019-03-06 11:40:52","data_=
time":1551843652000,"message":"14  2019-03-06 11:40:52","send_dat=
a_string":"2019-03-06 21:03:43"}=0A{"no":15,"extract_data_time":"=
2019-03-06 11:40:53","data_time":1551843653000,"message":"15  201=
9-03-06 11:40:53","send_data_string":"2019-03-06 21:03:43"}=0A{"n=
o":16,"extract_data_time":"2019-03-06 11:40:54","data_time":15518=
43654000,"message":"16  2019-03-06 11:40:54","send_data_string":"=
2019-03-06 21:03:43"}=0A{"no":17,"extract_data_time":"2019-03-06=20=
11:40:55","data_time":1551843655000,"message":"17  2019-03-06 11:=
40:55","send_data_string":"2019-03-06 21:03:43"}=0A{"no":18,"extr=
act_data_time":"2019-03-06 11:40:56","data_time":1551843656000,"m=
essage":"18  2019-03-06 11:40:56","send_data_string":"2019-03-06=20=
21:03:43"}=0A{"no":19,"extract_data_time":"2019-03-06 11:40:57","=
data_time":1551843657000,"message":"19  2019-03-06 11:40:57","sen=
d_data_string":"2019-03-06 21:03:43"}=0A{"no":20,"extract_data_ti=
me":"2019-03-06 11:40:58","data_time":1551843658000,"message":"20=
  2019-03-06 11:40:58","send_data_string":"2019-03-06 21:03:43"}=0A=
{"no":21,"extract_data_time":"2019-03-06 11:40:59","data_time":15=
51843659000,"message":"21  2019-03-06 11:40:59","send_data_string=
":"2019-03-06 21:03:43"}=0A{"no":22,"extract_data_time":"2019-03-=
06 11:41:00","data_time":1551843660000,"message":"22  2019-03-06=20=
11:41:00","send_data_string":"2019-03-06 21:03:43"}=0A{"no":23,"e=
xtract_data_time":"2019-03-06 11:41:01","data_time":1551843661000=
,"message":"23  2019-03-06 11:41:01","send_data_string":"2019-03-=
06 21:03:43"}=0A{"no":24,"extract_data_time":"2019-03-06 11:41:02=
","data_time":1551843662000,"message":"24  2019-03-06 11:41:02","=
send_data_string":"2019-03-06 21:03:43"}=0A{"no":25,"extract_data=
_time":"2019-03-06 11:41:03","data_time":1551843663000,"message":=
"25  2019-03-06 11:41:03","send_data_string":"2019-03-06 21:03:43=
"}=0A{"no":26,"extract_data_time":"2019-03-06 11:41:04","data_tim=
e":1551843664000,"message":"26  2019-03-06 11:41:04","send_data_s=
tring":"2019-03-06 21:03:43"}=0A{"no":27,"extract_data_time":"201=
9-03-06 11:41:05","data_time":1551843665000,"message":"27  2019-0=
3-06 11:41:05","send_data_string":"2019-03-06 21:03:43"}=0A{"no":=
28,"extract_data_time":"2019-03-06 11:41:06","data_time":15518436=
66000,"message":"28  2019-03-06 11:41:06","send_data_string":"201=
9-03-06 21:03:43"}=0A{"no":29,"extract_data_time":"2019-03-06 11:=
41:07","data_time":1551843667000,"message":"29  2019-03-06 11:41:=
07","send_data_string":"2019-03-06 21:03:43"}=0A{"no":30,"extract=
_data_time":"2019-03-06 11:41:08","data_time":1551843668000,"mess=
age":"30  2019-03-06 11:41:08","send_data_string":"2019-03-06 21:=
03:43"}=0A{"no":31,"extract_data_time":"2019-03-06 11:41:09","dat=
a_time":1551843669000,"message":"31  2019-03-06 11:41:09","send_d=
ata_string":"2019-03-06 21:03:43"}=0A{"no":32,"extract_data_time"=
:"2019-03-06 11:41:10","data_time":1551843670000,"message":"32  2=
019-03-06 11:41:10","send_data_string":"2019-03-06 21:03:43"}=0A{=
"no":33,"extract_data_time":"2019-03-06 11:41:11","data_time":155=
1843671000,"message":"33  2019-03-06 11:41:11","send_data_string"=
:"2019-03-06 21:03:43"}=0A{"no":34,"extract_data_time":"2019-03-0=
6 11:41:12","data_time":1551843672000,"message":"34  2019-03-06 1=
1:41:12","send_data_string":"2019-03-06 21:03:43"}=0A{"no":35,"ex=
tract_data_time":"2019-03-06 11:41:13","data_time":1551843673000,=
"message":"35  2019-03-06 11:41:13","send_data_string":"2019-03-0=
6 21:03:43"}=0A{"no":36,"extract_data_time":"2019-03-06 11:41:14"=
,"data_time":1551843674000,"message":"36  2019-03-06 11:41:14","s=
end_data_string":"2019-03-06 21:03:43"}=0A{"no":37,"extract_data_=
time":"2019-03-06 11:41:15","data_time":1551843675000,"message":"=
37  2019-03-06 11:41:15","send_data_string":"2019-03-06 21:03:43"=
}=0A{"no":38,"extract_data_time":"2019-03-06 11:41:16","data_time=
":1551843676000,"message":"38  2019-03-06 11:41:16","send_data_st=
ring":"2019-03-06 21:03:43"}=0A{"no":39,"extract_data_time":"2019=
-03-06 11:41:17","data_time":1551843677000,"message":"39  2019-03=
-06 11:41:17","send_data_string":"2019-03-06 21:03:43"}=0A{"no":4=
0,"extract_data_time":"2019-03-06 11:41:18","data_time":155184367=
8000,"message":"40  2019-03-06 11:41:18","send_data_string":"2019=
-03-06 21:03:43"}=0A{"no":41,"extract_data_time":"2019-03-06 11:4=
1:19","data_time":1551843679000,"message":"41  2019-03-06 11:41:1=
9","send_data_string":"2019-03-06 21:03:43"}=0A{"no":42,"extract_=
data_time":"2019-03-06 11:41:20","data_time":1551843680000,"messa=
ge":"42  2019-03-06 11:41:20","send_data_string":"2019-03-06 21:0=
3:43"}=0A{"no":43,"extract_data_time":"2019-03-06 11:41:21","data=
_time":1551843681000,"message":"43  2019-03-06 11:41:21","send_da=
ta_string":"2019-03-06 21:03:43"}=0A{"no":44,"extract_data_time":=
"2019-03-06 11:41:22","data_time":1551843682000,"message":"44  20=
19-03-06 11:41:22","send_data_string":"2019-03-06 21:03:43"}=0A{"=
no":45,"extract_data_time":"2019-03-06 11:41:23","data_time":1551=
843683000,"message":"45  2019-03-06 11:41:23","send_data_string":=
"2019-03-06 21:03:43"}=0A{"no":46,"extract_data_time":"2019-03-06=
 11:41:24","data_time":1551843684000,"message":"46  2019-03-06 11=
:41:24","send_data_string":"2019-03-06 21:03:43"}=0A{"no":47,"ext=
ract_data_time":"2019-03-06 11:41:25","data_time":1551843685000,"=
message":"47  2019-03-06 11:41:25","send_data_string":"2019-03-06=
 21:03:43"}=0A{"no":48,"extract_data_time":"2019-03-06 11:41:26",=
"data_time":1551843686000,"message":"48  2019-03-06 11:41:26","se=
nd_data_string":"2019-03-06 21:03:43"}=0A{"no":49,"extract_data_t=
ime":"2019-03-06 11:41:27","data_time":1551843687000,"message":"4=
9  2019-03-06 11:41:27","send_data_string":"2019-03-06 21:03:43"}=
=0A{"no":50,"extract_data_time":"2019-03-06 11:41:28","data_time"=
:1551843688000,"message":"50  2019-03-06 11:41:28","send_data_str=
ing":"2019-03-06 21:03:43"}=0A{"no":51,"extract_data_time":"2019-=
03-06 11:41:29","data_time":1551843689000,"message":"51  2019-03-=
06 11:41:29","send_data_string":"2019-03-06 21:03:43"}=0A{"no":52=
,"extract_data_time":"2019-03-06 11:41:30","data_time":1551843690=
000,"message":"52  2019-03-06 11:41:30","send_data_string":"2019-=
03-06 21:03:43"}=0A{"no":53,"extract_data_time":"2019-03-06 11:41=
:31","data_time":1551843691000,"message":"53  2019-03-06 11:41:31=
","send_data_string":"2019-03-06 21:03:43"}=0A{"no":54,"extract_d=
ata_time":"2019-03-06 11:41:32","data_time":1551843692000,"messag=
e":"54  2019-03-06 11:41:32","send_data_string":"2019-03-06 21:03=
:43"}=0A{"no":55,"extract_data_time":"2019-03-06 11:41:33","data_=
time":1551843693000,"message":"55  2019-03-06 11:41:33","send_dat=
a_string":"2019-03-06 21:03:43"}=0A{"no":56,"extract_data_time":"=
2019-03-06 11:41:34","data_time":1551843694000,"message":"56  201=
9-03-06 11:41:34","send_data_string":"2019-03-06 21:03:43"}=0A{"n=
o":57,"extract_data_time":"2019-03-06 11:41:35","data_time":15518=
43695000,"message":"57  2019-03-06 11:41:35","send_data_string":"=
2019-03-06 21:03:43"}=0A{"no":58,"extract_data_time":"2019-03-06=20=
11:41:36","data_time":1551843696000,"message":"58  2019-03-06 11:=
41:36","send_data_string":"2019-03-06 21:03:43"}=0A{"no":59,"extr=
act_data_time":"2019-03-06 11:41:37","data_time":1551843697000,"m=
essage":"59  2019-03-06 11:41:37","send_data_string":"2019-03-06=20=
21:03:43"}=0A{"no":60,"extract_data_time":"2019-03-06 11:41:38","=
data_time":1551843698000,"message":"60  2019-03-06 11:41:38","sen=
d_data_string":"2019-03-06 21:03:43"}=0A{"no":61,"extract_data_ti=
me":"2019-03-06 11:41:39","data_time":1551843699000,"message":"61=
  2019-03-06 11:41:39","send_data_string":"2019-03-06 21:03:43"}=0A=
{"no":62,"extract_data_time":"2019-03-06 11:41:40","data_time":15=
51843700000,"message":"62  2019-03-06 11:41:40","send_data_string=
":"2019-03-06 21:03:43"}=0A{"no":63,"extract_data_time":"2019-03-=
06 11:41:41","data_time":1551843701000,"message":"63  2019-03-06=20=
11:41:41","send_data_string":"2019-03-06 21:03:43"}=0A{"no":64,"e=
xtract_data_time":"2019-03-06 11:41:42","data_time":1551843702000=
,"message":"64  2019-03-06 11:41:42","send_data_string":"2019-03-=
06 21:03:43"}=0A{"no":65,"extract_data_time":"2019-03-06 11:41:43=
","data_time":1551843703000,"message":"65  2019-03-06 11:41:43","=
send_data_string":"2019-03-06 21:03:43"}=0A{"no":66,"extract_data=
_time":"2019-03-06 11:41:44","data_time":1551843704000,"message":=
"66  2019-03-06 11:41:44","send_data_string":"2019-03-06 21:03:43=
"}=0A{"no":67,"extract_data_time":"2019-03-06 11:41:45","data_tim=
e":1551843705000,"message":"67  2019-03-06 11:41:45","send_data_s=
tring":"2019-03-06 21:03:43"}=0A{"no":68,"extract_data_time":"201=
9-03-06 11:41:46","data_time":1551843706000,"message":"68  2019-0=
3-06 11:41:46","send_data_string":"2019-03-06 21:03:43"}=0A{"no":=
69,"extract_data_time":"2019-03-06 11:41:47","data_time":15518437=
07000,"message":"69  2019-03-06 11:41:47","send_data_string":"201=
9-03-06 21:03:43"}=0A{"no":70,"extract_data_time":"2019-03-06 11:=
41:48","data_time":1551843708000,"message":"70  2019-03-06 11:41:=
48","send_data_string":"2019-03-06 21:03:43"}=0A{"no":71,"extract=
_data_time":"2019-03-06 11:41:49","data_time":1551843709000,"mess=
age":"71  2019-03-06 11:41:49","send_data_string":"2019-03-06 21:=
03:43"}=0A{"no":72,"extract_data_time":"2019-03-06 11:41:50","dat=
a_time":1551843710000,"message":"72  2019-03-06 11:41:50","send_d=
ata_string":"2019-03-06 21:03:43"}=0A{"no":73,"extract_data_time"=
:"2019-03-06 11:41:51","data_time":1551843711000,"message":"73  2=
019-03-06 11:41:51","send_data_string":"2019-03-06 21:03:43"}=0A{=
"no":74,"extract_data_time":"2019-03-06 11:41:52","data_time":155=
1843712000,"message":"74  2019-03-06 11:41:52","send_data_string"=
:"2019-03-06 21:03:43"}=0A{"no":75,"extract_data_time":"2019-03-0=
6 11:41:53","data_time":1551843713000,"message":"75  2019-03-06 1=
1:41:53","send_data_string":"2019-03-06 21:03:43"}=0A{"no":76,"ex=
tract_data_time":"2019-03-06 11:41:54","data_time":1551843714000,=
"message":"76  2019-03-06 11:41:54","send_data_string":"2019-03-0=
6 21:03:43"}=0A{"no":77,"extract_data_time":"2019-03-06 11:41:55"=
,"data_time":1551843715000,"message":"77  2019-03-06 11:41:55","s=
end_data_string":"2019-03-06 21:03:43"}=0A{"no":78,"extract_data_=
time":"2019-03-06 11:41:56","data_time":1551843716000,"message":"=
78  2019-03-06 11:41:56","send_data_string":"2019-03-06 21:03:43"=
}=0A{"no":79,"extract_data_time":"2019-03-06 11:41:57","data_time=
":1551843717000,"message":"79  2019-03-06 11:41:57","send_data_st=
ring":"2019-03-06 21:03:43"}=0A{"no":80,"extract_data_time":"2019=
-03-06 11:41:58","data_time":1551843718000,"message":"80  2019-03=
-06 11:41:58","send_data_string":"2019-03-06 21:03:43"}=0A{"no":8=
1,"extract_data_time":"2019-03-06 11:41:59","data_time":155184371=
9000,"message":"81  2019-03-06 11:41:59","send_data_string":"2019=
-03-06 21:03:43"}=0A{"no":82,"extract_data_time":"2019-03-06 11:4=
2:00","data_time":1551843720000,"message":"82  2019-03-06 11:42:0=
0","send_data_string":"2019-03-06 21:03:43"}=0A{"no":83,"extract_=
data_time":"2019-03-06 11:42:01","data_time":1551843721000,"messa=
ge":"83  2019-03-06 11:42:01","send_data_string":"2019-03-06 21:0=
3:43"}=0A{"no":84,"extract_data_time":"2019-03-06 11:42:02","data=
_time":1551843722000,"message":"84  2019-03-06 11:42:02","send_da=
ta_string":"2019-03-06 21:03:43"}=0A{"no":85,"extract_data_time":=
"2019-03-06 11:42:03","data_time":1551843723000,"message":"85  20=
19-03-06 11:42:03","send_data_string":"2019-03-06 21:03:43"}=0A{"=
no":86,"extract_data_time":"2019-03-06 11:42:04","data_time":1551=
843724000,"message":"86  2019-03-06 11:42:04","send_data_string":=
"2019-03-06 21:03:43"}=0A{"no":87,"extract_data_time":"2019-03-06=
 11:42:05","data_time":1551843725000,"message":"87  2019-03-06 11=
:42:05","send_data_string":"2019-03-06 21:03:43"}=0A{"no":88,"ext=
ract_data_time":"2019-03-06 11:42:06","data_time":1551843726000,"=
message":"88  2019-03-06 11:42:06","send_data_string":"2019-03-06=
 21:03:43"}=0A{"no":89,"extract_data_time":"2019-03-06 11:42:07",=
"data_time":1551843727000,"message":"89  2019-03-06 11:42:07","se=
nd_data_string":"2019-03-06 21:03:43"}=0A{"no":90,"extract_data_t=
ime":"2019-03-06 11:42:08","data_time":1551843728000,"message":"9=
0  2019-03-06 11:42:08","send_data_string":"2019-03-06 21:03:43"}=
=0A{"no":91,"extract_data_time":"2019-03-06 11:42:09","data_time"=
:1551843729000,"message":"91  2019-03-06 11:42:09","send_data_str=
ing":"2019-03-06 21:03:43"}=0A{"no":92,"extract_data_time":"2019-=
03-06 11:42:10","data_time":1551843730000,"message":"92  2019-03-=
06 11:42:10","send_data_string":"2019-03-06 21:03:43"}=0A{"no":93=
,"extract_data_time":"2019-03-06 11:42:11","data_time":1551843731=
000,"message":"93  2019-03-06 11:42:11","send_data_string":"2019-=
03-06 21:03:43"}=0A{"no":94,"extract_data_time":"2019-03-06 11:42=
:12","data_time":1551843732000,"message":"94  2019-03-06 11:42:12=
","send_data_string":"2019-03-06 21:03:43"}=0A{"no":95,"extract_d=
ata_time":"2019-03-06 11:42:13","data_time":1551843733000,"messag=
e":"95  2019-03-06 11:42:13","send_data_string":"2019-03-06 21:03=
:43"}=0A{"no":96,"extract_data_time":"2019-03-06 11:42:14","data_=
time":1551843734000,"message":"96  2019-03-06 11:42:14","send_dat=
a_string":"2019-03-06 21:03:43"}=0A{"no":97,"extract_data_time":"=
2019-03-06 11:42:15","data_time":1551843735000,"message":"97  201=
9-03-06 11:42:15","send_data_string":"2019-03-06 21:03:43"}=0A{"n=
o":98,"extract_data_time":"2019-03-06 11:42:16","data_time":15518=
43736000,"message":"98  2019-03-06 11:42:16","send_data_string":"=
2019-03-06 21:03:43"}=0A{"no":99,"extract_data_time":"2019-03-06=20=
11:42:17","data_time":1551843737000,"message":"99  2019-03-06 11:=
42:17","send_data_string":"2019-03-06 21:03:43"}=0A{"no":100,"ext=
ract_data_time":"2019-03-06 11:42:18","data_time":1551843738000,"=
message":"100  2019-03-06 11:42:18","send_data_string":"2019-03-0=
6 21:03:43"}=0A=0A</code></pre><h2 style=3D"font-size: 1.5rem; co=
lor: rgb(36, 41, 46);"><font><font>ExecutionGraph.scheduleEager</=
font></font></h2><ul style=3D"color: rgb(36, 41, 46);"><li><font>=
<font>=B5=DA=D2=BB=B2=BF=B7=D6=A3=BA=D6=F7=CA=C7=D2=AA=C0=B4=D4=B4=
=A3=AC=B7=D6=CE=AA=C1=BD=B8=F6=D0=A1=B2=BD=A3=AC=B5=DA=D2=BB=B2=BD=
=A3=AC=CD=A8=B9=FDsocket=B6=C1=C8=A1=CA=FD=BE=DD=A3=AC=B5=DA=B6=FE=
=B2=BD=A3=AC=CD=A8=B9=FD=CA=CA=B5=B1/=CB=AE=D3=A1=B4=A6=C0=EDsour=
ce</font></font></li><li><font><font>=A3=A8=C0=B4=D4=B4=A3=BA=CC=D7=
=BD=D3=D7=D6=C1=F7-&gt;=CA=B1=BC=E4=B4=C1/=CB=AE=D3=A1=A3=A81/1=A3=
=A9=A3=A9</font></font></li><li><font><font>=B5=DA=B6=FE=B2=BF=B7=
=D6=A3=AC=B7=D6=CE=AA=C1=BD=B2=BF=B7=D6=A3=AC=B3=F5=B2=BD=B2=BFTr=
iggerWindow=A3=AC=B5=F7=D3=C3ProcessAllWindowFunction=BA=AF=CA=FD=
=A3=AC=B4=A6=C0=ED=B5=B1=C7=B0window=D4=AA=CB=D8=A3=AC=D4=D9=B5=BD=
=B5=DA=B6=FE=B2=BFSink</font></font></li><li><font><font>=A3=A8Tr=
iggerWindow=A3=A8TumblingEventTimeWindows=A3=A8100000000000=A3=A9=
=A3=ACListStateDescriptor {name =3D window-contents=A3=ACdefaultV=
alue =3D null=A3=ACserializer =3D org.apache.flink.api.common.typ=
eutils.base.ListSerializer @ 1e4a7dd4}=A3=ACEventTimeTrigger=A3=A8=
=A3=A9=A3=ACAllWindowedStream.process=A3=A8AllWindowedStream .sca=
la=A3=BA593=A3=A9=A3=A9-&gt;=BD=D3=CA=D5=C6=F7=A3=BA=B4=F2=D3=A1=B5=
=BD=B1=EA=D7=BC=CA=E4=B3=F6=A3=A81/1=A3=A9=A3=A9</font></font></l=
i><li><font><font>=CF=EA=C7=E9</font></font></li></ul><pre style=3D=
"font-size: 0.85rem; color: rgb(36, 41, 46); background-color: rg=
b(246, 248, 250);"><code>0 =3D {Execution@5366} "Attempt #0 (Sour=
ce: Socket Stream -&gt; Timestamps/Watermarks (1/1)) @ org.apache=
.flink.runtime.jobmaster.slotpool.SingleLogicalSlot@5987f5d2 - [S=
CHEDULED]"=0A1 =3D {Execution@5371} "Attempt #0 (TriggerWindow(Tu=
mblingEventTimeWindows(100000000000), ListStateDescriptor{name=3D=
window-contents, defaultValue=3Dnull, serializer=3Dorg.apache.fli=
nk.api.common.typeutils.base.ListSerializer@1e4a7dd4}, EventTimeT=
rigger(), AllWindowedStream.process(AllWindowedStream.scala:593))=
 -&gt; Sink: Print to Std. Out (1/1)) @ org.apache.flink.runtime.=
jobmaster.slotpool.SingleLogicalSlot@4cb70b36 - [SCHEDULED]"=0A=0A=
</code></pre><h2 style=3D"font-size: 1.5rem; color: rgb(36, 41, 4=
6);"><font><font>=C0=B4=D4=B4=A3=A8=C8=CE=CE=F1=A3=A9</font></fon=
t></h2><ul style=3D"color: rgb(36, 41, 46);"><li><font><font>oper=
atorChain.allOperators</font></font></li><li><font><font>=D4=B4=C8=
=CE=CE=F1=A3=AC=B7=D6=C1=BD=B8=F6=D4=CB=CB=E3=B7=FB=A3=AC=B5=DA=D2=
=BB=B8=F6=CA=C7StreamSource=A3=AC=B6=C1=C8=A1=CC=D7=BD=D3=D7=D6=D6=
=D0=B5=C4=CA=FD=BE=DD=A3=AC=B5=DA=B6=FE=B8=F6=CA=C7TimestampsAndP=
eriodicWatermarksOperator=A3=AC=B4=A6=C0=ED=D4=B4=D6=D0=B5=C4=BA=CF=
=C0=ED=CE=CA=CC=E2</font></font></li></ul><pre style=3D"font-size=
: 0.85rem; color: rgb(36, 41, 46); background-color: rgb(246, 248=
, 250);"><code>0 =3D {TimestampsAndPeriodicWatermarksOperator@782=
0} =0A1 =3D {StreamSource@7785} =0A</code></pre><hr style=3D"colo=
r: rgb(36, 41, 46); background: rgb(225, 228, 232);"><h3 style=3D=
"font-size: 1.25rem; color: rgb(36, 41, 46);"><font><font>=C0=B4=D4=
=B4=A3=A8=D4=CB=D3=AA=C9=CCStreamSource=A3=A9</font></font></h3><=
hr style=3D"color: rgb(36, 41, 46); background: rgb(225, 228, 232=
);"><h3 style=3D"font-size: 1.25rem; color: rgb(36, 41, 46);"><fo=
nt><font>SourceStreamTask.run</font></font></h3><ul style=3D"colo=
r: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=C3StreamSource.run=
=A3=A8=A3=A9=BA=AF=CA=FD</font></font></li></ul><pre style=3D"fon=
t-size: 0.85rem; color: rgb(36, 41, 46); background-color: rgb(24=
6, 248, 250);"><code>	protected void run() throws Exception {=0A=09=
	headOperator.run(getCheckpointLock(), getStreamStatusMaintainer(=
));=0A	}=0A</code></pre><h3 style=3D"font-size: 1.25rem; color: r=
gb(36, 41, 46);"><font><font>=B5=F7=D3=C3StreamSource.run=A3=A8=A3=
=A9</font></font></h3><pre style=3D"font-size: 0.85rem; color: rg=
b(36, 41, 46); background-color: rgb(246, 248, 250);"><code>	publ=
ic void run(final Object lockingObject, final StreamStatusMaintai=
ner streamStatusMaintainer) throws Exception {=0A		run(lockingObj=
ect, streamStatusMaintainer, output);=0A	}=0A</code></pre><h3 sty=
le=3D"font-size: 1.25rem; color: rgb(36, 41, 46);"><font><font>=B5=
=F7=D3=C3StreamSource.run=A3=A8=A3=A9</font></font></h3><ul style=
=3D"color: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=C3userFunc=
tion.run=A3=A8=A3=A9=BA=AF=CA=FD=A3=AC=B5=F7=D3=C3=CE=AASocketTex=
tStreamFunction.run=A3=A8=A3=A9=BA=AF=CA=FD</font></font></li></u=
l><pre style=3D"font-size: 0.85rem; color: rgb(36, 41, 46); backg=
round-color: rgb(246, 248, 250);"><code>public void run(final Obj=
ect lockingObject,=0A			final StreamStatusMaintainer streamStatus=
Maintainer,=0A			final Output&lt;StreamRecord&lt;OUT&gt;&gt; coll=
ector) throws Exception {=0A=0A		final TimeCharacteristic timeCha=
racteristic =3D getOperatorConfig().getTimeCharacteristic();=0A=0A=
		final Configuration configuration =3D this.getContainingTask().=
getEnvironment().getTaskManagerInfo().getConfiguration();=0A		fin=
al long latencyTrackingInterval =3D getExecutionConfig().isLatenc=
yTrackingConfigured()=0A			? getExecutionConfig().getLatencyTrack=
ingInterval()=0A			: configuration.getLong(MetricOptions.LATENCY_=
INTERVAL);=0A=0A		LatencyMarksEmitter&lt;OUT&gt; latencyEmitter =3D=
 null;=0A		if (latencyTrackingInterval &gt; 0) {=0A			latencyEmit=
ter =3D new LatencyMarksEmitter&lt;&gt;(=0A				getProcessingTimeS=
ervice(),=0A				collector,=0A				latencyTrackingInterval,=0A				t=
his.getOperatorID(),=0A				getRuntimeContext().getIndexOfThisSubt=
ask());=0A		}=0A=0A		final long watermarkInterval =3D getRuntimeC=
ontext().getExecutionConfig().getAutoWatermarkInterval();=0A=0A	=09=
this.ctx =3D StreamSourceContexts.getSourceContext(=0A			timeChar=
acteristic,=0A			getProcessingTimeService(),=0A			lockingObject,=0A=
			streamStatusMaintainer,=0A			collector,=0A			watermarkInterval=
,=0A			-1);=0A=0A		try {=0A			userFunction.run(ctx);=0A=0A			// i=
f we get here, then the user function either exited after being d=
one (finite source)=0A			// or the function was canceled or stopp=
ed. For the finite source case, we should emit=0A			// a final wa=
termark that indicates that we reached the end of event-time=0A	=09=
	if (!isCanceledOrStopped()) {=0A				ctx.emitWatermark(Watermark.=
MAX_WATERMARK);=0A			}=0A		} finally {=0A			// make sure that the=
 context is closed in any case=0A			ctx.close();=0A			if (latency=
Emitter !=3D null) {=0A				latencyEmitter.close();=0A			}=0A		}=0A=
	}=0A=0A</code></pre><h3 style=3D"font-size: 1.25rem; color: rgb(=
36, 41, 46);"><font><font>SocketTextStreamFunction.run</font></fo=
nt></h3><ul style=3D"color: rgb(36, 41, 46);"><li><font><font>=D2=
=BB=B4=CE=B6=C1=C8=A18kb=CA=FD=BE=DD=A3=AC=B6=C1=C8=A1=CC=D7=BD=D3=
=D7=D6=D6=D0=B5=C4=CA=FD=BE=DD=B7=C5=B5=BD=BB=BA=B4=E6=D6=D0=A3=AC=
=D4=D9=B0=B4=D0=D0=B4=A6=C0=ED=BB=BA=B4=E6=D6=D0=B5=C4=CA=FD=BE=DD=
</font></font></li><li><font><font>ctx.collect=A3=A8record=A3=A9=A3=
=AC=B0=D1=B4=D3sorcket=BB=D6=B8=B4=CE=AA=D2=BB=D0=D0=CA=FD=BE=DD=D7=
=F7=CE=AA=B2=CE=CA=FD=A3=AC=B5=F7=D3=C3StreamSourceContexts.Water=
markContext.collect</font></font></li></ul><pre style=3D"font-siz=
e: 0.85rem; color: rgb(36, 41, 46); background-color: rgb(246, 24=
8, 250);"><code>public void run(SourceContext&lt;String&gt; ctx)=20=
throws Exception {=0A		final StringBuilder buffer =3D new StringB=
uilder();=0A		long attempt =3D 0;=0A=0A		while (isRunning) {=0A=0A=
			try (Socket socket =3D new Socket()) {=0A				currentSocket =3D=
 socket;=0A=0A				LOG.info("Connecting to server socket " + hostn=
ame + ':' + port);=0A				socket.connect(new InetSocketAddress(hos=
tname, port), CONNECTION_TIMEOUT_TIME);=0A				try (BufferedReader=
 reader =3D new BufferedReader(new InputStreamReader(socket.getIn=
putStream()))) {=0A=0A					char[] cbuf =3D new char[8192];=0A			=09=
	int bytesRead;=0A					while (isRunning &amp;&amp; (bytesRead =3D=
 reader.read(cbuf)) !=3D -1) {=0A						buffer.append(cbuf, 0, byt=
esRead);=0A						int delimPos;=0A						while (buffer.length() &gt=
;=3D delimiter.length() &amp;&amp; (delimPos =3D buffer.indexOf(d=
elimiter)) !=3D -1) {=0A							String record =3D buffer.substring=
(0, delimPos);=0A							// truncate trailing carriage return=0A	=09=
					if (delimiter.equals("\n") &amp;&amp; record.endsWith("\r"))=
 {=0A								record =3D record.substring(0, record.length() - 1);=
=0A							}=0A							ctx.collect(record);=0A							buffer.delete(=
0, delimPos + delimiter.length());=0A						}=0A					}=0A				}=0A=09=
		}=0A=0A			// if we dropped out of this loop due to an EOF, slee=
p and retry=0A			if (isRunning) {=0A				attempt++;=0A				if (maxN=
umRetries =3D=3D -1 || attempt &lt; maxNumRetries) {=0A					LOG.w=
arn("Lost connection to server socket. Retrying in " + delayBetwe=
enRetries + " msecs...");=0A					Thread.sleep(delayBetweenRetries=
);=0A				}=0A				else {=0A					// this should probably be here, b=
ut some examples expect simple exists of the stream source=0A			=09=
	// throw new EOFException("Reached end of stream and reconnects=20=
are not enabled.");=0A					break;=0A				}=0A			}=0A		}=0A=0A		//=20=
collect trailing data=0A		if (buffer.length() &gt; 0) {=0A			ctx.=
collect(buffer.toString());=0A		}=0A	}=0A</code></pre><h3 style=3D=
"font-size: 1.25rem; color: rgb(36, 41, 46);"><font><font>StreamS=
ourceContexts.WatermarkContext</font></font></h3><ul style=3D"col=
or: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=C3StreamSourceCon=
texts.ManualWatermarkContext.processAndCollect=A3=A8=A3=A9=BA=AF=CA=
=FD</font></font></li></ul><pre style=3D"font-size: 0.85rem; colo=
r: rgb(36, 41, 46); background-color: rgb(246, 248, 250);"><code>=
	public void collect(T element) {=0A			synchronized (checkpointLo=
ck) {=0A				streamStatusMaintainer.toggleStreamStatus(StreamStatu=
s.ACTIVE);=0A=0A				if (nextCheck !=3D null) {=0A					this.failOn=
NextCheck =3D false;=0A				} else {=0A					scheduleNextIdleDetect=
ionTask();=0A				}=0A=0A				processAndCollect(element);=0A			}=0A=
		}=0A</code></pre><h3 style=3D"font-size: 1.25rem; color: rgb(36=
, 41, 46);"><font><font>StreamSourceContexts.ManualWatermarkConte=
xt.processAndCollect=A3=A8=A3=A9</font></font></h3><ul style=3D"c=
olor: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=C3AbstractStrea=
mOperator.CountingOutput.collect</font></font></li></ul><pre styl=
e=3D"font-size: 0.85rem; color: rgb(36, 41, 46); background-color=
: rgb(246, 248, 250);"><code>	protected void processAndCollect(T=20=
element) {=0A			output.collect(reuse.replace(element));=0A		}=0A<=
/code></pre><h3 style=3D"font-size: 1.25rem; color: rgb(36, 41, 4=
6);"><font><font>AbstractStreamOperator.CountingOutput.collect</f=
ont></font></h3><ul style=3D"color: rgb(36, 41, 46);"><li><font><=
font>=B5=F7=D3=C3OperatorChain.CopyingChainingOutput.collect</fon=
t></font></li></ul><pre style=3D"font-size: 0.85rem; color: rgb(3=
6, 41, 46); background-color: rgb(246, 248, 250);"><code>public v=
oid collect(StreamRecord&lt;OUT&gt; record) {=0A			numRecordsOut.=
inc();=0A			output.collect(record);=0A		}=0A</code></pre><h3 styl=
e=3D"font-size: 1.25rem; color: rgb(36, 41, 46);"><font><font>Ope=
ratorChain.CopyingChainingOutput.collect</font></font></h3><ul st=
yle=3D"color: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=C3Opera=
torChain.CopyingChainingOutput.pushToOperator=A3=A8=A3=A9</font><=
/font></li></ul><pre style=3D"font-size: 0.85rem; color: rgb(36,=20=
41, 46); background-color: rgb(246, 248, 250);"><code>public void=
 collect(StreamRecord&lt;T&gt; record) {=0A			if (this.outputTag=20=
!=3D null) {=0A				// we are only responsible for emitting to the=
 main input=0A				return;=0A			}=0A=0A			pushToOperator(record);=0A=
		}=0A</code></pre><h3 style=3D"font-size: 1.25rem; color: rgb(36=
, 41, 46);"><font><font>=C0=B4=D4=B4=A3=A8=D4=CB=CB=E3=B7=FB=CA=B1=
=BC=E4=B4=C1=BA=CD=B6=A8=C6=DA=CB=AE=D3=A1=D4=CB=CB=E3=B7=FB=A3=A9=
</font></font><span>OperatorChain.CopyingChainingOutput.pushToOpe=
rator=A3=A8=A3=A9</span></h3><ul style=3D"color: rgb(36, 41, 46);=
"><li><font><font>=D5=E2=C0=EF=B5=F7=D3=C3source=D6=D0=B5=C4=B5=DA=
=D2=BB=B8=F6=B6=FE=B8=F6operator TimestampsAndPeriodicWatermarksO=
perator.processElement=A3=A8=A3=A9=B4=A6=C0=ED=D4=AA=CB=D8</font>=
</font></li></ul><pre style=3D"font-size: 0.85rem; color: rgb(36,=
 41, 46); background-color: rgb(246, 248, 250);"><code>protected=20=
&lt;X&gt; void pushToOperator(StreamRecord&lt;X&gt; record) {=0A=09=
		try {=0A				// we know that the given outputTag matches our Out=
putTag so the record=0A				// must be of the type that our operat=
or (and Serializer) expects.=0A				@SuppressWarnings("unchecked")=
=0A				StreamRecord&lt;T&gt; castRecord =3D (StreamRecord&lt;T&gt=
;) record;=0A=0A				numRecordsIn.inc();=0A				StreamRecord&lt;T&g=
t; copy =3D castRecord.copy(serializer.copy(castRecord.getValue()=
));=0A				operator.setKeyContextElement1(copy);=0A				operator.pr=
ocessElement(copy);=0A			} catch (ClassCastException e) {=0A				i=
f (outputTag !=3D null) {=0A					// Enrich error message=0A					C=
lassCastException replace =3D new ClassCastException(=0A						Str=
ing.format(=0A							"%s. Failed to push OutputTag with id '%s' t=
o operator. " +=0A								"This can occur when multiple OutputTag=
s with different types " +=0A								"but identical names are bei=
ng used.",=0A							e.getMessage(),=0A							outputTag.getId()));=
=0A=0A					throw new ExceptionInChainedOperatorException(replace)=
;=0A				} else {=0A					throw new ExceptionInChainedOperatorExcep=
tion(e);=0A				}=0A			} catch (Exception e) {=0A				throw new Exc=
eptionInChainedOperatorException(e);=0A			}=0A=0A		}=0A	}=0A</cod=
e></pre><h3 style=3D"font-size: 1.25rem; color: rgb(36, 41, 46);"=
><font><font>TimestampsAndPeriodicWatermarksOperator.processEleme=
nt=A3=A8=A3=A9</font></font></h3><ul style=3D"color: rgb(36, 41,=20=
46);"><li><font><font>userFunction=D6=B8=B5=C4=CA=C7dataStream.as=
signTimestampsAndWatermarks=A3=A8=D6=B8=B6=A8=B5=C4=BA=AF=CA=FD=A3=
=A9=A3=AC=B5=F7=CE=AA=CE=AAAssignerWithPeriodicWatermarks=A3=A8=A3=
=A9=A3=AC=D7=A2=D2=E2=B4=CB=B4=A6=B1=DF=C1=BD=B8=F6=BA=AF=CA=FDex=
tractTimestamp=A3=A8=A3=A9=CC=E1=C8=A1=A3=ACgetCurrentWatermark=A3=
=A8=A3=A9=B5=C3=B5=BD=B5=B1=C7=B0=B5=C4=CB=AE=D3=A1</font></font>=
</li><li><font><font>element.replace=A3=A8element.getValue=A3=A8=A3=
=A9=A3=ACnewTimestamp=A3=A9=B8=F8=B5=B1=C7=B0=D4=AA=CB=D8=B5=F7=D6=
=C3=B7=C5=D6=C3=A3=AC=B4=D3=B6=F8=CE=AAAssignerWith PeriodicWater=
marks.extractTimestamp=A3=A8=A3=A9=B5=C3=B5=BD=B5=C4=D6=B5</font>=
</font></li><li><font><font>=B5=F7=D3=C3AbstractStreamOperator.Co=
untingOutput.collect=A3=A8=A3=A9</font></font></li></ul><pre styl=
e=3D"font-size: 0.85rem; color: rgb(36, 41, 46); background-color=
: rgb(246, 248, 250);"><code>	public void processElement(StreamRe=
cord&lt;T&gt; element) throws Exception {=0A		final long newTimes=
tamp =3D userFunction.extractTimestamp(element.getValue(),=0A			=09=
element.hasTimestamp() ? element.getTimestamp() : Long.MIN_VALUE)=
;=0A=0A		output.collect(element.replace(element.getValue(), newTi=
mestamp));=0A	}=0A</code></pre><h3 style=3D"font-size: 1.25rem; c=
olor: rgb(36, 41, 46);"><font><font>AbstractStreamOperator.Counti=
ngOutput.collect=A3=A8=A3=A9</font></font></h3><ul style=3D"color=
: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=C3RecordWriterOutpu=
t.collect</font></font></li><li><font><font>=B5=F7=D3=C3RecordWri=
ter.emit=A3=A8=A3=A9=BD=F8=D0=D0=B0=B4=BC=FC=B5=C4hash=BD=F8=D0=D0=
=B7=D6=C7=F8=A3=A8=C8=E7=B9=FB=C3=BB=D3=D0=BD=F8=D0=D0map=B5=C8=B2=
=D9=D7=F7=A3=AC=BE=CD=CA=C7=B0=B4=D0=D0=BA=C5=BD=F8=D0=D0hash=B7=D6=
=C7=F8=A3=A9=A3=AC=B2=A2=C7=D2=B7=A2=CB=CD=B8=F8=CF=C2=D3=CE</fon=
t></font></li></ul><pre style=3D"font-size: 0.85rem; color: rgb(3=
6, 41, 46); background-color: rgb(246, 248, 250);"><code>public v=
oid collect(StreamRecord&lt;OUT&gt; record) {=0A			numRecordsOut.=
inc();=0A			output.collect(record);=0A		}=0A</code></pre><hr styl=
e=3D"color: rgb(36, 41, 46); background: rgb(225, 228, 232);"><h2=
 style=3D"font-size: 1.5rem; color: rgb(36, 41, 46);"><font><font=
>=B4=B0=BF=DA=A3=A8=C8=CE=CE=F1=A3=A9</font></font></h2><ul style=
=3D"color: rgb(36, 41, 46);"><li><font><font>operatorChain.allOpe=
rators</font></font></li></ul><pre style=3D"font-size: 0.85rem; c=
olor: rgb(36, 41, 46); background-color: rgb(246, 248, 250);"><co=
de>0 =3D {StreamSink@6060} =0A1 =3D {WindowOperator@6041} =0A</co=
de></pre><h3 style=3D"font-size: 1.25rem; color: rgb(36, 41, 46);=
"><font><font>=B4=B0=BF=DA=A3=A8WindowOperator=A3=A9</font></font=
><span>OneInputStreamTask.run=A3=A8=A3=A9</span></h3><ul style=3D=
"color: rgb(36, 41, 46);"><li><font><font>=B4=A6=C0=EDWindow=D4=AA=
=CB=D8=A3=AC=BC=D3=B5=CD=B3=C9=B1=BE/=CB=AE=D3=A1=A3=AC=B7=D6=C5=E4=
=B4=B0=BF=DA=A3=AC=BC=D3=B4=A5=B7=A2</font></font></li><li><font>=
<font>=B5=F7=D3=C3StreamInputProcessor.processInput=A3=A8=A3=A9=B4=
=A6=C0=ED</font></font></li></ul><pre style=3D"font-size: 0.85rem=
; color: rgb(36, 41, 46); background-color: rgb(246, 248, 250);">=
<code>	protected void run() throws Exception {=0A		// cache proce=
ssor reference on the stack, to make the code more JIT friendly=0A=
		final StreamInputProcessor&lt;IN&gt; inputProcessor =3D this.in=
putProcessor;=0A=0A		while (running &amp;&amp; inputProcessor.pro=
cessInput()) {=0A			// all the work happens in the "processInput"=
 method=0A		}=0A	}=0A</code></pre><h3 style=3D"font-size: 1.25rem=
; color: rgb(36, 41, 46);"><font><font>StreamInputProcessor.proce=
ssInput=A3=A8=A3=A9</font></font></h3><ul style=3D"color: rgb(36,=
 41, 46);"><li><font><font>=B5=F7=D3=C3barrierHandler.getNextNonB=
locked=A3=A8=A3=A9=A3=AC=B5=F7=D3=C3BarrierTracker.getNextNonBloc=
ked=A3=A8=A3=A9=B4=A6=C0=ED=D4=B4=B7=A2=B9=FD=C0=B4=B5=C4=CA=FD=BE=
=DD</font></font></li><li><font><font>StreamElement recordOrMark=20=
=3D deserializationDelegate.getInstance=A3=A8=A3=A9;<span>&nbsp;<=
/span></font><font>//=B5=C3=B5=BDsource=B7=A2=C9=E4=B9=FD=C0=B4=B5=
=C4=D2=BB=CC=F5=CA=FD=BE=DD=A3=AC=BD=F8=D0=D0=B7=B4=D0=F2=C1=D0=BB=
=AF</font></font></li><li><font><font>=C9=E8=D6=C3=BC=FCstreamOpe=
rator.setKeyContextElement1=A3=A8record=A3=A9;</font></font></li>=
<li><font><font>=B5=F7=D3=C3WindowOperator.processElement=A3=A8re=
cord=A3=A9=B5=C3=B5=BD=D5=E2=CC=F5=CA=FD=BE=DDstreamOperator.proc=
essElement=A3=A8record=A3=A9;</font></font></li></ul><pre style=3D=
"font-size: 0.85rem; color: rgb(36, 41, 46); background-color: rg=
b(246, 248, 250);"><code>public boolean processInput() throws Exc=
eption {=0A		if (isFinished) {=0A			return false;=0A		}=0A		if (n=
umRecordsIn =3D=3D null) {=0A			try {=0A				numRecordsIn =3D ((Op=
eratorMetricGroup) streamOperator.getMetricGroup()).getIOMetricGr=
oup().getNumRecordsInCounter();=0A			} catch (Exception e) {=0A	=09=
		LOG.warn("An exception occurred during the metrics setup.", e);=
=0A				numRecordsIn =3D new SimpleCounter();=0A			}=0A		}=0A=0A	=09=
while (true) {=0A			if (currentRecordDeserializer !=3D null) {=0A=
				DeserializationResult result =3D currentRecordDeserializer.ge=
tNextRecord(deserializationDelegate);=0A=0A				if (result.isBuffe=
rConsumed()) {=0A					currentRecordDeserializer.getCurrentBuffer(=
).recycleBuffer();=0A					currentRecordDeserializer =3D null;=0A=09=
			}=0A=0A				if (result.isFullRecord()) {=0A					StreamElement r=
ecordOrMark =3D deserializationDelegate.getInstance();=0A=0A				=09=
if (recordOrMark.isWatermark()) {=0A						// handle watermark=0A=09=
					statusWatermarkValve.inputWatermark(recordOrMark.asWatermark=
(), currentChannel);=0A						continue;=0A					} else if (recordOr=
Mark.isStreamStatus()) {=0A						// handle stream status=0A					=09=
statusWatermarkValve.inputStreamStatus(recordOrMark.asStreamStatu=
s(), currentChannel);=0A						continue;=0A					} else if (recordO=
rMark.isLatencyMarker()) {=0A						// handle latency marker=0A		=09=
			synchronized (lock) {=0A							streamOperator.processLatencyMa=
rker(recordOrMark.asLatencyMarker());=0A						}=0A						continue;=
=0A					} else {=0A						// now we can do the actual processing=0A=
						StreamRecord&lt;IN&gt; record =3D recordOrMark.asRecord();=0A=
						synchronized (lock) {=0A							numRecordsIn.inc();=0A					=09=
	streamOperator.setKeyContextElement1(record);=0A							streamOpe=
rator.processElement(record);=0A						}=0A						return true;=0A	=09=
			}=0A				}=0A			}=0A=0A			final BufferOrEvent bufferOrEvent =3D=
 barrierHandler.getNextNonBlocked();=0A			if (bufferOrEvent !=3D=20=
null) {=0A				if (bufferOrEvent.isBuffer()) {=0A					currentChann=
el =3D bufferOrEvent.getChannelIndex();=0A					currentRecordDeser=
ializer =3D recordDeserializers[currentChannel];=0A					currentRe=
cordDeserializer.setNextBuffer(bufferOrEvent.getBuffer());=0A			=09=
}=0A				else {=0A					// Event received=0A					final AbstractEven=
t event =3D bufferOrEvent.getEvent();=0A					if (event.getClass()=
 !=3D EndOfPartitionEvent.class) {=0A						throw new IOException(=
"Unexpected event: " + event);=0A					}=0A				}=0A			}=0A			else=20=
{=0A				isFinished =3D true;=0A				if (!barrierHandler.isEmpty())=
 {=0A					throw new IllegalStateException("Trailing data in check=
point barrier handler.");=0A				}=0A				return false;=0A			}=0A	=09=
}=0A	}=0A</code></pre><h3 style=3D"font-size: 1.25rem; color: rgb=
(36, 41, 46);"><font><font>WindowOperator.processElement=A3=A8=BC=
=C7=C2=BC=A3=A9</font></font></h3><ul style=3D"color: rgb(36, 41,=
 46);"><li><p><font><font>=B7=D6=C5=E4=B4=B0=BF=DA=A3=AC=D2=B2=BE=
=CD=CA=C7=BC=C6=CB=E3=B4=B0=BF=DA=B5=C4=BF=AA=C6=F4=CA=B1=BC=E4=BA=
=CD=BD=E1=CA=F8=CA=B1=BC=E4=A3=AC=B8=C3=BC=C6=CB=E3=B7=BD=CA=BD=A3=
=AC=CB=E3=B7=A8=A3=AC=C7=A1=BA=C3=B0=D1=CB=F9=D3=D0=D4=AA=CB=D8=B6=
=BC=B7=D6=C5=E4=B5=BD=D5=FB=B4=F3=D0=A1=B5=C4=CA=B1=BC=E4=B6=CE=C8=
=E7=B4=F3=D0=A1=3D 5=C3=EB=A3=AC5000=BA=C1=C3=EB=A3=AC=D2=B2=BE=CD=
=CA=C7=BF=C9=D2=D4=D4=DA=D5=E2=D0=A9=B7=B6=CE=A7=C4=DA=B5=C4=A3=AC=
=BE=CD=BB=E1=B1=BB=B7=D6=C5=E4=B5=C4=D7=EE=BD=FC=B5=C4=D2=BB=B8=F6=
=C7=F8=BC=E4</font></font></p><pre style=3D"font-size: 0.85rem; b=
ackground-color: rgb(246, 248, 250);"><code>[2019-03-06 20:00:00=20=
  -&gt; 2019-03-06 20:00:05)=0A[2019-03-06 20:00:05   -&gt; 2019-=
03-06 20:00:10)=0A[2019-03-06 20:00:15   -&gt; 2019-03-06 20:00:2=
0)=0A[2019-03-06 20:00:20   -&gt; 2019-03-06 20:00:25)=0A[2019-03=
-06 20:00:25   -&gt; 2019-03-06 20:00:30)=0A......=0A</code></pre=
><ul><li><font><font>=BF=AA=CA=BC=CA=B1=BC=E4=A3=A8=B5=A5=CE=BB=A3=
=BA=BA=C1=C3=EB=A3=A9=A3=AC=B4=CB=B4=A6=C6=AB=D2=C6=3D 0=A3=AC=CA=
=B1=BC=E4=B4=C1=3D AssignerWithPeriodicWatermarks.extractTimestam=
p=A3=A8=A3=A9=CC=E1=C8=A1=B5=C4=B3=A4=B6=C8</font></font></li></u=
l><pre style=3D"font-size: 0.85rem; background-color: rgb(246, 24=
8, 250);"><code>long start =3D timestamp - (timestamp - offset +=20=
windowSize) % windowSize;=0A</code></pre><ul><li><font><font>=BD=E1=
=CA=F8=CA=B1=BC=E4=A3=A8=B5=A5=CE=BB=A3=BA=BA=C1=C3=EB=A3=A9=A3=AC=
=B4=F3=D0=A1=CE=AA.timeWindowAll=A3=A8Time.seconds=A3=A85=A3=A9=A3=
=A9=A3=AC5=C3=EB=BC=B4=CE=AA5000=BA=C1=C3=EB</font></font></li></=
ul><pre style=3D"font-size: 0.85rem; background-color: rgb(246, 2=
48, 250);"><code>long end =3D start + size =0A</code></pre><pre s=
tyle=3D"font-size: 0.85rem; background-color: rgb(246, 248, 250);=
"><code>	final Collection&lt;W&gt; elementWindows =3D windowAssig=
ner.assignWindows(=0A		element.getValue(), element.getTimestamp()=
, windowAssignerContext);=0A</code></pre></li><li><p><font><font>=
=C8=E7=B9=FB=B5=B1=C7=B0=D4=AA=CB=D8=B5=C4=BA=CF=C0=ED=A3=AC=BC=C6=
=CB=E3=BA=F3=A3=AC=BD=E1=CA=F8=CA=B1=BC=E4=B4=F3=D3=DA=B8=C3Windo=
w=B5=C4=BD=E1=CA=F8=CA=B1=BC=E4=A3=AC=BE=CD=CB=B5=C3=F7=BB=AE=B5=BD=
=BA=F3=C3=E6=B5=C4window=C8=A5=C1=CB=A3=AC=D2=B2=BE=CD=CA=C7=D5=E2=
=D2=BB=CC=F5=CA=FD=BE=DD=D6=D0=B6=CF=C1=CB</font></font></p></li>=
</ul><pre style=3D"font-size: 0.85rem; color: rgb(36, 41, 46); ba=
ckground-color: rgb(246, 248, 250);"><code>		// drop if the windo=
w is already late=0A				if (isWindowLate(window)) {=0A					contin=
ue;=0A				}=0A</code></pre><ul style=3D"color: rgb(36, 41, 46);">=
<li><font><font>windowState=CE=AAHeapListState=C0=B4=B4=E6=B4=A2=D4=
=AA=CB=D8</font></font></li></ul><pre style=3D"font-size: 0.85rem=
; color: rgb(36, 41, 46); background-color: rgb(246, 248, 250);">=
<code>windowState.add(element.getValue());=0A</code></pre><ul sty=
le=3D"color: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=C3trigge=
r=BA=AF=CA=FD=A3=AC=BE=CD=CA=C7=B8=F8=C3=BF=B8=F6=B4=B0=BF=DA=B0=F3=
=B6=A8=B3=F5=CA=BC=BB=AF=A3=AC=B5=B1window=B5=BD=C1=CB=BD=E1=CA=F8=
=CA=B1=BC=E4=A3=AC=BE=CD=BB=E1=B1=BB=B4=A5=B7=A2=A3=AC=B2=BB=B9=FD=
=CB=FB=B2=BB=CA=C7=C3=BF=B8=F6=D4=AA=CB=D8=B4=A5=B7=A2=D2=BB=B4=CE=
=A3=AC=B6=F8=CA=C7=B0=B4=BC=FC=A3=AC=BD=F8=D0=D0=C1=CBSet=C8=A5=D6=
=D8=A3=AC=C3=BF=B8=F6=BC=FC=BB=E1=B5=F7=D2=BB=B4=CEWindowOperator=
.onProcessingTime=A3=A8=A3=A9=BA=AF=CA=FD</font></font></li></ul>=
<pre style=3D"font-size: 0.85rem; color: rgb(36, 41, 46); backgro=
und-color: rgb(246, 248, 250);"><code>TriggerResult triggerResult=
 =3D triggerContext.onElement(element);=0A=0A</code></pre><pre st=
yle=3D"font-size: 0.85rem; color: rgb(36, 41, 46); background-col=
or: rgb(246, 248, 250);"><code>public void processElement(StreamR=
ecord&lt;IN&gt; element) throws Exception {=0A		final Collection&=
lt;W&gt; elementWindows =3D windowAssigner.assignWindows(=0A			el=
ement.getValue(), element.getTimestamp(), windowAssignerContext);=
=0A=0A		//if element is handled by none of assigned elementWindow=
s=0A		boolean isSkippedElement =3D true;=0A=0A		final K key =3D t=
his.&lt;K&gt;getKeyedStateBackend().getCurrentKey();=0A=0A		if (w=
indowAssigner instanceof MergingWindowAssigner) {=0A			MergingWin=
dowSet&lt;W&gt; mergingWindows =3D getMergingWindowSet();=0A=0A	=09=
	for (W window: elementWindows) {=0A=0A				// adding the new wind=
ow might result in a merge, in that case the actualWindow=0A				/=
/ is the merged window and we work with that. If we don't merge t=
hen=0A				// actualWindow =3D=3D window=0A				W actualWindow =3D=20=
mergingWindows.addWindow(window, new MergingWindowSet.MergeFuncti=
on&lt;W&gt;() {=0A					@Override=0A					public void merge(W merge=
Result,=0A							Collection&lt;W&gt; mergedWindows, W stateWindow=
Result,=0A							Collection&lt;W&gt; mergedStateWindows) throws E=
xception {=0A=0A						if ((windowAssigner.isEventTime() &amp;&amp=
; mergeResult.maxTimestamp() + allowedLateness &lt;=3D internalTi=
merService.currentWatermark())) {=0A							throw new UnsupportedO=
perationException("The end timestamp of an " +=0A									"event-=
time window cannot become earlier than the current watermark " +=0A=
									"by merging. Current watermark: " + internalTimerService=
.currentWatermark() +=0A									" window: " + mergeResult);=0A	=09=
				} else if (!windowAssigner.isEventTime() &amp;&amp; mergeResu=
lt.maxTimestamp() &lt;=3D internalTimerService.currentProcessingT=
ime()) {=0A							throw new UnsupportedOperationException("The en=
d timestamp of a " +=0A									"processing-time window cannot be=
come earlier than the current processing time " +=0A									"by=20=
merging. Current processing time: " + internalTimerService.curren=
tProcessingTime() +=0A									" window: " + mergeResult);=0A			=09=
		}=0A=0A						triggerContext.key =3D key;=0A						triggerContext=
.window =3D mergeResult;=0A=0A						triggerContext.onMerge(merged=
Windows);=0A=0A						for (W m: mergedWindows) {=0A							triggerC=
ontext.window =3D m;=0A							triggerContext.clear();=0A							de=
leteCleanupTimer(m);=0A						}=0A=0A						// merge the merged sta=
te windows into the newly resulting state window=0A						windowMe=
rgingState.mergeNamespaces(stateWindowResult, mergedStateWindows)=
;=0A					}=0A				});=0A=0A				// drop if the window is already la=
te=0A				if (isWindowLate(actualWindow)) {=0A					mergingWindows.=
retireWindow(actualWindow);=0A					continue;=0A				}=0A				isSkip=
pedElement =3D false;=0A=0A				W stateWindow =3D mergingWindows.g=
etStateWindow(actualWindow);=0A				if (stateWindow =3D=3D null) {=
=0A					throw new IllegalStateException("Window " + window + " is=
 not in in-flight window set.");=0A				}=0A=0A				windowState.set=
CurrentNamespace(stateWindow);=0A				windowState.add(element.getV=
alue());=0A=0A				triggerContext.key =3D key;=0A				triggerContex=
t.window =3D actualWindow;=0A=0A				TriggerResult triggerResult =3D=
 triggerContext.onElement(element);=0A=0A				if (triggerResult.is=
Fire()) {=0A					ACC contents =3D windowState.get();=0A					if (c=
ontents =3D=3D null) {=0A						continue;=0A					}=0A					emitWind=
owContents(actualWindow, contents);=0A				}=0A=0A				if (triggerR=
esult.isPurge()) {=0A					windowState.clear();=0A				}=0A				regi=
sterCleanupTimer(actualWindow);=0A			}=0A=0A			// need to make su=
re to update the merging state in state=0A			mergingWindows.persi=
st();=0A		} else {=0A			for (W window: elementWindows) {=0A=0A		=09=
	// drop if the window is already late=0A				if (isWindowLate(win=
dow)) {=0A					continue;=0A				}=0A				isSkippedElement =3D false=
;=0A=0A				windowState.setCurrentNamespace(window);=0A				windowS=
tate.add(element.getValue());=0A=0A				triggerContext.key =3D key=
;=0A				triggerContext.window =3D window;=0A=0A				TriggerResult=20=
triggerResult =3D triggerContext.onElement(element);=0A=0A				if=20=
(triggerResult.isFire()) {=0A					ACC contents =3D windowState.ge=
t();=0A					if (contents =3D=3D null) {=0A						continue;=0A				=09=
}=0A					emitWindowContents(window, contents);=0A				}=0A=0A				i=
f (triggerResult.isPurge()) {=0A					windowState.clear();=0A				}=
=0A				registerCleanupTimer(window);=0A			}=0A		}=0A=0A		// side=20=
output input event if=0A		// element not handled by any window=0A=
		// late arriving tag has been set=0A		// windowAssigner is even=
t time and current timestamp + allowed lateness no less than elem=
ent timestamp=0A		if (isSkippedElement &amp;&amp; isElementLate(e=
lement)) {=0A			if (lateDataOutputTag !=3D null){=0A				sideOutpu=
t(element);=0A			} else {=0A				this.numLateRecordsDropped.inc();=
=0A			}=0A		}=0A	}=0A=0A</code></pre><h3 style=3D"font-size: 1.25=
rem; color: rgb(36, 41, 46);"><font><font>WindowOperator.onEventT=
ime=A3=A8=A3=A9</font></font></h3><ul style=3D"color: rgb(36, 41,=
 46);"><li><font><font>=B5=B1=D7=D4=B6=A8=D2=E5=B3=CC=D0=F2datast=
ream.assignTimestampsAndWatermarks.AssignerWithPeriodicWatermarks=
.getCurrentWatermark=B5=C3=B5=BD=B5=C4=D6=B5=A3=AC=B4=F3=D3=DA=B5=
=B1=C7=B0=B4=B0=BF=DA=B5=C4end=A3=AC=CB=B5=C3=F7=B5=B1=C7=B0=B4=B0=
=BF=DA=BF=C9=D2=D4=BD=E1=CA=F8=C1=CB=A3=AC=BE=CD=BB=E1=B4=A5=B7=A2=
=B5=F7=D3=C3WindowOperator.onEventTime=A3=A8=A3=A9</font></font><=
/li><li><font><font>triggerResult.isFire=A3=A8=A3=A9//=BD=AB=BB=E1=
=C2=FA=D7=E3=CC=F5=BC=FE</font></font></li><li><font><font>window=
State.get=A3=A8=A3=A9; //=CA=D5=BB=D8=B5=B1=C7=B0window=D6=D0=BF=AA=
=CA=BC=CA=B1=BC=E4=B5=BD=BD=E1=CA=F8=CA=B1=BC=E4=B5=C4=A3=AC=CB=F9=
=D3=D0=D4=AA=CB=D8</font></font></li><li><font><font>=B5=F7=D3=C3=
emitWindowContents=A3=A8=A3=A9=BA=AF=CA=FD=BD=F8=D0=D0=B4=A6=C0=ED=
</font></font></li></ul><pre style=3D"font-size: 0.85rem; color:=20=
rgb(36, 41, 46); background-color: rgb(246, 248, 250);"><code>pub=
lic void onEventTime(InternalTimer&lt;K, W&gt; timer) throws Exce=
ption {=0A		triggerContext.key =3D timer.getKey();=0A		triggerCon=
text.window =3D timer.getNamespace();=0A=0A		MergingWindowSet&lt;=
W&gt; mergingWindows;=0A=0A		if (windowAssigner instanceof Mergin=
gWindowAssigner) {=0A			mergingWindows =3D getMergingWindowSet();=
=0A			W stateWindow =3D mergingWindows.getStateWindow(triggerCont=
ext.window);=0A			if (stateWindow =3D=3D null) {=0A				// Timer f=
iring for non-existent window, this can only happen if a=0A				//=
 trigger did not clean up timers. We have already cleared the mer=
ging=0A				// window and therefore the Trigger state, however, so=
 nothing to do.=0A				return;=0A			} else {=0A				windowState.set=
CurrentNamespace(stateWindow);=0A			}=0A		} else {=0A			windowSta=
te.setCurrentNamespace(triggerContext.window);=0A			mergingWindow=
s =3D null;=0A		}=0A=0A		TriggerResult triggerResult =3D triggerC=
ontext.onEventTime(timer.getTimestamp());=0A=0A		if (triggerResul=
t.isFire()) {=0A			ACC contents =3D windowState.get();=0A			if (c=
ontents !=3D null) {=0A				emitWindowContents(triggerContext.wind=
ow, contents);=0A			}=0A		}=0A=0A		if (triggerResult.isPurge()) {=
=0A			windowState.clear();=0A		}=0A=0A		if (windowAssigner.isEven=
tTime() &amp;&amp; isCleanupTime(triggerContext.window, timer.get=
Timestamp())) {=0A			clearAllState(triggerContext.window, windowS=
tate, mergingWindows);=0A		}=0A=0A		if (mergingWindows !=3D null)=
 {=0A			// need to make sure to update the merging state in state=
=0A			mergingWindows.persist();=0A		}=0A	}=0A=0A</code></pre><h3=20=
style=3D"font-size: 1.25rem; color: rgb(36, 41, 46);"><font><font=
>WindowOperator.emitWindowContents</font></font></h3><ul style=3D=
"color: rgb(36, 41, 46);"><li><font><font>userFunction=B5=F7=D3=C3=
InternalIterableProcessAllWindowFunction.process=A3=A8=A3=A9</fon=
t></font></li></ul><pre style=3D"font-size: 0.85rem; color: rgb(3=
6, 41, 46); background-color: rgb(246, 248, 250);"><code>	private=
 void emitWindowContents(W window, ACC contents) throws Exception=
 {=0A		timestampedCollector.setAbsoluteTimestamp(window.maxTimest=
amp());=0A		processContext.window =3D window;=0A		userFunction.pr=
ocess(triggerContext.key, window, processContext, contents, times=
tampedCollector);=0A	}=0A=0A</code></pre><h3 style=3D"font-size:=20=
1.25rem; color: rgb(36, 41, 46);"><font><font>InternalIterablePro=
cessAllWindowFunction.process</font></font></h3><ul style=3D"colo=
r: rgb(36, 41, 46);"><li><font><font>wrapedFunction.process=CE=AA=
=D3=C3=BB=A7=B6=A8=D2=E5=B5=C4=B4=A6=C0=ED=BA=AF=CA=FDAllWindowed=
Stream.process=A3=A8=A3=A9=BA=AF=CA=FD=A3=AC=BC=B4=D7=D4=BC=BA=B6=
=A8=D2=E5=B5=C4=B4=A6=C0=ED=B4=B0=BF=DA=B5=C4=BA=AF=CA=FD</font><=
/font></li><li><font><font>=CA=E4=C8=EB=CE=AA=B5=B1=C7=B0=B9=D1=B8=
=BE=B5=C4=CB=F9=D3=D0=D4=AA=CB=D8</font></font></li><li><font><fo=
nt>=B5=F7=D3=C3TimestampedCollector.collect=A3=A8=A3=A9=CC=F5=D2=BB=
=CC=F5=D4=AA=CB=D8=B7=A2=CB=CD</font></font></li></ul><pre style=3D=
"font-size: 0.85rem; color: rgb(36, 41, 46); background-color: rg=
b(246, 248, 250);"><code>	public void process(Byte key, final W w=
indow, final InternalWindowContext context, Iterable&lt;IN&gt; in=
put, Collector&lt;OUT&gt; out) throws Exception {=0A		this.ctx.wi=
ndow =3D window;=0A		this.ctx.internalContext =3D context;=0A		Pr=
ocessAllWindowFunction&lt;IN, OUT, W&gt; wrappedFunction =3D this=
.wrappedFunction;=0A		wrappedFunction.process(ctx, input, out);=0A=
	}=0A=0A</code></pre><h3 style=3D"font-size: 1.25rem; color: rgb(=
36, 41, 46);"><font><font>AbstractStreamOperator.CountingOutput</=
font></font></h3><ul style=3D"color: rgb(36, 41, 46);"><li><font>=
<font>=B5=F7=D3=C3CopyingChainingOutput.collect=A3=A8=A3=A9</font=
></font></li></ul><pre style=3D"font-size: 0.85rem; color: rgb(36=
, 41, 46); background-color: rgb(246, 248, 250);"><code>public vo=
id collect(StreamRecord&lt;OUT&gt; record) {=0A			numRecordsOut.i=
nc();=0A			output.collect(record);=0A		}=0A</code></pre><h3 style=
=3D"font-size: 1.25rem; color: rgb(36, 41, 46);"><font><font>=B4=B0=
=BF=DA=A3=A8StreamSink=A3=A9</font></font><span>OperatorChain.Cop=
yingChainingOutput</span></h3><ul style=3D"color: rgb(36, 41, 46)=
;"><li><font><font>=B5=F7=D3=C3StreamSink.processElement=A3=A8=A3=
=A9</font></font></li></ul><pre style=3D"font-size: 0.85rem; colo=
r: rgb(36, 41, 46); background-color: rgb(246, 248, 250);"><code>=
protected &lt;X&gt; void pushToOperator(StreamRecord&lt;X&gt; rec=
ord) {=0A			try {=0A				// we know that the given outputTag match=
es our OutputTag so the record=0A				// must be of the type that=20=
our operator (and Serializer) expects.=0A				@SuppressWarnings("u=
nchecked")=0A				StreamRecord&lt;T&gt; castRecord =3D (StreamReco=
rd&lt;T&gt;) record;=0A=0A				numRecordsIn.inc();=0A				StreamRec=
ord&lt;T&gt; copy =3D castRecord.copy(serializer.copy(castRecord.=
getValue()));=0A				operator.setKeyContextElement1(copy);=0A				o=
perator.processElement(copy);=0A			} catch (ClassCastException e)=
 {=0A				if (outputTag !=3D null) {=0A					// Enrich error messag=
e=0A					ClassCastException replace =3D new ClassCastException(=0A=
						String.format(=0A							"%s. Failed to push OutputTag with=20=
id '%s' to operator. " +=0A								"This can occur when multiple=20=
OutputTags with different types " +=0A								"but identical name=
s are being used.",=0A							e.getMessage(),=0A							outputTag.g=
etId()));=0A=0A					throw new ExceptionInChainedOperatorException=
(replace);=0A				} else {=0A					throw new ExceptionInChainedOper=
atorException(e);=0A				}=0A			} catch (Exception e) {=0A				thro=
w new ExceptionInChainedOperatorException(e);=0A			}=0A=0A		}=0A=09=
}=0A=0A</code></pre><h3 style=3D"font-size: 1.25rem; color: rgb(3=
6, 41, 46);"><font><font>StreamSink.processElement</font></font><=
/h3><ul style=3D"color: rgb(36, 41, 46);"><li><font><font>=B5=F7=D3=
=C3PrintSinkFuntion.invoke=CA=E4=B3=F6=B5=B1=C7=B0=D4=AA=CB=D8</f=
ont></font></li></ul><pre style=3D"font-size: 0.85rem; color: rgb=
(36, 41, 46); background-color: rgb(246, 248, 250);"><code>	publi=
c void processElement(StreamRecord&lt;IN&gt; element) throws Exce=
ption {=0A		sinkContext.element =3D element;=0A		userFunction.inv=
oke(element.getValue(), sinkContext);=0A	}=0A</code></pre><br cla=
ss=3D"Apple-interchange-newline"><br><div style=3D"color:gray;"><=
small>=C0=B4=D4=B4=A3=BA&nbsp;<a href=3D"https://github.com/opens=
ourceteams/flink-maven-scala/blob/master/md/miniCluster/Flink-Eve=
ntTime-watermark.md">https://github.com/opensourceteams/flink-mav=
en-scala/blob/master/md/miniCluster/Flink-EventTime-watermark.md<=
/a></small></div>=0A=0A=0A</body></html>=0A=0A=0A=0A=0A=0A=0A=0A=0A=
=0A

------=_Next_Part_0000421281.719--

------=_Next_Part_0001263843.074--

