From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?RmxpbmvKtbLZIDog17TMrLncwO0=?=
Date: Date: Fri, 23 Jul 2021 05:53:42 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0001106295.209"

This is a multi-part message in MIME format.

------=_Next_Part_0001106295.209
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000368765.630"


------=_Next_Part_0000368765.630
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000368765.630
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A<title>Flink=CA=B5=
=B2=D9 : =D7=B4=CC=AC=B9=DC=C0=ED</title>=0A    =0A<style id=3D"w=
iz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-edit=
or-body {font-family: Helvetica, 'Hiragino Sans GB', '=E5=BE=AE=E8=
=BD=AF=E9=9B=85=E9=BB=91', 'Microsoft YaHei UI', SimSun, SimHei,=20=
arial, sans-serif;line-height: 1.7;margin: 0 auto;padding: 20px 1=
6px;padding: 1.25rem 1rem;}.wiz-editor-body h1,.wiz-editor-body h=
2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wi=
z-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;pa=
dding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;f=
ont-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1=
.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wi=
z-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-b=
ody h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-=
size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-edit=
or-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-bo=
dy ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0;}.wiz=
-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body p=
re,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMir=
ror pre {margin:0;}.wiz-editor-body ul,.wiz-editor-body ol {paddi=
ng-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-leve=
l1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-le=
vel2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-l=
ist-level3 > li {list-style-type:lower-roman;}.wiz-editor-body bl=
ockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-c=
hild {margin-top:0;}.wiz-editor-body blockquote > :last-child {ma=
rgin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;heig=
ht:auto !important;margin:2px 0;}.wiz-editor-body table {border-c=
ollapse:collapse;border:1px solid #bbbbbb;}.wiz-editor-body td,.w=
iz-editor-body th {padding:4px 8px;border-collapse:collapse;borde=
r:1px solid #bbbbbb;min-height:28px;word-break:break-word;box-siz=
ing: border-box;}.wiz-hide {display:none !important;}</style><sty=
le id=3D"wiz_code_style">.wiz-editor-body .wiz-code-container{pos=
ition: relative; padding:8px 0; margin: 5px 25px 5px 5px;text-ind=
ent:0; text-align:left;}.CodeMirror {font-family: Consolas, "Libe=
ration Mono", Menlo, Courier, monospace; color: black; font-size:=
 10.5pt; font-size: 0.875rem}.wiz-editor-body .wiz-code-container=
 .CodeMirror div {margin-top: 0; margin-bottom: 0;}.CodeMirror-li=
nes {padding: 4px 0;}.CodeMirror pre {padding: 0 4px;}.CodeMirror=
-scrollbar-filler, .CodeMirror-gutter-filler {background-color: w=
hite;}.CodeMirror-gutters {border-right: 1px solid #ddd; backgrou=
nd-color: #f7f7f7; white-space: nowrap;}.CodeMirror-linenumbers {=
}.CodeMirror-linenumber {padding: 0 3px 0 5px; min-width: 20px; t=
ext-align: right; color: #999; white-space: nowrap;}.CodeMirror-g=
uttermarker {color: black;}.CodeMirror-guttermarker-subtle {color=
: #999;}.CodeMirror-cursor {border-left: 1px solid black; border-=
right: none; width: 0;}.CodeMirror div.CodeMirror-secondarycursor=
 {border-left: 1px solid silver;}.cm-fat-cursor .CodeMirror-curso=
r {width: auto; border: 0 !important; background: #7e7;}.cm-fat-c=
ursor div.CodeMirror-cursors {z-index: 1;}.cm-animate-fat-cursor=20=
{width: auto; border: 0; -webkit-animation: blink 1.06s steps(1)=20=
infinite; -moz-animation: blink 1.06s steps(1) infinite; animatio=
n: blink 1.06s steps(1) infinite; background-color: #7e7;}@-moz-k=
eyframes blink {  0% {}  50% { background-color: transparent; } =20=
100% {}}@-webkit-keyframes blink {  0% {}  50% { background-color=
: transparent; }  100% {}}@keyframes blink {  0% {}  50% { backgr=
ound-color: transparent; }  100% {}}.CodeMirror-overwrite .CodeMi=
rror-cursor {}.cm-tab { display: inline-block; text-decoration: i=
nherit; }.CodeMirror-rulers {position: absolute; left: 0; right:=20=
0; top: -50px; bottom: -20px; overflow: hidden;}.CodeMirror-ruler=
 {border-left: 1px solid #ccc; top: 0; bottom: 0; position: absol=
ute;}.cm-s-default .cm-header {color: blue;}.cm-s-default .cm-quo=
te {color: #090;}.cm-negative {color: #d44;}.cm-positive {color:=20=
#292;}.cm-header, .cm-strong {font-weight: bold;}.cm-em {font-sty=
le: italic;}.cm-link {text-decoration: underline;}.cm-strikethrou=
gh {text-decoration: line-through;}.cm-s-default .cm-keyword {col=
or: #708;}.cm-s-default .cm-atom {color: #219;}.cm-s-default .cm-=
number {color: #164;}.cm-s-default .cm-def {color: #00f;}.cm-s-de=
fault .cm-variable,.cm-s-default .cm-punctuation,.cm-s-default .c=
m-property,.cm-s-default .cm-operator {}.cm-s-default .cm-variabl=
e-2 {color: #05a;}.cm-s-default .cm-variable-3 {color: #085;}.cm-=
s-default .cm-comment {color: #a50;}.cm-s-default .cm-string {col=
or: #a11;}.cm-s-default .cm-string-2 {color: #f50;}.cm-s-default=20=
.cm-meta {color: #555;}.cm-s-default .cm-qualifier {color: #555;}=
.cm-s-default .cm-builtin {color: #30a;}.cm-s-default .cm-bracket=
 {color: #997;}.cm-s-default .cm-tag {color: #170;}.cm-s-default=20=
.cm-attribute {color: #00c;}.cm-s-default .cm-hr {color: #999;}.c=
m-s-default .cm-link {color: #00c;}.cm-s-default .cm-error {color=
: #f00;}.cm-invalidchar {color: #f00;}.CodeMirror-composing { bor=
der-bottom: 2px solid; }div.CodeMirror span.CodeMirror-matchingbr=
acket {color: #0f0;}div.CodeMirror span.CodeMirror-nonmatchingbra=
cket {color: #f22;}.CodeMirror-matchingtag { background: rgba(255=
, 150, 0, .3); }.CodeMirror-activeline-background {background: #e=
8f2ff;}.CodeMirror {position: relative; background: #f5f5f5;}.Cod=
eMirror-scroll {overflow: hidden !important; margin-bottom: 0; ma=
rgin-right: -30px; padding: 16px 30px 16px 0; outline: none; posi=
tion: relative;}.CodeMirror-sizer {position: relative; border-rig=
ht: 30px solid transparent;}.CodeMirror-vscrollbar, .CodeMirror-h=
scrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-fille=
r {position: absolute; z-index: 6; display: none;}.CodeMirror-vsc=
rollbar {right: 0; top: 0; overflow-x: hidden; overflow-y: scroll=
;}.CodeMirror-hscrollbar {bottom: 0; left: 0 !important; overflow=
-y: hidden; overflow-x: scroll;}.CodeMirror-scrollbar-filler {rig=
ht: 0; bottom: 0;}.CodeMirror-gutter-filler {left: 0; bottom: 0;}=
.CodeMirror-gutters {position: absolute; left: 0; top: -5px; min-=
height: 100%; z-index: 3;}.CodeMirror-gutter {white-space: normal=
; height: inherit; display: inline-block; vertical-align: top; ma=
rgin-bottom: -30px;}.CodeMirror-gutter-wrapper {position: absolut=
e; z-index: 4; background: none !important; border: none !importa=
nt;}.CodeMirror-gutter-background {position: absolute; top: 0; bo=
ttom: 0; z-index: 4;}.CodeMirror-gutter-elt {position: absolute;=20=
cursor: default; z-index: 4; text-align: center;}.CodeMirror-gutt=
er-wrapper ::selection { background-color: transparent }.CodeMirr=
or-gutter-wrapper ::-moz-selection { background-color: transparen=
t }.CodeMirror-lines {cursor: text; min-height: 1px;}.CodeMirror=20=
pre {-moz-border-radius: 0; -webkit-border-radius: 0; border-radi=
us: 0; border-width: 0; background: transparent; font-family: inh=
erit; font-size: inherit; margin: 0; white-space: pre; word-wrap:=
 normal; line-height: inherit; color: inherit; z-index: 2; positi=
on: relative; overflow: visible; -webkit-tap-highlight-color: tra=
nsparent; -webkit-font-variant-ligatures: contextual; font-varian=
t-ligatures: contextual;}.CodeMirror-wrap pre {word-wrap: break-w=
ord; white-space: pre-wrap; word-break: normal;}.CodeMirror-lineb=
ackground {position: absolute; left: 0; right: 0; top: 0; bottom:=
 0; z-index: 0;}.CodeMirror-linewidget {position: relative; z-ind=
ex: 2; overflow: auto;}.CodeMirror-widget {}.CodeMirror-rtl pre {=
 direction: rtl; }.CodeMirror-code {outline: none;}.CodeMirror-sc=
roll,.CodeMirror-sizer,.CodeMirror-gutter,.CodeMirror-gutters,.Co=
deMirror-linenumber {-moz-box-sizing: content-box; box-sizing: co=
ntent-box;}.CodeMirror-measure {position: absolute; width: 100%;=20=
height: 0; overflow: hidden; visibility: hidden;}.CodeMirror-curs=
or {position: absolute; pointer-events: none;}.CodeMirror-measure=
 pre { position: static; }div.CodeMirror-cursors {visibility: hid=
den; position: relative; z-index: 3;}div.CodeMirror-dragcursors {=
visibility: visible;}.CodeMirror-focused div.CodeMirror-cursors {=
visibility: visible;}.CodeMirror-selected { background: #d9d9d9;=20=
}.CodeMirror-focused .CodeMirror-selected { background: #d7d4f0;=20=
}.CodeMirror-crosshair { cursor: crosshair; }.CodeMirror-line::se=
lection, .CodeMirror-line > span::selection, .CodeMirror-line > s=
pan > span::selection { background: #d7d4f0; }.CodeMirror-line::-=
moz-selection, .CodeMirror-line > span::-moz-selection, .CodeMirr=
or-line > span > span::-moz-selection { background: #d7d4f0; }.cm=
-searching {background: #ffa; background: rgba(255, 255, 0, .4);}=
.cm-force-border { padding-right: .1px; }@media print {  .CodeMir=
ror div.CodeMirror-cursors {visibility: hidden;}}.cm-tab-wrap-hac=
k:after { content: ""; }span.CodeMirror-selectedtext { background=
: none; }.CodeMirror-activeline-background, .CodeMirror-selected=20=
{transition: visibility 0ms 100ms;}.CodeMirror-blur .CodeMirror-a=
ctiveline-background, .CodeMirror-blur .CodeMirror-selected {visi=
bility:hidden;}.CodeMirror-blur .CodeMirror-matchingbracket {colo=
r:inherit !important;outline:none !important;text-decoration:none=
 !important;}.CodeMirror-sizer {min-height:auto !important;}</sty=
le></head>=0A=0A<body class=3D"wiz-editor-body"  spellcheck=3D"fa=
lse"><div class=3D"toolbar-logo toolbar-subMenu-box csdn-toolbar-=
fl" style=3D"font-size:0.875rem;color:rgba(255, 255, 255, 0.8);ba=
ckground:url(&quot;https"><br></div><div class=3D"toc" style=3D"c=
olor:rgb(180, 180, 180) !important;background:rgb(38, 39, 40) !im=
portant;font-size:1.125rem"><h3 style=3D"font-size: 1.375rem;">.<=
/h3><ul style=3D"font-size: 1rem;"><li style=3D"background: rgb(3=
8, 39, 40) !important;"><a href=3D"https://zhangboyi.blog.csdn.ne=
t/article/details/114538717#__4" target=3D"_self" style=3D"text-d=
ecoration:none;color:rgb(78, 161, 219);">=D2=BB .=B8=C5=C4=EE</a>=
</li><li style=3D"background: rgb(38, 39, 40) !important;"><ul><l=
i style=3D"background: rgb(38, 39, 40) !important;"><a href=3D"ht=
tps://zhangboyi.blog.csdn.net/article/details/114538717#11__6" ta=
rget=3D"_self" style=3D"text-decoration:none;color:rgb(78, 161, 2=
19);">1.1. =CA=B2=C3=B4=CA=C7=D3=D0=D7=B4=CC=AC=B5=C4=BC=C6=CB=E3=
=A3=BF</a></li><li style=3D"background: rgb(38, 39, 40) !importan=
t;"><a href=3D"https://zhangboyi.blog.csdn.net/article/details/11=
4538717#12__14" target=3D"_self" style=3D"text-decoration:none;co=
lor:rgb(78, 161, 219);">1.2. =B4=AB=CD=B3=B5=C4=C1=F7=BC=C6=CB=E3=
=CF=B5=CD=B3=C8=B1=C9=D9=B6=D4=D3=DA=B3=CC=D0=F2=D7=B4=CC=AC=B5=C4=
=D3=D0=D0=A7=D6=A7=B3=D6</a></li><li style=3D"background: rgb(38,=
 39, 40) !important;"><a href=3D"https://zhangboyi.blog.csdn.net/=
article/details/114538717#13_Flink_37" target=3D"_self" style=3D"=
text-decoration:none;color:rgb(78, 161, 219);">1.3. Flink=B7=E1=B8=
=BB=B5=C4=D7=B4=CC=AC=B7=C3=CE=CA=BA=CD=B8=DF=D0=A7=B5=C4=C8=DD=B4=
=ED=BB=FA=D6=C6</a></li></ul></li><li style=3D"background: rgb(38=
, 39, 40) !important;"><a href=3D"https://zhangboyi.blog.csdn.net=
/article/details/114538717#_Keyed_State_76" target=3D"_self" styl=
e=3D"text-decoration:none;color:rgb(78, 161, 219);">=B6=FE .Keyed=
 State</a></li><li style=3D"background: rgb(38, 39, 40) !importan=
t;"><ul><li style=3D"background: rgb(38, 39, 40) !important;"><a=20=
href=3D"https://zhangboyi.blog.csdn.net/article/details/114538717=
#21state_83" target=3D"_self" style=3D"text-decoration:none;color=
:rgb(78, 161, 219);">2.1.=B1=A3=B4=E6state=B5=C4=CA=FD=BE=DD=BD=E1=
=B9=B9</a></li><li style=3D"background: rgb(38, 39, 40) !importan=
t;"><a href=3D"https://zhangboyi.blog.csdn.net/article/details/11=
4538717#22__TTL_193" target=3D"_self" style=3D"text-decoration:no=
ne;color:rgb(78, 161, 219);">2.2. =D7=B4=CC=AC=D3=D0=D0=A7=C6=DA=20=
(TTL)</a></li><li style=3D"background: rgb(38, 39, 40) !important=
;"><ul><li style=3D"background: rgb(38, 39, 40) !important;"><a h=
ref=3D"https://zhangboyi.blog.csdn.net/article/details/114538717#=
221_237" target=3D"_self" style=3D"text-decoration:none;color:rgb=
(78, 161, 219);">2.2.1.=B9=FD=C6=DA=CA=FD=BE=DD=B5=C4=C7=E5=C0=ED=
</a></li><li style=3D"background: rgb(38, 39, 40) !important;"><a=
 href=3D"https://zhangboyi.blog.csdn.net/article/details/11453871=
7#22_251" target=3D"_self" style=3D"text-decoration:none;color:rg=
b(78, 161, 219);">2.2.=C8=AB=C1=BF=BF=EC=D5=D5=CA=B1=BD=F8=D0=D0=C7=
=E5=C0=ED</a></li><li style=3D"background: rgb(38, 39, 40) !impor=
tant;"><a href=3D"https://zhangboyi.blog.csdn.net/article/details=
/114538717#23_268" target=3D"_self" style=3D"text-decoration:none=
;color:rgb(78, 161, 219);">2.3.=D4=F6=C1=BF=CA=FD=BE=DD=C7=E5=C0=ED=
</a></li><li style=3D"background: rgb(38, 39, 40) !important;"><a=
 href=3D"https://zhangboyi.blog.csdn.net/article/details/11453871=
7#24_RocksDB__292" target=3D"_self" style=3D"text-decoration:none=
;color:rgb(78, 161, 219);">2.4.=D4=DA RocksDB =D1=B9=CB=F5=CA=B1=C7=
=E5=C0=ED</a></li></ul></li><li style=3D"background: rgb(38, 39,=20=
40) !important;"><a href=3D"https://zhangboyi.blog.csdn.net/artic=
le/details/114538717#23_DataStream__Scala_API_mapWithStateflatMap=
WithState_321" target=3D"_self" style=3D"text-decoration:none;col=
or:rgb(78, 161, 219);">2.3. DataStream =D7=B4=CC=AC=CF=E0=B9=D8=B5=
=C4 Scala API [mapWithState/flatMapWithState]</a></li><li style=3D=
"background: rgb(38, 39, 40) !important;"><ul><li style=3D"backgr=
ound: rgb(38, 39, 40) !important;"><a href=3D"https://zhangboyi.b=
log.csdn.net/article/details/114538717#231_mapWithState__326" tar=
get=3D"_self" style=3D"text-decoration:none;color:rgb(78, 161, 21=
9);">2.3.1. mapWithState :</a></li><li style=3D"background: rgb(3=
8, 39, 40) !important;"><a href=3D"https://zhangboyi.blog.csdn.ne=
t/article/details/114538717#232flatMapWithState__383" target=3D"_=
self" style=3D"text-decoration:none;color:rgb(78, 161, 219);">2.3=
.2.flatMapWithState :</a></li></ul></li></ul></li><li style=3D"ba=
ckground: rgb(38, 39, 40) !important;"><a href=3D"https://zhangbo=
yi.blog.csdn.net/article/details/114538717#_Operator_State_441" t=
arget=3D"_self" style=3D"text-decoration:none;color:rgb(78, 161,=20=
219);">=C8=FD .Operator State</a></li><li style=3D"background: rg=
b(38, 39, 40) !important;"><ul><li style=3D"background: rgb(38, 3=
9, 40) !important;"><ul><li style=3D"background: rgb(38, 39, 40)=20=
!important;"><a href=3D"https://zhangboyi.blog.csdn.net/article/d=
etails/114538717#151_CheckpointedFunction_454" target=3D"_self" s=
tyle=3D"text-decoration:none;color:rgb(78, 161, 219);">1.5.1. Che=
ckpointedFunction</a></li><li style=3D"background: rgb(38, 39, 40=
) !important;"><a href=3D"https://zhangboyi.blog.csdn.net/article=
/details/114538717#152__Source_Function_556" target=3D"_self" sty=
le=3D"text-decoration:none;color:rgb(78, 161, 219);">1.5.2. =B4=F8=
=D7=B4=CC=AC=B5=C4 Source Function</a></li></ul></li></ul></li><l=
i style=3D"background: rgb(38, 39, 40) !important;"><a href=3D"ht=
tps://zhangboyi.blog.csdn.net/article/details/114538717#_Broadcas=
t_State_618" target=3D"_self" style=3D"text-decoration:none;color=
:rgb(78, 161, 219);">=CB=C4. Broadcast State</a></li></ul></div><=
div id=3D"content_views" class=3D"markdown_views prism-tomorrow-n=
ight" style=3D"color: rgb(196, 196, 200) !important; background:=20=
rgb(38, 39, 40) !important;"><h1 style=3D"font-size: 1.75rem; col=
or: rgb(180, 180, 180) !important;">=D2=BB .=B8=C5=C4=EE</h1><h2=20=
style=3D"font-size: 1.5rem; color: rgb(180, 180, 180) !important;=
">1.1. =CA=B2=C3=B4=CA=C7=D3=D0=D7=B4=CC=AC=B5=C4=BC=C6=CB=E3=A3=BF=
</h2><p style=3D"font-size:1.125rem;color:rgb(180, 180, 180) !imp=
ortant;">=BC=C6=CB=E3=C8=CE=CE=F1=B5=C4=BD=E1=B9=FB=B2=BB=BD=F6=BD=
=F6=D2=C0=C0=B5=D3=DA=CA=E4=C8=EB=A3=AC=BB=B9=D2=C0=C0=B5=D3=DA=CB=
=FC=B5=C4=B5=B1=C7=B0=D7=B4=CC=AC=A3=AC=C6=E4=CA=B5=B4=F3=B6=E0=CA=
=FD=B5=C4=BC=C6=CB=E3=B6=BC=CA=C7=D3=D0=D7=B4=CC=AC=B5=C4=BC=C6=CB=
=E3=A1=A3</p><p style=3D"font-size:1.125rem;color:rgb(180, 180, 1=
80) !important;">=B1=C8=C8=E7wordcount,=BC=C6=CB=E3=B5=A5=B4=CA=B5=
=C4count,=D5=E2=CA=C7=D2=BB=B8=F6=BA=DC=B3=A3=BC=FB=B5=C4=D2=B5=CE=
=F1=B3=A1=BE=B0=A1=A3</p><p style=3D"font-size:1.125rem;color:rgb=
(180, 180, 180) !important;">count=D7=F6=CE=AA=CA=E4=B3=F6=A3=AC=D4=
=DA=BC=C6=CB=E3=B5=C4=B9=FD=B3=CC=D6=D0=D2=AA=B2=BB=B6=CF=B5=C4=B0=
=D1=CA=E4=C8=EB=C0=DB=BC=D3=B5=BDcount=C9=CF=C8=A5=A3=AC=C4=C7=C3=
=B4count=BE=CD=CA=C7=D2=BB=B8=F6state=A1=A3</p><h2 style=3D"font-=
size: 1.5rem; color: rgb(180, 180, 180) !important;">1.2. =B4=AB=CD=
=B3=B5=C4=C1=F7=BC=C6=CB=E3=CF=B5=CD=B3=C8=B1=C9=D9=B6=D4=D3=DA=B3=
=CC=D0=F2=D7=B4=CC=AC=B5=C4=D3=D0=D0=A7=D6=A7=B3=D6</h2><ul style=
=3D"color: rgb(180, 180, 180) !important;"><li style=3D"backgroun=
d: rgb(38, 39, 40) !important;">=D7=B4=CC=AC=CA=FD=BE=DD=B5=C4=B4=
=E6=B4=A2=BA=CD=B7=C3=CE=CA=A3=BB</li><li style=3D"background: rg=
b(38, 39, 40) !important;">=D7=B4=CC=AC=CA=FD=BE=DD=B5=C4=B1=B8=B7=
=DD=BA=CD=BB=D6=B8=B4=A3=BB</li><li style=3D"background: rgb(38,=20=
39, 40) !important;">=D7=B4=CC=AC=CA=FD=BE=DD=B5=C4=BB=AE=B7=D6=BA=
=CD=B6=AF=CC=AC=C0=A9=C8=DD=A1=A3</li></ul><p style=3D"font-size:=
1.125rem;color:rgb(180, 180, 180) !important;">=D4=DA=B4=AB=CD=B3=
=B5=C4=C5=FA=B4=A6=C0=ED=D6=D0=A3=AC=CA=FD=BE=DD=CA=C7=BB=AE=B7=D6=
=CE=AA=BF=E9=B7=D6=C6=AC=C8=A5=CD=EA=B3=C9=B5=C4=A3=AC=C8=BB=BA=F3=
=C3=BF=D2=BB=B8=F6Task=C8=A5=B4=A6=C0=ED=D2=BB=B8=F6=B7=D6=C6=AC=A1=
=A3<br>=B5=B1=B7=D6=C6=AC=D6=B4=D0=D0=CD=EA=B3=C9=BA=F3=A3=AC=B0=D1=
=CA=E4=B3=F6=BE=DB=BA=CF=C6=F0=C0=B4=BE=CD=CA=C7=D7=EE=D6=D5=B5=C4=
=BD=E1=B9=FB=A1=A3<br>=D4=DA=D5=E2=B8=F6=B9=FD=B3=CC=B5=B1=D6=D0=A3=
=AC=B6=D4=D3=DAstate=B5=C4=D0=E8=C7=F3=BB=B9=CA=C7=B1=C8=BD=CF=D0=
=A1=B5=C4=A1=A3</p><p style=3D"font-size:1.125rem;color:rgb(180,=20=
180, 180) !important;">=B6=D4=D3=DA=C1=F7=BC=C6=CB=E3=B6=F8=D1=D4=
=A3=AC=B6=D4State=D3=D0=B7=C7=B3=A3=B8=DF=B5=C4=D2=AA=C7=F3=A3=AC=
=D2=F2=CE=AA=D4=DA=C1=F7=CF=B5=CD=B3=D6=D0=CA=E4=C8=EB=CA=C7=D2=BB=
=B8=F6=CE=DE=CF=DE=D6=C6=B5=C4=C1=F7=A3=AC=BB=E1=D4=CB=D0=D0=BA=DC=
=B3=A4=D2=BB=B6=CE=CA=B1=BC=E4=A3=AC=C9=F5=D6=C1=D4=CB=D0=D0=BC=B8=
=CC=EC=BB=F2=D5=DF=BC=B8=B8=F6=D4=C2=B6=BC=B2=BB=BB=E1=CD=A3=BB=FA=
=A1=A3=D4=DA=D5=E2=B8=F6=B9=FD=B3=CC=B5=B1=D6=D0=A3=AC=BE=CD=D0=E8=
=D2=AA=BD=AB=D7=B4=CC=AC=CA=FD=BE=DD=BA=DC=BA=C3=B5=C4=B9=DC=C0=ED=
=C6=F0=C0=B4=A1=A3=BA=DC=B2=BB=D0=D2=B5=C4=CA=C7=A3=AC=D4=DA=B4=AB=
=CD=B3=B5=C4=C1=F7=BC=C6=CB=E3=CF=B5=CD=B3=D6=D0=A3=AC=B6=D4=D7=B4=
=CC=AC=B9=DC=C0=ED=D6=A7=B3=D6=B2=A2=B2=BB=CA=C7=BA=DC=CD=EA=C9=C6=
=A1=A3=B1=C8=C8=E7storm,=C3=BB=D3=D0=C8=CE=BA=CE=B3=CC=D0=F2=D7=B4=
=CC=AC=B5=C4=D6=A7=B3=D6=A3=AC=D2=BB=D6=D6=BF=C9=D1=A1=B5=C4=B7=BD=
=B0=B8=CA=C7storm+hbase=D5=E2=D1=F9=B5=C4=B7=BD=CA=BD=C8=A5=CA=B5=
=CF=D6=A3=AC=B0=D1=D5=E2=D7=B4=CC=AC=CA=FD=BE=DD=B4=E6=B7=C5=D4=DA=
Hbase=D6=D0=A3=AC=BC=C6=CB=E3=B5=C4=CA=B1=BA=F2=D4=D9=B4=CE=B4=D3=
Hbase=B6=C1=C8=A1=D7=B4=CC=AC=CA=FD=BE=DD=A3=AC=D7=F6=B8=FC=D0=C2=
=D4=DA=D0=B4=C8=EB=BD=F8=C8=A5=A1=A3=D5=E2=D1=F9=BE=CD=BB=E1=D3=D0=
=C8=E7=CF=C2=BC=B8=B8=F6=CE=CA=CC=E2</p><ul style=3D"color: rgb(1=
80, 180, 180) !important;"><li style=3D"background: rgb(38, 39, 4=
0) !important;"><p style=3D"font-size: 1.125rem;">=C1=F7=BC=C6=CB=
=E3=CF=B5=CD=B3=B5=C4=C8=CE=CE=F1=BA=CDHbase=B5=C4=CA=FD=BE=DD=B4=
=E6=B4=A2=D3=D0=BF=C9=C4=DC=B2=BB=D4=DA=CD=AC=D2=BB=CC=A8=BB=FA=C6=
=F7=C9=CF=A3=AC=B5=BC=D6=C2=D0=D4=C4=DC=BB=E1=BA=DC=B2=EE=A1=A3=D5=
=E2=D1=F9=BE=AD=B3=A3=BB=E1=D7=F6=D4=B6=B6=CB=B5=C4=B7=C3=CE=CA=A3=
=AC=D7=DF=CD=F8=C2=E7=BA=CD=B4=E6=B4=A2=A3=BB</p></li><li style=3D=
"background: rgb(38, 39, 40) !important;"><p style=3D"font-size:=20=
1.125rem;">=B1=B8=B7=DD=BA=CD=BB=D6=B8=B4=CA=C7=B1=C8=BD=CF=C0=A7=
=C4=D1=A3=AC=D2=F2=CE=AAHbase=CA=C7=C3=BB=D3=D0=BB=D8=B9=F6=B5=C4=
=A3=AC=D2=AA=D7=F6=B5=BDExactly once =BA=DC=C0=A7=C4=D1=A1=A3=D4=DA=
=B7=D6=B2=BC=CA=BD=BB=B7=BE=B3=CF=C2=A3=AC=C8=E7=B9=FB=B3=CC=D0=F2=
=B3=F6=CF=D6=B9=CA=D5=CF=A3=AC=D6=BB=C4=DC=D6=D8=C6=F4Storm=A3=AC=
=C4=C7=C3=B4Hbase=B5=C4=CA=FD=BE=DD=D2=B2=BE=CD=CE=DE=B7=A8=BB=D8=
=B9=F6=B5=BD=D6=AE=C7=B0=B5=C4=D7=B4=CC=AC=A1=A3<br>=B1=C8=C8=E7=B9=
=E3=B8=E6=BC=C6=B7=D1=B5=C4=D5=E2=D6=D6=B3=A1=BE=B0=A3=ACStorm+Hb=
ase=CA=C7=CA=C7=D0=D0=B2=BB=CD=A8=B5=C4=A3=AC=B3=F6=CF=D6=B5=C4=CE=
=CA=CC=E2=CA=C7=C7=AE=BF=C9=C4=DC=BE=CD=BB=E1=B6=E0=CB=E3=A3=AC=BD=
=E2=BE=F6=D2=D4=C9=CF=B5=C4=B0=EC=B7=A8=CA=C7Storm+mysql=A3=AC=CD=
=A8=B9=FDmysql=B5=C4=BB=D8=B9=F6=BD=E2=BE=F6=D2=BB=D6=C2=D0=D4=B5=
=C4=CE=CA=CC=E2=A1=A3=B5=AB=CA=C7=BC=DC=B9=B9=BB=E1=B1=E4=B5=C3=B7=
=C7=B3=A3=B8=B4=D4=D3=A1=A3=D0=D4=C4=DC=D2=B2=BB=E1=BA=DC=B2=EE=A3=
=AC=D2=AAcommit=C8=B7=B1=A3=CA=FD=BE=DD=B5=C4=D2=BB=D6=C2=D0=D4=A1=
=A3</p></li><li style=3D"background: rgb(38, 39, 40) !important;"=
><p style=3D"font-size: 1.125rem;">=B6=D4=D3=DAstorm=B6=F8=D1=D4=D7=
=B4=CC=AC=CA=FD=BE=DD=B5=C4=BB=AE=B7=D6=BA=CD=B6=AF=CC=AC=C0=A9=C8=
=DD=D2=B2=CA=C7=B7=C7=B3=A3=C4=D1=D7=F6=A1=A3<br>=D2=BB=B8=F6=BA=DC=
=D1=CF=D6=D8=B5=C4=CE=CA=CC=E2=CA=C7=CB=F9=D3=D0=D3=C3=BB=A7=B6=BC=
=BB=E1=D4=DAstrom=C9=CF=D6=D8=B8=B4=B5=C4=D7=F6=D5=E2=D0=A9=B9=A4=
=D7=F7=A3=AC=B1=C8=C8=E7=CB=D1=CB=F7=A3=AC=B9=E3=B8=E6=B6=BC=D2=AA=
=D4=DA=D7=F6=D2=BB=B1=E9=A3=AC=D3=C9=B4=CB=CF=DE=D6=C6=C1=CB=B2=BF=
=C3=C5=B5=C4=D2=B5=CE=F1=B7=A2=D5=B9=A1=A3</p></li></ul><h2 style=
=3D"font-size: 1.5rem; color: rgb(180, 180, 180) !important;">1.3=
. Flink=B7=E1=B8=BB=B5=C4=D7=B4=CC=AC=B7=C3=CE=CA=BA=CD=B8=DF=D0=A7=
=B5=C4=C8=DD=B4=ED=BB=FA=D6=C6</h2><p style=3D"font-size:1.125rem=
;color:rgb(180, 180, 180) !important;">=CE=D2=C3=C7=C7=B0=C3=E6=D0=
=B4=B5=C4WordCount=B5=C4=C0=FD=D7=D3=A3=AC=C3=BB=D3=D0=B0=FC=BA=AC=
<code style=3D"font-size: 0.875rem; background-color: rgb(64, 64,=
 65) !important;">=D7=B4=CC=AC=B9=DC=C0=ED</code>=A1=A3=C8=E7=B9=FB=
=D2=BB=B8=F6Task=D4=DA=B4=A6=C0=ED=B9=FD=B3=CC=D6=D0=B9=D2=B5=F4=C1=
=CB=A3=AC=C4=C7=C3=B4=CB=FC=D4=DA=C4=DA=B4=E6=D6=D0=B5=C4=D7=B4=CC=
=AC=B6=BC=BB=E1=B6=AA=CA=A7=A3=AC=CB=F9=D3=D0=B5=C4=CA=FD=BE=DD=B6=
=BC=D0=E8=D2=AA=D6=D8=D0=C2=BC=C6=CB=E3=A1=A3</p><p style=3D"font=
-size:1.125rem;color:rgb(180, 180, 180) !important;">=B4=D3=C8=DD=
=B4=ED=BA=CD=CF=FB=CF=A2=B4=A6=C0=ED=B5=C4=D3=EF=D2=E5=C9=CF(<str=
ong>at least once, exactly once</strong>)=A3=ACFlink=D2=FD=C8=EB=C1=
=CB<code style=3D"font-size: 0.875rem; background-color: rgb(64,=20=
64, 65) !important;">State</code>=BA=CD<code style=3D"font-size:=20=
0.875rem; background-color: rgb(64, 64, 65) !important;">Checkpoi=
nt</code></p><p style=3D"font-size:1.125rem;color:rgb(180, 180, 1=
80) !important;">=CA=D7=CF=C8=C7=F8=B7=D6=D2=BB=CF=C2=C1=BD=B8=F6=
=B8=C5=C4=EE:</p><blockquote style=3D"color:rgb(180, 180, 180) !i=
mportant;background:rgb(46, 47, 48) !important;"><p style=3D"font=
-size: 0.875rem;"><strong>State:</strong></p><p style=3D"font-siz=
e: 0.875rem;"> =D2=BB=B0=E3=D6=B8=D2=BB=B8=F6=BE=DF=CC=E5=B5=C4Ta=
sk/Operator=B5=C4=D7=B4=CC=AC=A3=AC</p><p style=3D"font-size: 0.8=
75rem;"> State=CA=FD=BE=DD=C4=AC=C8=CF=B1=A3=B4=E6=D4=DAJava=B5=C4=
=B6=D1=C4=DA=B4=E6=D6=D0</p></blockquote><blockquote style=3D"col=
or:rgb(180, 180, 180) !important;background:rgb(46, 47, 48) !impo=
rtant;"><p style=3D"font-size: 0.875rem;"><strong>Checkpoint:</st=
rong></p><p style=3D"font-size: 0.875rem;"> =B1=ED=CA=BE=C1=CB=D2=
=BB=B8=F6Flink Job=D4=DA=D2=BB=B8=F6=CC=D8=B6=A8=CA=B1=BF=CC=B5=C4=
=D2=BB=B7=DD=C8=AB=BE=D6=D7=B4=CC=AC=BF=EC=D5=D5=A3=AC=BC=B4=B0=FC=
=BA=AC=C1=CB=CB=F9=D3=D0Task/Operator=B5=C4=D7=B4=CC=AC</p><p sty=
le=3D"font-size: 0.875rem;"> =BF=C9=D2=D4=C0=ED=BD=E2=CE=AACheckp=
oint=CA=C7=B0=D1State=CA=FD=BE=DD=B6=A8=CA=B1=B3=D6=BE=C3=BB=AF=B4=
=E6=B4=A2=C1=CB=A3=AC</p></blockquote><p style=3D"font-size:1.125=
rem;color:rgb(180, 180, 180) !important;">State=BF=C9=D2=D4=B1=BB=
=BC=C7=C2=BC=A3=AC=D4=DA=CA=A7=B0=DC=B5=C4=C7=E9=BF=F6=CF=C2=CA=FD=
=BE=DD=BB=B9=BF=C9=D2=D4=BB=D6=B8=B4</p><p style=3D"font-size:1.1=
25rem;color:rgb(180, 180, 180) !important;">Flink=D6=D0=D3=D0=C1=BD=
=D6=D6=BB=F9=B1=BE=C0=E0=D0=CD=B5=C4State</p><ul style=3D"color:=20=
rgb(180, 180, 180) !important;"><li style=3D"background: rgb(38,=20=
39, 40) !important;">Keyed State</li><li style=3D"background: rgb=
(38, 39, 40) !important;">Operator State</li></ul><p style=3D"fon=
t-size:1.125rem;color:rgb(180, 180, 180) !important;">=BF=C9=D2=D4=
=D2=D4=C1=BD=D6=D6=D0=CE=CA=BD=B4=E6=D4=DA=A3=BA<code style=3D"fo=
nt-size: 0.875rem; background-color: rgb(64, 64, 65) !important;"=
>=D4=AD=CA=BC=D7=B4=CC=AC</code>=BA=CD<code style=3D"font-size: 0=
.875rem; background-color: rgb(64, 64, 65) !important;">=CD=D0=B9=
=DC=D7=B4=CC=AC</code></p><p style=3D"font-size:1.125rem;color:rg=
b(180, 180, 180) !important;">=CD=D0=B9=DC=D7=B4=CC=AC=CA=C7=D3=C9=
Flink=BF=F2=BC=DC=B9=DC=C0=ED=B5=C4=D7=B4=CC=AC=A3=AC=C8=E7ValueS=
tate, ListState, MapState=B5=C8=A1=A3</p><p style=3D"font-size:1.=
125rem;color:rgb(180, 180, 180) !important;">=B6=F8=D4=AD=CA=BC=D7=
=B4=CC=AC=A3=AC=D3=C9=D3=C3=BB=A7=D7=D4=D0=D0=B9=DC=C0=ED=D7=B4=CC=
=AC=BE=DF=CC=E5=B5=C4=CA=FD=BE=DD=BD=E1=B9=B9=A3=AC=BF=F2=BC=DC=D4=
=DA=D7=F6checkpoint=B5=C4=CA=B1=BA=F2=A3=AC=CA=B9=D3=C3byte[]=C0=B4=
=B6=C1=D0=B4=D7=B4=CC=AC=C4=DA=C8=DD=A3=AC=B6=D4=C6=E4=C4=DA=B2=BF=
=CA=FD=BE=DD=BD=E1=B9=B9=D2=BB=CE=DE=CB=F9=D6=AA=A1=A3</p><p styl=
e=3D"font-size:1.125rem;color:rgb(180, 180, 180) !important;">=CD=
=A8=B3=A3=D4=DADataStream=C9=CF=B5=C4=D7=B4=CC=AC=CD=C6=BC=F6=CA=B9=
=D3=C3=CD=D0=B9=DC=B5=C4=D7=B4=CC=AC=A3=AC=B5=B1=CA=B5=CF=D6=D2=BB=
=B8=F6=D3=C3=BB=A7=D7=D4=B6=A8=D2=E5=B5=C4operator=CA=B1=A3=AC=BB=
=E1=CA=B9=D3=C3=B5=BD=D4=AD=CA=BC=D7=B4=CC=AC=A1=A3</p><h1 style=3D=
"font-size: 1.75rem; color: rgb(180, 180, 180) !important;">=B6=FE=
 .Keyed State</h1><p style=3D"font-size:1.125rem;color:rgb(180, 1=
80, 180) !important;">=B9=CB=C3=FB=CB=BC=D2=E5=A3=AC=BE=CD=CA=C7=BB=
=F9=D3=DAKeyedStream=C9=CF=B5=C4=D7=B4=CC=AC=A1=A3<strong>=D5=E2=B8=
=F6=D7=B4=CC=AC=CA=C7=B8=FA=CC=D8=B6=A8=B5=C4key=B0=F3=B6=A8=B5=C4=
=A3=AC=B6=D4KeyedStream=C1=F7=C9=CF=B5=C4=C3=BF=D2=BB=B8=F6key=A3=
=AC=B6=BC=B6=D4=D3=A6=D2=BB=B8=F6state=A1=A3</strong></p><blockqu=
ote style=3D"color:rgb(180, 180, 180) !important;background:rgb(4=
6, 47, 48) !important;"><p style=3D"font-size: 0.875rem;">stream.=
keyBy(=A1=AD)</p></blockquote><h2 style=3D"font-size: 1.5rem; col=
or: rgb(180, 180, 180) !important;">2.1.=B1=A3=B4=E6state=B5=C4=CA=
=FD=BE=DD=BD=E1=B9=B9</h2><ul style=3D"color: rgb(180, 180, 180)=20=
!important;"><li style=3D"background: rgb(38, 39, 40) !important;=
"><p style=3D"font-size: 1.125rem;"><strong>ValueState</strong>:=BC=
=B4=C0=E0=D0=CD=CE=AAT=B5=C4<code style=3D"font-size: 0.875rem; b=
ackground-color: rgb(64, 64, 65) !important;">=B5=A5=D6=B5</code>=
=D7=B4=CC=AC=A1=A3=D5=E2=B8=F6=D7=B4=CC=AC=D3=EB=B6=D4=D3=A6=B5=C4=
key=B0=F3=B6=A8=A3=AC=CA=C7=D7=EE=BC=F2=B5=A5=B5=C4=D7=B4=CC=AC=C1=
=CB=A1=A3=CB=FC=BF=C9=D2=D4=CD=A8=B9=FD<code style=3D"font-size:=20=
0.875rem; background-color: rgb(64, 64, 65) !important;">update</=
code>=B7=BD=B7=A8=B8=FC=D0=C2=D7=B4=CC=AC=D6=B5=A3=AC=CD=A8=B9=FD=
<code style=3D"font-size: 0.875rem; background-color: rgb(64, 64,=
 65) !important;">value()</code>=B7=BD=B7=A8=BB=F1=C8=A1=D7=B4=CC=
=AC=D6=B5</p></li><li style=3D"background: rgb(38, 39, 40) !impor=
tant;"><p style=3D"font-size: 1.125rem;"><strong>ListState</stron=
g>:=BC=B4key=C9=CF=B5=C4=D7=B4=CC=AC=D6=B5=CE=AA=D2=BB=B8=F6=C1=D0=
=B1=ED=A1=A3=BF=C9=D2=D4=CD=A8=B9=FDadd=B7=BD=B7=A8=CD=F9=C1=D0=B1=
=ED=D6=D0=B8=BD=BC=D3=D6=B5=A3=BB=D2=B2=BF=C9=D2=D4=CD=A8=B9=FDge=
t()=B7=BD=B7=A8=B7=B5=BB=D8=D2=BB=B8=F6Iterable=C0=B4=B1=E9=C0=FA=
=D7=B4=CC=AC=D6=B5</p></li><li style=3D"background: rgb(38, 39, 4=
0) !important;"><p style=3D"font-size: 1.125rem;"><strong>Reducin=
gState</strong><span>&nbsp;</span>:=D5=E2=D6=D6=D7=B4=CC=AC=CD=A8=
=B9=FD=D3=C3=BB=A7=B4=AB=C8=EB=B5=C4reduceFunction=A3=AC=C3=BF=B4=
=CE=B5=F7=D3=C3add=B7=BD=B7=A8=CC=ED=BC=D3=D6=B5=B5=C4=CA=B1=BA=F2=
=A3=AC=BB=E1=B5=F7=D3=C3reduceFunction=A3=AC=D7=EE=BA=F3=BA=CF=B2=
=A2=B5=BD=D2=BB=B8=F6=B5=A5=D2=BB=B5=C4=D7=B4=CC=AC=D6=B5</p></li=
><li style=3D"background: rgb(38, 39, 40) !important;"><p style=3D=
"font-size: 1.125rem;"><strong>MapState&lt;UK, UV&gt;</strong>:=BC=
=B4=D7=B4=CC=AC=D6=B5=CE=AA=D2=BB=B8=F6map=A1=A3=D3=C3=BB=A7=CD=A8=
=B9=FDput=BB=F2putAll=B7=BD=B7=A8=CC=ED=BC=D3=D4=AA=CB=D8</p></li=
></ul><p style=3D"font-size:1.125rem;color:rgb(180, 180, 180) !im=
portant;">=CB=F9=D3=D0=C0=E0=D0=CD=B5=C4=D7=B4=CC=AC=BB=B9=D3=D0=D2=
=BB=B8=F6clear() =B7=BD=B7=A8=A3=AC=C7=E5=B3=FD=B5=B1=C7=B0 key =CF=
=C2=B5=C4=D7=B4=CC=AC=CA=FD=BE=DD=A3=AC=D2=B2=BE=CD=CA=C7=B5=B1=C7=
=B0=CA=E4=C8=EB=D4=AA=CB=D8=B5=C4 key=A1=A3</p><p style=3D"font-s=
ize:1.125rem;color:rgb(180, 180, 180) !important;">=D0=E8=D2=AA=D7=
=A2=D2=E2=B5=C4=CA=C7=A3=AC=D2=D4=C9=CF=CB=F9=CA=F6=B5=C4State=B6=
=D4=CF=F3=A3=AC=BD=F6=BD=F6=D3=C3=D3=DA=D3=EB=D7=B4=CC=AC=BD=F8=D0=
=D0=BD=BB=BB=A5=A3=A8=B8=FC=D0=C2=A1=A2=C9=BE=B3=FD=A1=A2=C7=E5=BF=
=D5=B5=C8=A3=A9=A3=AC=B6=F8=D5=E6=D5=FD=B5=C4=D7=B4=CC=AC=D6=B5=A3=
=AC=D3=D0=BF=C9=C4=DC=CA=C7=B4=E6=D4=DA=C4=DA=B4=E6=A1=A2=B4=C5=C5=
=CC=A1=A2=BB=F2=D5=DF=C6=E4=CB=FB=B7=D6=B2=BC=CA=BD=B4=E6=B4=A2=CF=
=B5=CD=B3=D6=D0=A1=A3=CF=E0=B5=B1=D3=DA=CE=D2=C3=C7=D6=BB=CA=C7<s=
trong>=B3=D6=D3=D0=C1=CB=D5=E2=B8=F6=D7=B4=CC=AC=B5=C4=BE=E4=B1=FA=
</strong><span>&nbsp;</span>.</p><p style=3D"font-size:1.125rem;c=
olor:rgb(180, 180, 180) !important;">=C4=E3=B1=D8=D0=EB=B4=B4=BD=A8=
=D2=BB=B8=F6 StateDescriptor=A3=AC=B2=C5=C4=DC=B5=C3=B5=BD=B6=D4=D3=
=A6=B5=C4=D7=B4=CC=AC=BE=E4=B1=FA=A1=A3 =D5=E2=B1=A3=B4=E6=C1=CB=D7=
=B4=CC=AC=C3=FB=B3=C6=A3=A8=D5=FD=C8=E7=CE=D2=C3=C7=C9=D4=BA=F3=BD=
=AB=BF=B4=B5=BD=B5=C4=A3=AC=C4=E3=BF=C9=D2=D4=B4=B4=BD=A8=B6=E0=B8=
=F6=D7=B4=CC=AC=A3=AC=B2=A2=C7=D2=CB=FC=C3=C7=B1=D8=D0=EB=BE=DF=D3=
=D0=CE=A8=D2=BB=B5=C4=C3=FB=B3=C6=D2=D4=B1=E3=BF=C9=D2=D4=D2=FD=D3=
=C3=CB=FC=C3=C7=A3=A9=A3=AC =D7=B4=CC=AC=CB=F9=B3=D6=D3=D0=D6=B5=B5=
=C4=C0=E0=D0=CD=A3=AC=B2=A2=C7=D2=BF=C9=C4=DC=B0=FC=BA=AC=D3=C3=BB=
=A7=D6=B8=B6=A8=B5=C4=BA=AF=CA=FD=A3=AC=C0=FD=C8=E7ReduceFunction=
=A1=A3 =B8=F9=BE=DD=B2=BB=CD=AC=B5=C4=D7=B4=CC=AC=C0=E0=D0=CD=A3=AC=
=BF=C9=D2=D4=B4=B4=BD=A8ValueStateDescriptor=A3=ACListStateDescri=
ptor=A3=AC ReducingStateDescriptor =BB=F2 MapStateDescriptor=A1=A3=
</p><p style=3D"font-size:1.125rem;color:rgb(180, 180, 180) !impo=
rtant;">=D7=B4=CC=AC=CD=A8=B9=FD RuntimeContext =BD=F8=D0=D0=B7=C3=
=CE=CA=A3=AC=D2=F2=B4=CB=D6=BB=C4=DC=D4=DA rich functions =D6=D0=CA=
=B9=D3=C3=A1=A3=C7=EB=B2=CE=D4=C4=D5=E2=C0=EF=BB=F1=C8=A1=CF=E0=B9=
=D8=D0=C5=CF=A2=A3=AC =B5=AB=CA=C7=CE=D2=C3=C7=BA=DC=BF=EC=D2=B2=BB=
=E1=BF=B4=B5=BD=D2=BB=B8=F6=C0=FD=D7=D3=A1=A3RichFunction =D6=D0=20=
RuntimeContext =CC=E1=B9=A9=C8=E7=CF=C2=B7=BD=B7=A8=A3=BA</p><p s=
tyle=3D"font-size:1.125rem;color:rgb(180, 180, 180) !important;">=
<strong>RichFunction =D6=D0 RuntimeContext =CC=E1=B9=A9=C8=E7=CF=C2=
=B7=BD=B7=A8=A3=BA</strong></p><ul style=3D"color: rgb(180, 180,=20=
180) !important;"><li style=3D"background: rgb(38, 39, 40) !impor=
tant;">ValueState getState(ValueStateDescriptor)</li><li style=3D=
"background: rgb(38, 39, 40) !important;">ReducingState getReduci=
ngState(ReducingStateDescriptor)</li><li style=3D"background: rgb=
(38, 39, 40) !important;">ListState getListState(ListStateDescrip=
tor)</li><li style=3D"background: rgb(38, 39, 40) !important;">Ag=
gregatingState&lt;IN, OUT&gt; getAggregatingState(AggregatingStat=
eDescriptor&lt;IN, ACC, OUT&gt;)</li><li style=3D"background: rgb=
(38, 39, 40) !important;">MapState&lt;UK, UV&gt; getMapState(MapS=
tateDescriptor&lt;UK, UV&gt;)</li></ul></div><p style=3D"color:rg=
b(180, 180, 180) !important;background:rgb(38, 39, 40) !important=
;font-size:1.125rem"><strong>=CA=BE=C0=FD :</strong></p><div><br>=
</div><div style=3D"color:gray;"><small>=C0=B4=D4=B4=A3=BA&nbsp;<=
a href=3D"https://zhangboyi.blog.csdn.net/article/details/1145387=
17">https://zhangboyi.blog.csdn.net/article/details/114538717</a>=
</small></div><div  data-mode=3D"JavaScript" data-theme=3D"defaul=
t" id=3D"wiz_cm_1623250704656_6170" class=3D"wiz-code-container">=
<textarea style=3D"display: none;">=0Aimport org.apache.flink.api=
.common.functions.RichFlatMapFunction=0Aimport org.apache.flink.a=
pi.common.state.{ValueState, ValueStateDescriptor}=0Aimport org.a=
pache.flink.configuration.Configuration=0Aimport org.apache.flink=
.streaming.api.scala.StreamExecutionEnvironment=0Aimport org.apac=
he.flink.api.scala._=0Aimport org.apache.flink.util.Collector=0A=0A=
=0A/**=0A *=0A * =CA=B5=CF=D6=C1=CB=D2=BB=B8=F6=BC=F2=B5=A5=B5=C4=
=BC=C6=CA=FD=B4=B0=BF=DA=A1=A3 =CE=D2=C3=C7=B0=D1=D4=AA=D7=E9=B5=C4=
=B5=DA=D2=BB=B8=F6=D4=AA=CB=D8=B5=B1=D7=F7 key=A3=A8=D4=DA=CA=BE=C0=
=FD=D6=D0=B6=BC key =B6=BC=CA=C7 =A1=B01=A1=B1=A3=A9=A1=A3=0A * =B8=
=C3=BA=AF=CA=FD=BD=AB=B3=F6=CF=D6=B5=C4=B4=CE=CA=FD=D2=D4=BC=B0=D7=
=DC=BA=CD=B4=E6=B4=A2=D4=DA =A1=B0ValueState=A1=B1 =D6=D0=A1=A3=0A=
 * =D2=BB=B5=A9=B3=F6=CF=D6=B4=CE=CA=FD=B4=EF=B5=BD 2=A3=AC=D4=F2=
=BD=AB=C6=BD=BE=F9=D6=B5=B7=A2=CB=CD=B5=BD=CF=C2=D3=CE=A3=AC=B2=A2=
=C7=E5=B3=FD=D7=B4=CC=AC=D6=D8=D0=C2=BF=AA=CA=BC=A1=A3=0A *=0A *=20=
=C7=EB=D7=A2=D2=E2=A3=AC=CE=D2=C3=C7=BB=E1=CE=AA=C3=BF=B8=F6=B2=BB=
=CD=AC=B5=C4 key=A3=A8=D4=AA=D7=E9=D6=D0=B5=DA=D2=BB=B8=F6=D4=AA=CB=
=D8=A3=A9=B1=A3=B4=E6=D2=BB=B8=F6=B5=A5=B6=C0=B5=C4=D6=B5=A1=A3=0A=
 *=0A */=0Aclass CountWindowAverage extends RichFlatMapFunction[(=
Long,Long),(Long,Long)] {=0A=0A  private var sum : ValueState[(Lo=
ng,Long)] =3D _=0A=0A  override def flatMap(input: (Long, Long),=20=
out : Collector[(Long, Long)]): Unit =3D {=0A    // =BB=F1=C8=A1=B5=
=B1=C7=B0=B5=C4=D7=B4=CC=AC=D6=B5=0A    val tmpCurrentSum =3D sum=
.value()=0A=0A    val currentSum =3D if(tmpCurrentSum !=3D null)=20=
{=0A      tmpCurrentSum=0A    }else{=0A      (0L,0L)=0A    }=0A=0A=
    // =BB=F1=C8=A1=B5=B1=C7=B0=D6=B5=0A    val newSum =3D (curre=
ntSum._1 + 1, currentSum._2 + input._2)=0A=0A    // =B8=FC=D0=C2s=
tate=0A    sum.update(newSum)=0A=0A=0A    // =C8=E7=B9=FB=BC=C6=CB=
=E3=B4=EF=B5=BD2, =BC=C6=CB=E3=C6=BD=BE=F9=D6=B5,=B2=A2=C7=E5=B3=FD=
state=0A    if (newSum._1 &gt;=3D 2) {=0A      out.collect((input=
._1,newSum._2/newSum._1))=0A      sum.clear()=0A    }=0A=0A=0A=0A=
  }=0A=0A  override def open(parameters: Configuration): Unit =3D=
 {=0A    sum =3D getRuntimeContext.getState(=0A      new ValueSta=
teDescriptor[(Long, Long)]("average", createTypeInformation[(Long=
, Long)])=0A    )=0A  }=0A=0A}=0A=0A=0Aobject ExampleCountWindowA=
verage extends  App {=0A=0A  val env =3D StreamExecutionEnvironme=
nt.getExecutionEnvironment=0A=0A  env.fromCollection(List(=0A   =20=
(1L, 3L),=0A    (1L, 5L),=0A    (1L, 7L),=0A    (1L, 4L),=0A    (=
1L, 2L)=0A  )).keyBy(_._1)=0A    .flatMap(new CountWindowAverage(=
))=0A    .print()=0A=0A  // the printed output will be (1,4) and=20=
(1,5)=0A=0A  env.execute("ExampleKeyedState")=0A}=0A=0A</textarea=
><wiz_code_mirror><div class=3D"CodeMirror cm-s-default CodeMirro=
r-wrap CodeMirror-focused" data-id=3D"wiz_cm_1623250704656_6170">=
<div style=3D"overflow: hidden; position: relative; width: 3px; h=
eight: 0px; top: 1791px; left: 34px;"><textarea autocorrect=3D"of=
f" autocapitalize=3D"off" spellcheck=3D"false" style=3D"position:=
 absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em=
; outline: none;" tabindex=3D"0"></textarea></div><div class=3D"C=
odeMirror-scrollbar-filler" cm-not-content=3D"true"></div><div cl=
ass=3D"CodeMirror-gutter-filler" cm-not-content=3D"true"></div><d=
iv class=3D"CodeMirror-scroll" tabindex=3D"-1"><div class=3D"Code=
Mirror-sizer" style=3D"margin-left: 30px; margin-bottom: 0px; bor=
der-right-width: 30px; min-height: 1802px; padding-right: 0px; pa=
dding-bottom: 0px;"><div style=3D"position: relative; top: 0px;">=
<div class=3D"CodeMirror-lines" role=3D"presentation"><div role=3D=
"presentation" style=3D"position: relative; outline: none;"><div=20=
class=3D"CodeMirror-measure"><pre>x</pre><div class=3D"CodeMirror=
-linenumber CodeMirror-gutter-elt"><div>78</div></div></div><div=20=
class=3D"CodeMirror-measure"></div><div style=3D"position: relati=
ve; z-index: 1;"></div><div class=3D" wiz-hide wiz_CodeMirror-cur=
sors" style=3D"visibility: hidden;"><div class=3D"CodeMirror-curs=
or" style=3D"left: 4px; top: 1771px; height: 23px;">&nbsp;</div><=
/div><div class=3D"CodeMirror-code" role=3D"presentation"><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">1</div></d=
iv><pre class=3D"CodeMirror-line" role=3D"presentation"><span rol=
e=3D"presentation" style=3D"padding-right: 0.1px;"><span cm-text=3D=
""></span></span></pre></div><div style=3D"position: relative;"><=
div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><d=
iv class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">2</div></div><pre class=3D"CodeMirror-l=
ine" role=3D"presentation"><span role=3D"presentation" style=3D"p=
adding-right: 0.1px;"><span class=3D"cm-keyword">import</span> <s=
pan class=3D"cm-def">org</span>.<span class=3D"cm-variable">apach=
e</span>.<span class=3D"cm-property">flink</span>.<span class=3D"=
cm-property">api</span>.<span class=3D"cm-property">common</span>=
.<span class=3D"cm-property">functions</span>.<span class=3D"cm-p=
roperty">RichFlatMapFunction</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">3</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-ke=
yword">import</span> <span class=3D"cm-def">org</span>.<span clas=
s=3D"cm-variable">apache</span>.<span class=3D"cm-property">flink=
</span>.<span class=3D"cm-property">api</span>.<span class=3D"cm-=
property">common</span>.<span class=3D"cm-property">state</span>.=
{<span class=3D"cm-variable">ValueState</span>, <span class=3D"cm=
-variable">ValueStateDescriptor</span>}</span></pre></div><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">4</div></d=
iv><pre class=3D"CodeMirror-line" role=3D"presentation"><span rol=
e=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-keyword">import</span> <span class=3D"cm-def">org</span>.<spa=
n class=3D"cm-variable">apache</span>.<span class=3D"cm-property"=
>flink</span>.<span class=3D"cm-property">configuration</span>.<s=
pan class=3D"cm-property">Configuration</span></span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">5</=
div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><s=
pan role=3D"presentation" style=3D"padding-right: 0.1px;"><span c=
lass=3D"cm-keyword">import</span> <span class=3D"cm-def">org</spa=
n>.<span class=3D"cm-variable">apache</span>.<span class=3D"cm-pr=
operty">flink</span>.<span class=3D"cm-property">streaming</span>=
.<span class=3D"cm-property">api</span>.<span class=3D"cm-propert=
y">scala</span>.<span class=3D"cm-property">StreamExecutionEnviro=
nment</span></span></pre></div><div style=3D"position: relative;"=
><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;">=
<div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">6</div></div><pre class=3D"CodeMirror-l=
ine" role=3D"presentation"><span role=3D"presentation" style=3D"p=
adding-right: 0.1px;"><span class=3D"cm-keyword">import</span> <s=
pan class=3D"cm-def">org</span>.<span class=3D"cm-variable">apach=
e</span>.<span class=3D"cm-property">flink</span>.<span class=3D"=
cm-property">api</span>.<span class=3D"cm-property">scala</span>.=
<span class=3D"cm-property">_</span></span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">7</div></div>=
<pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-=
keyword">import</span> <span class=3D"cm-def">org</span>.<span cl=
ass=3D"cm-variable">apache</span>.<span class=3D"cm-property">fli=
nk</span>.<span class=3D"cm-property">util</span>.<span class=3D"=
cm-property">Collector</span></span></pre></div><div style=3D"pos=
ition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">8</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"><span cm-text=3D""></span>=
</span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">9</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span cm-text=3D""></span></span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">10</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-=
comment">/**</span></span></pre></div><div style=3D"position: rel=
ative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -=
30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=
 style=3D"left: 0px; width: 21px;">11</div></div><pre class=3D"Co=
deMirror-line" role=3D"presentation"><span role=3D"presentation"=20=
style=3D"padding-right: 0.1px;"><span class=3D"cm-comment"> *</sp=
an></span></pre></div><div style=3D"position: relative;"><div cla=
ss=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div clas=
s=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=20=
0px; width: 21px;">12</div></div><pre class=3D"CodeMirror-line" r=
ole=3D"presentation"><span role=3D"presentation" style=3D"padding=
-right: 0.1px;"><span class=3D"cm-comment"> * =CA=B5=CF=D6=C1=CB=D2=
=BB=B8=F6=BC=F2=B5=A5=B5=C4=BC=C6=CA=FD=B4=B0=BF=DA=A1=A3 =CE=D2=C3=
=C7=B0=D1=D4=AA=D7=E9=B5=C4=B5=DA=D2=BB=B8=F6=D4=AA=CB=D8=B5=B1=D7=
=F7 key=A3=A8=D4=DA=CA=BE=C0=FD=D6=D0=B6=BC key =B6=BC=CA=C7 =A1=B0=
1=A1=B1=A3=A9=A1=A3</span></span></pre></div><div style=3D"positi=
on: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"=
left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutt=
er-elt" style=3D"left: 0px; width: 21px;">13</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"><span class=3D"cm-comment"=
> * =B8=C3=BA=AF=CA=FD=BD=AB=B3=F6=CF=D6=B5=C4=B4=CE=CA=FD=D2=D4=BC=
=B0=D7=DC=BA=CD=B4=E6=B4=A2=D4=DA =A1=B0ValueState=A1=B1 =D6=D0=A1=
=A3</span></span></pre></div><div style=3D"position: relative;"><=
div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><d=
iv class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">14</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"><span class=3D"cm-comment"> * =D2=BB=B5=A9=
=B3=F6=CF=D6=B4=CE=CA=FD=B4=EF=B5=BD 2=A3=AC=D4=F2=BD=AB=C6=BD=BE=
=F9=D6=B5=B7=A2=CB=CD=B5=BD=CF=C2=D3=CE=A3=AC=B2=A2=C7=E5=B3=FD=D7=
=B4=CC=AC=D6=D8=D0=C2=BF=AA=CA=BC=A1=A3</span></span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">15<=
/div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><=
span role=3D"presentation" style=3D"padding-right: 0.1px;"><span=20=
class=3D"cm-comment"> *</span></span></pre></div><div style=3D"po=
sition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=
=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt" style=3D"left: 0px; width: 21px;">16</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-comm=
ent"> * =C7=EB=D7=A2=D2=E2=A3=AC=CE=D2=C3=C7=BB=E1=CE=AA=C3=BF=B8=
=F6=B2=BB=CD=AC=B5=C4 key=A3=A8=D4=AA=D7=E9=D6=D0=B5=DA=D2=BB=B8=F6=
=D4=AA=CB=D8=A3=A9=B1=A3=B4=E6=D2=BB=B8=F6=B5=A5=B6=C0=B5=C4=D6=B5=
=A1=A3</span></span></pre></div><div style=3D"position: relative;=
"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"=
><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=
=3D"left: 0px; width: 21px;">17</div></div><pre class=3D"CodeMirr=
or-line" role=3D"presentation"><span role=3D"presentation" style=3D=
"padding-right: 0.1px;"><span class=3D"cm-comment"> *</span></spa=
n></pre></div><div style=3D"position: relative;"><div class=3D"Co=
deMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Cod=
eMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wid=
th: 21px;">18</div></div><pre class=3D"CodeMirror-line" role=3D"p=
resentation"><span role=3D"presentation" style=3D"padding-right:=20=
0.1px;"><span class=3D"cm-comment"> */</span></span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">19</=
div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><s=
pan role=3D"presentation" style=3D"padding-right: 0.1px;"><span c=
lass=3D"cm-keyword">class</span> <span class=3D"cm-def">CountWind=
owAverage</span> <span class=3D"cm-keyword">extends</span> <span=20=
class=3D"cm-variable">RichFlatMapFunction</span>[(<span class=3D"=
cm-variable">Long</span>,<span class=3D"cm-variable">Long</span>)=
,(<span class=3D"cm-variable">Long</span>,<span class=3D"cm-varia=
ble">Long</span>)] {</span></pre></div><div style=3D"position: re=
lative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=20=
-30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt=
" style=3D"left: 0px; width: 21px;">20</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span=
></pre></div><div style=3D"position: relative;"><div class=3D"Cod=
eMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Code=
Mirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; widt=
h: 21px;">21</div></div><pre class=3D"CodeMirror-line" role=3D"pr=
esentation"><span role=3D"presentation" style=3D"padding-right: 0=
.1px;"> &nbsp;<span class=3D"cm-property">private</span> <span cl=
ass=3D"cm-property">var</span> <span class=3D"cm-def">sum</span>=20=
: <span class=3D"cm-variable">ValueState</span>[(<span class=3D"c=
m-variable">Long</span>,<span class=3D"cm-variable">Long</span>)]=
 <span class=3D"cm-operator">=3D</span> <span class=3D"cm-variabl=
e">_</span></span></pre></div><div style=3D"position: relative;">=
<div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><=
div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">22</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"><span cm-text=3D""></span></span></pre></d=
iv><div style=3D"position: relative;"><div class=3D"CodeMirror-gu=
tter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-lin=
enumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">=
23</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"> &n=
bsp;<span class=3D"cm-variable">override</span> <span class=3D"cm=
-variable">def</span> <span class=3D"cm-variable">flatMap</span>(=
<span class=3D"cm-variable">input</span>: (<span class=3D"cm-vari=
able">Long</span>, <span class=3D"cm-variable">Long</span>), <spa=
n class=3D"cm-variable">out</span> : <span class=3D"cm-variable">=
Collector</span>[(<span class=3D"cm-variable">Long</span>, <span=20=
class=3D"cm-variable">Long</span>)]): <span class=3D"cm-variable"=
>Unit</span> <span class=3D"cm-operator">=3D</span> {</span></pre=
></div><div style=3D"position: relative;"><div class=3D"CodeMirro=
r-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror=
-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21p=
x;">24</div></div><pre class=3D"CodeMirror-line" role=3D"presenta=
tion"><span role=3D"presentation" style=3D"padding-right: 0.1px;"=
> &nbsp; &nbsp;<span class=3D"cm-comment">// =BB=F1=C8=A1=B5=B1=C7=
=B0=B5=C4=D7=B4=CC=AC=D6=B5</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">25</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span=
 class=3D"cm-property">val</span> <span class=3D"cm-variable">tmp=
CurrentSum</span> <span class=3D"cm-operator">=3D</span> <span cl=
ass=3D"cm-variable">sum</span>.<span class=3D"cm-variable">value<=
/span>()</span></pre></div><div style=3D"position: relative;"><di=
v class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=
 class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"l=
eft: 0px; width: 21px;">26</div></div><pre class=3D"CodeMirror-li=
ne" role=3D"presentation"><span role=3D"presentation" style=3D"pa=
dding-right: 0.1px;"><span cm-text=3D""></span></span></pre></div=
><div style=3D"position: relative;"><div class=3D"CodeMirror-gutt=
er-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linen=
umber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">27=
</div></div><pre class=3D"CodeMirror-line" role=3D"presentation">=
<span role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbs=
p; &nbsp;<span class=3D"cm-variable">val</span> <span class=3D"cm=
-variable">currentSum</span> <span class=3D"cm-operator">=3D</spa=
n> <span class=3D"cm-keyword">if</span>(<span class=3D"cm-variabl=
e">tmpCurrentSum</span> <span class=3D"cm-operator">!=3D</span> <=
span class=3D"cm-atom">null</span>) {</span></pre></div><div styl=
e=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper=
" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Code=
Mirror-gutter-elt" style=3D"left: 0px; width: 21px;">28</div></di=
v><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=
=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;=20=
&nbsp;<span class=3D"cm-variable">tmpCurrentSum</span></span></pr=
e></div><div style=3D"position: relative;"><div class=3D"CodeMirr=
or-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">29</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"> &nbsp;  }<span class=3D"cm-keyword">else</span>{</span></pre><=
/div><div style=3D"position: relative;"><div class=3D"CodeMirror-=
gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-l=
inenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;=
">30</div></div><pre class=3D"CodeMirror-line" role=3D"presentati=
on"><span role=3D"presentation" style=3D"padding-right: 0.1px;">=20=
&nbsp; &nbsp;  (<span class=3D"cm-number">0</span><span class=3D"=
cm-variable">L</span>,<span class=3D"cm-number">0</span><span cla=
ss=3D"cm-variable">L</span>)</span></pre></div><div style=3D"posi=
tion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">31</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"> &nbsp;  }</span></pre></=
div><div style=3D"position: relative;"><div class=3D"CodeMirror-g=
utter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-li=
nenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;"=
>32</div></div><pre class=3D"CodeMirror-line" role=3D"presentatio=
n"><span role=3D"presentation" style=3D"padding-right: 0.1px;"><s=
pan cm-text=3D""></span></span></pre></div><div style=3D"position=
: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"le=
ft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter=
-elt" style=3D"left: 0px; width: 21px;">33</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"c=
m-comment">// =BB=F1=C8=A1=B5=B1=C7=B0=D6=B5</span></span></pre><=
/div><div style=3D"position: relative;"><div class=3D"CodeMirror-=
gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-l=
inenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;=
">34</div></div><pre class=3D"CodeMirror-line" role=3D"presentati=
on"><span role=3D"presentation" style=3D"padding-right: 0.1px;">=20=
&nbsp; &nbsp;<span class=3D"cm-variable">val</span> <span class=3D=
"cm-variable">newSum</span> <span class=3D"cm-operator">=3D</span=
> (<span class=3D"cm-variable">currentSum</span>.<span class=3D"c=
m-property">_1</span> <span class=3D"cm-operator">+</span> <span=20=
class=3D"cm-number">1</span>, <span class=3D"cm-variable">current=
Sum</span>.<span class=3D"cm-property">_2</span> <span class=3D"c=
m-operator">+</span> <span class=3D"cm-variable">input</span>.<sp=
an class=3D"cm-property">_2</span>)</span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">35</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"><span cm-text=3D"">=
</span></span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">36</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-comment">// =B8=
=FC=D0=C2state</span></span></pre></div><div style=3D"position: r=
elative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=
 -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-el=
t" style=3D"left: 0px; width: 21px;">37</div></div><pre class=3D"=
CodeMirror-line" role=3D"presentation"><span role=3D"presentation=
" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm=
-variable">sum</span>.<span class=3D"cm-property">update</span>(<=
span class=3D"cm-variable">newSum</span>)</span></pre></div><div=20=
style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wra=
pper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=20=
CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">38</div>=
</div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=20=
role=3D"presentation" style=3D"padding-right: 0.1px;"><span cm-te=
xt=3D""></span></span></pre></div><div style=3D"position: relativ=
e;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px=
;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" sty=
le=3D"left: 0px; width: 21px;">39</div></div><pre class=3D"CodeMi=
rror-line" role=3D"presentation"><span role=3D"presentation" styl=
e=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span></pr=
e></div><div style=3D"position: relative;"><div class=3D"CodeMirr=
or-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">40</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"> &nbsp; &nbsp;<span class=3D"cm-comment">// =C8=E7=B9=FB=BC=C6=CB=
=E3=B4=EF=B5=BD2, =BC=C6=CB=E3=C6=BD=BE=F9=D6=B5,=B2=A2=C7=E5=B3=FD=
state</span></span></pre></div><div style=3D"position: relative;"=
><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;">=
<div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">41</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-keyword">i=
f</span> (<span class=3D"cm-variable">newSum</span>.<span class=3D=
"cm-property">_1</span> <span class=3D"cm-operator">&gt;=3D</span=
> <span class=3D"cm-number">2</span>) {</span></pre></div><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">42</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp=
; &nbsp;<span class=3D"cm-variable">out</span>.<span class=3D"cm-=
property">collect</span>((<span class=3D"cm-variable">input</span=
>.<span class=3D"cm-property">_1</span>,<span class=3D"cm-variabl=
e">newSum</span>.<span class=3D"cm-property">_2</span><span class=
=3D"cm-operator">/</span><span class=3D"cm-variable">newSum</span=
>.<span class=3D"cm-property">_1</span>))</span></pre></div><div=20=
style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wra=
pper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=20=
CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">43</div>=
</div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=20=
role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nb=
sp; &nbsp;<span class=3D"cm-variable">sum</span>.<span class=3D"c=
m-property">clear</span>()</span></pre></div><div style=3D"positi=
on: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"=
left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutt=
er-elt" style=3D"left: 0px; width: 21px;">44</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"> &nbsp;  }</span></pre></d=
iv><div style=3D"position: relative;"><div class=3D"CodeMirror-gu=
tter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-lin=
enumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">=
45</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"><sp=
an cm-text=3D""></span></span></pre></div><div style=3D"position:=
 relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"lef=
t: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-=
elt" style=3D"left: 0px; width: 21px;">46</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></sp=
an></pre></div><div style=3D"position: relative;"><div class=3D"C=
odeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">47</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;"><span cm-text=3D""></span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">48</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;">  }</span></pre></d=
iv><div style=3D"position: relative;"><div class=3D"CodeMirror-gu=
tter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-lin=
enumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">=
49</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"><sp=
an cm-text=3D""></span></span></pre></div><div style=3D"position:=
 relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"lef=
t: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-=
elt" style=3D"left: 0px; width: 21px;">50</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp;<span class=3D"cm-varia=
ble">override</span> <span class=3D"cm-variable">def</span> <span=
 class=3D"cm-variable">open</span>(<span class=3D"cm-variable">pa=
rameters</span>: <span class=3D"cm-variable">Configuration</span>=
): <span class=3D"cm-variable">Unit</span> <span class=3D"cm-oper=
ator">=3D</span> {</span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">51</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-pr=
operty">sum</span> <span class=3D"cm-operator">=3D</span> <span c=
lass=3D"cm-variable">getRuntimeContext</span>.<span class=3D"cm-v=
ariable">getState</span>(</span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">52</div></div><pre class=
=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presenta=
tion" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span=20=
class=3D"cm-keyword">new</span> <span class=3D"cm-variable">Value=
StateDescriptor</span>[(<span class=3D"cm-variable">Long</span>,=20=
<span class=3D"cm-variable">Long</span>)](<span class=3D"cm-strin=
g">"average"</span>, <span class=3D"cm-variable">createTypeInform=
ation</span>[(<span class=3D"cm-variable">Long</span>, <span clas=
s=3D"cm-variable">Long</span>)])</span></pre></div><div style=3D"=
position: relative;"><div class=3D"CodeMirror-gutter-wrapper" sty=
le=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirro=
r-gutter-elt" style=3D"left: 0px; width: 21px;">53</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"> &nbsp;  )</span></p=
re></div><div style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">54</div></div><pre class=3D"CodeMirror-line" role=3D"presen=
tation"><span role=3D"presentation" style=3D"padding-right: 0.1px=
;">  }</span></pre></div><div style=3D"position: relative;"><div=20=
class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div c=
lass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"lef=
t: 0px; width: 21px;">55</div></div><pre class=3D"CodeMirror-line=
" role=3D"presentation"><span role=3D"presentation" style=3D"padd=
ing-right: 0.1px;"><span cm-text=3D""></span></span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">56</=
div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><s=
pan role=3D"presentation" style=3D"padding-right: 0.1px;">}</span=
></pre></div><div style=3D"position: relative;"><div class=3D"Cod=
eMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Code=
Mirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; widt=
h: 21px;">57</div></div><pre class=3D"CodeMirror-line" role=3D"pr=
esentation"><span role=3D"presentation" style=3D"padding-right: 0=
.1px;"><span cm-text=3D""></span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">58</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"><span cm-text=3D"">=
</span></span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">59</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;"><span class=3D"cm-variable">object</span> <sp=
an class=3D"cm-variable">ExampleCountWindowAverage</span> <span c=
lass=3D"cm-keyword">extends</span> &nbsp;<span class=3D"cm-variab=
le">App</span> {</span></pre></div><div style=3D"position: relati=
ve;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30p=
x;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" st=
yle=3D"left: 0px; width: 21px;">60</div></div><pre class=3D"CodeM=
irror-line" role=3D"presentation"><span role=3D"presentation" sty=
le=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span></p=
re></div><div style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">61</div></div><pre class=3D"CodeMirror-line" role=3D"presen=
tation"><span role=3D"presentation" style=3D"padding-right: 0.1px=
;"> &nbsp;<span class=3D"cm-variable">val</span> <span class=3D"c=
m-variable">env</span> <span class=3D"cm-operator">=3D</span> <sp=
an class=3D"cm-variable">StreamExecutionEnvironment</span>.<span=20=
class=3D"cm-property">getExecutionEnvironment</span></span></pre>=
</div><div style=3D"position: relative;"><div class=3D"CodeMirror=
-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-=
linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px=
;">62</div></div><pre class=3D"CodeMirror-line" role=3D"presentat=
ion"><span role=3D"presentation" style=3D"padding-right: 0.1px;">=
<span cm-text=3D""></span></span></pre></div><div style=3D"positi=
on: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"=
left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutt=
er-elt" style=3D"left: 0px; width: 21px;">63</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"> &nbsp;<span class=3D"cm-v=
ariable">env</span>.<span class=3D"cm-property">fromCollection</s=
pan>(<span class=3D"cm-variable">List</span>(</span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">64</=
div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><s=
pan role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;=
  (<span class=3D"cm-number">1</span><span class=3D"cm-variable">=
L</span>, <span class=3D"cm-number">3</span><span class=3D"cm-var=
iable">L</span>),</span></pre></div><div style=3D"position: relat=
ive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30=
px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" s=
tyle=3D"left: 0px; width: 21px;">65</div></div><pre class=3D"Code=
Mirror-line" role=3D"presentation"><span role=3D"presentation" st=
yle=3D"padding-right: 0.1px;"> &nbsp;  (<span class=3D"cm-number"=
>1</span><span class=3D"cm-variable">L</span>, <span class=3D"cm-=
number">5</span><span class=3D"cm-variable">L</span>),</span></pr=
e></div><div style=3D"position: relative;"><div class=3D"CodeMirr=
or-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">66</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"> &nbsp;  (<span class=3D"cm-number">1</span><span class=3D"cm-v=
ariable">L</span>, <span class=3D"cm-number">7</span><span class=3D=
"cm-variable">L</span>),</span></pre></div><div style=3D"position=
: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"le=
ft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter=
-elt" style=3D"left: 0px; width: 21px;">67</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp;  (<span class=3D"cm-nu=
mber">1</span><span class=3D"cm-variable">L</span>, <span class=3D=
"cm-number">4</span><span class=3D"cm-variable">L</span>),</span>=
</pre></div><div style=3D"position: relative;"><div class=3D"Code=
Mirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeM=
irror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width=
: 21px;">68</div></div><pre class=3D"CodeMirror-line" role=3D"pre=
sentation"><span role=3D"presentation" style=3D"padding-right: 0.=
1px;"> &nbsp;  (<span class=3D"cm-number">1</span><span class=3D"=
cm-variable">L</span>, <span class=3D"cm-number">2</span><span cl=
ass=3D"cm-variable">L</span>)</span></pre></div><div style=3D"pos=
ition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">69</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;">  )).<span class=3D"cm-pr=
operty">keyBy</span>(<span class=3D"cm-variable">_</span>.<span c=
lass=3D"cm-property">_1</span>)</span></pre></div><div style=3D"p=
osition: relative;"><div class=3D"CodeMirror-gutter-wrapper" styl=
e=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror=
-gutter-elt" style=3D"left: 0px; width: 21px;">70</div></div><pre=
 class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pr=
esentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<span class=
=3D"cm-property">flatMap</span>(<span class=3D"cm-keyword">new</s=
pan> <span class=3D"cm-variable">CountWindowAverage</span>())</sp=
an></pre></div><div style=3D"position: relative;"><div class=3D"C=
odeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">71</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;"> &nbsp;  .<span class=3D"cm-property">print</span>()</sp=
an></pre></div><div style=3D"position: relative;"><div class=3D"C=
odeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">72</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;"><span cm-text=3D""></span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">73</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"> &nbsp;<span class=3D=
"cm-comment">// the printed output will be (1,4) and (1,5)</span>=
</span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">74</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span cm-text=3D""></span></span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">75</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"> &nbsp;<span class=
=3D"cm-variable">env</span>.<span class=3D"cm-property">execute</=
span>(<span class=3D"cm-string">"ExampleKeyedState"</span>)</span=
></pre></div><div style=3D"position: relative;"><div class=3D"Cod=
eMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Code=
Mirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; widt=
h: 21px;">76</div></div><pre class=3D"CodeMirror-line" role=3D"pr=
esentation"><span role=3D"presentation" style=3D"padding-right: 0=
.1px;">}</span></pre></div><div style=3D"position: relative;"><di=
v class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=
 class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"l=
eft: 0px; width: 21px;">77</div></div><pre class=3D"CodeMirror-li=
ne" role=3D"presentation"><span role=3D"presentation" style=3D"pa=
dding-right: 0.1px;"><span cm-text=3D""></span></span></pre></div=
><div class=3D"CodeMirror-activeline" style=3D"position: relative=
;"><div class=3D" wiz-hide wiz_CodeMirror-activeline-background C=
odeMirror-linebackground"></div><div class=3D"CodeMirror-gutter-b=
ackground CodeMirror-activeline-gutter" style=3D"left: -30px; wid=
th: 30px;"></div><div class=3D"CodeMirror-gutter-wrapper CodeMirr=
or-activeline-gutter" style=3D"left: -30px;"><div class=3D"CodeMi=
rror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=
 21px;">78</div></div><pre class=3D"CodeMirror-line" role=3D"pres=
entation"><span role=3D"presentation" style=3D"padding-right: 0.1=
px;"><span cm-text=3D""></span></span></pre></div></div></div></d=
iv></div></div><div style=3D"position: absolute; height: 13px; wi=
dth: 1px; border-bottom-width: 0px; border-bottom-style: solid; b=
order-bottom-color: transparent; top: 1802px;"></div><div class=3D=
"CodeMirror-gutters" style=3D"height: 1832px;"><div class=3D"Code=
Mirror-gutter CodeMirror-linenumbers" style=3D"width: 29px;"></di=
v></div></div></div></wiz_code_mirror></div><div id=3D"content_vi=
ews" class=3D"markdown_views prism-tomorrow-night" style=3D"color=
: rgb(196, 196, 200) !important; background: rgb(38, 39, 40) !imp=
ortant;"><h2 style=3D"font-size: 1.5rem; color: rgb(180, 180, 180=
) !important;">2.2. =D7=B4=CC=AC=D3=D0=D0=A7=C6=DA (TTL)</h2></di=
v><p style=3D"color:rgb(180, 180, 180) !important;background:rgb(=
38, 39, 40) !important;font-size:1.125rem">=C8=CE=BA=CE=C0=E0=D0=CD=
=B5=C4 keyed state =B6=BC=BF=C9=D2=D4=D3=D0 =D3=D0=D0=A7=C6=DA (T=
TL)=A1=A3=C8=E7=B9=FB=C5=E4=D6=C3=C1=CB TTL =C7=D2=D7=B4=CC=AC=D6=
=B5=D2=D1=B9=FD=C6=DA=A3=AC=D4=F2=BB=E1=BE=A1=D7=EE=B4=F3=BF=C9=C4=
=DC=C7=E5=B3=FD=B6=D4=D3=A6=B5=C4=D6=B5.<br>=CB=F9=D3=D0=D7=B4=CC=
=AC=C0=E0=D0=CD=B6=BC=D6=A7=B3=D6=B5=A5=D4=AA=CB=D8=B5=C4 TTL=A1=A3=
 =D5=E2=D2=E2=CE=B6=D7=C5=C1=D0=B1=ED=D4=AA=CB=D8=BA=CD=D3=B3=C9=E4=
=D4=AA=CB=D8=BD=AB=B6=C0=C1=A2=B5=BD=C6=DA=A1=A3</p><p style=3D"c=
olor:rgb(180, 180, 180) !important;background:rgb(38, 39, 40) !im=
portant;font-size:1.125rem">=D4=DA=CA=B9=D3=C3=D7=B4=CC=AC TTL =C7=
=B0=A3=AC=D0=E8=D2=AA=CF=C8=B9=B9=BD=A8=D2=BB=B8=F6StateTtlConfig=
 =C5=E4=D6=C3=B6=D4=CF=F3=A1=A3 =C8=BB=BA=F3=B0=D1=C5=E4=D6=C3=B4=
=AB=B5=DD=B5=BD state descriptor =D6=D0=C6=F4=D3=C3 TTL =B9=A6=C4=
=DC=A3=BA</p><div  data-mode=3D"JavaScript" data-theme=3D"default=
" id=3D"wiz_cm_1623250704633_1240" class=3D"wiz-code-container"><=
textarea style=3D"display: none;">import org.apache.flink.api.com=
mon.state.StateTtlConfig=0Aimport org.apache.flink.api.common.sta=
te.ValueStateDescriptor=0Aimport org.apache.flink.api.common.time=
.Time=0A=0Aval ttlConfig =3D StateTtlConfig=0A    .newBuilder(Tim=
e.seconds(1))=0A    .setUpdateType(StateTtlConfig.UpdateType.OnCr=
eateAndWrite)=0A    .setStateVisibility(StateTtlConfig.StateVisib=
ility.NeverReturnExpired)=0A    .build=0A    =0Aval stateDescript=
or =3D new ValueStateDescriptor[String]("text state", classOf[Str=
ing])=0AstateDescriptor.enableTimeToLive(ttlConfig)=0A=0A</textar=
ea><wiz_code_mirror><div class=3D"CodeMirror cm-s-default CodeMir=
ror-wrap" data-id=3D"wiz_cm_1623250704633_1240"><div style=3D"ove=
rflow: hidden; position: relative; width: 3px; height: 0px; top:=20=
20px; left: 34px;"><textarea autocorrect=3D"off" autocapitalize=3D=
"off" spellcheck=3D"false" style=3D"position: absolute; bottom: -=
1em; padding: 0px; width: 1000px; height: 1em; outline: none;" ta=
bindex=3D"0"></textarea></div><div class=3D"CodeMirror-scrollbar-=
filler" cm-not-content=3D"true"></div><div class=3D"CodeMirror-gu=
tter-filler" cm-not-content=3D"true"></div><div class=3D"CodeMirr=
or-scroll" tabindex=3D"-1"><div class=3D"CodeMirror-sizer" style=3D=
"margin-left: 30px; margin-bottom: 0px; border-right-width: 30px;=
 min-height: 330px; padding-right: 0px; padding-bottom: 0px;"><di=
v style=3D"position: relative; top: 0px;"><div class=3D"CodeMirro=
r-lines" role=3D"presentation"><div role=3D"presentation" style=3D=
"position: relative; outline: none;"><div class=3D"CodeMirror-mea=
sure"><pre>x</pre></div><div class=3D"CodeMirror-measure"></div><=
div style=3D"position: relative; z-index: 1;"></div><div class=3D=
" wiz-hide wiz_CodeMirror-cursors" style=3D"visibility: hidden;">=
<div class=3D"CodeMirror-cursor" style=3D"left: 4px; top: 0px; he=
ight: 23px;">&nbsp;</div></div><div class=3D"CodeMirror-code" rol=
e=3D"presentation"><div class=3D"CodeMirror-activeline" style=3D"=
position: relative;"><div class=3D" wiz-hide wiz_CodeMirror-activ=
eline-background CodeMirror-linebackground"></div><div class=3D"C=
odeMirror-gutter-background CodeMirror-activeline-gutter" style=3D=
"left: -30px; width: 30px;"></div><div class=3D"CodeMirror-gutter=
-wrapper CodeMirror-activeline-gutter" style=3D"left: -30px;"><di=
v class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"=
left: 0px; width: 21px;">1</div></div><pre class=3D"CodeMirror-li=
ne" role=3D"presentation"><span role=3D"presentation" style=3D"pa=
dding-right: 0.1px;"><span class=3D"cm-keyword">import</span> <sp=
an class=3D"cm-def">org</span>.<span class=3D"cm-variable">apache=
</span>.<span class=3D"cm-property">flink</span>.<span class=3D"c=
m-property">api</span>.<span class=3D"cm-property">common</span>.=
<span class=3D"cm-property">state</span>.<span class=3D"cm-proper=
ty">StateTtlConfig</span></span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">2</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"><span class=3D"cm-keyword">imp=
ort</span> <span class=3D"cm-def">org</span>.<span class=3D"cm-va=
riable">apache</span>.<span class=3D"cm-property">flink</span>.<s=
pan class=3D"cm-property">api</span>.<span class=3D"cm-property">=
common</span>.<span class=3D"cm-property">state</span>.<span clas=
s=3D"cm-property">ValueStateDescriptor</span></span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">3</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"><span cl=
ass=3D"cm-keyword">import</span> <span class=3D"cm-def">org</span=
>.<span class=3D"cm-variable">apache</span>.<span class=3D"cm-pro=
perty">flink</span>.<span class=3D"cm-property">api</span>.<span=20=
class=3D"cm-property">common</span>.<span class=3D"cm-property">t=
ime</span>.<span class=3D"cm-property">Time</span></span></pre></=
div><div style=3D"position: relative;"><div class=3D"CodeMirror-g=
utter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-li=
nenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;"=
>4</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"><sp=
an cm-text=3D""></span></span></pre></div><div style=3D"position:=
 relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"lef=
t: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-=
elt" style=3D"left: 0px; width: 21px;">5</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"><span class=3D"cm-variable">va=
l</span> <span class=3D"cm-variable">ttlConfig</span> <span class=
=3D"cm-operator">=3D</span> <span class=3D"cm-variable">StateTtlC=
onfig</span></span></pre></div><div style=3D"position: relative;"=
><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;">=
<div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">6</div></div><pre class=3D"CodeMirror-l=
ine" role=3D"presentation"><span role=3D"presentation" style=3D"p=
adding-right: 0.1px;"> &nbsp;  .<span class=3D"cm-property">newBu=
ilder</span>(<span class=3D"cm-variable">Time</span>.<span class=3D=
"cm-property">seconds</span>(<span class=3D"cm-number">1</span>))=
</span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">7</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp;  .<span class=3D"cm-property">setUpdateType</sp=
an>(<span class=3D"cm-variable">StateTtlConfig</span>.<span class=
=3D"cm-property">UpdateType</span>.<span class=3D"cm-property">On=
CreateAndWrite</span>)</span></pre></div><div style=3D"position:=20=
relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left=
: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-e=
lt" style=3D"left: 0px; width: 21px;">8</div></div><pre class=3D"=
CodeMirror-line" role=3D"presentation"><span role=3D"presentation=
" style=3D"padding-right: 0.1px;"> &nbsp;  .<span class=3D"cm-pro=
perty">setStateVisibility</span>(<span class=3D"cm-variable">Stat=
eTtlConfig</span>.<span class=3D"cm-property">StateVisibility</sp=
an>.<span class=3D"cm-property">NeverReturnExpired</span>)</span>=
</pre></div><div style=3D"position: relative;"><div class=3D"Code=
Mirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeM=
irror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width=
: 21px;">9</div></div><pre class=3D"CodeMirror-line" role=3D"pres=
entation"><span role=3D"presentation" style=3D"padding-right: 0.1=
px;"> &nbsp;  .<span class=3D"cm-property">build</span></span></p=
re></div><div style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">10</div></div><pre class=3D"CodeMirror-line" role=3D"presen=
tation"><span role=3D"presentation" style=3D"padding-right: 0.1px=
;"> &nbsp; &nbsp;</span></pre></div><div style=3D"position: relat=
ive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30=
px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" s=
tyle=3D"left: 0px; width: 21px;">11</div></div><pre class=3D"Code=
Mirror-line" role=3D"presentation"><span role=3D"presentation" st=
yle=3D"padding-right: 0.1px;"><span class=3D"cm-variable">val</sp=
an> <span class=3D"cm-variable">stateDescriptor</span> <span clas=
s=3D"cm-operator">=3D</span> <span class=3D"cm-keyword">new</span=
> <span class=3D"cm-variable">ValueStateDescriptor</span>[<span c=
lass=3D"cm-variable">String</span>](<span class=3D"cm-string">"te=
xt state"</span>, <span class=3D"cm-variable">classOf</span>[<spa=
n class=3D"cm-variable">String</span>])</span></pre></div><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">12</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-variable">stateDescriptor</span>.<span class=3D"cm-property">=
enableTimeToLive</span>(<span class=3D"cm-variable">ttlConfig</sp=
an>)</span></pre></div><div style=3D"position: relative;"><div cl=
ass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=
 0px; width: 21px;">13</div></div><pre class=3D"CodeMirror-line"=20=
role=3D"presentation"><span role=3D"presentation" style=3D"paddin=
g-right: 0.1px;"><span cm-text=3D""></span></span></pre></div><di=
v class=3D"" style=3D"position: relative;"><div class=3D"CodeMirr=
or-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">14</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"><span cm-text=3D""></span></span></pre></div></div></div></div>=
</div></div><div style=3D"position: absolute; height: 13px; width=
: 1px; border-bottom-width: 0px; border-bottom-style: solid; bord=
er-bottom-color: transparent; top: 330px;"></div><div class=3D"Co=
deMirror-gutters" style=3D"height: 360px;"><div class=3D"CodeMirr=
or-gutter CodeMirror-linenumbers" style=3D"width: 29px;"></div></=
div></div></div></wiz_code_mirror></div><p style=3D"color:rgb(180=
, 180, 180) !important;background:rgb(38, 39, 40) !important;font=
-size:1.125rem">TTL =C5=E4=D6=C3=D3=D0=D2=D4=CF=C2=BC=B8=B8=F6=D1=
=A1=CF=EE=A3=BA<span>&nbsp;</span><strong>newBuilder</strong><spa=
n>&nbsp;</span>=B5=C4=B5=DA=D2=BB=B8=F6=B2=CE=CA=FD=B1=ED=CA=BE=CA=
=FD=BE=DD=B5=C4=D3=D0=D0=A7=C6=DA=A3=AC=CA=C7=B1=D8=D1=A1=CF=EE=A1=
=A3</p><div id=3D"content_views" class=3D"markdown_views prism-to=
morrow-night" style=3D"color: rgb(196, 196, 200) !important; back=
ground: rgb(38, 39, 40) !important;"><blockquote style=3D"color:r=
gb(180, 180, 180) !important;background:rgb(46, 47, 48) !importan=
t;"><p style=3D"font-size: 0.875rem;">TTL =B5=C4=B8=FC=D0=C2=B2=DF=
=C2=D4=A3=A8=C4=AC=C8=CF=CA=C7 OnCreateAndWrite=A3=A9=A3=BA</p></=
blockquote><ul style=3D"color: rgb(180, 180, 180) !important;"><l=
i style=3D"background: rgb(38, 39, 40) !important;">StateTtlConfi=
g.UpdateType.OnCreateAndWrite - =BD=F6=D4=DA=B4=B4=BD=A8=BA=CD=D0=
=B4=C8=EB=CA=B1=B8=FC=D0=C2</li><li style=3D"background: rgb(38,=20=
39, 40) !important;">StateTtlConfig.UpdateType.OnReadAndWrite - =B6=
=C1=C8=A1=CA=B1=D2=B2=B8=FC=D0=C2</li></ul><blockquote style=3D"c=
olor:rgb(180, 180, 180) !important;background:rgb(46, 47, 48) !im=
portant;"><p style=3D"font-size: 0.875rem;">=CA=FD=BE=DD=D4=DA=B9=
=FD=C6=DA=B5=AB=BB=B9=CE=B4=B1=BB=C7=E5=C0=ED=CA=B1=B5=C4=BF=C9=BC=
=FB=D0=D4=C5=E4=D6=C3=C8=E7=CF=C2=A3=A8=C4=AC=C8=CF=CE=AA NeverRe=
turnExpired):</p></blockquote><ul style=3D"color: rgb(180, 180, 1=
80) !important;"><li style=3D"background: rgb(38, 39, 40) !import=
ant;">StateTtlConfig.StateVisibility.NeverReturnExpired - =B2=BB=B7=
=B5=BB=D8=B9=FD=C6=DA=CA=FD=BE=DD</li><li style=3D"background: rg=
b(38, 39, 40) !important;">StateTtlConfig.StateVisibility.ReturnE=
xpiredIfNotCleanedUp - =BB=E1=B7=B5=BB=D8=B9=FD=C6=DA=B5=AB=CE=B4=
=C7=E5=C0=ED=B5=C4=CA=FD=BE=DD</li></ul><p style=3D"font-size:1.1=
25rem;color:rgb(180, 180, 180) !important;">NeverReturnExpired =C7=
=E9=BF=F6=CF=C2=A3=AC=B9=FD=C6=DA=CA=FD=BE=DD=BE=CD=CF=F1=B2=BB=B4=
=E6=D4=DA=D2=BB=D1=F9=A3=AC=B2=BB=B9=DC=CA=C7=B7=F1=B1=BB=CE=EF=C0=
=ED=C9=BE=B3=FD=A1=A3=D5=E2=B6=D4=D3=DA=B2=BB=C4=DC=B7=C3=CE=CA=B9=
=FD=C6=DA=CA=FD=BE=DD=B5=C4=B3=A1=BE=B0=CF=C2=B7=C7=B3=A3=D3=D0=D3=
=C3=A3=AC=B1=C8=C8=E7=C3=F4=B8=D0=CA=FD=BE=DD=A1=A3<br>ReturnExpi=
redIfNotCleanedUp =D4=DA=CA=FD=BE=DD=B1=BB=CE=EF=C0=ED=C9=BE=B3=FD=
=C7=B0=B6=BC=BB=E1=B7=B5=BB=D8=A1=A3</p><blockquote style=3D"colo=
r:rgb(180, 180, 180) !important;background:rgb(46, 47, 48) !impor=
tant;"><p style=3D"font-size: 0.875rem;">=D7=A2=D2=E2:<br>=D7=B4=CC=
=AC=C9=CF=B4=CE=B5=C4=D0=DE=B8=C4=CA=B1=BC=E4=BB=E1=BA=CD=CA=FD=BE=
=DD=D2=BB=C6=F0=B1=A3=B4=E6=D4=DA state backend =D6=D0=A3=AC=D2=F2=
=B4=CB=BF=AA=C6=F4=B8=C3=CC=D8=D0=D4=BB=E1=D4=F6=BC=D3=D7=B4=CC=AC=
=CA=FD=BE=DD=B5=C4=B4=E6=B4=A2=A1=A3 Heap state backend =BB=E1=B6=
=EE=CD=E2=B4=E6=B4=A2=D2=BB=B8=F6=B0=FC=C0=A8=D3=C3=BB=A7=D7=B4=CC=
=AC=D2=D4=BC=B0=CA=B1=BC=E4=B4=C1=B5=C4 Java =B6=D4=CF=F3=A3=ACRo=
cksDB state backend =BB=E1=D4=DA=C3=BF=B8=F6=D7=B4=CC=AC=D6=B5=A3=
=A8list =BB=F2=D5=DF map =B5=C4=C3=BF=B8=F6=D4=AA=CB=D8=A3=A9=D0=F2=
=C1=D0=BB=AF=BA=F3=D4=F6=BC=D3 8 =B8=F6=D7=D6=BD=DA=A1=A3<br>=D4=DD=
=CA=B1=D6=BB=D6=A7=B3=D6=BB=F9=D3=DA processing time =B5=C4 TTL=A1=
=A3<br>=B3=A2=CA=D4=B4=D3 checkpoint/savepoint =BD=F8=D0=D0=BB=D6=
=B8=B4=CA=B1=A3=ACTTL =B5=C4=D7=B4=CC=AC=A3=A8=CA=C7=B7=F1=BF=AA=C6=
=F4=A3=A9=B1=D8=D0=EB=BA=CD=D6=AE=C7=B0=B1=A3=B3=D6=D2=BB=D6=C2=A3=
=AC=B7=F1=D4=F2=BB=E1=D3=F6=B5=BD =A1=B0StateMigrationException=A1=
=B1=A1=A3<br>TTL =B5=C4=C5=E4=D6=C3=B2=A2=B2=BB=BB=E1=B1=A3=B4=E6=
=D4=DA checkpoint/savepoint =D6=D0=A3=AC=BD=F6=B6=D4=B5=B1=C7=B0=20=
Job =D3=D0=D0=A7=A1=A3<br>=B5=B1=C7=B0=BF=AA=C6=F4 TTL =B5=C4 map=
 state =BD=F6=D4=DA=D3=C3=BB=A7=D6=B5=D0=F2=C1=D0=BB=AF=C6=F7=D6=A7=
=B3=D6 null =B5=C4=C7=E9=BF=F6=CF=C2=A3=AC=B2=C5=D6=A7=B3=D6=D3=C3=
=BB=A7=D6=B5=CE=AA null=A1=A3=C8=E7=B9=FB=D3=C3=BB=A7=D6=B5=D0=F2=
=C1=D0=BB=AF=C6=F7=B2=BB=D6=A7=B3=D6 null=A3=AC =BF=C9=D2=D4=D3=C3=
 NullableSerializer =B0=FC=D7=B0=D2=BB=B2=E3=A1=A3</p></blockquot=
e><h3 style=3D"font-size: 1.375rem; color: rgb(180, 180, 180) !im=
portant;">2.2.1.=B9=FD=C6=DA=CA=FD=BE=DD=B5=C4=C7=E5=C0=ED</h3></=
div><p style=3D"color:rgb(180, 180, 180) !important;background:rg=
b(38, 39, 40) !important;font-size:1.125rem">=C4=AC=C8=CF=C7=E9=BF=
=F6=CF=C2=A3=AC=B9=FD=C6=DA=CA=FD=BE=DD=BB=E1=D4=DA=B6=C1=C8=A1=B5=
=C4=CA=B1=BA=F2=B1=BB=C9=BE=B3=FD=A3=AC=C0=FD=C8=E7 ValueState#va=
lue=A3=AC=CD=AC=CA=B1=BB=E1=D3=D0=BA=F3=CC=A8=CF=DF=B3=CC=B6=A8=C6=
=DA=C7=E5=C0=ED=A3=A8=C8=E7=B9=FB StateBackend =D6=A7=B3=D6=B5=C4=
=BB=B0=A3=A9=A1=A3=BF=C9=D2=D4=CD=A8=B9=FD StateTtlConfig =C5=E4=D6=
=C3=B9=D8=B1=D5=BA=F3=CC=A8=C7=E5=C0=ED=A3=BA</p><div  data-mode=3D=
"JavaScript" data-theme=3D"default" id=3D"wiz_cm_1623250704621_76=
94" class=3D"wiz-code-container"><textarea style=3D"display: none=
;">import org.apache.flink.api.common.state.StateTtlConfig=0A=0Av=
al ttlConfig =3D StateTtlConfig=0A    .newBuilder(Time.seconds(1)=
)=0A    .disableCleanupInBackground=0A    .build=0A1=0A2=0A3=0A4=0A=
5=0A6</textarea><wiz_code_mirror><div class=3D"CodeMirror cm-s-de=
fault CodeMirror-wrap" data-id=3D"wiz_cm_1623250704621_7694"><div=
 style=3D"overflow: hidden; position: relative; width: 3px; heigh=
t: 0px; top: 20px; left: 34px;"><textarea autocorrect=3D"off" aut=
ocapitalize=3D"off" spellcheck=3D"false" style=3D"position: absol=
ute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outl=
ine: none;" tabindex=3D"0"></textarea></div><div class=3D"CodeMir=
ror-scrollbar-filler" cm-not-content=3D"true"></div><div class=3D=
"CodeMirror-gutter-filler" cm-not-content=3D"true"></div><div cla=
ss=3D"CodeMirror-scroll" tabindex=3D"-1"><div class=3D"CodeMirror=
-sizer" style=3D"margin-left: 30px; margin-bottom: 0px; border-ri=
ght-width: 30px; min-height: 284px; padding-right: 0px; padding-b=
ottom: 0px;"><div style=3D"position: relative; top: 0px;"><div cl=
ass=3D"CodeMirror-lines" role=3D"presentation"><div role=3D"prese=
ntation" style=3D"position: relative; outline: none;"><div class=3D=
"CodeMirror-measure"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt"><div>12</div></div></div><div class=3D"CodeMirror-=
measure"></div><div style=3D"position: relative; z-index: 1;"></d=
iv><div class=3D" wiz-hide wiz_CodeMirror-cursors"><div class=3D"=
CodeMirror-cursor" style=3D"left: 4px; top: 0px; height: 23px;">&=
nbsp;</div></div><div class=3D"CodeMirror-code" role=3D"presentat=
ion"><div class=3D"CodeMirror-activeline" style=3D"position: rela=
tive;"><div class=3D" wiz-hide wiz_CodeMirror-activeline-backgrou=
nd CodeMirror-linebackground"></div><div class=3D"CodeMirror-gutt=
er-background CodeMirror-activeline-gutter" style=3D"left: -30px;=
 width: 30px;"></div><div class=3D"CodeMirror-gutter-wrapper Code=
Mirror-activeline-gutter" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">1</div></div><pre class=3D"CodeMirror-line" role=3D"p=
resentation"><span role=3D"presentation" style=3D"padding-right:=20=
0.1px;"><span class=3D"cm-keyword">import</span> <span class=3D"c=
m-def">org</span>.<span class=3D"cm-variable">apache</span>.<span=
 class=3D"cm-property">flink</span>.<span class=3D"cm-property">a=
pi</span>.<span class=3D"cm-property">common</span>.<span class=3D=
"cm-property">state</span>.<span class=3D"cm-property">StateTtlCo=
nfig</span></span></pre></div><div style=3D"position: relative;">=
<div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><=
div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">2</div></div><pre class=3D"CodeMirror-l=
ine" role=3D"presentation"><span role=3D"presentation" style=3D"p=
adding-right: 0.1px;"><span cm-text=3D""></span></span></pre></di=
v><div style=3D"position: relative;"><div class=3D"CodeMirror-gut=
ter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-line=
number CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">3=
</div></div><pre class=3D"CodeMirror-line" role=3D"presentation">=
<span role=3D"presentation" style=3D"padding-right: 0.1px;"><span=
 class=3D"cm-variable">val</span> <span class=3D"cm-variable">ttl=
Config</span> <span class=3D"cm-operator">=3D</span> <span class=3D=
"cm-variable">StateTtlConfig</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">4</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<span clas=
s=3D"cm-property">newBuilder</span>(<span class=3D"cm-variable">T=
ime</span>.<span class=3D"cm-property">seconds</span>(<span class=
=3D"cm-number">1</span>))</span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">5</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp;  .<span class=3D"cm-pr=
operty">disableCleanupInBackground</span></span></pre></div><div=20=
style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wra=
pper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=20=
CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">6</div><=
/div><pre class=3D"CodeMirror-line" role=3D"presentation"><span r=
ole=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<s=
pan class=3D"cm-property">build</span></span></pre></div><div sty=
le=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrappe=
r" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Cod=
eMirror-gutter-elt" style=3D"left: 0px; width: 21px;">7</div></di=
v><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=
=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D"=
cm-number">1</span></span></pre></div><div style=3D"position: rel=
ative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -=
30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=
 style=3D"left: 0px; width: 21px;">8</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"><span class=3D"cm-number">2</span>=
</span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">9</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span class=3D"cm-number">3</span></span></pre></div><d=
iv style=3D"position: relative;"><div class=3D"CodeMirror-gutter-=
wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumb=
er CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">10</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"><span cl=
ass=3D"cm-number">4</span></span></pre></div><div style=3D"positi=
on: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"=
left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutt=
er-elt" style=3D"left: 0px; width: 21px;">11</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"><span class=3D"cm-number">=
5</span></span></pre></div><div style=3D"position: relative;"><di=
v class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=
 class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"l=
eft: 0px; width: 21px;">12</div></div><pre class=3D"CodeMirror-li=
ne" role=3D"presentation"><span role=3D"presentation" style=3D"pa=
dding-right: 0.1px;"><span class=3D"cm-number">6</span></span></p=
re></div></div></div></div></div></div><div style=3D"position: ab=
solute; height: 13px; width: 1px; border-bottom-width: 0px; borde=
r-bottom-style: solid; border-bottom-color: transparent; top: 284=
px;"></div><div class=3D"CodeMirror-gutters" style=3D"height: 314=
px;"><div class=3D"CodeMirror-gutter CodeMirror-linenumbers" styl=
e=3D"width: 29px;"></div></div></div></div></wiz_code_mirror></di=
v><p style=3D"color:rgb(180, 180, 180) !important;background:rgb(=
38, 39, 40) !important;font-size:1.125rem">=BF=C9=D2=D4=B0=B4=D5=D5=
=C8=E7=CF=C2=CB=F9=CA=BE=C5=E4=D6=C3=B8=FC=CF=B8=C1=A3=B6=C8=B5=C4=
=BA=F3=CC=A8=C7=E5=C0=ED=B2=DF=C2=D4=A1=A3=B5=B1=C7=B0=B5=C4=CA=B5=
=CF=D6=D6=D0 HeapStateBackend =D2=C0=C0=B5=D4=F6=C1=BF=CA=FD=BE=DD=
=C7=E5=C0=ED=A3=ACRocksDBStateBackend =C0=FB=D3=C3=D1=B9=CB=F5=B9=
=FD=C2=CB=C6=F7=BD=F8=D0=D0=BA=F3=CC=A8=C7=E5=C0=ED=A1=A3</p><div=
 id=3D"content_views" class=3D"markdown_views prism-tomorrow-nigh=
t" style=3D"color: rgb(196, 196, 200) !important; background: rgb=
(38, 39, 40) !important;"><h3 style=3D"font-size: 1.375rem; color=
: rgb(180, 180, 180) !important;">2.2.=C8=AB=C1=BF=BF=EC=D5=D5=CA=
=B1=BD=F8=D0=D0=C7=E5=C0=ED</h3></div><p style=3D"color:rgb(180,=20=
180, 180) !important;background:rgb(38, 39, 40) !important;font-s=
ize:1.125rem">=BF=C9=D2=D4=C6=F4=D3=C3=C8=AB=C1=BF=BF=EC=D5=D5=CA=
=B1=BD=F8=D0=D0=C7=E5=C0=ED=B5=C4=B2=DF=C2=D4=A3=AC=D5=E2=BF=C9=D2=
=D4=BC=F5=C9=D9=D5=FB=B8=F6=BF=EC=D5=D5=B5=C4=B4=F3=D0=A1=A1=A3=B5=
=B1=C7=B0=CA=B5=CF=D6=D6=D0=B2=BB=BB=E1=C7=E5=C0=ED=B1=BE=B5=D8=B5=
=C4=D7=B4=CC=AC=A3=AC=B5=AB=B4=D3=C9=CF=B4=CE=BF=EC=D5=D5=BB=D6=B8=
=B4=CA=B1=A3=AC=B2=BB=BB=E1=BB=D6=B8=B4=C4=C7=D0=A9=D2=D1=BE=AD=C9=
=BE=B3=FD=B5=C4=B9=FD=C6=DA=CA=FD=BE=DD=A1=A3<br>=B8=C3=B2=DF=C2=D4=
=BF=C9=D2=D4=CD=A8=B9=FD StateTtlConfig =C5=E4=D6=C3=BD=F8=D0=D0=C5=
=E4=D6=C3=A3=BA</p><div  data-mode=3D"JavaScript" data-theme=3D"d=
efault" id=3D"wiz_cm_1623250704607_602" class=3D"wiz-code-contain=
er"><textarea style=3D"display: none;">import org.apache.flink.ap=
i.common.state.StateTtlConfig=0Aimport org.apache.flink.api.commo=
n.time.Time=0A=0Aval ttlConfig =3D StateTtlConfig=0A    .newBuild=
er(Time.seconds(1))=0A    .cleanupFullSnapshot=0A    .build</text=
area><wiz_code_mirror><div class=3D"CodeMirror cm-s-default CodeM=
irror-wrap" data-id=3D"wiz_cm_1623250704607_602"><div style=3D"ov=
erflow: hidden; position: relative; width: 3px; height: 0px; top:=
 20px; left: 34px;"><textarea autocorrect=3D"off" autocapitalize=3D=
"off" spellcheck=3D"false" style=3D"position: absolute; bottom: -=
1em; padding: 0px; width: 1000px; height: 1em; outline: none;" ta=
bindex=3D"0"></textarea></div><div class=3D"CodeMirror-scrollbar-=
filler" cm-not-content=3D"true"></div><div class=3D"CodeMirror-gu=
tter-filler" cm-not-content=3D"true"></div><div class=3D"CodeMirr=
or-scroll" tabindex=3D"-1"><div class=3D"CodeMirror-sizer" style=3D=
"margin-left: 30px; margin-bottom: 0px; border-right-width: 30px;=
 min-height: 169px; padding-right: 0px; padding-bottom: 0px;"><di=
v style=3D"position: relative; top: 0px;"><div class=3D"CodeMirro=
r-lines" role=3D"presentation"><div role=3D"presentation" style=3D=
"position: relative; outline: none;"><div class=3D"CodeMirror-mea=
sure"><pre>x</pre><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt"><div>7</div></div></div><div class=3D"CodeMirror-meas=
ure"></div><div style=3D"position: relative; z-index: 1;"></div><=
div class=3D" wiz-hide wiz_CodeMirror-cursors"><div class=3D"Code=
Mirror-cursor" style=3D"left: 4px; top: 0px; height: 23px;">&nbsp=
;</div></div><div class=3D"CodeMirror-code" role=3D"presentation"=
><div class=3D"CodeMirror-activeline" style=3D"position: relative=
;"><div class=3D" wiz-hide wiz_CodeMirror-activeline-background C=
odeMirror-linebackground"></div><div class=3D"CodeMirror-gutter-b=
ackground CodeMirror-activeline-gutter" style=3D"left: -30px; wid=
th: 30px;"></div><div class=3D"CodeMirror-gutter-wrapper CodeMirr=
or-activeline-gutter" style=3D"left: -30px;"><div class=3D"CodeMi=
rror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=
 21px;">1</div></div><pre class=3D"CodeMirror-line" role=3D"prese=
ntation"><span role=3D"presentation" style=3D"padding-right: 0.1p=
x;"><span class=3D"cm-keyword">import</span> <span class=3D"cm-de=
f">org</span>.<span class=3D"cm-variable">apache</span>.<span cla=
ss=3D"cm-property">flink</span>.<span class=3D"cm-property">api</=
span>.<span class=3D"cm-property">common</span>.<span class=3D"cm=
-property">state</span>.<span class=3D"cm-property">StateTtlConfi=
g</span></span></pre></div><div style=3D"position: relative;"><di=
v class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=
 class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"l=
eft: 0px; width: 21px;">2</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;"><span class=3D"cm-keyword">import</span> <spa=
n class=3D"cm-def">org</span>.<span class=3D"cm-variable">apache<=
/span>.<span class=3D"cm-property">flink</span>.<span class=3D"cm=
-property">api</span>.<span class=3D"cm-property">common</span>.<=
span class=3D"cm-property">time</span>.<span class=3D"cm-property=
">Time</span></span></pre></div><div style=3D"position: relative;=
"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"=
><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=
=3D"left: 0px; width: 21px;">3</div></div><pre class=3D"CodeMirro=
r-line" role=3D"presentation"><span role=3D"presentation" style=3D=
"padding-right: 0.1px;"><span cm-text=3D""></span></span></pre></=
div><div style=3D"position: relative;"><div class=3D"CodeMirror-g=
utter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-li=
nenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;"=
>4</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"><sp=
an class=3D"cm-variable">val</span> <span class=3D"cm-variable">t=
tlConfig</span> <span class=3D"cm-operator">=3D</span> <span clas=
s=3D"cm-variable">StateTtlConfig</span></span></pre></div><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">5</div></d=
iv><pre class=3D"CodeMirror-line" role=3D"presentation"><span rol=
e=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<spa=
n class=3D"cm-property">newBuilder</span>(<span class=3D"cm-varia=
ble">Time</span>.<span class=3D"cm-property">seconds</span>(<span=
 class=3D"cm-number">1</span>))</span></pre></div><div style=3D"p=
osition: relative;"><div class=3D"CodeMirror-gutter-wrapper" styl=
e=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror=
-gutter-elt" style=3D"left: 0px; width: 21px;">6</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<span class=3D=
"cm-property">cleanupFullSnapshot</span></span></pre></div><div c=
lass=3D"" style=3D"position: relative;"><div class=3D"CodeMirror-=
gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-l=
inenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;=
">7</div></div><pre class=3D"CodeMirror-line" role=3D"presentatio=
n"><span role=3D"presentation" style=3D"padding-right: 0.1px;"> &=
nbsp;  .<span class=3D"cm-property">build</span></span></pre></di=
v></div></div></div></div></div><div style=3D"position: absolute;=
 height: 13px; width: 1px; border-bottom-width: 0px; border-botto=
m-style: solid; border-bottom-color: transparent; top: 169px;"></=
div><div class=3D"CodeMirror-gutters" style=3D"height: 199px;"><d=
iv class=3D"CodeMirror-gutter CodeMirror-linenumbers" style=3D"wi=
dth: 29px;"></div></div></div></div></wiz_code_mirror></div><p st=
yle=3D"color:rgb(180, 180, 180) !important;background:rgb(38, 39,=
 40) !important;font-size:1.125rem">=D5=E2=D6=D6=B2=DF=C2=D4=D4=DA=
 RocksDBStateBackend =B5=C4=D4=F6=C1=BF checkpoint =C4=A3=CA=BD=CF=
=C2=CE=DE=D0=A7=A1=A3</p><div id=3D"content_views" class=3D"markd=
own_views prism-tomorrow-night" style=3D"color: rgb(196, 196, 200=
) !important; background: rgb(38, 39, 40) !important;"><blockquot=
e style=3D"color:rgb(180, 180, 180) !important;background:rgb(46,=
 47, 48) !important;"><p style=3D"font-size: 0.875rem;">=D7=A2=D2=
=E2: =D5=E2=D6=D6=C7=E5=C0=ED=B7=BD=CA=BD=BF=C9=D2=D4=D4=DA=C8=CE=
=BA=CE=CA=B1=BA=F2=CD=A8=B9=FD StateTtlConfig =C6=F4=D3=C3=BB=F2=D5=
=DF=B9=D8=B1=D5=A3=AC=B1=C8=C8=E7=D4=DA=B4=D3 savepoint =BB=D6=B8=
=B4=CA=B1=A1=A3</p></blockquote><h3 style=3D"font-size: 1.375rem;=
 color: rgb(180, 180, 180) !important;">2.3.=D4=F6=C1=BF=CA=FD=BE=
=DD=C7=E5=C0=ED</h3></div><p style=3D"color:rgb(180, 180, 180) !i=
mportant;background:rgb(38, 39, 40) !important;font-size:1.125rem=
">=D1=A1=D4=F1=D4=F6=C1=BF=CA=BD=C7=E5=C0=ED=D7=B4=CC=AC=CA=FD=BE=
=DD=A3=AC=D4=DA=D7=B4=CC=AC=B7=C3=CE=CA=BB=F2/=BA=CD=B4=A6=C0=ED=CA=
=B1=BD=F8=D0=D0=A1=A3=C8=E7=B9=FB=C4=B3=B8=F6=D7=B4=CC=AC=BF=AA=C6=
=F4=C1=CB=B8=C3=C7=E5=C0=ED=B2=DF=C2=D4=A3=AC=D4=F2=BB=E1=D4=DA=B4=
=E6=B4=A2=BA=F3=B6=CB=B1=A3=C1=F4=D2=BB=B8=F6=CB=F9=D3=D0=D7=B4=CC=
=AC=B5=C4=B6=E8=D0=D4=C8=AB=BE=D6=B5=FC=B4=FA=C6=F7=A1=A3 =C3=BF=B4=
=CE=B4=A5=B7=A2=D4=F6=C1=BF=C7=E5=C0=ED=CA=B1=A3=AC=B4=D3=B5=FC=B4=
=FA=C6=F7=D6=D0=D1=A1=D4=F1=D2=D1=BE=AD=B9=FD=C6=DA=B5=C4=CA=FD=BD=
=F8=D0=D0=C7=E5=C0=ED=A1=A3</p><div  data-mode=3D"JavaScript" dat=
a-theme=3D"default" id=3D"wiz_cm_1623250704595_9629" class=3D"wiz=
-code-container"><textarea style=3D"display: none;">import org.ap=
ache.flink.api.common.state.StateTtlConfig=0Aval ttlConfig =3D St=
ateTtlConfig=0A    .newBuilder(Time.seconds(1))=0A    .cleanupInc=
rementally(10, true)=0A    .build</textarea><wiz_code_mirror><div=
 class=3D"CodeMirror cm-s-default CodeMirror-wrap" data-id=3D"wiz=
_cm_1623250704595_9629"><div style=3D"overflow: hidden; position:=
 relative; width: 3px; height: 0px; top: 20px; left: 34px;"><text=
area autocorrect=3D"off" autocapitalize=3D"off" spellcheck=3D"fal=
se" style=3D"position: absolute; bottom: -1em; padding: 0px; widt=
h: 1000px; height: 1em; outline: none;" tabindex=3D"0"></textarea=
></div><div class=3D"CodeMirror-scrollbar-filler" cm-not-content=3D=
"true"></div><div class=3D"CodeMirror-gutter-filler" cm-not-conte=
nt=3D"true"></div><div class=3D"CodeMirror-scroll" tabindex=3D"-1=
"><div class=3D"CodeMirror-sizer" style=3D"margin-left: 30px; mar=
gin-bottom: 0px; border-right-width: 30px; min-height: 123px; pad=
ding-right: 0px; padding-bottom: 0px;"><div style=3D"position: re=
lative; top: 0px;"><div class=3D"CodeMirror-lines" role=3D"presen=
tation"><div role=3D"presentation" style=3D"position: relative; o=
utline: none;"><div class=3D"CodeMirror-measure"><pre>x</pre><div=
 class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</di=
v></div></div><div class=3D"CodeMirror-measure"></div><div style=3D=
"position: relative; z-index: 1;"></div><div class=3D" wiz-hide w=
iz_CodeMirror-cursors"><div class=3D"CodeMirror-cursor" style=3D"=
left: 4px; top: 0px; height: 23px;">&nbsp;</div></div><div class=3D=
"CodeMirror-code" role=3D"presentation"><div class=3D"CodeMirror-=
activeline" style=3D"position: relative;"><div class=3D" wiz-hide=
 wiz_CodeMirror-activeline-background CodeMirror-linebackground">=
</div><div class=3D"CodeMirror-gutter-background CodeMirror-activ=
eline-gutter" style=3D"left: -30px; width: 30px;"></div><div clas=
s=3D"CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" styl=
e=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror=
-gutter-elt" style=3D"left: 0px; width: 21px;">1</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-keyw=
ord">import</span> <span class=3D"cm-def">org</span>.<span class=3D=
"cm-variable">apache</span>.<span class=3D"cm-property">flink</sp=
an>.<span class=3D"cm-property">api</span>.<span class=3D"cm-prop=
erty">common</span>.<span class=3D"cm-property">state</span>.<spa=
n class=3D"cm-property">StateTtlConfig</span></span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">2</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"><span cl=
ass=3D"cm-variable">val</span> <span class=3D"cm-variable">ttlCon=
fig</span> <span class=3D"cm-operator">=3D</span> <span class=3D"=
cm-variable">StateTtlConfig</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">3</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<span clas=
s=3D"cm-property">newBuilder</span>(<span class=3D"cm-variable">T=
ime</span>.<span class=3D"cm-property">seconds</span>(<span class=
=3D"cm-number">1</span>))</span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">4</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp;  .<span class=3D"cm-pr=
operty">cleanupIncrementally</span>(<span class=3D"cm-number">10<=
/span>, <span class=3D"cm-atom">true</span>)</span></pre></div><d=
iv class=3D"" style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">5</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"> &nbsp;  .<span class=3D"cm-property">build</span></span></pre>=
</div></div></div></div></div></div><div style=3D"position: absol=
ute; height: 13px; width: 1px; border-bottom-width: 0px; border-b=
ottom-style: solid; border-bottom-color: transparent; top: 123px;=
"></div><div class=3D"CodeMirror-gutters" style=3D"height: 153px;=
"><div class=3D"CodeMirror-gutter CodeMirror-linenumbers" style=3D=
"width: 29px;"></div></div></div></div></wiz_code_mirror></div><p=
 style=3D"color:rgb(180, 180, 180) !important;background:rgb(38,=20=
39, 40) !important;font-size:1.125rem">=B8=C3=B2=DF=C2=D4=D3=D0=C1=
=BD=B8=F6=B2=CE=CA=FD=A1=A3<br>=B5=DA=D2=BB=B8=F6=CA=C7=C3=BF=B4=CE=
=C7=E5=C0=ED=CA=B1=BC=EC=B2=E9=D7=B4=CC=AC=B5=C4=CC=F5=C4=BF=CA=FD=
=A3=AC=D4=DA=C3=BF=B8=F6=D7=B4=CC=AC=B7=C3=CE=CA=CA=B1=B4=A5=B7=A2=
=A1=A3<br>=B5=DA=B6=FE=B8=F6=B2=CE=CA=FD=B1=ED=CA=BE=CA=C7=B7=F1=D4=
=DA=B4=A6=C0=ED=C3=BF=CC=F5=BC=C7=C2=BC=CA=B1=B4=A5=B7=A2=C7=E5=C0=
=ED=A1=A3<br><strong>Heap backend =C4=AC=C8=CF=BB=E1=BC=EC=B2=E9=20=
5 =CC=F5=D7=B4=CC=AC=A3=AC=B2=A2=C7=D2=B9=D8=B1=D5=D4=DA=C3=BF=CC=
=F5=BC=C7=C2=BC=CA=B1=B4=A5=B7=A2=C7=E5=C0=ED=A1=A3</strong></p><=
div id=3D"content_views" class=3D"markdown_views prism-tomorrow-n=
ight" style=3D"color: rgb(196, 196, 200) !important; background:=20=
rgb(38, 39, 40) !important;"><blockquote style=3D"color:rgb(180,=20=
180, 180) !important;background:rgb(46, 47, 48) !important;"><p s=
tyle=3D"font-size: 0.875rem;">=D7=A2=D2=E2:<br>1.=C8=E7=B9=FB=C3=BB=
=D3=D0 state =B7=C3=CE=CA=A3=AC=D2=B2=C3=BB=D3=D0=B4=A6=C0=ED=CA=FD=
=BE=DD=A3=AC=D4=F2=B2=BB=BB=E1=C7=E5=C0=ED=B9=FD=C6=DA=CA=FD=BE=DD=
=A1=A3<br>2.=D4=F6=C1=BF=C7=E5=C0=ED=BB=E1=D4=F6=BC=D3=CA=FD=BE=DD=
=B4=A6=C0=ED=B5=C4=BA=C4=CA=B1=A1=A3<br>3.=CF=D6=D4=DA=BD=F6 Heap=
 state backend =D6=A7=B3=D6=D4=F6=C1=BF=C7=E5=B3=FD=BB=FA=D6=C6=A1=
=A3=D4=DA RocksDB state backend =C9=CF=C6=F4=D3=C3=B8=C3=CC=D8=D0=
=D4=CE=DE=D0=A7=A1=A3<br>4.=C8=E7=B9=FB Heap state backend =CA=B9=
=D3=C3=CD=AC=B2=BD=BF=EC=D5=D5=B7=BD=CA=BD=A3=AC=D4=F2=BB=E1=B1=A3=
=B4=E6=D2=BB=B7=DD=CB=F9=D3=D0 key =B5=C4=BF=BD=B1=B4=A3=AC=B4=D3=
=B6=F8=B7=C0=D6=B9=B2=A2=B7=A2=D0=DE=B8=C4=CE=CA=CC=E2=A3=AC=D2=F2=
=B4=CB=BB=E1=D4=F6=BC=D3=C4=DA=B4=E6=B5=C4=CA=B9=D3=C3=A1=A3=B5=AB=
=D2=EC=B2=BD=BF=EC=D5=D5=D4=F2=C3=BB=D3=D0=D5=E2=B8=F6=CE=CA=CC=E2=
=A1=A3<br>5.=B6=D4=D2=D1=D3=D0=B5=C4=D7=F7=D2=B5=A3=AC=D5=E2=B8=F6=
=C7=E5=C0=ED=B7=BD=CA=BD=BF=C9=D2=D4=D4=DA=C8=CE=BA=CE=CA=B1=BA=F2=
=CD=A8=B9=FD StateTtlConfig =C6=F4=D3=C3=BB=F2=BD=FB=D3=C3=B8=C3=CC=
=D8=D0=D4=A3=AC=B1=C8=C8=E7=B4=D3 savepoint =D6=D8=C6=F4=BA=F3=A1=
=A3</p></blockquote><h3 style=3D"font-size: 1.375rem; color: rgb(=
180, 180, 180) !important;">2.4.=D4=DA RocksDB =D1=B9=CB=F5=CA=B1=
=C7=E5=C0=ED</h3></div><p style=3D"color:rgb(180, 180, 180) !impo=
rtant;background:rgb(38, 39, 40) !important;font-size:1.125rem">=C8=
=E7=B9=FB=CA=B9=D3=C3 RocksDB state backend=A3=AC=D4=F2=BB=E1=C6=F4=
=D3=C3 Flink =CE=AA RocksDB =B6=A8=D6=C6=B5=C4=D1=B9=CB=F5=B9=FD=C2=
=CB=C6=F7=A1=A3<br>RocksDB =BB=E1=D6=DC=C6=DA=D0=D4=B5=C4=B6=D4=CA=
=FD=BE=DD=BD=F8=D0=D0=BA=CF=B2=A2=D1=B9=CB=F5=B4=D3=B6=F8=BC=F5=C9=
=D9=B4=E6=B4=A2=BF=D5=BC=E4=A1=A3<br>Flink =CC=E1=B9=A9=B5=C4 Roc=
ksDB =D1=B9=CB=F5=B9=FD=C2=CB=C6=F7=BB=E1=D4=DA=D1=B9=CB=F5=CA=B1=
=B9=FD=C2=CB=B5=F4=D2=D1=BE=AD=B9=FD=C6=DA=B5=C4=D7=B4=CC=AC=CA=FD=
=BE=DD=A1=A3</p><p style=3D"color:rgb(180, 180, 180) !important;b=
ackground:rgb(38, 39, 40) !important;font-size:1.125rem">=B8=C3=CC=
=D8=D0=D4=BF=C9=D2=D4=CD=A8=B9=FD StateTtlConfig =BD=F8=D0=D0=C5=E4=
=D6=C3=A3=BA</p><div  data-mode=3D"JavaScript" data-theme=3D"defa=
ult" id=3D"wiz_cm_1623250704582_9657" class=3D"wiz-code-container=
"><textarea style=3D"display: none;">import org.apache.flink.api.=
common.state.StateTtlConfig=0A=0Aval ttlConfig =3D StateTtlConfig=
=0A    .newBuilder(Time.seconds(1))=0A    .cleanupInRocksdbCompac=
tFilter(1000)=0A    .build=0A</textarea><wiz_code_mirror><div cla=
ss=3D"CodeMirror cm-s-default CodeMirror-wrap" data-id=3D"wiz_cm_=
1623250704582_9657"><div style=3D"overflow: hidden; position: rel=
ative; width: 3px; height: 0px; top: 20px; left: 34px;"><textarea=
 autocorrect=3D"off" autocapitalize=3D"off" spellcheck=3D"false"=20=
style=3D"position: absolute; bottom: -1em; padding: 0px; width: 1=
000px; height: 1em; outline: none;" tabindex=3D"0"></textarea></d=
iv><div class=3D"CodeMirror-scrollbar-filler" cm-not-content=3D"t=
rue"></div><div class=3D"CodeMirror-gutter-filler" cm-not-content=
=3D"true"></div><div class=3D"CodeMirror-scroll" tabindex=3D"-1">=
<div class=3D"CodeMirror-sizer" style=3D"margin-left: 30px; margi=
n-bottom: 0px; border-right-width: 30px; min-height: 169px; paddi=
ng-right: 0px; padding-bottom: 0px;"><div style=3D"position: rela=
tive; top: 0px;"><div class=3D"CodeMirror-lines" role=3D"presenta=
tion"><div role=3D"presentation" style=3D"position: relative; out=
line: none;"><div class=3D"CodeMirror-measure"><pre>x</pre><div c=
lass=3D"CodeMirror-linenumber CodeMirror-gutter-elt"><div>7</div>=
</div></div><div class=3D"CodeMirror-measure"></div><div style=3D=
"position: relative; z-index: 1;"></div><div class=3D" wiz-hide w=
iz_CodeMirror-cursors" style=3D"visibility: hidden;"><div class=3D=
"CodeMirror-cursor" style=3D"left: 4px; top: 0px; height: 23px;">=
&nbsp;</div></div><div class=3D"CodeMirror-code" role=3D"presenta=
tion"><div class=3D"CodeMirror-activeline" style=3D"position: rel=
ative;"><div class=3D" wiz-hide wiz_CodeMirror-activeline-backgro=
und CodeMirror-linebackground"></div><div class=3D"CodeMirror-gut=
ter-background CodeMirror-activeline-gutter" style=3D"left: -30px=
; width: 30px;"></div><div class=3D"CodeMirror-gutter-wrapper Cod=
eMirror-activeline-gutter" style=3D"left: -30px;"><div class=3D"C=
odeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; w=
idth: 21px;">1</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;"><span class=3D"cm-keyword">import</span> <span class=3D"=
cm-def">org</span>.<span class=3D"cm-variable">apache</span>.<spa=
n class=3D"cm-property">flink</span>.<span class=3D"cm-property">=
api</span>.<span class=3D"cm-property">common</span>.<span class=3D=
"cm-property">state</span>.<span class=3D"cm-property">StateTtlCo=
nfig</span></span></pre></div><div style=3D"position: relative;">=
<div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><=
div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">2</div></div><pre class=3D"CodeMirror-l=
ine" role=3D"presentation"><span role=3D"presentation" style=3D"p=
adding-right: 0.1px;"><span cm-text=3D""></span></span></pre></di=
v><div style=3D"position: relative;"><div class=3D"CodeMirror-gut=
ter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-line=
number CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">3=
</div></div><pre class=3D"CodeMirror-line" role=3D"presentation">=
<span role=3D"presentation" style=3D"padding-right: 0.1px;"><span=
 class=3D"cm-variable">val</span> <span class=3D"cm-variable">ttl=
Config</span> <span class=3D"cm-operator">=3D</span> <span class=3D=
"cm-variable">StateTtlConfig</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">4</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<span clas=
s=3D"cm-property">newBuilder</span>(<span class=3D"cm-variable">T=
ime</span>.<span class=3D"cm-property">seconds</span>(<span class=
=3D"cm-number">1</span>))</span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">5</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp;  .<span class=3D"cm-pr=
operty">cleanupInRocksdbCompactFilter</span>(<span class=3D"cm-nu=
mber">1000</span>)</span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">6</div></div><pre class=3D"Code=
Mirror-line" role=3D"presentation"><span role=3D"presentation" st=
yle=3D"padding-right: 0.1px;"> &nbsp;  .<span class=3D"cm-propert=
y">build</span></span></pre></div><div class=3D"" style=3D"positi=
on: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"=
left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutt=
er-elt" style=3D"left: 0px; width: 21px;">7</div></div><pre class=
=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presenta=
tion" style=3D"padding-right: 0.1px;"><span cm-text=3D""></span><=
/span></pre></div></div></div></div></div></div><div style=3D"pos=
ition: absolute; height: 13px; width: 1px; border-bottom-width: 0=
px; border-bottom-style: solid; border-bottom-color: transparent;=
 top: 169px;"></div><div class=3D"CodeMirror-gutters" style=3D"he=
ight: 199px;"><div class=3D"CodeMirror-gutter CodeMirror-linenumb=
ers" style=3D"width: 29px;"></div></div></div></div></wiz_code_mi=
rror></div><p style=3D"color:rgb(180, 180, 180) !important;backgr=
ound:rgb(38, 39, 40) !important;font-size:1.125rem">Flink =B4=A6=C0=
=ED=D2=BB=B6=A8=CC=F5=CA=FD=B5=C4=D7=B4=CC=AC=CA=FD=BE=DD=BA=F3=A3=
=AC=BB=E1=CA=B9=D3=C3=B5=B1=C7=B0=CA=B1=BC=E4=B4=C1=C0=B4=BC=EC=B2=
=E2 RocksDB =D6=D0=B5=C4=D7=B4=CC=AC=CA=C7=B7=F1=D2=D1=BE=AD=B9=FD=
=C6=DA=A3=AC =C4=E3=BF=C9=D2=D4=CD=A8=B9=FD StateTtlConfig.newBui=
lder(=A1=AD).cleanupInRocksdbCompactFilter(long queryTimeAfterNum=
Entries) =B7=BD=B7=A8=D6=B8=B6=A8=B4=A6=C0=ED=D7=B4=CC=AC=B5=C4=CC=
=F5=CA=FD=A1=A3</p><p style=3D"color:rgb(180, 180, 180) !importan=
t;background:rgb(38, 39, 40) !important;font-size:1.125rem">=CA=B1=
=BC=E4=B4=C1=B8=FC=D0=C2=B5=C4=D4=BD=C6=B5=B7=B1=A3=AC=D7=B4=CC=AC=
=B5=C4=C7=E5=C0=ED=D4=BD=BC=B0=CA=B1=A3=AC=B5=AB=D3=C9=D3=DA=D1=B9=
=CB=F5=BB=E1=D3=D0=B5=F7=D3=C3 JNI =B5=C4=BF=AA=CF=FA=A3=AC=D2=F2=
=B4=CB=BB=E1=D3=B0=CF=EC=D5=FB=CC=E5=B5=C4=D1=B9=CB=F5=D0=D4=C4=DC=
=A1=A3<br>RocksDB backend =B5=C4=C4=AC=C8=CF=BA=F3=CC=A8=C7=E5=C0=
=ED=B2=DF=C2=D4=BB=E1=C3=BF=B4=A6=C0=ED 1000 =CC=F5=CA=FD=BE=DD=BD=
=F8=D0=D0=D2=BB=B4=CE=A1=A3</p><p style=3D"color:rgb(180, 180, 18=
0) !important;background:rgb(38, 39, 40) !important;font-size:1.1=
25rem">=C4=E3=BB=B9=BF=C9=D2=D4=CD=A8=B9=FD=C5=E4=D6=C3=BF=AA=C6=F4=
 RocksDB =B9=FD=C2=CB=C6=F7=B5=C4 debug =C8=D5=D6=BE=A3=BA log4j.=
logger.org.rocksdb.FlinkCompactionFilter=3DDEBUG</p><div id=3D"co=
ntent_views" class=3D"markdown_views prism-tomorrow-night" style=3D=
"color: rgb(196, 196, 200) !important; background: rgb(38, 39, 40=
) !important;"><blockquote style=3D"color:rgb(180, 180, 180) !imp=
ortant;background:rgb(46, 47, 48) !important;"><p style=3D"font-s=
ize: 0.875rem;">=D7=A2=D2=E2:<br>=D1=B9=CB=F5=CA=B1=B5=F7=D3=C3 T=
TL =B9=FD=C2=CB=C6=F7=BB=E1=BD=B5=B5=CD=CB=D9=B6=C8=A1=A3TTL =B9=FD=
=C2=CB=C6=F7=D0=E8=D2=AA=BD=E2=CE=F6=C9=CF=B4=CE=B7=C3=CE=CA=B5=C4=
=CA=B1=BC=E4=B4=C1=A3=AC=B2=A2=B6=D4=C3=BF=B8=F6=BD=AB=B2=CE=D3=EB=
=D1=B9=CB=F5=B5=C4=D7=B4=CC=AC=BD=F8=D0=D0=CA=C7=B7=F1=B9=FD=C6=DA=
=BC=EC=B2=E9=A1=A3 =B6=D4=D3=DA=BC=AF=BA=CF=D0=CD=D7=B4=CC=AC=C0=E0=
=D0=CD=A3=A8=B1=C8=C8=E7 list =BA=CD map=A3=A9=A3=AC=BB=E1=B6=D4=BC=
=AF=BA=CF=D6=D0=C3=BF=B8=F6=D4=AA=CB=D8=BD=F8=D0=D0=BC=EC=B2=E9=A1=
=A3<br>=B6=D4=D3=DA=D4=AA=CB=D8=D0=F2=C1=D0=BB=AF=BA=F3=B3=A4=B6=C8=
=B2=BB=B9=CC=B6=A8=B5=C4=C1=D0=B1=ED=D7=B4=CC=AC=A3=ACTTL =B9=FD=C2=
=CB=C6=F7=D0=E8=D2=AA=D4=DA=C3=BF=B4=CE JNI =B5=F7=D3=C3=B9=FD=B3=
=CC=D6=D0=A3=AC=B6=EE=CD=E2=B5=F7=D3=C3 Flink =B5=C4 java =D0=F2=C1=
=D0=BB=AF=C6=F7=A3=AC =B4=D3=B6=F8=C8=B7=B6=A8=CF=C2=D2=BB=B8=F6=CE=
=B4=B9=FD=C6=DA=CA=FD=BE=DD=B5=C4=CE=BB=D6=C3=A1=A3<br>=B6=D4=D2=D1=
=D3=D0=B5=C4=D7=F7=D2=B5=A3=AC=D5=E2=B8=F6=C7=E5=C0=ED=B7=BD=CA=BD=
=BF=C9=D2=D4=D4=DA=C8=CE=BA=CE=CA=B1=BA=F2=CD=A8=B9=FD StateTtlCo=
nfig =C6=F4=D3=C3=BB=F2=BD=FB=D3=C3=B8=C3=CC=D8=D0=D4=A3=AC=B1=C8=
=C8=E7=B4=D3 savepoint =D6=D8=C6=F4=BA=F3=A1=A3</p></blockquote><=
h2 style=3D"font-size: 1.5rem; color: rgb(180, 180, 180) !importa=
nt;">2.3. DataStream =D7=B4=CC=AC=CF=E0=B9=D8=B5=C4 Scala API [ma=
pWithState/flatMapWithState]</h2><p style=3D"font-size:1.125rem;c=
olor:rgb(180, 180, 180) !important;">=B3=FD=C1=CB=C9=CF=C3=E6=C3=E8=
=CA=F6=B5=C4=BD=D3=BF=DA=D6=AE=CD=E2=A3=ACScala API =BB=B9=D4=DA=20=
KeyedStream =C9=CF=B6=D4 map() =BA=CD flatMap() =B7=C3=CE=CA Valu=
eState =CC=E1=B9=A9=C1=CB=D2=BB=B8=F6=B8=FC=B1=E3=BD=DD=B5=C4=BD=D3=
=BF=DA=A1=A3<br>=D3=C3=BB=A7=BA=AF=CA=FD=C4=DC=B9=BB=CD=A8=B9=FD=20=
Option =BB=F1=C8=A1=B5=B1=C7=B0 ValueState =B5=C4=D6=B5=A3=AC=B2=A2=
=C7=D2=B7=B5=BB=D8=BC=B4=BD=AB=B1=A3=B4=E6=B5=BD=D7=B4=CC=AC=B5=C4=
=D6=B5=A1=A3</p><h3 style=3D"font-size: 1.375rem; color: rgb(180,=
 180, 180) !important;">2.3.1. mapWithState :</h3></div><div  dat=
a-mode=3D"JavaScript" data-theme=3D"default" id=3D"wiz_cm_1623250=
704517_3979" class=3D"wiz-code-container"><textarea style=3D"disp=
lay: none;">=0Apackage com.boyi.state=0A=0Aimport org.apache.flin=
k.streaming.api.scala.StreamExecutionEnvironment=0Aimport org.apa=
che.flink.api.scala._=0A=0A=0A/**=0A *=0A *=0A * mapWithState =BA=
=AF=CA=FD=CB=B5=C3=F7 :=0A *=0A * mapWithState[R, S]=0A *  (fun :=
 scala.Function2[T, scala.Option[S], scala.Tuple2[ R, scala.Optio=
n[S] ]])=0A * R: TypeInformation =A3=A8return=B7=B5=BB=D8=C0=E0=D0=
=CD=A3=A9=0A * S: TypeInformation =A3=A8stateful=D7=B4=CC=AC=C0=E0=
=D0=CD=A3=A9=0A * T =A3=A8input =CA=E4=C8=EB=C0=E0=D0=CD=A3=A9=0A=
 * fun: (T, Option[S]) =3D&gt; (R, Option[S]) =BA=AF=CA=FD=BD=AB=CA=
=E4=C8=EB=B7=BA=D0=CD=D7=AA=BB=AF=C1=CBR=A3=AC=D7=B4=CC=AC=B7=BA=D0=
=CD=C3=BB=D3=D0=B1=E4=BB=AF=0A *=0A *=0A *=0A * =B0=B8=C0=FD : =BC=
=C6=CB=E3 =B6=AF=CC=AC=BC=C6=CB=E3 =C3=BF=B8=F6key=B5=C4=C6=BD=BE=
=F9=CA=FD=0A */=0Aobject MapWithStateOp extends  App {=0A=0A  val=
 env =3D StreamExecutionEnvironment.getExecutionEnvironment=0A=0A=
  env.fromCollection(List(=0A    (1L, 3L),=0A    (1L, 5L),=0A   =20=
(1L, 7L),=0A    (1L, 4L),=0A    (1L, 2L),=0A    (2L,10L),=0A    (=
2L,2L)=0A  )).keyBy(_._1)=0A    .mapWithState[(Long,Long),(Long,L=
ong)]((input: (Long,Long), out: Option[(Long,Long)]) =3D&gt;=0A =20=
    out match {=0A        case Some(state) =3D&gt; {=0A         =20=
// return  : (key,=C6=BD=BE=F9=CA=FD) , ()=0A          // state =20=
 : (value=B8=F6=CA=FD,value=D7=DC=BA=CD)=0A          ((input._1,(=
(state._2+input._2)/(state._1+1))),Some((state._1+1, state._2+inp=
ut._2)))=0A        }=0A        case None =3D&gt; ((input._1,input=
._2),Some((1L,input._2)))=0A      }).map(x =3D&gt; {=0A    "key :=
 "+x._1+" =3D=3D=3D&gt; avg : "+x._2=0A  }).print()=0A=0A=0A  env=
.execute("MapWithStateOp")=0A}=0A</textarea><wiz_code_mirror><div=
 class=3D"CodeMirror cm-s-default CodeMirror-wrap" data-id=3D"wiz=
_cm_1623250704517_3979"><div style=3D"overflow: hidden; position:=
 relative; width: 3px; height: 0px; top: 20px; left: 34px;"><text=
area autocorrect=3D"off" autocapitalize=3D"off" spellcheck=3D"fal=
se" style=3D"position: absolute; bottom: -1em; padding: 0px; widt=
h: 1000px; height: 1em; outline: none;" tabindex=3D"0"></textarea=
></div><div class=3D"CodeMirror-scrollbar-filler" cm-not-content=3D=
"true"></div><div class=3D"CodeMirror-gutter-filler" cm-not-conte=
nt=3D"true"></div><div class=3D"CodeMirror-scroll" tabindex=3D"-1=
"><div class=3D"CodeMirror-sizer" style=3D"margin-left: 30px; mar=
gin-bottom: 0px; border-right-width: 30px; min-height: 1204px; pa=
dding-right: 0px; padding-bottom: 0px;"><div style=3D"position: r=
elative; top: 0px;"><div class=3D"CodeMirror-lines" role=3D"prese=
ntation"><div role=3D"presentation" style=3D"position: relative;=20=
outline: none;"><div class=3D"CodeMirror-measure"><pre>x</pre><di=
v class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"><div>52</=
div></div></div><div class=3D"CodeMirror-measure"></div><div styl=
e=3D"position: relative; z-index: 1;"></div><div class=3D" wiz-hi=
de wiz_CodeMirror-cursors" style=3D"visibility: hidden;"><div cla=
ss=3D"CodeMirror-cursor" style=3D"left: 4px; top: 0px; height: 23=
px;">&nbsp;</div></div><div class=3D"CodeMirror-code" role=3D"pre=
sentation"><div class=3D"CodeMirror-activeline" style=3D"position=
: relative;"><div class=3D" wiz-hide wiz_CodeMirror-activeline-ba=
ckground CodeMirror-linebackground"></div><div class=3D"CodeMirro=
r-gutter-background CodeMirror-activeline-gutter" style=3D"left:=20=
-30px; width: 30px;"></div><div class=3D"CodeMirror-gutter-wrappe=
r CodeMirror-activeline-gutter" style=3D"left: -30px;"><div class=
=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0=
px; width: 21px;">1</div></div><pre class=3D"CodeMirror-line" rol=
e=3D"presentation"><span role=3D"presentation" style=3D"padding-r=
ight: 0.1px;"><span cm-text=3D""></span></span></pre></div><div s=
tyle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrap=
per" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber C=
odeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">2</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-variable">package</span> <span class=3D"cm-variable">com</spa=
n>.<span class=3D"cm-property">boyi</span>.<span class=3D"cm-prop=
erty">state</span></span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">3</div></div><pre class=3D"Code=
Mirror-line" role=3D"presentation"><span role=3D"presentation" st=
yle=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span></=
pre></div><div style=3D"position: relative;"><div class=3D"CodeMi=
rror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMir=
ror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=20=
21px;">4</div></div><pre class=3D"CodeMirror-line" role=3D"presen=
tation"><span role=3D"presentation" style=3D"padding-right: 0.1px=
;"><span class=3D"cm-keyword">import</span> <span class=3D"cm-def=
">org</span>.<span class=3D"cm-variable">apache</span>.<span clas=
s=3D"cm-property">flink</span>.<span class=3D"cm-property">stream=
ing</span>.<span class=3D"cm-property">api</span>.<span class=3D"=
cm-property">scala</span>.<span class=3D"cm-property">StreamExecu=
tionEnvironment</span></span></pre></div><div style=3D"position:=20=
relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left=
: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-e=
lt" style=3D"left: 0px; width: 21px;">5</div></div><pre class=3D"=
CodeMirror-line" role=3D"presentation"><span role=3D"presentation=
" style=3D"padding-right: 0.1px;"><span class=3D"cm-keyword">impo=
rt</span> <span class=3D"cm-def">org</span>.<span class=3D"cm-var=
iable">apache</span>.<span class=3D"cm-property">flink</span>.<sp=
an class=3D"cm-property">api</span>.<span class=3D"cm-property">s=
cala</span>.<span class=3D"cm-property">_</span></span></pre></di=
v><div style=3D"position: relative;"><div class=3D"CodeMirror-gut=
ter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-line=
number CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">6=
</div></div><pre class=3D"CodeMirror-line" role=3D"presentation">=
<span role=3D"presentation" style=3D"padding-right: 0.1px;"><span=
 cm-text=3D""></span></span></pre></div><div style=3D"position: r=
elative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=
 -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-el=
t" style=3D"left: 0px; width: 21px;">7</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span=
></pre></div><div style=3D"position: relative;"><div class=3D"Cod=
eMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Code=
Mirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; widt=
h: 21px;">8</div></div><pre class=3D"CodeMirror-line" role=3D"pre=
sentation"><span role=3D"presentation" style=3D"padding-right: 0.=
1px;"><span class=3D"cm-comment">/**</span></span></pre></div><di=
v style=3D"position: relative;"><div class=3D"CodeMirror-gutter-w=
rapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumbe=
r CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">9</div=
></div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=
 role=3D"presentation" style=3D"padding-right: 0.1px;"><span clas=
s=3D"cm-comment"> *</span></span></pre></div><div style=3D"positi=
on: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"=
left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutt=
er-elt" style=3D"left: 0px; width: 21px;">10</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"><span class=3D"cm-comment"=
> *</span></span></pre></div><div style=3D"position: relative;"><=
div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><d=
iv class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">11</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"><span class=3D"cm-comment"> * mapWithState=
 =BA=AF=CA=FD=CB=B5=C3=F7 :</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">12</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-c=
omment"> *</span></span></pre></div><div style=3D"position: relat=
ive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30=
px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" s=
tyle=3D"left: 0px; width: 21px;">13</div></div><pre class=3D"Code=
Mirror-line" role=3D"presentation"><span role=3D"presentation" st=
yle=3D"padding-right: 0.1px;"><span class=3D"cm-comment"> * mapWi=
thState[R, S]</span></span></pre></div><div style=3D"position: re=
lative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=20=
-30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt=
" style=3D"left: 0px; width: 21px;">14</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;"><span class=3D"cm-comment"> *  (=
fun : scala.Function2[T, scala.Option[S], scala.Tuple2[ R, scala.=
Option[S] ]])</span></span></pre></div><div style=3D"position: re=
lative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=20=
-30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt=
" style=3D"left: 0px; width: 21px;">15</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;"><span class=3D"cm-comment"> * R:=
 TypeInformation =A3=A8return=B7=B5=BB=D8=C0=E0=D0=CD=A3=A9</span=
></span></pre></div><div style=3D"position: relative;"><div class=
=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D=
"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=
 width: 21px;">16</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span class=3D"cm-comment"> * S: TypeInformation =A3=A8=
stateful=D7=B4=CC=AC=C0=E0=D0=CD=A3=A9</span></span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">17</=
div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><s=
pan role=3D"presentation" style=3D"padding-right: 0.1px;"><span c=
lass=3D"cm-comment"> * T =A3=A8input =CA=E4=C8=EB=C0=E0=D0=CD=A3=A9=
</span></span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">18</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;"><span class=3D"cm-comment"> * fun: (T, Option=
[S]) =3D&gt; (R, Option[S]) =BA=AF=CA=FD=BD=AB=CA=E4=C8=EB=B7=BA=D0=
=CD=D7=AA=BB=AF=C1=CBR=A3=AC=D7=B4=CC=AC=B7=BA=D0=CD=C3=BB=D3=D0=B1=
=E4=BB=AF</span></span></pre></div><div style=3D"position: relati=
ve;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30p=
x;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" st=
yle=3D"left: 0px; width: 21px;">19</div></div><pre class=3D"CodeM=
irror-line" role=3D"presentation"><span role=3D"presentation" sty=
le=3D"padding-right: 0.1px;"><span class=3D"cm-comment"> *</span>=
</span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">20</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span class=3D"cm-comment"> *</span></span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">21<=
/div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><=
span role=3D"presentation" style=3D"padding-right: 0.1px;"><span=20=
class=3D"cm-comment"> *</span></span></pre></div><div style=3D"po=
sition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=
=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt" style=3D"left: 0px; width: 21px;">22</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-comm=
ent"> * =B0=B8=C0=FD : =BC=C6=CB=E3 =B6=AF=CC=AC=BC=C6=CB=E3 =C3=BF=
=B8=F6key=B5=C4=C6=BD=BE=F9=CA=FD</span></span></pre></div><div s=
tyle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrap=
per" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber C=
odeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">23</div><=
/div><pre class=3D"CodeMirror-line" role=3D"presentation"><span r=
ole=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-comment"> */</span></span></pre></div><div style=3D"position:=
 relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"lef=
t: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-=
elt" style=3D"left: 0px; width: 21px;">24</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"><span class=3D"cm-variable">ob=
ject</span> <span class=3D"cm-variable">MapWithStateOp</span> <sp=
an class=3D"cm-keyword">extends</span> &nbsp;<span class=3D"cm-va=
riable">App</span> {</span></pre></div><div style=3D"position: re=
lative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=20=
-30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt=
" style=3D"left: 0px; width: 21px;">25</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span=
></pre></div><div style=3D"position: relative;"><div class=3D"Cod=
eMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Code=
Mirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; widt=
h: 21px;">26</div></div><pre class=3D"CodeMirror-line" role=3D"pr=
esentation"><span role=3D"presentation" style=3D"padding-right: 0=
.1px;"> &nbsp;<span class=3D"cm-variable">val</span> <span class=3D=
"cm-variable">env</span> <span class=3D"cm-operator">=3D</span> <=
span class=3D"cm-variable">StreamExecutionEnvironment</span>.<spa=
n class=3D"cm-property">getExecutionEnvironment</span></span></pr=
e></div><div style=3D"position: relative;"><div class=3D"CodeMirr=
or-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">27</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"><span cm-text=3D""></span></span></pre></div><div style=3D"posi=
tion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">28</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"> &nbsp;<span class=3D"cm-=
variable">env</span>.<span class=3D"cm-property">fromCollection</=
span>(<span class=3D"cm-variable">List</span>(</span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">29<=
/div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><=
span role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp=
;  (<span class=3D"cm-number">1</span><span class=3D"cm-variable"=
>L</span>, <span class=3D"cm-number">3</span><span class=3D"cm-va=
riable">L</span>),</span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">30</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp;  (<span class=3D"cm-number=
">1</span><span class=3D"cm-variable">L</span>, <span class=3D"cm=
-number">5</span><span class=3D"cm-variable">L</span>),</span></p=
re></div><div style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">31</div></div><pre class=3D"CodeMirror-line" role=3D"presen=
tation"><span role=3D"presentation" style=3D"padding-right: 0.1px=
;"> &nbsp;  (<span class=3D"cm-number">1</span><span class=3D"cm-=
variable">L</span>, <span class=3D"cm-number">7</span><span class=
=3D"cm-variable">L</span>),</span></pre></div><div style=3D"posit=
ion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">32</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"> &nbsp;  (<span class=3D"=
cm-number">1</span><span class=3D"cm-variable">L</span>, <span cl=
ass=3D"cm-number">4</span><span class=3D"cm-variable">L</span>),<=
/span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">33</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp;  (<span class=3D"cm-number">1</span><span class=
=3D"cm-variable">L</span>, <span class=3D"cm-number">2</span><spa=
n class=3D"cm-variable">L</span>),</span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">34</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"> &nbsp;  (<span cla=
ss=3D"cm-number">2</span><span class=3D"cm-variable">L</span>,<sp=
an class=3D"cm-number">10</span><span class=3D"cm-variable">L</sp=
an>),</span></pre></div><div style=3D"position: relative;"><div c=
lass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cl=
ass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left=
: 0px; width: 21px;">35</div></div><pre class=3D"CodeMirror-line"=
 role=3D"presentation"><span role=3D"presentation" style=3D"paddi=
ng-right: 0.1px;"> &nbsp;  (<span class=3D"cm-number">2</span><sp=
an class=3D"cm-variable">L</span>,<span class=3D"cm-number">2</sp=
an><span class=3D"cm-variable">L</span>)</span></pre></div><div s=
tyle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrap=
per" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber C=
odeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">36</div><=
/div><pre class=3D"CodeMirror-line" role=3D"presentation"><span r=
ole=3D"presentation" style=3D"padding-right: 0.1px;">  )).<span c=
lass=3D"cm-property">keyBy</span>(<span class=3D"cm-variable">_</=
span>.<span class=3D"cm-property">_1</span>)</span></pre></div><d=
iv style=3D"position: relative;"><div class=3D"CodeMirror-gutter-=
wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumb=
er CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">37</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;=20=
 .<span class=3D"cm-property">mapWithState</span>[(<span class=3D=
"cm-variable">Long</span>,<span class=3D"cm-variable">Long</span>=
),(<span class=3D"cm-variable">Long</span>,<span class=3D"cm-vari=
able">Long</span>)]((<span class=3D"cm-def">input</span>: (<span=20=
class=3D"cm-variable">Long</span>,<span class=3D"cm-variable">Lon=
g</span>), <span class=3D"cm-variable">out</span>: <span class=3D=
"cm-variable">Option</span>[(<span class=3D"cm-variable">Long</sp=
an>,<span class=3D"cm-variable">Long</span>)]) <span class=3D"cm-=
operator">=3D&gt;</span></span></pre></div><div style=3D"position=
: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"le=
ft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter=
-elt" style=3D"left: 0px; width: 21px;">38</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span cla=
ss=3D"cm-variable">out</span> <span class=3D"cm-variable">match</=
span> {</span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">39</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class=3D"cm=
-keyword">case</span> <span class=3D"cm-variable">Some</span>(<sp=
an class=3D"cm-variable">state</span>) <span class=3D"cm-operator=
">=3D&gt;</span> {</span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">40</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
;<span class=3D"cm-comment">// return  : (key,=C6=BD=BE=F9=CA=FD)=
 , ()</span></span></pre></div><div style=3D"position: relative;"=
><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;">=
<div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">41</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span c=
lass=3D"cm-comment">// state &nbsp; : (value=B8=F6=CA=FD,value=D7=
=DC=BA=CD)</span></span></pre></div><div style=3D"position: relat=
ive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30=
px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" s=
tyle=3D"left: 0px; width: 21px;">42</div></div><pre class=3D"Code=
Mirror-line" role=3D"presentation"><span role=3D"presentation" st=
yle=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  ((<sp=
an class=3D"cm-variable">input</span>.<span class=3D"cm-property"=
>_1</span>,((<span class=3D"cm-variable">state</span>.<span class=
=3D"cm-property">_2</span><span class=3D"cm-operator">+</span><sp=
an class=3D"cm-variable">input</span>.<span class=3D"cm-property"=
>_2</span>)<span class=3D"cm-operator">/</span>(<span class=3D"cm=
-variable">state</span>.<span class=3D"cm-property">_1</span><spa=
n class=3D"cm-operator">+</span><span class=3D"cm-number">1</span=
>))),<span class=3D"cm-variable">Some</span>((<span class=3D"cm-v=
ariable">state</span>.<span class=3D"cm-property">_1</span><span=20=
class=3D"cm-operator">+</span><span class=3D"cm-number">1</span>,=
 <span class=3D"cm-variable">state</span>.<span class=3D"cm-prope=
rty">_2</span><span class=3D"cm-operator">+</span><span class=3D"=
cm-variable">input</span>.<span class=3D"cm-property">_2</span>))=
)</span></pre></div><div style=3D"position: relative;"><div class=
=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D=
"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=
 width: 21px;">43</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">44</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbs=
p; &nbsp;<span class=3D"cm-keyword">case</span> <span class=3D"cm=
-def">None</span> <span class=3D"cm-operator">=3D&gt;</span> ((<s=
pan class=3D"cm-variable">input</span>.<span class=3D"cm-property=
">_1</span>,<span class=3D"cm-variable">input</span>.<span class=3D=
"cm-property">_2</span>),<span class=3D"cm-variable">Some</span>(=
(<span class=3D"cm-number">1</span><span class=3D"cm-variable">L<=
/span>,<span class=3D"cm-variable">input</span>.<span class=3D"cm=
-variable">_2</span>)))</span></pre></div><div style=3D"position:=
 relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"lef=
t: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-=
elt" style=3D"left: 0px; width: 21px;">45</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;  }).<span class=
=3D"cm-variable">map</span>(<span class=3D"cm-variable">x</span>=20=
<span class=3D"cm-operator">=3D&gt;</span> {</span></pre></div><d=
iv style=3D"position: relative;"><div class=3D"CodeMirror-gutter-=
wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumb=
er CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">46</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;=20=
&nbsp;<span class=3D"cm-string">"key : "</span><span class=3D"cm-=
operator">+</span><span class=3D"cm-variable">x</span>.<span clas=
s=3D"cm-variable">_1</span><span class=3D"cm-operator">+</span><s=
pan class=3D"cm-string">" =3D=3D=3D&gt; avg : "</span><span class=
=3D"cm-operator">+</span><span class=3D"cm-variable">x</span>.<sp=
an class=3D"cm-variable">_2</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">47</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;">  }).<span class=3D=
"cm-variable">print</span>()</span></pre></div><div style=3D"posi=
tion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">48</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"><span cm-text=3D""></span=
></span></pre></div><div style=3D"position: relative;"><div class=
=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D=
"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=
 width: 21px;">49</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span cm-text=3D""></span></span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">50</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"> &nbsp;<span class=
=3D"cm-variable">env</span>.<span class=3D"cm-variable">execute</=
span>(<span class=3D"cm-string">"MapWithStateOp"</span>)</span></=
pre></div><div style=3D"position: relative;"><div class=3D"CodeMi=
rror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMir=
ror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=20=
21px;">51</div></div><pre class=3D"CodeMirror-line" role=3D"prese=
ntation"><span role=3D"presentation" style=3D"padding-right: 0.1p=
x;">}</span></pre></div><div class=3D"" style=3D"position: relati=
ve;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30p=
x;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" st=
yle=3D"left: 0px; width: 21px;">52</div></div><pre class=3D"CodeM=
irror-line" role=3D"presentation"><span role=3D"presentation" sty=
le=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span></p=
re></div></div></div></div></div></div><div style=3D"position: ab=
solute; height: 13px; width: 1px; border-bottom-width: 0px; borde=
r-bottom-style: solid; border-bottom-color: transparent; top: 120=
4px;"></div><div class=3D"CodeMirror-gutters" style=3D"height: 12=
34px;"><div class=3D"CodeMirror-gutter CodeMirror-linenumbers" st=
yle=3D"width: 29px;"></div></div></div></div></wiz_code_mirror></=
div><div><h3 style=3D"font-size: 1.375rem; color: rgb(180, 180, 1=
80) !important; background: rgb(38, 39, 40) !important;">2.3.2.fl=
atMapWithState :</h3></div><div  data-mode=3D"JavaScript" data-th=
eme=3D"default" id=3D"wiz_cm_1623250704452_1971" class=3D"wiz-cod=
e-container"><textarea style=3D"display: none;">=0Apackage com.bo=
yi.state=0A=0Aimport org.apache.flink.streaming.api.scala.StreamE=
xecutionEnvironment=0Aimport org.apache.flink.api.scala._=0A=0A=0A=
/**=0A *=0A *=0A * flatMapWithState =BA=AF=CA=FD=CB=B5=C3=F7 :=0A=
 *=0A * flatMapWithState[R, S]=0A *  (fun : scala.Function2[T, sc=
ala.Option[S], scala.Tuple2[ scala.TraversableOnce[R], scala.Opti=
on[S] ]])=0A * R: TypeInformation =A3=A8return=B7=B5=BB=D8=C0=E0=D0=
=CD=A3=A9=0A * S: TypeInformation =A3=A8stateful=D7=B4=CC=AC=C0=E0=
=D0=CD=A3=A9=0A * T =A3=A8input =CA=E4=C8=EB=C0=E0=D0=CD=A3=A9=0A=
 * fun: (T, Option[S]) =3D&gt; (R, Option[S]) =BA=AF=CA=FD=BD=AB=CA=
=E4=C8=EB=B7=BA=D0=CD=D7=AA=BB=AF=C1=CBR=A3=AC=D7=B4=CC=AC=B7=BA=D0=
=CD=C3=BB=D3=D0=B1=E4=BB=AF=0A *=0A *=0A *=0A * =B0=B8=C0=FD : =BC=
=C6=CB=E3 =B6=AF=CC=AC=BC=C6=CB=E3 =C3=BF=B8=F6key=B5=C4=C6=BD=BE=
=F9=CA=FD=0A */=0Aobject FlatMapWithStateOp extends  App {=0A=0A=20=
 val env =3D StreamExecutionEnvironment.getExecutionEnvironment=0A=
=0A  env.fromCollection(List(=0A    (1L, 3L),=0A    (1L, 5L),=0A=20=
   (1L, 7L),=0A    (1L, 4L),=0A    (1L, 2L),=0A    (2L,10L),=0A =20=
  (2L,2L)=0A  )).keyBy(_._1)=0A    //=0A    .flatMapWithState[(Lo=
ng,Long),(Long,Long)]((input: (Long,Long), state: Option[(Long,Lo=
ng)]) =3D&gt;=0A      state match {=0A        case Some(state) =3D=
&gt; {=0A          // return  : (key,=C6=BD=BE=F9=CA=FD) , ()=0A=20=
         // state   : (value=B8=F6=CA=FD,value=D7=DC=BA=CD)=0A  =20=
       ( List((input._1,((state._2+input._2)/(state._1+1)))),Some=
((state._1+1,state._2+input._2)) )=0A        }=0A        case Non=
e =3D&gt; ( List((input._1,input._2)),Some((1L,input._2)) )=0A  =20=
   }).map(x=3D&gt; "key : "+x._1 + "  =3D=3D=3D=3D&gt; value : "=20=
+ x._2)=0A      .print()=0A=0A=0A  env.execute("FlatMapWithStateO=
p")=0A}=0A</textarea><wiz_code_mirror><div class=3D"CodeMirror cm=
-s-default CodeMirror-wrap" data-id=3D"wiz_cm_1623250704452_1971"=
><div style=3D"overflow: hidden; position: relative; width: 3px;=20=
height: 0px; top: 20px; left: 34px;"><textarea autocorrect=3D"off=
" autocapitalize=3D"off" spellcheck=3D"false" style=3D"position:=20=
absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em;=
 outline: none;" tabindex=3D"0"></textarea></div><div class=3D"Co=
deMirror-scrollbar-filler" cm-not-content=3D"true"></div><div cla=
ss=3D"CodeMirror-gutter-filler" cm-not-content=3D"true"></div><di=
v class=3D"CodeMirror-scroll" tabindex=3D"-1"><div class=3D"CodeM=
irror-sizer" style=3D"margin-left: 30px; margin-bottom: 0px; bord=
er-right-width: 30px; min-height: 1204px; padding-right: 0px; pad=
ding-bottom: 0px;"><div style=3D"position: relative; top: 0px;"><=
div class=3D"CodeMirror-lines" role=3D"presentation"><div role=3D=
"presentation" style=3D"position: relative; outline: none;"><div=20=
class=3D"CodeMirror-measure"><pre>x</pre><div class=3D"CodeMirror=
-linenumber CodeMirror-gutter-elt"><div>52</div></div></div><div=20=
class=3D"CodeMirror-measure"></div><div style=3D"position: relati=
ve; z-index: 1;"></div><div class=3D" wiz-hide wiz_CodeMirror-cur=
sors"><div class=3D"CodeMirror-cursor" style=3D"left: 4px; top: 0=
px; height: 23px;">&nbsp;</div></div><div class=3D"CodeMirror-cod=
e" role=3D"presentation"><div class=3D"CodeMirror-activeline" sty=
le=3D"position: relative;"><div class=3D" wiz-hide wiz_CodeMirror=
-activeline-background CodeMirror-linebackground"></div><div clas=
s=3D"CodeMirror-gutter-background CodeMirror-activeline-gutter" s=
tyle=3D"left: -30px; width: 30px;"></div><div class=3D"CodeMirror=
-gutter-wrapper CodeMirror-activeline-gutter" style=3D"left: -30p=
x;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" st=
yle=3D"left: 0px; width: 21px;">1</div></div><pre class=3D"CodeMi=
rror-line" role=3D"presentation"><span role=3D"presentation" styl=
e=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span></pr=
e></div><div style=3D"position: relative;"><div class=3D"CodeMirr=
or-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">2</div></div><pre class=3D"CodeMirror-line" role=3D"presenta=
tion"><span role=3D"presentation" style=3D"padding-right: 0.1px;"=
><span class=3D"cm-variable">package</span> <span class=3D"cm-var=
iable">com</span>.<span class=3D"cm-property">boyi</span>.<span c=
lass=3D"cm-property">state</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">3</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""><=
/span></span></pre></div><div style=3D"position: relative;"><div=20=
class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div c=
lass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"lef=
t: 0px; width: 21px;">4</div></div><pre class=3D"CodeMirror-line"=
 role=3D"presentation"><span role=3D"presentation" style=3D"paddi=
ng-right: 0.1px;"><span class=3D"cm-keyword">import</span> <span=20=
class=3D"cm-def">org</span>.<span class=3D"cm-variable">apache</s=
pan>.<span class=3D"cm-property">flink</span>.<span class=3D"cm-p=
roperty">streaming</span>.<span class=3D"cm-property">api</span>.=
<span class=3D"cm-property">scala</span>.<span class=3D"cm-proper=
ty">StreamExecutionEnvironment</span></span></pre></div><div styl=
e=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper=
" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Code=
Mirror-gutter-elt" style=3D"left: 0px; width: 21px;">5</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-=
keyword">import</span> <span class=3D"cm-def">org</span>.<span cl=
ass=3D"cm-variable">apache</span>.<span class=3D"cm-property">fli=
nk</span>.<span class=3D"cm-property">api</span>.<span class=3D"c=
m-property">scala</span>.<span class=3D"cm-property">_</span></sp=
an></pre></div><div style=3D"position: relative;"><div class=3D"C=
odeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">6</div></div><pre class=3D"CodeMirror-line" role=3D"p=
resentation"><span role=3D"presentation" style=3D"padding-right:=20=
0.1px;"><span cm-text=3D""></span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">7</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""><=
/span></span></pre></div><div style=3D"position: relative;"><div=20=
class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div c=
lass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"lef=
t: 0px; width: 21px;">8</div></div><pre class=3D"CodeMirror-line"=
 role=3D"presentation"><span role=3D"presentation" style=3D"paddi=
ng-right: 0.1px;"><span class=3D"cm-comment">/**</span></span></p=
re></div><div style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">9</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"><span class=3D"cm-comment"> *</span></span></pre></div><div sty=
le=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrappe=
r" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Cod=
eMirror-gutter-elt" style=3D"left: 0px; width: 21px;">10</div></d=
iv><pre class=3D"CodeMirror-line" role=3D"presentation"><span rol=
e=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-comment"> *</span></span></pre></div><div style=3D"position:=20=
relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left=
: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-e=
lt" style=3D"left: 0px; width: 21px;">11</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"><span class=3D"cm-comment"> *=20=
flatMapWithState =BA=AF=CA=FD=CB=B5=C3=F7 :</span></span></pre></=
div><div style=3D"position: relative;"><div class=3D"CodeMirror-g=
utter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-li=
nenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;"=
>12</div></div><pre class=3D"CodeMirror-line" role=3D"presentatio=
n"><span role=3D"presentation" style=3D"padding-right: 0.1px;"><s=
pan class=3D"cm-comment"> *</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">13</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-c=
omment"> * flatMapWithState[R, S]</span></span></pre></div><div s=
tyle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrap=
per" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber C=
odeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">14</div><=
/div><pre class=3D"CodeMirror-line" role=3D"presentation"><span r=
ole=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-comment"> *  (fun : scala.Function2[T, scala.Option[S], scala=
.Tuple2[ scala.TraversableOnce[R], scala.Option[S] ]])</span></sp=
an></pre></div><div style=3D"position: relative;"><div class=3D"C=
odeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">15</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;"><span class=3D"cm-comment"> * R: TypeInformation =A3=A8r=
eturn=B7=B5=BB=D8=C0=E0=D0=CD=A3=A9</span></span></pre></div><div=
 style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wr=
apper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=
 CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">16</div=
></div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=
 role=3D"presentation" style=3D"padding-right: 0.1px;"><span clas=
s=3D"cm-comment"> * S: TypeInformation =A3=A8stateful=D7=B4=CC=AC=
=C0=E0=D0=CD=A3=A9</span></span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">17</div></div><pre class=
=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presenta=
tion" style=3D"padding-right: 0.1px;"><span class=3D"cm-comment">=
 * T =A3=A8input =CA=E4=C8=EB=C0=E0=D0=CD=A3=A9</span></span></pr=
e></div><div style=3D"position: relative;"><div class=3D"CodeMirr=
or-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">18</div></div><pre class=3D"CodeMirror-line" role=3D"present=
ation"><span role=3D"presentation" style=3D"padding-right: 0.1px;=
"><span class=3D"cm-comment"> * fun: (T, Option[S]) =3D&gt; (R, O=
ption[S]) =BA=AF=CA=FD=BD=AB=CA=E4=C8=EB=B7=BA=D0=CD=D7=AA=BB=AF=C1=
=CBR=A3=AC=D7=B4=CC=AC=B7=BA=D0=CD=C3=BB=D3=D0=B1=E4=BB=AF</span>=
</span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">19</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span class=3D"cm-comment"> *</span></span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">20<=
/div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><=
span role=3D"presentation" style=3D"padding-right: 0.1px;"><span=20=
class=3D"cm-comment"> *</span></span></pre></div><div style=3D"po=
sition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=
=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt" style=3D"left: 0px; width: 21px;">21</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-comm=
ent"> *</span></span></pre></div><div style=3D"position: relative=
;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;=
"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" styl=
e=3D"left: 0px; width: 21px;">22</div></div><pre class=3D"CodeMir=
ror-line" role=3D"presentation"><span role=3D"presentation" style=
=3D"padding-right: 0.1px;"><span class=3D"cm-comment"> * =B0=B8=C0=
=FD : =BC=C6=CB=E3 =B6=AF=CC=AC=BC=C6=CB=E3 =C3=BF=B8=F6key=B5=C4=
=C6=BD=BE=F9=CA=FD</span></span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">23</div></div><pre class=
=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presenta=
tion" style=3D"padding-right: 0.1px;"><span class=3D"cm-comment">=
 */</span></span></pre></div><div style=3D"position: relative;"><=
div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><d=
iv class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">24</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"><span class=3D"cm-variable">object</span>=20=
<span class=3D"cm-variable">FlatMapWithStateOp</span> <span class=
=3D"cm-keyword">extends</span> &nbsp;<span class=3D"cm-variable">=
App</span> {</span></pre></div><div style=3D"position: relative;"=
><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;">=
<div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">25</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"><span cm-text=3D""></span></span></pre></d=
iv><div style=3D"position: relative;"><div class=3D"CodeMirror-gu=
tter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-lin=
enumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">=
26</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"> &n=
bsp;<span class=3D"cm-variable">val</span> <span class=3D"cm-vari=
able">env</span> <span class=3D"cm-operator">=3D</span> <span cla=
ss=3D"cm-variable">StreamExecutionEnvironment</span>.<span class=3D=
"cm-property">getExecutionEnvironment</span></span></pre></div><d=
iv style=3D"position: relative;"><div class=3D"CodeMirror-gutter-=
wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumb=
er CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">27</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"><span cm=
-text=3D""></span></span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">28</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp;<span class=3D"cm-variable"=
>env</span>.<span class=3D"cm-property">fromCollection</span>(<sp=
an class=3D"cm-variable">List</span>(</span></pre></div><div styl=
e=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper=
" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Code=
Mirror-gutter-elt" style=3D"left: 0px; width: 21px;">29</div></di=
v><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=
=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;  (<span=
 class=3D"cm-number">1</span><span class=3D"cm-variable">L</span>=
, <span class=3D"cm-number">3</span><span class=3D"cm-variable">L=
</span>),</span></pre></div><div style=3D"position: relative;"><d=
iv class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><di=
v class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"=
left: 0px; width: 21px;">30</div></div><pre class=3D"CodeMirror-l=
ine" role=3D"presentation"><span role=3D"presentation" style=3D"p=
adding-right: 0.1px;"> &nbsp;  (<span class=3D"cm-number">1</span=
><span class=3D"cm-variable">L</span>, <span class=3D"cm-number">=
5</span><span class=3D"cm-variable">L</span>),</span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">31<=
/div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><=
span role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp=
;  (<span class=3D"cm-number">1</span><span class=3D"cm-variable"=
>L</span>, <span class=3D"cm-number">7</span><span class=3D"cm-va=
riable">L</span>),</span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">32</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp;  (<span class=3D"cm-number=
">1</span><span class=3D"cm-variable">L</span>, <span class=3D"cm=
-number">4</span><span class=3D"cm-variable">L</span>),</span></p=
re></div><div style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">33</div></div><pre class=3D"CodeMirror-line" role=3D"presen=
tation"><span role=3D"presentation" style=3D"padding-right: 0.1px=
;"> &nbsp;  (<span class=3D"cm-number">1</span><span class=3D"cm-=
variable">L</span>, <span class=3D"cm-number">2</span><span class=
=3D"cm-variable">L</span>),</span></pre></div><div style=3D"posit=
ion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">34</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"> &nbsp;  (<span class=3D"=
cm-number">2</span><span class=3D"cm-variable">L</span>,<span cla=
ss=3D"cm-number">10</span><span class=3D"cm-variable">L</span>),<=
/span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">35</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp;  (<span class=3D"cm-number">2</span><span class=
=3D"cm-variable">L</span>,<span class=3D"cm-number">2</span><span=
 class=3D"cm-variable">L</span>)</span></pre></div><div style=3D"=
position: relative;"><div class=3D"CodeMirror-gutter-wrapper" sty=
le=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirro=
r-gutter-elt" style=3D"left: 0px; width: 21px;">36</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;">  )).<span class=3D"=
cm-property">keyBy</span>(<span class=3D"cm-variable">_</span>.<s=
pan class=3D"cm-property">_1</span>)</span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">37</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<spa=
n class=3D"cm-comment">//</span></span></pre></div><div style=3D"=
position: relative;"><div class=3D"CodeMirror-gutter-wrapper" sty=
le=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirro=
r-gutter-elt" style=3D"left: 0px; width: 21px;">38</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"> &nbsp;  .<span clas=
s=3D"cm-property">flatMapWithState</span>[(<span class=3D"cm-vari=
able">Long</span>,<span class=3D"cm-variable">Long</span>),(<span=
 class=3D"cm-variable">Long</span>,<span class=3D"cm-variable">Lo=
ng</span>)]((<span class=3D"cm-def">input</span>: (<span class=3D=
"cm-variable">Long</span>,<span class=3D"cm-variable">Long</span>=
), <span class=3D"cm-variable">state</span>: <span class=3D"cm-va=
riable">Option</span>[(<span class=3D"cm-variable">Long</span>,<s=
pan class=3D"cm-variable">Long</span>)]) <span class=3D"cm-operat=
or">=3D&gt;</span></span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">39</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class=3D=
"cm-variable">state</span> <span class=3D"cm-variable">match</spa=
n> {</span></pre></div><div style=3D"position: relative;"><div cl=
ass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=
 0px; width: 21px;">40</div></div><pre class=3D"CodeMirror-line"=20=
role=3D"presentation"><span role=3D"presentation" style=3D"paddin=
g-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class=3D"cm-ke=
yword">case</span> <span class=3D"cm-variable">Some</span>(<span=20=
class=3D"cm-variable">state</span>) <span class=3D"cm-operator">=3D=
&gt;</span> {</span></pre></div><div style=3D"position: relative;=
"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"=
><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=
=3D"left: 0px; width: 21px;">41</div></div><pre class=3D"CodeMirr=
or-line" role=3D"presentation"><span role=3D"presentation" style=3D=
"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span=20=
class=3D"cm-comment">// return  : (key,=C6=BD=BE=F9=CA=FD) , ()</=
span></span></pre></div><div style=3D"position: relative;"><div c=
lass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cl=
ass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left=
: 0px; width: 21px;">42</div></div><pre class=3D"CodeMirror-line"=
 role=3D"presentation"><span role=3D"presentation" style=3D"paddi=
ng-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class=3D=
"cm-comment">// state &nbsp; : (value=B8=F6=CA=FD,value=D7=DC=BA=CD=
)</span></span></pre></div><div style=3D"position: relative;"><di=
v class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=
 class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"l=
eft: 0px; width: 21px;">43</div></div><pre class=3D"CodeMirror-li=
ne" role=3D"presentation"><span role=3D"presentation" style=3D"pa=
dding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  ( <span class=3D=
"cm-variable">List</span>((<span class=3D"cm-variable">input</spa=
n>.<span class=3D"cm-property">_1</span>,((<span class=3D"cm-vari=
able">state</span>.<span class=3D"cm-property">_2</span><span cla=
ss=3D"cm-operator">+</span><span class=3D"cm-variable">input</spa=
n>.<span class=3D"cm-property">_2</span>)<span class=3D"cm-operat=
or">/</span>(<span class=3D"cm-variable">state</span>.<span class=
=3D"cm-property">_1</span><span class=3D"cm-operator">+</span><sp=
an class=3D"cm-number">1</span>)))),<span class=3D"cm-variable">S=
ome</span>((<span class=3D"cm-variable">state</span>.<span class=3D=
"cm-property">_1</span><span class=3D"cm-operator">+</span><span=20=
class=3D"cm-number">1</span>,<span class=3D"cm-variable">state</s=
pan>.<span class=3D"cm-property">_2</span><span class=3D"cm-opera=
tor">+</span><span class=3D"cm-variable">input</span>.<span class=
=3D"cm-property">_2</span>)) )</span></pre></div><div style=3D"po=
sition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=
=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt" style=3D"left: 0px; width: 21px;">44</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;=20=
 }</span></pre></div><div style=3D"position: relative;"><div clas=
s=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=
=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0=
px; width: 21px;">45</div></div><pre class=3D"CodeMirror-line" ro=
le=3D"presentation"><span role=3D"presentation" style=3D"padding-=
right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class=3D"cm-keyw=
ord">case</span> <span class=3D"cm-def">None</span> <span class=3D=
"cm-operator">=3D&gt;</span> ( <span class=3D"cm-variable">List</=
span>((<span class=3D"cm-variable">input</span>.<span class=3D"cm=
-property">_1</span>,<span class=3D"cm-variable">input</span>.<sp=
an class=3D"cm-property">_2</span>)),<span class=3D"cm-variable">=
Some</span>((<span class=3D"cm-number">1</span><span class=3D"cm-=
variable">L</span>,<span class=3D"cm-variable">input</span>.<span=
 class=3D"cm-variable">_2</span>)) )</span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">46</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;  })=
.<span class=3D"cm-variable">map</span>(<span class=3D"cm-variabl=
e">x</span><span class=3D"cm-operator">=3D&gt;</span> <span class=
=3D"cm-string">"key : "</span><span class=3D"cm-operator">+</span=
><span class=3D"cm-variable">x</span>.<span class=3D"cm-variable"=
>_1</span> <span class=3D"cm-operator">+</span> <span class=3D"cm=
-string">"  =3D=3D=3D=3D&gt; value : "</span> <span class=3D"cm-o=
perator">+</span> <span class=3D"cm-variable">x</span>.<span clas=
s=3D"cm-variable">_2</span>)</span></pre></div><div style=3D"posi=
tion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">47</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;  .<span cl=
ass=3D"cm-variable">print</span>()</span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">48</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"><span cm-text=3D"">=
</span></span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">49</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;"><span cm-text=3D""></span></span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">50<=
/div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><=
span role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp=
;<span class=3D"cm-variable">env</span>.<span class=3D"cm-variabl=
e">execute</span>(<span class=3D"cm-string">"FlatMapWithStateOp"<=
/span>)</span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">51</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;">}</span></pre></div><div class=3D"" style=3D"=
position: relative;"><div class=3D"CodeMirror-gutter-wrapper" sty=
le=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirro=
r-gutter-elt" style=3D"left: 0px; width: 21px;">52</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""><=
/span></span></pre></div></div></div></div></div></div><div style=
=3D"position: absolute; height: 13px; width: 1px; border-bottom-w=
idth: 0px; border-bottom-style: solid; border-bottom-color: trans=
parent; top: 1204px;"></div><div class=3D"CodeMirror-gutters" sty=
le=3D"height: 1234px;"><div class=3D"CodeMirror-gutter CodeMirror=
-linenumbers" style=3D"width: 29px;"></div></div></div></div></wi=
z_code_mirror></div><div id=3D"content_views" class=3D"markdown_v=
iews prism-tomorrow-night" style=3D"color: rgb(196, 196, 200) !im=
portant; background: rgb(38, 39, 40) !important;"><h1 style=3D"fo=
nt-size: 1.75rem; color: rgb(180, 180, 180) !important;">=C8=FD .=
Operator State</h1><ul style=3D"color: rgb(180, 180, 180) !import=
ant;"><li style=3D"background: rgb(38, 39, 40) !important;"><p st=
yle=3D"font-size: 1.125rem;">=D3=EBKey=CE=DE=B9=D8=B5=C4State=A3=AC=
=D3=EBOperator=B0=F3=B6=A8=B5=C4state=A3=AC=D5=FB=B8=F6operator<c=
ode style=3D"font-size: 0.875rem; background-color: rgb(64, 64, 6=
5) !important;">=D6=BB=B6=D4=D3=A6=D2=BB=B8=F6</code>state</p></l=
i><li style=3D"background: rgb(38, 39, 40) !important;"><p style=3D=
"font-size: 1.125rem;">=B1=A3=B4=E6state=B5=C4=CA=FD=BE=DD=BD=E1=B9=
=B9</p><ul><li style=3D"background: rgb(38, 39, 40) !important;">=
ListState</li></ul></li><li style=3D"background: rgb(38, 39, 40)=20=
!important;"><p style=3D"font-size: 1.125rem;">=BE=D9=C0=FD=C0=B4=
=CB=B5=A3=ACFlink=D6=D0=B5=C4Kafka Connector=A3=AC=BE=CD=CA=B9=D3=
=C3=C1=CBoperator state=A1=A3=CB=FC=BB=E1=D4=DA=C3=BF=B8=F6connec=
tor=CA=B5=C0=FD=D6=D0=A3=AC=B1=A3=B4=E6=B8=C3=CA=B5=C0=FD=D6=D0=CF=
=FB=B7=D1topic=B5=C4=CB=F9=D3=D0(partition, offset)=D3=B3=C9=E4</=
p></li></ul><h3 style=3D"font-size: 1.375rem; color: rgb(180, 180=
, 180) !important;">1.5.1. CheckpointedFunction</h3><p style=3D"f=
ont-size:1.125rem;color:rgb(180, 180, 180) !important;">=D3=C3=BB=
=A7=BF=C9=D2=D4=CD=A8=B9=FD=CA=B5=CF=D6 CheckpointedFunction =BD=D3=
=BF=DA=C0=B4=CA=B9=D3=C3 operator state=A1=A3<br>CheckpointedFunc=
tion =BD=D3=BF=DA=CC=E1=B9=A9=C1=CB=B7=C3=CE=CA non-keyed state =B5=
=C4=B7=BD=B7=A8=A3=AC=D0=E8=D2=AA=CA=B5=CF=D6=C8=E7=CF=C2=C1=BD=B8=
=F6=B7=BD=B7=A8=A3=BA</p><blockquote style=3D"color:rgb(180, 180,=
 180) !important;background:rgb(46, 47, 48) !important;"><p style=
=3D"font-size: 0.875rem;">void snapshotState(FunctionSnapshotCont=
ext context) throws Exception;</p></blockquote><blockquote style=3D=
"color:rgb(180, 180, 180) !important;background:rgb(46, 47, 48) !=
important;"><p style=3D"font-size: 0.875rem;">void initializeStat=
e(FunctionInitializationContext context) throws Exception;</p></b=
lockquote><p style=3D"font-size:1.125rem;color:rgb(180, 180, 180)=
 !important;">=BD=F8=D0=D0 checkpoint =CA=B1=BB=E1=B5=F7=D3=C3 sn=
apshotState()=A1=A3 =D3=C3=BB=A7=D7=D4=B6=A8=D2=E5=BA=AF=CA=FD=B3=
=F5=CA=BC=BB=AF=CA=B1=BB=E1=B5=F7=D3=C3 initializeState()=A3=AC=B3=
=F5=CA=BC=BB=AF=B0=FC=C0=A8=B5=DA=D2=BB=B4=CE=D7=D4=B6=A8=D2=E5=BA=
=AF=CA=FD=B3=F5=CA=BC=BB=AF=BA=CD=B4=D3=D6=AE=C7=B0=B5=C4 checkpo=
int =BB=D6=B8=B4=A1=A3 =D2=F2=B4=CB initializeState() =B2=BB=BD=F6=
=CA=C7=B6=A8=D2=E5=B2=BB=CD=AC=D7=B4=CC=AC=C0=E0=D0=CD=B3=F5=CA=BC=
=BB=AF=B5=C4=B5=D8=B7=BD=A3=AC=D2=B2=D0=E8=D2=AA=B0=FC=C0=A8=D7=B4=
=CC=AC=BB=D6=B8=B4=B5=C4=C2=DF=BC=AD=A1=A3</p><p style=3D"font-si=
ze:1.125rem;color:rgb(180, 180, 180) !important;">=B5=B1=C7=B0 op=
erator state =D2=D4 list =B5=C4=D0=CE=CA=BD=B4=E6=D4=DA=A1=A3=D5=E2=
=D0=A9=D7=B4=CC=AC=CA=C7=D2=BB=B8=F6 =BF=C9=D0=F2=C1=D0=BB=AF =B6=
=D4=CF=F3=B5=C4=BC=AF=BA=CF List=A3=AC=B1=CB=B4=CB=B6=C0=C1=A2=A3=
=AC=B7=BD=B1=E3=D4=DA=B8=C4=B1=E4=B2=A2=B7=A2=BA=F3=BD=F8=D0=D0=D7=
=B4=CC=AC=B5=C4=D6=D8=D0=C2=B7=D6=C5=C9=A1=A3 =BB=BB=BE=E4=BB=B0=CB=
=B5=A3=AC=D5=E2=D0=A9=B6=D4=CF=F3=CA=C7=D6=D8=D0=C2=B7=D6=C5=E4 n=
on-keyed state =B5=C4=D7=EE=CF=B8=C1=A3=B6=C8=A1=A3=B8=F9=BE=DD=D7=
=B4=CC=AC=B5=C4=B2=BB=CD=AC=B7=C3=CE=CA=B7=BD=CA=BD=A3=AC=D3=D0=C8=
=E7=CF=C2=BC=B8=D6=D6=D6=D8=D0=C2=B7=D6=C5=E4=B5=C4=C4=A3=CA=BD=A3=
=BA</p><ul style=3D"color: rgb(180, 180, 180) !important;"><li st=
yle=3D"background: rgb(38, 39, 40) !important;"><p style=3D"font-=
size: 1.125rem;"><strong>Even-split redistribution</strong>: =C3=BF=
=B8=F6=CB=E3=D7=D3=B6=BC=B1=A3=B4=E6=D2=BB=B8=F6=C1=D0=B1=ED=D0=CE=
=CA=BD=B5=C4=D7=B4=CC=AC=BC=AF=BA=CF=A3=AC=D5=FB=B8=F6=D7=B4=CC=AC=
=D3=C9=CB=F9=D3=D0=B5=C4=C1=D0=B1=ED=C6=B4=BD=D3=B6=F8=B3=C9=A1=A3=
=B5=B1=D7=F7=D2=B5=BB=D6=B8=B4=BB=F2=D6=D8=D0=C2=B7=D6=C5=E4=B5=C4=
=CA=B1=BA=F2=A3=AC=D5=FB=B8=F6=D7=B4=CC=AC=BB=E1=B0=B4=D5=D5=CB=E3=
=D7=D3=B5=C4=B2=A2=B7=A2=B6=C8=BD=F8=D0=D0<strong>=BE=F9=D4=C8=B7=
=D6=C5=E4</strong>=A1=A3 =B1=C8=C8=E7=CB=B5=A3=AC=CB=E3=D7=D3 A =B5=
=C4=B2=A2=B7=A2=B6=C1=CE=AA 1=A3=AC=B0=FC=BA=AC=C1=BD=B8=F6=D4=AA=
=CB=D8 element1 =BA=CD element2=A3=AC=B5=B1=B2=A2=B7=A2=B6=C1=D4=F6=
=BC=D3=CE=AA 2 =CA=B1=A3=ACelement1 =BB=E1=B1=BB=B7=D6=B5=BD=B2=A2=
=B7=A2 0 =C9=CF=A3=ACelement2 =D4=F2=BB=E1=B1=BB=B7=D6=B5=BD=B2=A2=
=B7=A2 1 =C9=CF=A1=A3</p></li><li style=3D"background: rgb(38, 39=
, 40) !important;"><p style=3D"font-size: 1.125rem;"><strong>Unio=
n redistribution</strong>: =C3=BF=B8=F6=CB=E3=D7=D3=B1=A3=B4=E6=D2=
=BB=B8=F6=C1=D0=B1=ED=D0=CE=CA=BD=B5=C4=D7=B4=CC=AC=BC=AF=BA=CF=A1=
=A3=D5=FB=B8=F6=D7=B4=CC=AC=D3=C9=CB=F9=D3=D0=B5=C4=C1=D0=B1=ED=C6=
=B4=BD=D3=B6=F8=B3=C9=A1=A3=B5=B1=D7=F7=D2=B5=BB=D6=B8=B4=BB=F2=D6=
=D8=D0=C2=B7=D6=C5=E4=CA=B1=A3=AC=C3=BF=B8=F6=CB=E3=D7=D3=B6=BC=BD=
=AB=BB=F1=B5=C3<strong>=CB=F9=D3=D0=B5=C4=D7=B4=CC=AC=CA=FD=BE=DD=
</strong>=A1=A3 Do not use this feature if your list may have hig=
h cardinality. Checkpoint metadata will store an offset to each l=
ist entry, which could lead to RPC framesize or out-of-memory err=
ors.</p></li></ul></div><p style=3D"color:rgb(180, 180, 180) !imp=
ortant;background:rgb(38, 39, 40) !important;font-size:1.125rem">=
=CF=C2=C3=E6=B5=C4=C0=FD=D7=D3=D6=D0=B5=C4 SinkFunction =D4=DA Ch=
eckpointedFunction =D6=D0=BD=F8=D0=D0=CA=FD=BE=DD=BB=BA=B4=E6=A3=AC=
=C8=BB=BA=F3=CD=B3=D2=BB=B7=A2=CB=CD=B5=BD=CF=C2=D3=CE=A3=AC=D5=E2=
=B8=F6=C0=FD=D7=D3=D1=DD=CA=BE=C1=CB=C1=D0=B1=ED=D7=B4=CC=AC=CA=FD=
=BE=DD=B5=C4 event-split redistribution=A1=A3</p><div  data-mode=3D=
"JavaScript" data-theme=3D"default" id=3D"wiz_cm_1623250704380_71=
96" class=3D"wiz-code-container"><textarea style=3D"display: none=
;">package com.boyi.state=0A=0Aimport org.apache.flink.api.common=
.state.{ListState, ListStateDescriptor}=0Aimport org.apache.flink=
.api.common.typeinfo.{TypeHint, TypeInformation}=0Aimport org.apa=
che.flink.runtime.state.{FunctionInitializationContext, FunctionS=
napshotContext}=0Aimport org.apache.flink.streaming.api.checkpoin=
t.CheckpointedFunction=0Aimport org.apache.flink.streaming.api.fu=
nctions.sink.SinkFunction=0Aimport org.apache.flink.streaming.api=
.functions.sink.SinkFunction.Context=0A=0Aimport scala.collection=
.mutable.ListBuffer=0A=0Aclass BufferingSink(threshold: Int =3D 0=
)=0A  extends SinkFunction[(String, Int)]=0A    with Checkpointed=
Function {=0A=0A  @transient=0A  private var checkpointedState: L=
istState[(String, Int)] =3D _=0A=0A  private val bufferedElements=
 =3D ListBuffer[(String, Int)]()=0A=0A  override def invoke(value=
: (String, Int), context: Context): Unit =3D {=0A    bufferedElem=
ents +=3D value=0A    if (bufferedElements.size =3D=3D threshold)=
 {=0A      for (element &lt;- bufferedElements) {=0A        // se=
nd it to the sink=0A      }=0A      bufferedElements.clear()=0A =20=
  }=0A  }=0A=0A  override def snapshotState(context: FunctionSnap=
shotContext): Unit =3D {=0A    checkpointedState.clear()=0A=0A  =20=
 bufferedElements.foreach(element =3D&gt; {=0A      checkpointedS=
tate.add(element)=0A    })=0A  }=0A=0A  override def initializeSt=
ate(context: FunctionInitializationContext): Unit =3D {=0A    val=
 descriptor =3D new ListStateDescriptor[(String, Int)](=0A      "=
buffered-elements",=0A      TypeInformation.of(new TypeHint[(Stri=
ng, Int)]() {})=0A    )=0A=0A    checkpointedState =3D context.ge=
tOperatorStateStore.getListState(descriptor)=0A=0A    if(context.=
isRestored) {=0A      val iterate  =3D checkpointedState.get()=0A=
      iterate.forEach(element =3D&gt; bufferedElements +=3D eleme=
nt )=0A=0A    }=0A  }=0A=0A}</textarea><wiz_code_mirror><div clas=
s=3D"CodeMirror cm-s-default CodeMirror-wrap" data-id=3D"wiz_cm_1=
623250704380_7196"><div style=3D"overflow: hidden; position: rela=
tive; width: 3px; height: 0px; top: 20px; left: 34px;"><textarea=20=
autocorrect=3D"off" autocapitalize=3D"off" spellcheck=3D"false" s=
tyle=3D"position: absolute; bottom: -1em; padding: 0px; width: 10=
00px; height: 1em; outline: none;" tabindex=3D"0"></textarea></di=
v><div class=3D"CodeMirror-scrollbar-filler" cm-not-content=3D"tr=
ue"></div><div class=3D"CodeMirror-gutter-filler" cm-not-content=3D=
"true"></div><div class=3D"CodeMirror-scroll" tabindex=3D"-1"><di=
v class=3D"CodeMirror-sizer" style=3D"margin-left: 30px; margin-b=
ottom: 0px; border-right-width: 30px; min-height: 1250px; padding=
-right: 0px; padding-bottom: 0px;"><div style=3D"position: relati=
ve; top: 0px;"><div class=3D"CodeMirror-lines" role=3D"presentati=
on"><div role=3D"presentation" style=3D"position: relative; outli=
ne: none;"><div class=3D"CodeMirror-measure"><pre>x</pre><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt"><div>54</div><=
/div></div><div class=3D"CodeMirror-measure"></div><div style=3D"=
position: relative; z-index: 1;"></div><div class=3D" wiz-hide wi=
z_CodeMirror-cursors" style=3D"visibility: hidden;"><div class=3D=
"CodeMirror-cursor" style=3D"left: 4px; top: 0px; height: 23px;">=
&nbsp;</div></div><div class=3D"CodeMirror-code" role=3D"presenta=
tion"><div class=3D"CodeMirror-activeline" style=3D"position: rel=
ative;"><div class=3D" wiz-hide wiz_CodeMirror-activeline-backgro=
und CodeMirror-linebackground"></div><div class=3D"CodeMirror-gut=
ter-background CodeMirror-activeline-gutter" style=3D"left: -30px=
; width: 30px;"></div><div class=3D"CodeMirror-gutter-wrapper Cod=
eMirror-activeline-gutter" style=3D"left: -30px;"><div class=3D"C=
odeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; w=
idth: 21px;">1</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;"><span class=3D"cm-variable">package</span> <span class=3D=
"cm-variable">com</span>.<span class=3D"cm-property">boyi</span>.=
<span class=3D"cm-property">state</span></span></pre></div><div s=
tyle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrap=
per" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber C=
odeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">2</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"><span cm-text=
=3D""></span></span></pre></div><div style=3D"position: relative;=
"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"=
><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=
=3D"left: 0px; width: 21px;">3</div></div><pre class=3D"CodeMirro=
r-line" role=3D"presentation"><span role=3D"presentation" style=3D=
"padding-right: 0.1px;"><span class=3D"cm-keyword">import</span>=20=
<span class=3D"cm-def">org</span>.<span class=3D"cm-variable">apa=
che</span>.<span class=3D"cm-property">flink</span>.<span class=3D=
"cm-property">api</span>.<span class=3D"cm-property">common</span=
>.<span class=3D"cm-property">state</span>.{<span class=3D"cm-var=
iable">ListState</span>, <span class=3D"cm-variable">ListStateDes=
criptor</span>}</span></pre></div><div style=3D"position: relativ=
e;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px=
;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" sty=
le=3D"left: 0px; width: 21px;">4</div></div><pre class=3D"CodeMir=
ror-line" role=3D"presentation"><span role=3D"presentation" style=
=3D"padding-right: 0.1px;"><span class=3D"cm-keyword">import</spa=
n> <span class=3D"cm-def">org</span>.<span class=3D"cm-variable">=
apache</span>.<span class=3D"cm-property">flink</span>.<span clas=
s=3D"cm-property">api</span>.<span class=3D"cm-property">common</=
span>.<span class=3D"cm-property">typeinfo</span>.{<span class=3D=
"cm-variable">TypeHint</span>, <span class=3D"cm-variable">TypeIn=
formation</span>}</span></pre></div><div style=3D"position: relat=
ive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30=
px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" s=
tyle=3D"left: 0px; width: 21px;">5</div></div><pre class=3D"CodeM=
irror-line" role=3D"presentation"><span role=3D"presentation" sty=
le=3D"padding-right: 0.1px;"><span class=3D"cm-keyword">import</s=
pan> <span class=3D"cm-def">org</span>.<span class=3D"cm-variable=
">apache</span>.<span class=3D"cm-property">flink</span>.<span cl=
ass=3D"cm-property">runtime</span>.<span class=3D"cm-property">st=
ate</span>.{<span class=3D"cm-variable">FunctionInitializationCon=
text</span>, <span class=3D"cm-variable">FunctionSnapshotContext<=
/span>}</span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">6</div></div><pre class=3D"CodeMirror-line=
" role=3D"presentation"><span role=3D"presentation" style=3D"padd=
ing-right: 0.1px;"><span class=3D"cm-keyword">import</span> <span=
 class=3D"cm-def">org</span>.<span class=3D"cm-variable">apache</=
span>.<span class=3D"cm-property">flink</span>.<span class=3D"cm-=
property">streaming</span>.<span class=3D"cm-property">api</span>=
.<span class=3D"cm-property">checkpoint</span>.<span class=3D"cm-=
property">CheckpointedFunction</span></span></pre></div><div styl=
e=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper=
" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Code=
Mirror-gutter-elt" style=3D"left: 0px; width: 21px;">7</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-=
keyword">import</span> <span class=3D"cm-def">org</span>.<span cl=
ass=3D"cm-variable">apache</span>.<span class=3D"cm-property">fli=
nk</span>.<span class=3D"cm-property">streaming</span>.<span clas=
s=3D"cm-property">api</span>.<span class=3D"cm-property">function=
s</span>.<span class=3D"cm-property">sink</span>.<span class=3D"c=
m-property">SinkFunction</span></span></pre></div><div style=3D"p=
osition: relative;"><div class=3D"CodeMirror-gutter-wrapper" styl=
e=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror=
-gutter-elt" style=3D"left: 0px; width: 21px;">8</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"><span class=3D"cm-keyw=
ord">import</span> <span class=3D"cm-def">org</span>.<span class=3D=
"cm-variable">apache</span>.<span class=3D"cm-property">flink</sp=
an>.<span class=3D"cm-property">streaming</span>.<span class=3D"c=
m-property">api</span>.<span class=3D"cm-property">functions</spa=
n>.<span class=3D"cm-property">sink</span>.<span class=3D"cm-prop=
erty">SinkFunction</span>.<span class=3D"cm-property">Context</sp=
an></span></pre></div><div style=3D"position: relative;"><div cla=
ss=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div clas=
s=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=20=
0px; width: 21px;">9</div></div><pre class=3D"CodeMirror-line" ro=
le=3D"presentation"><span role=3D"presentation" style=3D"padding-=
right: 0.1px;"><span cm-text=3D""></span></span></pre></div><div=20=
style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wra=
pper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=20=
CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">10</div>=
</div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=20=
role=3D"presentation" style=3D"padding-right: 0.1px;"><span class=
=3D"cm-keyword">import</span> <span class=3D"cm-def">scala</span>=
.<span class=3D"cm-variable">collection</span>.<span class=3D"cm-=
property">mutable</span>.<span class=3D"cm-property">ListBuffer</=
span></span></pre></div><div style=3D"position: relative;"><div c=
lass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cl=
ass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left=
: 0px; width: 21px;">11</div></div><pre class=3D"CodeMirror-line"=
 role=3D"presentation"><span role=3D"presentation" style=3D"paddi=
ng-right: 0.1px;"><span cm-text=3D""></span></span></pre></div><d=
iv style=3D"position: relative;"><div class=3D"CodeMirror-gutter-=
wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumb=
er CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">12</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"><span cl=
ass=3D"cm-keyword">class</span> <span class=3D"cm-def">BufferingS=
ink</span>(<span class=3D"cm-variable">threshold</span>: <span cl=
ass=3D"cm-variable">Int</span> <span class=3D"cm-operator">=3D</s=
pan> <span class=3D"cm-number">0</span>)</span></pre></div><div s=
tyle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrap=
per" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber C=
odeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">13</div><=
/div><pre class=3D"CodeMirror-line" role=3D"presentation"><span r=
ole=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;<span=
 class=3D"cm-keyword">extends</span> <span class=3D"cm-variable">=
SinkFunction</span>[(<span class=3D"cm-variable">String</span>, <=
span class=3D"cm-variable">Int</span>)]</span></pre></div><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">14</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp=
;<span class=3D"cm-keyword">with</span> <span class=3D"cm-variabl=
e">CheckpointedFunction</span> {</span></pre></div><div style=3D"=
position: relative;"><div class=3D"CodeMirror-gutter-wrapper" sty=
le=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirro=
r-gutter-elt" style=3D"left: 0px; width: 21px;">15</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""><=
/span></span></pre></div><div style=3D"position: relative;"><div=20=
class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div c=
lass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"lef=
t: 0px; width: 21px;">16</div></div><pre class=3D"CodeMirror-line=
" role=3D"presentation"><span role=3D"presentation" style=3D"padd=
ing-right: 0.1px;"> &nbsp;<span class=3D"cm-operator">@</span><sp=
an class=3D"cm-variable">transient</span></span></pre></div><div=20=
style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wra=
pper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=20=
CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">17</div>=
</div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=20=
role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;<spa=
n class=3D"cm-variable">private</span> <span class=3D"cm-keyword"=
>var</span> <span class=3D"cm-def">checkpointedState</span>: <spa=
n class=3D"cm-variable">ListState</span>[(<span class=3D"cm-varia=
ble">String</span>, <span class=3D"cm-variable">Int</span>)] <spa=
n class=3D"cm-operator">=3D</span> <span class=3D"cm-variable">_<=
/span></span></pre></div><div style=3D"position: relative;"><div=20=
class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div c=
lass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"lef=
t: 0px; width: 21px;">18</div></div><pre class=3D"CodeMirror-line=
" role=3D"presentation"><span role=3D"presentation" style=3D"padd=
ing-right: 0.1px;"><span cm-text=3D""></span></span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">19</=
div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><s=
pan role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;=
<span class=3D"cm-variable">private</span> <span class=3D"cm-vari=
able">val</span> <span class=3D"cm-variable">bufferedElements</sp=
an> <span class=3D"cm-operator">=3D</span> <span class=3D"cm-vari=
able">ListBuffer</span>[(<span class=3D"cm-variable">String</span=
>, <span class=3D"cm-variable">Int</span>)]()</span></pre></div><=
div style=3D"position: relative;"><div class=3D"CodeMirror-gutter=
-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenum=
ber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">20</=
div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><s=
pan role=3D"presentation" style=3D"padding-right: 0.1px;"><span c=
m-text=3D""></span></span></pre></div><div style=3D"position: rel=
ative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -=
30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=
 style=3D"left: 0px; width: 21px;">21</div></div><pre class=3D"Co=
deMirror-line" role=3D"presentation"><span role=3D"presentation"=20=
style=3D"padding-right: 0.1px;"> &nbsp;<span class=3D"cm-variable=
">override</span> <span class=3D"cm-variable">def</span> <span cl=
ass=3D"cm-variable">invoke</span>(<span class=3D"cm-variable">val=
ue</span>: (<span class=3D"cm-variable">String</span>, <span clas=
s=3D"cm-variable">Int</span>), <span class=3D"cm-variable">contex=
t</span>: <span class=3D"cm-variable">Context</span>): <span clas=
s=3D"cm-variable">Unit</span> <span class=3D"cm-operator">=3D</sp=
an> {</span></pre></div><div style=3D"position: relative;"><div c=
lass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cl=
ass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left=
: 0px; width: 21px;">22</div></div><pre class=3D"CodeMirror-line"=
 role=3D"presentation"><span role=3D"presentation" style=3D"paddi=
ng-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-property">buffe=
redElements</span> <span class=3D"cm-operator">+=3D</span> <span=20=
class=3D"cm-variable">value</span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">23</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span=
 class=3D"cm-keyword">if</span> (<span class=3D"cm-variable">buff=
eredElements</span>.<span class=3D"cm-variable">size</span> <span=
 class=3D"cm-operator">=3D=3D</span> <span class=3D"cm-variable">=
threshold</span>) {</span></pre></div><div style=3D"position: rel=
ative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -=
30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=
 style=3D"left: 0px; width: 21px;">24</div></div><pre class=3D"Co=
deMirror-line" role=3D"presentation"><span role=3D"presentation"=20=
style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class=3D=
"cm-keyword">for</span> (<span class=3D"cm-variable">element</spa=
n> <span class=3D"cm-operator">&lt;-</span> <span class=3D"cm-var=
iable">bufferedElements</span>) {</span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">25</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbs=
p; &nbsp;<span class=3D"cm-comment">// send it to the sink</span>=
</span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">26</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp; &nbsp;  }</span></pre></div><div style=3D"posit=
ion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">27</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<spa=
n class=3D"cm-variable">bufferedElements</span>.<span class=3D"cm=
-property">clear</span>()</span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">28</div></div><pre class=
=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presenta=
tion" style=3D"padding-right: 0.1px;"> &nbsp;  }</span></pre></di=
v><div style=3D"position: relative;"><div class=3D"CodeMirror-gut=
ter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-line=
number CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">2=
9</div></div><pre class=3D"CodeMirror-line" role=3D"presentation"=
><span role=3D"presentation" style=3D"padding-right: 0.1px;">  }<=
/span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">30</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"><span cm-text=3D""></span></span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">31</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"> &nbsp;<span class=
=3D"cm-variable">override</span> <span class=3D"cm-variable">def<=
/span> <span class=3D"cm-variable">snapshotState</span>(<span cla=
ss=3D"cm-variable">context</span>: <span class=3D"cm-variable">Fu=
nctionSnapshotContext</span>): <span class=3D"cm-variable">Unit</=
span> <span class=3D"cm-operator">=3D</span> {</span></pre></div>=
<div style=3D"position: relative;"><div class=3D"CodeMirror-gutte=
r-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenu=
mber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">32<=
/div></div><pre class=3D"CodeMirror-line" role=3D"presentation"><=
span role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp=
; &nbsp;<span class=3D"cm-property">checkpointedState</span>.<spa=
n class=3D"cm-variable">clear</span>()</span></pre></div><div sty=
le=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrappe=
r" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Cod=
eMirror-gutter-elt" style=3D"left: 0px; width: 21px;">33</div></d=
iv><pre class=3D"CodeMirror-line" role=3D"presentation"><span rol=
e=3D"presentation" style=3D"padding-right: 0.1px;"><span cm-text=3D=
""></span></span></pre></div><div style=3D"position: relative;"><=
div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><d=
iv class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">34</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-variable">=
bufferedElements</span>.<span class=3D"cm-variable">foreach</span=
>(<span class=3D"cm-variable">element</span> <span class=3D"cm-op=
erator">=3D&gt;</span> {</span></pre></div><div style=3D"position=
: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"le=
ft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter=
-elt" style=3D"left: 0px; width: 21px;">35</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span cla=
ss=3D"cm-variable">checkpointedState</span>.<span class=3D"cm-var=
iable">add</span>(<span class=3D"cm-variable">element</span>)</sp=
an></pre></div><div style=3D"position: relative;"><div class=3D"C=
odeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">36</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;"> &nbsp;  })</span></pre></div><div style=3D"position: re=
lative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=20=
-30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt=
" style=3D"left: 0px; width: 21px;">37</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;">  }</span></pre></div><div style=
=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapper"=
 style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeM=
irror-gutter-elt" style=3D"left: 0px; width: 21px;">38</div></div=
><pre class=3D"CodeMirror-line" role=3D"presentation"><span role=3D=
"presentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""=
></span></span></pre></div><div style=3D"position: relative;"><di=
v class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=
 class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"l=
eft: 0px; width: 21px;">39</div></div><pre class=3D"CodeMirror-li=
ne" role=3D"presentation"><span role=3D"presentation" style=3D"pa=
dding-right: 0.1px;"> &nbsp;<span class=3D"cm-variable">override<=
/span> <span class=3D"cm-variable">def</span> <span class=3D"cm-v=
ariable">initializeState</span>(<span class=3D"cm-variable">conte=
xt</span>: <span class=3D"cm-variable">FunctionInitializationCont=
ext</span>): <span class=3D"cm-variable">Unit</span> <span class=3D=
"cm-operator">=3D</span> {</span></pre></div><div style=3D"positi=
on: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"=
left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutt=
er-elt" style=3D"left: 0px; width: 21px;">40</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D=
"cm-property">val</span> <span class=3D"cm-variable">descriptor</=
span> <span class=3D"cm-operator">=3D</span> <span class=3D"cm-ke=
yword">new</span> <span class=3D"cm-variable">ListStateDescriptor=
</span>[(<span class=3D"cm-variable">String</span>, <span class=3D=
"cm-variable">Int</span>)](</span></pre></div><div style=3D"posit=
ion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">41</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<spa=
n class=3D"cm-string">"buffered-elements"</span>,</span></pre></d=
iv><div style=3D"position: relative;"><div class=3D"CodeMirror-gu=
tter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-lin=
enumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">=
42</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"> &n=
bsp; &nbsp; &nbsp;<span class=3D"cm-variable">TypeInformation</sp=
an>.<span class=3D"cm-variable">of</span>(<span class=3D"cm-keywo=
rd">new</span> <span class=3D"cm-variable">TypeHint</span>[(<span=
 class=3D"cm-variable">String</span>, <span class=3D"cm-variable"=
>Int</span>)]() {})</span></pre></div><div style=3D"position: rel=
ative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -=
30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=
 style=3D"left: 0px; width: 21px;">43</div></div><pre class=3D"Co=
deMirror-line" role=3D"presentation"><span role=3D"presentation"=20=
style=3D"padding-right: 0.1px;"> &nbsp;  )</span></pre></div><div=
 style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wr=
apper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=
 CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">44</div=
></div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=
 role=3D"presentation" style=3D"padding-right: 0.1px;"><span cm-t=
ext=3D""></span></span></pre></div><div style=3D"position: relati=
ve;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30p=
x;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" st=
yle=3D"left: 0px; width: 21px;">45</div></div><pre class=3D"CodeM=
irror-line" role=3D"presentation"><span role=3D"presentation" sty=
le=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-vari=
able">checkpointedState</span> <span class=3D"cm-operator">=3D</s=
pan> <span class=3D"cm-variable">context</span>.<span class=3D"cm=
-property">getOperatorStateStore</span>.<span class=3D"cm-propert=
y">getListState</span>(<span class=3D"cm-variable">descriptor</sp=
an>)</span></pre></div><div style=3D"position: relative;"><div cl=
ass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=
 0px; width: 21px;">46</div></div><pre class=3D"CodeMirror-line"=20=
role=3D"presentation"><span role=3D"presentation" style=3D"paddin=
g-right: 0.1px;"><span cm-text=3D""></span></span></pre></div><di=
v style=3D"position: relative;"><div class=3D"CodeMirror-gutter-w=
rapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumbe=
r CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">47</di=
v></div><pre class=3D"CodeMirror-line" role=3D"presentation"><spa=
n role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &=
nbsp;<span class=3D"cm-keyword">if</span>(<span class=3D"cm-varia=
ble">context</span>.<span class=3D"cm-property">isRestored</span>=
) {</span></pre></div><div style=3D"position: relative;"><div cla=
ss=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div clas=
s=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=20=
0px; width: 21px;">48</div></div><pre class=3D"CodeMirror-line" r=
ole=3D"presentation"><span role=3D"presentation" style=3D"padding=
-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class=3D"cm-variable">=
val</span> <span class=3D"cm-variable">iterate</span> &nbsp;<span=
 class=3D"cm-operator">=3D</span> <span class=3D"cm-variable">che=
ckpointedState</span>.<span class=3D"cm-property">get</span>()</s=
pan></pre></div><div style=3D"position: relative;"><div class=3D"=
CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"C=
odeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; w=
idth: 21px;">49</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class=3D"cm-variable">iterat=
e</span>.<span class=3D"cm-property">forEach</span>(<span class=3D=
"cm-def">element</span> <span class=3D"cm-operator">=3D&gt;</span=
> <span class=3D"cm-variable">bufferedElements</span> <span class=
=3D"cm-operator">+=3D</span> <span class=3D"cm-variable-2">elemen=
t</span> )</span></pre></div><div style=3D"position: relative;"><=
div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><d=
iv class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">50</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"><span cm-text=3D""></span></span></pre></d=
iv><div style=3D"position: relative;"><div class=3D"CodeMirror-gu=
tter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-lin=
enumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">=
51</div></div><pre class=3D"CodeMirror-line" role=3D"presentation=
"><span role=3D"presentation" style=3D"padding-right: 0.1px;"> &n=
bsp;  }</span></pre></div><div style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">52</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;">  }</span></pre></div><div style=3D"position:=
 relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"lef=
t: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-=
elt" style=3D"left: 0px; width: 21px;">53</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></sp=
an></pre></div><div class=3D"" style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">54</div></div><pre class=3D"CodeMirror-lin=
e" role=3D"presentation"><span role=3D"presentation" style=3D"pad=
ding-right: 0.1px;">}</span></pre></div></div></div></div></div><=
/div><div style=3D"position: absolute; height: 13px; width: 1px;=20=
border-bottom-width: 0px; border-bottom-style: solid; border-bott=
om-color: transparent; top: 1250px;"></div><div class=3D"CodeMirr=
or-gutters" style=3D"height: 1280px;"><div class=3D"CodeMirror-gu=
tter CodeMirror-linenumbers" style=3D"width: 29px;"></div></div><=
/div></div></wiz_code_mirror></div><p style=3D"color:rgb(180, 180=
, 180) !important;background:rgb(38, 39, 40) !important;font-size=
:1.125rem">initializeState =B7=BD=B7=A8=BD=D3=CA=D5=D2=BB=B8=F6 F=
unctionInitializationContext =B2=CE=CA=FD=A3=AC=BB=E1=D3=C3=C0=B4=
=B3=F5=CA=BC=BB=AF non-keyed state =B5=C4 =A1=B0=C8=DD=C6=F7=A1=B1=
=A1=A3=D5=E2=D0=A9=C8=DD=C6=F7=CA=C7=D2=BB=B8=F6 ListState =D3=C3=
=D3=DA=D4=DA checkpoint =CA=B1=B1=A3=B4=E6 non-keyed state =B6=D4=
=CF=F3=A1=A3</p><p style=3D"color:rgb(180, 180, 180) !important;b=
ackground:rgb(38, 39, 40) !important;font-size:1.125rem">=D7=A2=D2=
=E2=D5=E2=D0=A9=D7=B4=CC=AC=CA=C7=C8=E7=BA=CE=B3=F5=CA=BC=BB=AF=B5=
=C4=A3=AC=BA=CD keyed state =C0=E0=CF=B5=A3=ACStateDescriptor =BB=
=E1=B0=FC=C0=A8=D7=B4=CC=AC=C3=FB=D7=D6=A1=A2=D2=D4=BC=B0=D7=B4=CC=
=AC=C0=E0=D0=CD=CF=E0=B9=D8=D0=C5=CF=A2=A1=A3</p><div  data-mode=3D=
"JavaScript" data-theme=3D"default" id=3D"wiz_cm_1623250704363_97=
10" class=3D"wiz-code-container"><textarea style=3D"display: none=
;">val descriptor =3D new ListStateDescriptor[(String, Long)](=0A=
    "buffered-elements",=0A    TypeInformation.of(new TypeHint[(S=
tring, Long)]() {})=0A)=0A=0A// =B5=F7=D3=C3=B2=BB=CD=AC=B5=C4=BB=
=F1=C8=A1=D7=B4=CC=AC=B6=D4=CF=F3=B5=C4=BD=D3=BF=DA=A3=AC=BB=E1=CA=
=B9=D3=C3=B2=BB=CD=AC=B5=C4=D7=B4=CC=AC=B7=D6=C5=E4=CB=E3=B7=A8=A1=
=A3=0AcheckpointedState =3D context.getOperatorStateStore.getList=
State(descriptor)=0A</textarea><wiz_code_mirror><div class=3D"Cod=
eMirror cm-s-default CodeMirror-wrap" data-id=3D"wiz_cm_162325070=
4363_9710"><div style=3D"overflow: hidden; position: relative; wi=
dth: 3px; height: 0px; top: 20px; left: 34px;"><textarea autocorr=
ect=3D"off" autocapitalize=3D"off" spellcheck=3D"false" style=3D"=
position: absolute; bottom: -1em; padding: 0px; width: 1000px; he=
ight: 1em; outline: none;" tabindex=3D"0"></textarea></div><div c=
lass=3D"CodeMirror-scrollbar-filler" cm-not-content=3D"true"></di=
v><div class=3D"CodeMirror-gutter-filler" cm-not-content=3D"true"=
></div><div class=3D"CodeMirror-scroll" tabindex=3D"-1"><div clas=
s=3D"CodeMirror-sizer" style=3D"margin-left: 30px; margin-bottom:=
 0px; border-right-width: 30px; min-height: 192px; padding-right:=
 0px; padding-bottom: 0px;"><div style=3D"position: relative; top=
: 0px;"><div class=3D"CodeMirror-lines" role=3D"presentation"><di=
v role=3D"presentation" style=3D"position: relative; outline: non=
e;"><div class=3D"CodeMirror-measure"><pre>x</pre><div class=3D"C=
odeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div></d=
iv><div class=3D"CodeMirror-measure"></div><div style=3D"position=
: relative; z-index: 1;"></div><div class=3D" wiz-hide wiz_CodeMi=
rror-cursors" style=3D"visibility: hidden;"><div class=3D"CodeMir=
ror-cursor" style=3D"left: 4px; top: 0px; height: 23px;">&nbsp;</=
div></div><div class=3D"CodeMirror-code" role=3D"presentation"><d=
iv class=3D"CodeMirror-activeline" style=3D"position: relative;">=
<div class=3D" wiz-hide wiz_CodeMirror-activeline-background Code=
Mirror-linebackground"></div><div class=3D"CodeMirror-gutter-back=
ground CodeMirror-activeline-gutter" style=3D"left: -30px; width:=
 30px;"></div><div class=3D"CodeMirror-gutter-wrapper CodeMirror-=
activeline-gutter" style=3D"left: -30px;"><div class=3D"CodeMirro=
r-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21=
px;">1</div></div><pre class=3D"CodeMirror-line" role=3D"presenta=
tion"><span role=3D"presentation" style=3D"padding-right: 0.1px;"=
><span class=3D"cm-variable">val</span> <span class=3D"cm-variabl=
e">descriptor</span> <span class=3D"cm-operator">=3D</span> <span=
 class=3D"cm-keyword">new</span> <span class=3D"cm-variable">List=
StateDescriptor</span>[(<span class=3D"cm-variable">String</span>=
, <span class=3D"cm-variable">Long</span>)](</span></pre></div><d=
iv style=3D"position: relative;"><div class=3D"CodeMirror-gutter-=
wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumb=
er CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">2</di=
v></div><pre class=3D"CodeMirror-line" role=3D"presentation"><spa=
n role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &=
nbsp;<span class=3D"cm-string">"buffered-elements"</span>,</span>=
</pre></div><div style=3D"position: relative;"><div class=3D"Code=
Mirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeM=
irror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width=
: 21px;">3</div></div><pre class=3D"CodeMirror-line" role=3D"pres=
entation"><span role=3D"presentation" style=3D"padding-right: 0.1=
px;"> &nbsp; &nbsp;<span class=3D"cm-variable">TypeInformation</s=
pan>.<span class=3D"cm-property">of</span>(<span class=3D"cm-keyw=
ord">new</span> <span class=3D"cm-variable">TypeHint</span>[(<spa=
n class=3D"cm-variable">String</span>, <span class=3D"cm-variable=
">Long</span>)]() {})</span></pre></div><div style=3D"position: r=
elative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=
 -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-el=
t" style=3D"left: 0px; width: 21px;">4</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;">)</span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">5</div></div><pr=
e class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"p=
resentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""><=
/span></span></pre></div><div style=3D"position: relative;"><div=20=
class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div c=
lass=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"lef=
t: 0px; width: 21px;">6</div></div><pre class=3D"CodeMirror-line"=
 role=3D"presentation"><span role=3D"presentation" style=3D"paddi=
ng-right: 0.1px;"><span class=3D"cm-comment">// =B5=F7=D3=C3=B2=BB=
=CD=AC=B5=C4=BB=F1=C8=A1=D7=B4=CC=AC=B6=D4=CF=F3=B5=C4=BD=D3=BF=DA=
=A3=AC=BB=E1=CA=B9=D3=C3=B2=BB=CD=AC=B5=C4=D7=B4=CC=AC=B7=D6=C5=E4=
=CB=E3=B7=A8=A1=A3</span></span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">7</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"><span class=3D"cm-variable">ch=
eckpointedState</span> <span class=3D"cm-operator">=3D</span> <sp=
an class=3D"cm-variable">context</span>.<span class=3D"cm-propert=
y">getOperatorStateStore</span>.<span class=3D"cm-property">getLi=
stState</span>(<span class=3D"cm-variable">descriptor</span>)</sp=
an></pre></div><div class=3D"" style=3D"position: relative;"><div=
 class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div=20=
class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"le=
ft: 0px; width: 21px;">8</div></div><pre class=3D"CodeMirror-line=
" role=3D"presentation"><span role=3D"presentation" style=3D"padd=
ing-right: 0.1px;"><span cm-text=3D""></span></span></pre></div><=
/div></div></div></div></div><div style=3D"position: absolute; he=
ight: 13px; width: 1px; border-bottom-width: 0px; border-bottom-s=
tyle: solid; border-bottom-color: transparent; top: 192px;"></div=
><div class=3D"CodeMirror-gutters" style=3D"height: 222px;"><div=20=
class=3D"CodeMirror-gutter CodeMirror-linenumbers" style=3D"width=
: 29px;"></div></div></div></div></wiz_code_mirror></div><div id=3D=
"content_views" class=3D"markdown_views prism-tomorrow-night" sty=
le=3D"color: rgb(196, 196, 200) !important; background: rgb(38, 3=
9, 40) !important;"><blockquote style=3D"color:rgb(180, 180, 180)=
 !important;background:rgb(46, 47, 48) !important;"><p style=3D"f=
ont-size: 0.875rem;">=B5=F7=D3=C3=B2=BB=CD=AC=B5=C4=BB=F1=C8=A1=D7=
=B4=CC=AC=B6=D4=CF=F3=B5=C4=BD=D3=BF=DA=A3=AC=BB=E1=CA=B9=D3=C3=B2=
=BB=CD=AC=B5=C4=D7=B4=CC=AC=B7=D6=C5=E4=CB=E3=B7=A8=A1=A3<br>=B1=C8=
=C8=E7 getUnionListState(descriptor) =BB=E1=CA=B9=D3=C3 union red=
istribution =CB=E3=B7=A8=A3=AC<br>=B6=F8 getListState(descriptor)=
 =D4=F2=BC=F2=B5=A5=B5=C4=CA=B9=D3=C3 even-split redistribution =CB=
=E3=B7=A8=A1=A3</p></blockquote><p style=3D"font-size:1.125rem;co=
lor:rgb(180, 180, 180) !important;">=B5=B1=B3=F5=CA=BC=BB=AF=BA=C3=
=D7=B4=CC=AC=B6=D4=CF=F3=BA=F3=A3=AC=CE=D2=C3=C7=CD=A8=B9=FD isRe=
stored() =B7=BD=B7=A8=C5=D0=B6=CF=CA=C7=B7=F1=B4=D3=D6=AE=C7=B0=B5=
=C4=B9=CA=D5=CF=D6=D0=BB=D6=B8=B4=BB=D8=C0=B4=A3=AC=C8=E7=B9=FB=B8=
=C3=B7=BD=B7=A8=B7=B5=BB=D8 true =D4=F2=B1=ED=CA=BE=B4=D3=B9=CA=D5=
=CF=D6=D0=BD=F8=D0=D0=BB=D6=B8=B4=A3=AC=BB=E1=D6=B4=D0=D0=BD=D3=CF=
=C2=C0=B4=B5=C4=BB=D6=B8=B4=C2=DF=BC=AD=A1=A3</p><p style=3D"font=
-size:1.125rem;color:rgb(180, 180, 180) !important;">=D5=FD=C8=E7=
=B4=FA=C2=EB=CB=F9=CA=BE=A3=ACBufferingSink =D6=D0=B3=F5=CA=BC=BB=
=AF=CA=B1=A3=AC=BB=D6=B8=B4=BB=D8=C0=B4=B5=C4 ListState =B5=C4=CB=
=F9=D3=D0=D4=AA=CB=D8=BB=E1=CC=ED=BC=D3=B5=BD=D2=BB=B8=F6=BE=D6=B2=
=BF=B1=E4=C1=BF=D6=D0=A3=AC=B9=A9=CF=C2=B4=CE snapshotState() =CA=
=B1=CA=B9=D3=C3=A1=A3 =C8=BB=BA=F3=C7=E5=BF=D5 ListState=A3=AC=D4=
=D9=B0=D1=B5=B1=C7=B0=BE=D6=B2=BF=B1=E4=C1=BF=D6=D0=B5=C4=CB=F9=D3=
=D0=D4=AA=CB=D8=D0=B4=C8=EB=B5=BD checkpoint =D6=D0=A1=A3</p><p s=
tyle=3D"font-size:1.125rem;color:rgb(180, 180, 180) !important;">=
=C1=ED=CD=E2=A3=AC=CE=D2=C3=C7=CD=AC=D1=F9=BF=C9=D2=D4=D4=DA init=
ializeState() =B7=BD=B7=A8=D6=D0=CA=B9=D3=C3 FunctionInitializati=
onContext =B3=F5=CA=BC=BB=AF keyed state=A1=A3</p><h3 style=3D"fo=
nt-size: 1.375rem; color: rgb(180, 180, 180) !important;">1.5.2.=20=
=B4=F8=D7=B4=CC=AC=B5=C4 Source Function</h3></div><p style=3D"co=
lor:rgb(180, 180, 180) !important;background:rgb(38, 39, 40) !imp=
ortant;font-size:1.125rem">=B4=F8=D7=B4=CC=AC=B5=C4=CA=FD=BE=DD=D4=
=B4=B1=C8=C6=E4=CB=FB=B5=C4=CB=E3=D7=D3=D0=E8=D2=AA=D7=A2=D2=E2=B8=
=FC=B6=E0=B6=AB=CE=F7=A1=A3<br>=CE=AA=C1=CB=B1=A3=D6=A4=B8=FC=D0=C2=
=D7=B4=CC=AC=D2=D4=BC=B0=CA=E4=B3=F6=B5=C4=D4=AD=D7=D3=D0=D4=A3=A8=
=D3=C3=D3=DA=D6=A7=B3=D6 exactly-once =D3=EF=D2=E5=A3=A9=A3=AC=D3=
=C3=BB=A7=D0=E8=D2=AA=D4=DA=B7=A2=CB=CD=CA=FD=BE=DD=C7=B0=BB=F1=C8=
=A1=CA=FD=BE=DD=D4=B4=B5=C4=C8=AB=BE=D6=CB=F8=A1=A3</p><div  data=
-mode=3D"JavaScript" data-theme=3D"default" id=3D"wiz_cm_16232507=
04234_5783" class=3D"wiz-code-container"><textarea style=3D"displ=
ay: none;">=0Aimport org.apache.flink.api.common.state.{ListState=
, ListStateDescriptor}=0Aimport org.apache.flink.runtime.state.{F=
unctionInitializationContext, FunctionSnapshotContext}=0Aimport o=
rg.apache.flink.streaming.api.checkpoint.CheckpointedFunction=0Ai=
mport org.apache.flink.streaming.api.functions.source.{RichParall=
elSourceFunction, SourceFunction}=0A=0Aimport scala.collection.Ja=
vaConverters.iterableAsScalaIterableConverter=0A=0A/**=0A * =B4=F8=
=D7=B4=CC=AC=B5=C4 Source Function=0A * =B4=F8=D7=B4=CC=AC=B5=C4=CA=
=FD=BE=DD=D4=B4=B1=C8=C6=E4=CB=FB=B5=C4=CB=E3=D7=D3=D0=E8=D2=AA=D7=
=A2=D2=E2=B8=FC=B6=E0=B6=AB=CE=F7=A1=A3=0A *=0A * =CE=AA=C1=CB=B1=
=A3=D6=A4=B8=FC=D0=C2=D7=B4=CC=AC=D2=D4=BC=B0=CA=E4=B3=F6=B5=C4=D4=
=AD=D7=D3=D0=D4=A3=A8=D3=C3=D3=DA=D6=A7=B3=D6 exactly-once =D3=EF=
=D2=E5=A3=A9=A3=AC=D3=C3=BB=A7=D0=E8=D2=AA=D4=DA=B7=A2=CB=CD=CA=FD=
=BE=DD=C7=B0=BB=F1=C8=A1=CA=FD=BE=DD=D4=B4=B5=C4=C8=AB=BE=D6=CB=F8=
=A1=A3=0A *=0A */=0Aclass CounterSource=0A  extends RichParallelS=
ourceFunction[Long]=0A    with CheckpointedFunction {=0A=0A  @vol=
atile=0A  private var isRunning =3D true=0A=0A  private var offse=
t =3D 0L=0A  private var state: ListState[Long] =3D _=0A=0A  over=
ride def run(ctx: SourceFunction.SourceContext[Long]): Unit =3D {=
=0A    val lock =3D ctx.getCheckpointLock=0A=0A    while (isRunni=
ng) {=0A      // output and state update are atomic=0A      lock.=
synchronized({=0A        ctx.collect(offset)=0A=0A        offset=20=
+=3D 1=0A      })=0A    }=0A  }=0A=0A  override def cancel(): Uni=
t =3D isRunning =3D false=0A=0A  override def initializeState(con=
text: FunctionInitializationContext): Unit =3D {=0A    state =3D=20=
context.getOperatorStateStore.getListState(=0A      new ListState=
Descriptor[Long]("state", classOf[Long]))=0A=0A    for (l &lt;- s=
tate.get().asScala) {=0A      offset =3D l=0A    }=0A  }=0A=0A  o=
verride def snapshotState(context: FunctionSnapshotContext): Unit=
 =3D {=0A    state.clear()=0A    state.add(offset)=0A  }=0A}=0A</=
textarea><wiz_code_mirror><div class=3D"CodeMirror cm-s-default C=
odeMirror-wrap" data-id=3D"wiz_cm_1623250704234_5783"><div style=3D=
"overflow: hidden; position: relative; width: 3px; height: 0px; t=
op: 20px; left: 34px;"><textarea autocorrect=3D"off" autocapitali=
ze=3D"off" spellcheck=3D"false" style=3D"position: absolute; bott=
om: -1em; padding: 0px; width: 1000px; height: 1em; outline: none=
;" tabindex=3D"0"></textarea></div><div class=3D"CodeMirror-scrol=
lbar-filler" cm-not-content=3D"true"></div><div class=3D"CodeMirr=
or-gutter-filler" cm-not-content=3D"true"></div><div class=3D"Cod=
eMirror-scroll" tabindex=3D"-1"><div class=3D"CodeMirror-sizer" s=
tyle=3D"margin-left: 30px; margin-bottom: 0px; border-right-width=
: 30px; min-height: 1273px; padding-right: 0px; padding-bottom: 0=
px;"><div style=3D"position: relative; top: 0px;"><div class=3D"C=
odeMirror-lines" role=3D"presentation"><div role=3D"presentation"=
 style=3D"position: relative; outline: none;"><div class=3D"CodeM=
irror-measure"><pre>x</pre><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt"><div>55</div></div></div><div class=3D"CodeM=
irror-measure"></div><div style=3D"position: relative; z-index: 1=
;"></div><div class=3D" wiz-hide wiz_CodeMirror-cursors"><div cla=
ss=3D"CodeMirror-cursor" style=3D"left: 4px; top: 0px; height: 23=
px;">&nbsp;</div></div><div class=3D"CodeMirror-code" role=3D"pre=
sentation"><div class=3D"CodeMirror-activeline" style=3D"position=
: relative;"><div class=3D" wiz-hide wiz_CodeMirror-activeline-ba=
ckground CodeMirror-linebackground"></div><div class=3D"CodeMirro=
r-gutter-background CodeMirror-activeline-gutter" style=3D"left:=20=
-30px; width: 30px;"></div><div class=3D"CodeMirror-gutter-wrappe=
r CodeMirror-activeline-gutter" style=3D"left: -30px;"><div class=
=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0=
px; width: 21px;">1</div></div><pre class=3D"CodeMirror-line" rol=
e=3D"presentation"><span role=3D"presentation" style=3D"padding-r=
ight: 0.1px;"><span cm-text=3D""></span></span></pre></div><div s=
tyle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrap=
per" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber C=
odeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">2</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-keyword">import</span> <span class=3D"cm-def">org</span>.<spa=
n class=3D"cm-variable">apache</span>.<span class=3D"cm-property"=
>flink</span>.<span class=3D"cm-property">api</span>.<span class=3D=
"cm-property">common</span>.<span class=3D"cm-property">state</sp=
an>.{<span class=3D"cm-variable">ListState</span>, <span class=3D=
"cm-variable">ListStateDescriptor</span>}</span></pre></div><div=20=
style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wra=
pper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=20=
CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">3</div><=
/div><pre class=3D"CodeMirror-line" role=3D"presentation"><span r=
ole=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-keyword">import</span> <span class=3D"cm-def">org</span>.<spa=
n class=3D"cm-variable">apache</span>.<span class=3D"cm-property"=
>flink</span>.<span class=3D"cm-property">runtime</span>.<span cl=
ass=3D"cm-property">state</span>.{<span class=3D"cm-variable">Fun=
ctionInitializationContext</span>, <span class=3D"cm-variable">Fu=
nctionSnapshotContext</span>}</span></pre></div><div style=3D"pos=
ition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">4</div></div><pre clas=
s=3D"CodeMirror-line" role=3D"presentation"><span role=3D"present=
ation" style=3D"padding-right: 0.1px;"><span class=3D"cm-keyword"=
>import</span> <span class=3D"cm-def">org</span>.<span class=3D"c=
m-variable">apache</span>.<span class=3D"cm-property">flink</span=
>.<span class=3D"cm-property">streaming</span>.<span class=3D"cm-=
property">api</span>.<span class=3D"cm-property">checkpoint</span=
>.<span class=3D"cm-property">CheckpointedFunction</span></span><=
/pre></div><div style=3D"position: relative;"><div class=3D"CodeM=
irror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMi=
rror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=
 21px;">5</div></div><pre class=3D"CodeMirror-line" role=3D"prese=
ntation"><span role=3D"presentation" style=3D"padding-right: 0.1p=
x;"><span class=3D"cm-keyword">import</span> <span class=3D"cm-de=
f">org</span>.<span class=3D"cm-variable">apache</span>.<span cla=
ss=3D"cm-property">flink</span>.<span class=3D"cm-property">strea=
ming</span>.<span class=3D"cm-property">api</span>.<span class=3D=
"cm-property">functions</span>.<span class=3D"cm-property">source=
</span>.{<span class=3D"cm-variable">RichParallelSourceFunction</=
span>, <span class=3D"cm-variable">SourceFunction</span>}</span><=
/pre></div><div style=3D"position: relative;"><div class=3D"CodeM=
irror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMi=
rror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=
 21px;">6</div></div><pre class=3D"CodeMirror-line" role=3D"prese=
ntation"><span role=3D"presentation" style=3D"padding-right: 0.1p=
x;"><span cm-text=3D""></span></span></pre></div><div style=3D"po=
sition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=
=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt" style=3D"left: 0px; width: 21px;">7</div></div><pre c=
lass=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pres=
entation" style=3D"padding-right: 0.1px;"><span class=3D"cm-keywo=
rd">import</span> <span class=3D"cm-def">scala</span>.<span class=
=3D"cm-variable">collection</span>.<span class=3D"cm-property">Ja=
vaConverters</span>.<span class=3D"cm-property">iterableAsScalaIt=
erableConverter</span></span></pre></div><div style=3D"position:=20=
relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left=
: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-e=
lt" style=3D"left: 0px; width: 21px;">8</div></div><pre class=3D"=
CodeMirror-line" role=3D"presentation"><span role=3D"presentation=
" style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></spa=
n></pre></div><div style=3D"position: relative;"><div class=3D"Co=
deMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Cod=
eMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wid=
th: 21px;">9</div></div><pre class=3D"CodeMirror-line" role=3D"pr=
esentation"><span role=3D"presentation" style=3D"padding-right: 0=
.1px;"><span class=3D"cm-comment">/**</span></span></pre></div><d=
iv style=3D"position: relative;"><div class=3D"CodeMirror-gutter-=
wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumb=
er CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">10</d=
iv></div><pre class=3D"CodeMirror-line" role=3D"presentation"><sp=
an role=3D"presentation" style=3D"padding-right: 0.1px;"><span cl=
ass=3D"cm-comment"> * =B4=F8=D7=B4=CC=AC=B5=C4 Source Function</s=
pan></span></pre></div><div style=3D"position: relative;"><div cl=
ass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=
 0px; width: 21px;">11</div></div><pre class=3D"CodeMirror-line"=20=
role=3D"presentation"><span role=3D"presentation" style=3D"paddin=
g-right: 0.1px;"><span class=3D"cm-comment"> * =B4=F8=D7=B4=CC=AC=
=B5=C4=CA=FD=BE=DD=D4=B4=B1=C8=C6=E4=CB=FB=B5=C4=CB=E3=D7=D3=D0=E8=
=D2=AA=D7=A2=D2=E2=B8=FC=B6=E0=B6=AB=CE=F7=A1=A3</span></span></p=
re></div><div style=3D"position: relative;"><div class=3D"CodeMir=
ror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirr=
or-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 2=
1px;">12</div></div><pre class=3D"CodeMirror-line" role=3D"presen=
tation"><span role=3D"presentation" style=3D"padding-right: 0.1px=
;"><span class=3D"cm-comment"> *</span></span></pre></div><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">13</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"><span class=3D=
"cm-comment"> * =CE=AA=C1=CB=B1=A3=D6=A4=B8=FC=D0=C2=D7=B4=CC=AC=D2=
=D4=BC=B0=CA=E4=B3=F6=B5=C4=D4=AD=D7=D3=D0=D4=A3=A8=D3=C3=D3=DA=D6=
=A7=B3=D6 exactly-once =D3=EF=D2=E5=A3=A9=A3=AC=D3=C3=BB=A7=D0=E8=
=D2=AA=D4=DA=B7=A2=CB=CD=CA=FD=BE=DD=C7=B0=BB=F1=C8=A1=CA=FD=BE=DD=
=D4=B4=B5=C4=C8=AB=BE=D6=CB=F8=A1=A3</span></span></pre></div><di=
v style=3D"position: relative;"><div class=3D"CodeMirror-gutter-w=
rapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumbe=
r CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">14</di=
v></div><pre class=3D"CodeMirror-line" role=3D"presentation"><spa=
n role=3D"presentation" style=3D"padding-right: 0.1px;"><span cla=
ss=3D"cm-comment"> *</span></span></pre></div><div style=3D"posit=
ion: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D=
"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gut=
ter-elt" style=3D"left: 0px; width: 21px;">15</div></div><pre cla=
ss=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presen=
tation" style=3D"padding-right: 0.1px;"><span class=3D"cm-comment=
"> */</span></span></pre></div><div style=3D"position: relative;"=
><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;">=
<div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">16</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"><span class=3D"cm-keyword">class</span> <s=
pan class=3D"cm-def">CounterSource</span></span></pre></div><div=20=
style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wra=
pper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=20=
CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">17</div>=
</div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=20=
role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;<spa=
n class=3D"cm-keyword">extends</span> <span class=3D"cm-variable"=
>RichParallelSourceFunction</span>[<span class=3D"cm-variable">Lo=
ng</span>]</span></pre></div><div style=3D"position: relative;"><=
div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><d=
iv class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">18</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-keyword">w=
ith</span> <span class=3D"cm-variable">CheckpointedFunction</span=
> {</span></pre></div><div style=3D"position: relative;"><div cla=
ss=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div clas=
s=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=20=
0px; width: 21px;">19</div></div><pre class=3D"CodeMirror-line" r=
ole=3D"presentation"><span role=3D"presentation" style=3D"padding=
-right: 0.1px;"><span cm-text=3D""></span></span></pre></div><div=
 style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wr=
apper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=
 CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">20</div=
></div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=
 role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp;<sp=
an class=3D"cm-operator">@</span><span class=3D"cm-variable">vola=
tile</span></span></pre></div><div style=3D"position: relative;">=
<div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><=
div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">21</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;"> &nbsp;<span class=3D"cm-variable">private=
</span> <span class=3D"cm-keyword">var</span> <span class=3D"cm-d=
ef">isRunning</span> <span class=3D"cm-operator">=3D</span> <span=
 class=3D"cm-atom">true</span></span></pre></div><div style=3D"po=
sition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=
=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt" style=3D"left: 0px; width: 21px;">22</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""></s=
pan></span></pre></div><div style=3D"position: relative;"><div cl=
ass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=
 0px; width: 21px;">23</div></div><pre class=3D"CodeMirror-line"=20=
role=3D"presentation"><span role=3D"presentation" style=3D"paddin=
g-right: 0.1px;"> &nbsp;<span class=3D"cm-variable">private</span=
> <span class=3D"cm-keyword">var</span> <span class=3D"cm-def">of=
fset</span> <span class=3D"cm-operator">=3D</span> <span class=3D=
"cm-number">0</span><span class=3D"cm-variable">L</span></span></=
pre></div><div style=3D"position: relative;"><div class=3D"CodeMi=
rror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMir=
ror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=20=
21px;">24</div></div><pre class=3D"CodeMirror-line" role=3D"prese=
ntation"><span role=3D"presentation" style=3D"padding-right: 0.1p=
x;"> &nbsp;<span class=3D"cm-variable">private</span> <span class=
=3D"cm-keyword">var</span> <span class=3D"cm-def">state</span>: <=
span class=3D"cm-variable">ListState</span>[<span class=3D"cm-var=
iable">Long</span>] <span class=3D"cm-operator">=3D</span> <span=20=
class=3D"cm-variable">_</span></span></pre></div><div style=3D"po=
sition: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=
=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-=
gutter-elt" style=3D"left: 0px; width: 21px;">25</div></div><pre=20=
class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"pre=
sentation" style=3D"padding-right: 0.1px;"><span cm-text=3D""></s=
pan></span></pre></div><div style=3D"position: relative;"><div cl=
ass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=
 0px; width: 21px;">26</div></div><pre class=3D"CodeMirror-line"=20=
role=3D"presentation"><span role=3D"presentation" style=3D"paddin=
g-right: 0.1px;"> &nbsp;<span class=3D"cm-variable">override</spa=
n> <span class=3D"cm-variable">def</span> <span class=3D"cm-varia=
ble">run</span>(<span class=3D"cm-variable">ctx</span>: <span cla=
ss=3D"cm-variable">SourceFunction</span>.<span class=3D"cm-variab=
le">SourceContext</span>[<span class=3D"cm-variable">Long</span>]=
): <span class=3D"cm-variable">Unit</span> <span class=3D"cm-oper=
ator">=3D</span> {</span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">27</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-pr=
operty">val</span> <span class=3D"cm-variable">lock</span> <span=20=
class=3D"cm-operator">=3D</span> <span class=3D"cm-variable">ctx<=
/span>.<span class=3D"cm-variable">getCheckpointLock</span></span=
></pre></div><div style=3D"position: relative;"><div class=3D"Cod=
eMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Code=
Mirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; widt=
h: 21px;">28</div></div><pre class=3D"CodeMirror-line" role=3D"pr=
esentation"><span role=3D"presentation" style=3D"padding-right: 0=
.1px;"><span cm-text=3D""></span></span></pre></div><div style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">29</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;<span=
 class=3D"cm-keyword">while</span> (<span class=3D"cm-variable">i=
sRunning</span>) {</span></pre></div><div style=3D"position: rela=
tive;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -3=
0px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=20=
style=3D"left: 0px; width: 21px;">30</div></div><pre class=3D"Cod=
eMirror-line" role=3D"presentation"><span role=3D"presentation" s=
tyle=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class=3D=
"cm-comment">// output and state update are atomic</span></span><=
/pre></div><div style=3D"position: relative;"><div class=3D"CodeM=
irror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMi=
rror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width:=
 21px;">31</div></div><pre class=3D"CodeMirror-line" role=3D"pres=
entation"><span role=3D"presentation" style=3D"padding-right: 0.1=
px;"> &nbsp; &nbsp; &nbsp;<span class=3D"cm-variable">lock</span>=
.<span class=3D"cm-variable">synchronized</span>({</span></pre></=
div><div style=3D"position: relative;"><div class=3D"CodeMirror-g=
utter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-li=
nenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;"=
>32</div></div><pre class=3D"CodeMirror-line" role=3D"presentatio=
n"><span role=3D"presentation" style=3D"padding-right: 0.1px;"> &=
nbsp; &nbsp; &nbsp; &nbsp;<span class=3D"cm-variable">ctx</span>.=
<span class=3D"cm-variable">collect</span>(<span class=3D"cm-vari=
able">offset</span>)</span></pre></div><div style=3D"position: re=
lative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=20=
-30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt=
" style=3D"left: 0px; width: 21px;">33</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span=
></pre></div><div style=3D"position: relative;"><div class=3D"Cod=
eMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Code=
Mirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; widt=
h: 21px;">34</div></div><pre class=3D"CodeMirror-line" role=3D"pr=
esentation"><span role=3D"presentation" style=3D"padding-right: 0=
.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class=3D"cm-variable">of=
fset</span> <span class=3D"cm-operator">+=3D</span> <span class=3D=
"cm-number">1</span></span></pre></div><div style=3D"position: re=
lative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left:=20=
-30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt=
" style=3D"left: 0px; width: 21px;">35</div></div><pre class=3D"C=
odeMirror-line" role=3D"presentation"><span role=3D"presentation"=
 style=3D"padding-right: 0.1px;"> &nbsp; &nbsp;  })</span></pre><=
/div><div style=3D"position: relative;"><div class=3D"CodeMirror-=
gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-l=
inenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;=
">36</div></div><pre class=3D"CodeMirror-line" role=3D"presentati=
on"><span role=3D"presentation" style=3D"padding-right: 0.1px;">=20=
&nbsp;  }</span></pre></div><div style=3D"position: relative;"><d=
iv class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><di=
v class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"=
left: 0px; width: 21px;">37</div></div><pre class=3D"CodeMirror-l=
ine" role=3D"presentation"><span role=3D"presentation" style=3D"p=
adding-right: 0.1px;">  }</span></pre></div><div style=3D"positio=
n: relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"l=
eft: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutte=
r-elt" style=3D"left: 0px; width: 21px;">38</div></div><pre class=
=3D"CodeMirror-line" role=3D"presentation"><span role=3D"presenta=
tion" style=3D"padding-right: 0.1px;"><span cm-text=3D""></span><=
/span></pre></div><div style=3D"position: relative;"><div class=3D=
"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"=
CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=20=
width: 21px;">39</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp;<span class=3D"cm-variable">override</span> <spa=
n class=3D"cm-variable">def</span> <span class=3D"cm-variable">ca=
ncel</span>(): <span class=3D"cm-variable">Unit</span> <span clas=
s=3D"cm-operator">=3D</span> <span class=3D"cm-variable">isRunnin=
g</span> <span class=3D"cm-operator">=3D</span> <span class=3D"cm=
-atom">false</span></span></pre></div><div style=3D"position: rel=
ative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -=
30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt"=
 style=3D"left: 0px; width: 21px;">40</div></div><pre class=3D"Co=
deMirror-line" role=3D"presentation"><span role=3D"presentation"=20=
style=3D"padding-right: 0.1px;"><span cm-text=3D""></span></span>=
</pre></div><div style=3D"position: relative;"><div class=3D"Code=
Mirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"CodeM=
irror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; width=
: 21px;">41</div></div><pre class=3D"CodeMirror-line" role=3D"pre=
sentation"><span role=3D"presentation" style=3D"padding-right: 0.=
1px;"> &nbsp;<span class=3D"cm-variable">override</span> <span cl=
ass=3D"cm-variable">def</span> <span class=3D"cm-variable">initia=
lizeState</span>(<span class=3D"cm-variable">context</span>: <spa=
n class=3D"cm-variable">FunctionInitializationContext</span>): <s=
pan class=3D"cm-variable">Unit</span> <span class=3D"cm-operator"=
>=3D</span> {</span></pre></div><div style=3D"position: relative;=
"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"=
><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=
=3D"left: 0px; width: 21px;">42</div></div><pre class=3D"CodeMirr=
or-line" role=3D"presentation"><span role=3D"presentation" style=3D=
"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-property"=
>state</span> <span class=3D"cm-operator">=3D</span> <span class=3D=
"cm-variable">context</span>.<span class=3D"cm-variable">getOpera=
torStateStore</span>.<span class=3D"cm-variable">getListState</sp=
an>(</span></pre></div><div style=3D"position: relative;"><div cl=
ass=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div cla=
ss=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left:=
 0px; width: 21px;">43</div></div><pre class=3D"CodeMirror-line"=20=
role=3D"presentation"><span role=3D"presentation" style=3D"paddin=
g-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class=3D"cm-keyword">=
new</span> <span class=3D"cm-variable">ListStateDescriptor</span>=
[<span class=3D"cm-variable">Long</span>](<span class=3D"cm-strin=
g">"state"</span>, <span class=3D"cm-variable">classOf</span>[<sp=
an class=3D"cm-variable">Long</span>]))</span></pre></div><div st=
yle=3D"position: relative;"><div class=3D"CodeMirror-gutter-wrapp=
er" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber Co=
deMirror-gutter-elt" style=3D"left: 0px; width: 21px;">44</div></=
div><pre class=3D"CodeMirror-line" role=3D"presentation"><span ro=
le=3D"presentation" style=3D"padding-right: 0.1px;"><span cm-text=
=3D""></span></span></pre></div><div style=3D"position: relative;=
"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"=
><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=
=3D"left: 0px; width: 21px;">45</div></div><pre class=3D"CodeMirr=
or-line" role=3D"presentation"><span role=3D"presentation" style=3D=
"padding-right: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-keyword">=
for</span> (<span class=3D"cm-variable">l</span> <span class=3D"c=
m-operator">&lt;-</span> <span class=3D"cm-variable">state</span>=
.<span class=3D"cm-variable">get</span>().<span class=3D"cm-varia=
ble">asScala</span>) {</span></pre></div><div style=3D"position:=20=
relative;"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left=
: -30px;"><div class=3D"CodeMirror-linenumber CodeMirror-gutter-e=
lt" style=3D"left: 0px; width: 21px;">46</div></div><pre class=3D=
"CodeMirror-line" role=3D"presentation"><span role=3D"presentatio=
n" style=3D"padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span cla=
ss=3D"cm-variable">offset</span> <span class=3D"cm-operator">=3D<=
/span> <span class=3D"cm-variable">l</span></span></pre></div><di=
v style=3D"position: relative;"><div class=3D"CodeMirror-gutter-w=
rapper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumbe=
r CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">47</di=
v></div><pre class=3D"CodeMirror-line" role=3D"presentation"><spa=
n role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; =20=
}</span></pre></div><div style=3D"position: relative;"><div class=
=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D=
"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px;=
 width: 21px;">48</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;">  }</span></pre></div><div style=3D"position: relative;=
"><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;"=
><div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=
=3D"left: 0px; width: 21px;">49</div></div><pre class=3D"CodeMirr=
or-line" role=3D"presentation"><span role=3D"presentation" style=3D=
"padding-right: 0.1px;"><span cm-text=3D""></span></span></pre></=
div><div style=3D"position: relative;"><div class=3D"CodeMirror-g=
utter-wrapper" style=3D"left: -30px;"><div class=3D"CodeMirror-li=
nenumber CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;"=
>50</div></div><pre class=3D"CodeMirror-line" role=3D"presentatio=
n"><span role=3D"presentation" style=3D"padding-right: 0.1px;"> &=
nbsp;<span class=3D"cm-variable">override</span> <span class=3D"c=
m-variable">def</span> <span class=3D"cm-variable">snapshotState<=
/span>(<span class=3D"cm-variable">context</span>: <span class=3D=
"cm-variable">FunctionSnapshotContext</span>): <span class=3D"cm-=
variable">Unit</span> <span class=3D"cm-operator">=3D</span> {</s=
pan></pre></div><div style=3D"position: relative;"><div class=3D"=
CodeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"C=
odeMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; w=
idth: 21px;">51</div></div><pre class=3D"CodeMirror-line" role=3D=
"presentation"><span role=3D"presentation" style=3D"padding-right=
: 0.1px;"> &nbsp; &nbsp;<span class=3D"cm-property">state</span>.=
<span class=3D"cm-variable">clear</span>()</span></pre></div><div=
 style=3D"position: relative;"><div class=3D"CodeMirror-gutter-wr=
apper" style=3D"left: -30px;"><div class=3D"CodeMirror-linenumber=
 CodeMirror-gutter-elt" style=3D"left: 0px; width: 21px;">52</div=
></div><pre class=3D"CodeMirror-line" role=3D"presentation"><span=
 role=3D"presentation" style=3D"padding-right: 0.1px;"> &nbsp; &n=
bsp;<span class=3D"cm-variable">state</span>.<span class=3D"cm-va=
riable">add</span>(<span class=3D"cm-variable">offset</span>)</sp=
an></pre></div><div style=3D"position: relative;"><div class=3D"C=
odeMirror-gutter-wrapper" style=3D"left: -30px;"><div class=3D"Co=
deMirror-linenumber CodeMirror-gutter-elt" style=3D"left: 0px; wi=
dth: 21px;">53</div></div><pre class=3D"CodeMirror-line" role=3D"=
presentation"><span role=3D"presentation" style=3D"padding-right:=
 0.1px;">  }</span></pre></div><div style=3D"position: relative;"=
><div class=3D"CodeMirror-gutter-wrapper" style=3D"left: -30px;">=
<div class=3D"CodeMirror-linenumber CodeMirror-gutter-elt" style=3D=
"left: 0px; width: 21px;">54</div></div><pre class=3D"CodeMirror-=
line" role=3D"presentation"><span role=3D"presentation" style=3D"=
padding-right: 0.1px;">}</span></pre></div><div class=3D"" style=3D=
"position: relative;"><div class=3D"CodeMirror-gutter-wrapper" st=
yle=3D"left: -30px;"><div class=3D"CodeMirror-linenumber CodeMirr=
or-gutter-elt" style=3D"left: 0px; width: 21px;">55</div></div><p=
re class=3D"CodeMirror-line" role=3D"presentation"><span role=3D"=
presentation" style=3D"padding-right: 0.1px;"><span cm-text=3D"">=
</span></span></pre></div></div></div></div></div></div><div styl=
e=3D"position: absolute; height: 13px; width: 1px; border-bottom-=
width: 0px; border-bottom-style: solid; border-bottom-color: tran=
sparent; top: 1273px;"></div><div class=3D"CodeMirror-gutters" st=
yle=3D"height: 1303px;"><div class=3D"CodeMirror-gutter CodeMirro=
r-linenumbers" style=3D"width: 29px;"></div></div></div></div></w=
iz_code_mirror></div><div id=3D"content_views" class=3D"markdown_=
views prism-tomorrow-night" style=3D"color: rgb(196, 196, 200) !i=
mportant; background: rgb(38, 39, 40) !important;"><h1 style=3D"f=
ont-size: 1.75rem; color: rgb(180, 180, 180) !important;">=CB=C4.=
 Broadcast State</h1><p style=3D"font-size:1.125rem;color:rgb(180=
, 180, 180) !important;">=B9=E3=B2=A5=D7=B4=CC=AC=CA=C7=D2=BB=D6=D6=
=CC=D8=CA=E2=B5=C4=B2=D9=D7=F7=D7=B4=CC=AC=A1=A3</p><p style=3D"f=
ont-size:1.125rem;color:rgb(180, 180, 180) !important;">Broadcast=
 State is a special type of Operator State. It was introduced to=20=
support use cases where records of one stream need to be broadcas=
ted to all downstream tasks, where they are used to maintain the=20=
same state among all subtasks. This state can then be accessed wh=
ile processing records of a second stream. As an example where br=
oadcast state can emerge as a natural fit, one can imagine a low-=
throughput stream containing a set of rules which we want to eval=
uate against all elements coming from another stream. Having the=20=
above type of use cases in mind, broadcast state differs from the=
 rest of operator states in that:</p><blockquote style=3D"color:r=
gb(180, 180, 180) !important;background:rgb(46, 47, 48) !importan=
t;"><ol style=3D"font-size: 0.875rem;" class=3D"wiz-list-level1">=
<li>it has a map format,</li><li>it is only available to specific=
 operators that have as inputs a broadcasted stream and a non-bro=
adcasted one, andsuch an operator can have multiple broadcast sta=
tes with different names.</li></ol></blockquote></div><p style=3D=
"font-size: 1.125rem; color: rgb(180, 180, 180) !important; backg=
round: rgb(38, 39, 40) !important;">=B9=D9=B7=BD=CE=C4=B5=B5 :</p=
><p style=3D"font-size: 1.125rem; color: rgb(180, 180, 180) !impo=
rtant; background: rgb(38, 39, 40) !important;">https://ci.apache=
.org/projects/flink/flink-docs-stable/zh/dev/stream/state/state.h=
tml</p><div style=3D"color: rgba(0, 0, 0, 0.74902); font-size: 0.=
875rem; background: rgb(38, 39, 40) !important;"></div><div class=
=3D"container clearfix" id=3D"mainBox" style=3D"color: rgba(0, 0,=
 0, 0.74902); font-size: 0.875rem;"><main><br></main></div><div c=
lass=3D"left-toolbox" style=3D"color: rgba(0, 0, 0, 0.74902); fon=
t-size: 0.875rem; background-color: rgb(45, 46, 47) !important;">=
<ul class=3D"toolbox-list"><li class=3D"tool-item tool-item-size=20=
tool-active is-like" id=3D"is-like" style=3D"background: rgb(45,=20=
46, 47) !important;"><br></li></ul></div><div></div></body></html=
>

------=_Next_Part_0000368765.630--

------=_Next_Part_0001106295.209--

