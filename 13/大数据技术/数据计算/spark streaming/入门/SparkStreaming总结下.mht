From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?U3BhcmtTdHJlYW1pbmfX3L3hz8I=?=
Date: Date: Fri, 23 Jul 2021 05:55:19 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0001398234.493"

This is a multi-part message in MIME format.

------=_Next_Part_0001398234.493
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000466078.596"


------=_Next_Part_0000466078.596
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000466078.596
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A=0A=0A=
<title>SparkStreaming=D7=DC=BD=E1=CF=C2</title>=0A    =0A<style i=
d=3D"wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wi=
z-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '=E5=BE=
=AE=E8=BD=AF=E9=9B=85=E9=BB=91', 'Microsoft YaHei UI', SimSun, Si=
mHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;padding:=20=
20px 16px;padding: 1.25rem 1rem;}.wiz-editor-body h1,.wiz-editor-=
body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body=20=
h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625=
rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:=
20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-=
size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25re=
m;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-ed=
itor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6=20=
{font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wi=
z-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-edi=
tor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0=
;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-=
body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .C=
odeMirror pre {margin:0;}.wiz-editor-body ul,.wiz-editor-body ol=20=
{padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-lis=
t-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-l=
ist-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol=
.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-b=
ody blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :f=
irst-child {margin-top:0;}.wiz-editor-body blockquote > :last-chi=
ld {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100=
%;height:auto !important;margin:2px 0;}.wiz-editor-body table {bo=
rder-collapse:collapse;border:1px solid #bbbbbb;}.wiz-editor-body=
 td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse=
;border:1px solid #bbbbbb;min-height:28px;word-break:break-word;b=
ox-sizing: border-box;}.wiz-hide {display:none !important;}</styl=
e></head>=0A=0A<body class=3D"wiz-editor-body"  spellcheck=3D"fal=
se"><div><div class=3D"article-title-box" style=3D"color:rgb(51,=20=
51, 51);font-size:0.875rem"><h1 class=3D"title-article" style=3D"=
font-size: 1.5rem;">SparkStreaming=D7=DC=BD=E1=CF=C2</h1></div><d=
iv class=3D"article-bar-top" style=3D"color:rgb(133, 133, 133);fo=
nt-size:0.875rem"><span class=3D"time">2017=C4=EA08=D4=C229=C8=D5=
 21:13:58</span><span class=3D"Apple-converted-space">&nbsp;</spa=
n><a class=3D"follow-nickName" href=3D"https://me.csdn.net/xiaoqi=
ang17" target=3D"_blank" style=3D"color: rgb(120, 165, 241); text=
-decoration: none;">xiaoqiang17</a><span class=3D"Apple-converted=
-space">&nbsp;</span><span class=3D"read-count">=D4=C4=B6=C1=CA=FD=
 6417</span></div><div class=3D"operating" style=3D"color:rgb(51,=
 51, 51);font-size:0.875rem"></div><div class=3D"article-copyrigh=
t" style=3D"color:rgb(153, 153, 153);font-size:0.75rem"><span cla=
ss=3D"Apple-converted-space">&nbsp;</span>=B0=E6=C8=A8=C9=F9=C3=F7=
=A3=BA=B1=BE=CE=C4=CE=AA=B2=A9=D6=F7=D4=AD=B4=B4=CE=C4=D5=C2=A3=AC=
=CE=B4=BE=AD=B2=A9=D6=F7=D4=CA=D0=ED=B2=BB=B5=C3=D7=AA=D4=D8=A1=A3=
<span class=3D"Apple-converted-space">&nbsp;</span><a class=3D"co=
py-right-url" href=3D"https://blog.csdn.net/xiaoqiang17/article/d=
etails/77688345" style=3D"color: rgb(120, 165, 241); text-decorat=
ion: none;">https://blog.csdn.net/xiaoqiang17/article/details/776=
88345</a></div><p style=3D"color: rgb(77, 77, 77);">=D2=BB=A1=A2s=
park=D6=B1=C1=AC=B7=BD=CA=BD=BA=CDReceiver=B7=BD=CA=BD=B1=C8=BD=CF=
</p><div class=3D"wiz-table-container" style=3D"color:rgb(51, 51,=
 51);font-size:0.875rem;position:relative;padding:0px"><div class=
=3D"table-box wiz-table-body"><table border=3D"1" style=3D"width:=
962px;"><tbody><tr><td valign=3D"top" style=3D"color: rgb(79, 79,=
 79);"><p>consumer =B4=AB=CD=B3=B5=C4=CF=FB=CF=A2=D5=DF=A3=A8=C0=CF=
=B5=C4=B7=BD=CA=BD=A3=A9=D0=E8=D2=AA=C1=AC=BD=D3ZK=A3=AC=D0=C2=B5=
=C4=B7=BD=CA=BD=A3=A8=B8=DF=D0=A7=B5=C4=B7=BD=CA=BD=A3=A9=B2=BB=D0=
=E8=D2=AA=C1=AC=BD=D3ZK=A3=AC=B5=AB=CA=C7=D2=AA=D7=D4=BC=BA=CE=AC=
=BB=A4=C6=AB=D2=C6=C1=BF</p><p>consumer group =D2=BB=B8=F6=CF=FB=B7=
=D1=D5=DF=D7=E9=CF=C2=BF=C9=D2=D4=D3=D0=B6=E0=B8=F6=CF=FB=B7=D1=D5=
=DF=A3=AC=B2=BB=D6=D8=B8=B4=CF=FB=CF=A2</p><p>&nbsp;</p><p>DStrea=
m=C0=EB=C9=A2=B5=C4=CA=FD=BE=DD=C1=F7=A3=AC=CA=C7SparkStreaming=D6=
=D0=D2=BB=B8=F6=D7=EE=BB=F9=B1=BE=B5=C4=B3=E9=CF=F3=A3=ACDStream=D6=
=D0=B2=BB=B4=E6=B7=C5=CA=FD=BE=DD=A3=AC=D2=B2=BF=C9=D2=D4=C8=CF=CE=
=AA=CA=C7=D2=BB=B8=F6=B7=D6=B2=BC=CA=BD=B5=C4=CA=FD=BE=DD=BC=AF=A3=
=AC=B1=BE=D7=D3=C9=CFDStream=CA=C7=D2=BB=CF=B5=C1=D0=C1=AC=D0=F8=B5=
=C4RDD=A3=ACDStream=CA=C7=B6=D4RDD=B5=C4=B7=E2=D7=B0=A3=AC=BF=C9=D2=
=D4=B4=A6=C0=ED=CA=B5=CA=B1=B5=C4=CA=FD=BE=DD=C1=F7</p><p>&nbsp;<=
/p><p>DStream=C3=BF=B8=F4=D2=BB=B6=CE=CA=B1=BC=E4=BB=E1=C9=FA=B3=C9=
=D2=BB=B8=F6=D0=A1=C5=FA=B4=CE=A3=AC=BD=AB=B8=C3=D0=A1=C5=FA=B4=CE=
=CC=E1=BD=BB=B5=BDSpark=D2=FD=C7=E6=D6=D0=BD=F8=D0=D0=BC=C6=CB=E3=
=A3=AC=C3=BF=D2=BB=B8=F6=C5=FA=B4=CE=B6=BC=BB=E1=D3=D0=BC=C6=CB=E3=
=B5=C4=BD=E1=B9=FB</p><p>&nbsp;</p><p>SparkStreaming=D5=FB=BA=CFK=
afka=D3=D0=C1=BD=D6=D6=B7=BD=CA=BD=A3=A80.8, 0.10=D6=BB=D6=A7=B3=D6=
=D6=B1=C1=AC=B7=BD=CA=BD=A3=A9</p><p>=B5=DA=D2=BB=D6=D6=B7=BD=CA=BD=
=BE=CD=CA=C7=D3=D0Receiver=B5=C4=B7=BD=CA=BD=A3=AC=CF=E0=B5=B1=D3=
=DA=D3=D0=BD=D3=CA=DC=D5=DF=A3=AC=BD=D3=CA=D5=D2=BB=B8=F6=C5=FA=B4=
=CE=B2=FA=C9=FA=CA=FD=BE=DD=B5=C4=A3=AC=C8=BB=BA=F3=D4=DA=BD=F8=D0=
=D0=BC=C6=CB=E3=A3=AC=CA=CA=BA=CF=B8=DF=BC=B6=B5=C4=CF=FB=B7=D1AP=
I=A3=A8=C1=AC=BD=D3zk=A3=AC=D7=D4=B6=AF=B8=FA=D0=C2=C6=AB=D2=C6=C1=
=BF=A3=ACWAL=A3=A9=A3=AC=B5=AB=CA=C7=D0=A7=C2=CA=B1=C8=BD=CF=B5=CD=
</p><p>=B5=DA=B6=FE=D6=D6=B7=BD=CA=BD=CA=C7=D6=B1=C1=AC=B7=BD=CA=BD=
=A3=AC=D2=BB=B8=F6SparkStraming=B5=C4Task=D6=AE=BC=E4=C1=AC=B5=BD=
Kafka=B6=D4=D3=A6Topic=B5=C4=B7=D6=C7=F8=C9=CF=A3=AC=D2=D4=B5=FC=B4=
=FA=C6=F7=B5=C4=B7=BD=CA=BD=D2=BB=CC=F5=D2=BB=CC=F5=B6=D4=C6=E4=CA=
=FD=BE=DD=A3=AC=B1=DF=B6=C8=B1=DF=BC=C6=CB=E3=A3=AC=BC=C6=CB=E3=D2=
=BB=B8=F6=C5=FA=B4=CE=B5=C4=CA=B1=BC=E4=A3=AC=C9=FA=B3=C9=D2=BB=B8=
=F6=C5=FA=B4=CE=B5=C4=D0=A1=BD=E1=B9=B9=A3=AC=B8=C3=CF=FB=CF=A2=B7=
=BD=CA=BD=A3=AC=B2=BB=D0=E8=D2=AA=C1=AC=BD=D3zk=A3=AC=D6=AE=BC=E4=
=C1=AC=BD=D3broker=C9=CF=A3=AC=B5=AB=CA=C7=D0=E8=D2=AA=CA=D6=B6=AF=
=CE=AC=BB=A4=C6=AB=D2=C6=C1=BF=A3=A8=C6=AB=D2=C6=C1=BF=BF=C9=D2=D4=
=BC=C7=C2=BC=B5=BDMySQL=A1=A2Redis=A1=A2ZK=A3=A9</p><p>&nbsp;</p>=
</td></tr></tbody></table></div></div><p style=3D"color: rgb(77,=20=
77, 77);">&nbsp;</p><p style=3D"color: rgb(77, 77, 77);">=B6=FE=A1=
=A2sparkStreaming=D6=B1=C1=AC=B7=BD=CA=BD=D5=FB=BA=CFKafka0.8</p>=
<div class=3D"wiz-table-container" style=3D"color:rgb(51, 51, 51)=
;font-size:0.875rem;position:relative;padding:0px"><div class=3D"=
table-box wiz-table-body"><table border=3D"1" style=3D"width:962p=
x;"><tbody><tr><td valign=3D"top" style=3D"color: rgb(79, 79, 79)=
;"><p>object KafkaDirectWordCount {</p><p>&nbsp; def main(args: A=
rray[String]): Unit =3D {</p><p>&nbsp;&nbsp;&nbsp; val group=3D"g=
001"</p><p>&nbsp;&nbsp;&nbsp; val conf =3D new SparkConf().setMas=
ter("local[2]").setAppName("KafkaDirectWordCount")</p><p>&nbsp;&n=
bsp;&nbsp; val ssc =3D new StreamingContext(conf,Seconds(5))</p><=
p>&nbsp;&nbsp;&nbsp; val topic =3D"wordcount"</p><p>&nbsp;&nbsp;&=
nbsp; //=D6=B8=B6=A8kafka=B5=C4broker=B5=D8=D6=B7(sparkStream=B5=C4=
Task=D6=B1=C1=AC=B5=BDkafka=B5=C4=B7=D6=C7=F8=C9=CF=A3=AC=D3=C3=B8=
=FC=BC=D3=B5=D7=B2=E3=B5=C4API=CF=FB=B7=D1=A3=AC=D0=A7=C2=CA=B8=FC=
=B8=DF)</p><p>&nbsp;&nbsp;&nbsp; val brokerList =3D "hdp20-01:909=
2,hdp20-02:9092,hdp20-03:9092"</p><p>&nbsp;&nbsp;&nbsp; //=D6=B8=B6=
=A8zk=B5=C4=B5=D8=D6=B7=A3=AC=BA=F3=C6=DA=B8=FC=D0=C2=CF=FB=B7=D1=
=B5=C4=C6=AB=D2=C6=C1=BF=CA=B1=CA=B9=D3=C3</p><p>&nbsp;&nbsp;&nbs=
p; val zkQuorum =3D "hdp20-01:2181,hdp20-02:2181,hdp20-03:2181"</=
p><p>&nbsp;&nbsp;&nbsp; //=B4=B4=BD=A8 stream =CA=B1=CA=B9=D3=C3=B5=
=C4 topic =C3=FB=D7=D6=BC=AF=BA=CF</p><p>&nbsp;&nbsp;&nbsp; val t=
opics: Set[String] =3D Set(topic)</p><p>&nbsp;&nbsp;&nbsp; //=B4=B4=
=BD=A8=D2=BB=B8=F6 ZKGroupTopicDirs =B6=D4=CF=F3,=C6=E4=CA=B5=CA=C7=
=D6=B8=B6=A8=CD=F9zk=D6=D0=D0=B4=C8=EB=CA=FD=BE=DD=B5=C4=C4=BF=C2=
=BC=A3=AC=D3=C3=D3=DA=B1=A3=B4=E6=C6=AB=D2=C6=C1=BF</p><p>&nbsp;&=
nbsp;&nbsp; val topicDirs =3D new ZKGroupTopicDirs(group, topic)<=
/p><p>&nbsp;&nbsp;&nbsp; //=BB=F1=C8=A1 zookeeper =D6=D0=B5=C4=C2=
=B7=BE=B6 "/g001/offsets/wordcount/"</p><p>&nbsp;&nbsp;&nbsp; val=
 zkTopicPath =3D s"${topicDirs.consumerOffsetDir}"</p><p>&nbsp;&n=
bsp;&nbsp; //=D7=BC=B1=B8kafka=B5=C4=B2=CE=CA=FD</p><p>&nbsp;&nbs=
p;&nbsp; val kafkaParams =3D Map(</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp; "metadata.broker.list" -&gt; brokerList,</p><p>&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp; "group.id" -&gt; group,</p><p>&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp; "auto.offset.reset" -&gt; kafka.api.OffsetRequest.=
SmallestTimeString</p><p>&nbsp;&nbsp;&nbsp; )</p><p>&nbsp;&nbsp;&=
nbsp; //zookeeper =B5=C4host =BA=CD ip=A3=AC=B4=B4=BD=A8=D2=BB=B8=
=F6 client,=D3=C3=D3=DA=B8=FA=D0=C2=C6=AB=D2=C6=C1=BF=C1=BF=B5=C4=
</p><p>&nbsp;&nbsp;&nbsp; val zkClient =3D new ZkClient(zkQuorum)=
</p><p>&nbsp;&nbsp;&nbsp; //=B2=E9=D1=AF=B8=C3=C2=B7=BE=B6=CF=C2=CA=
=C7=B7=F1=D7=D6=BD=DA=B5=E3=A3=A8=C4=AC=C8=CF=D3=D0=D7=D6=BD=DA=B5=
=E3=CE=AA=CE=D2=C3=C7=D7=D4=BC=BA=B1=A3=B4=E6=B2=BB=CD=AC partiti=
on =CA=B1=C9=FA=B3=C9=B5=C4=A3=A9</p><p>&nbsp;&nbsp;&nbsp; // /g0=
01/offsets/wordcount/0/10001"</p><p>&nbsp;&nbsp;&nbsp; // /g001/o=
ffsets/wordcount/1/30001"</p><p>&nbsp;&nbsp;&nbsp; // /g001/offse=
ts/wordcount/2/10001"</p><p>&nbsp;&nbsp;&nbsp; //zkTopicPath&nbsp=
; -&gt; /g001/offsets/wordcount/</p><p>&nbsp;&nbsp;&nbsp; val chi=
ldren =3D zkClient.countChildren(zkTopicPath)</p><p>&nbsp;&nbsp;&=
nbsp; var kafkaStream: InputDStream[(String, String)] =3D null</p=
><p>&nbsp;&nbsp;&nbsp; //=C8=E7=B9=FB zookeeper =D6=D0=D3=D0=B1=A3=
=B4=E6 offset=A3=AC=CE=D2=C3=C7=BB=E1=C0=FB=D3=C3=D5=E2=B8=F6 off=
set =D7=F7=CE=AA kafkaStream =B5=C4=C6=F0=CA=BC=CE=BB=D6=C3</p><p=
>&nbsp;&nbsp;&nbsp; var fromOffsets: Map[TopicAndPartition, Long]=
 =3D Map()</p><p>&nbsp;&nbsp;&nbsp; //=C8=E7=B9=FB=B1=A3=B4=E6=B9=
=FD offset</p><p>&nbsp;&nbsp;&nbsp; if (children &gt; 0) {</p><p>=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i &lt;- 0 until children) {</=
p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // /g001/offsets/=
wordcount/0/10001</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
; val partitionOffset =3D zkClient.readData[String](s"$zkTopicPat=
h/${i}")</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // word=
count/0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val tp =3D=
 TopicAndPartition(topic, i)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp; //=BD=AB=B2=BB=CD=AC partition =B6=D4=D3=A6=B5=C4 of=
fset =D4=F6=BC=D3=B5=BD fromOffsets =D6=D0</p><p>&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp; // wordcount/0 -&gt; 10001</p><p>&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fromOffsets +=3D (tp -&gt;=20=
partitionOffset.toLong)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p=
><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Key: wordcount&nbsp;&nbsp; v=
alues: "hello tom hello jerry"</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p; //=D5=E2=B8=F6=BB=E1=BD=AB kafka =B5=C4=CF=FB=CF=A2=BD=F8=D0=D0=
 transform=A3=AC=D7=EE=D6=D5 kafak =B5=C4=CA=FD=BE=DD=B6=BC=BB=E1=
=B1=E4=B3=C9 (topic_name, message) =D5=E2=D1=F9=B5=C4 tuple</p><p=
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; val messageHandler =3D (mmd: Mess=
ageAndMetadata[String, String]) =3D&gt; (mmd.topic, mmd.message()=
)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //=CD=A8=B9=FDKafkaUtils=B4=
=B4=BD=A8=D6=B1=C1=AC=B5=C4DStream=A3=A8fromOffsets=B2=CE=CA=FD=B5=
=C4=D7=F7=D3=C3=CA=C7:=B0=B4=D5=D5=C7=B0=C3=E6=BC=C6=CB=E3=BA=C3=C1=
=CB=B5=C4=C6=AB=D2=C6=C1=BF=BC=CC=D0=F8=CF=FB=B7=D1=CA=FD=BE=DD=A3=
=A9</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //[String, String, Strin=
gDecoder, StringDecoder,&nbsp;&nbsp;&nbsp;&nbsp; (String, String)=
]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; key&nbsp;&nbsp;&n=
bsp; value&nbsp;&nbsp;&nbsp; key=B5=C4=BD=E2=C2=EB=B7=BD=CA=BD&nb=
sp;&nbsp; value=B5=C4=BD=E2=C2=EB=B7=BD=CA=BD</p><p>&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; kafkaStream =3D KafkaUtils.createDirectStream[S=
tring, String, StringDecoder, StringDecoder, (String, String)](ss=
c, kafkaParams, fromOffsets, messageHandler)</p><p>&nbsp;&nbsp;&n=
bsp; } else {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //=C8=E7=B9=FB=
=CE=B4=B1=A3=B4=E6=A3=AC=B8=F9=BE=DD kafkaParam =B5=C4=C5=E4=D6=C3=
=CA=B9=D3=C3=D7=EE=D0=C2(largest)=BB=F2=D5=DF=D7=EE=BE=C9=B5=C4=A3=
=A8smallest=A3=A9 offset</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kaf=
kaStream =3D KafkaUtils.createDirectStream[String, String, String=
Decoder, StringDecoder](ssc, kafkaParams, topics)</p><p>&nbsp;&nb=
sp;&nbsp; }</p><p>&nbsp;&nbsp;&nbsp; //=C6=AB=D2=C6=C1=BF=B5=C4=B7=
=B6=CE=A7</p><p>&nbsp;&nbsp;&nbsp; var offsetRanges =3D Array[Off=
setRange]()</p><p>&nbsp;&nbsp;&nbsp; //=B4=D3kafka=B6=C1=C8=A1=B5=
=C4=CF=FB=CF=A2=A3=ACDStream=B5=C4Transform=B7=BD=B7=A8=BF=C9=D2=D4=
=BD=AB=B5=B1=C7=B0=C5=FA=B4=CE=B5=C4RDD=BB=F1=C8=A1=B3=F6=C0=B4</=
p><p>&nbsp;&nbsp;&nbsp; //=B8=C3transform=B7=BD=B7=A8=BC=C6=CB=E3=
=BB=F1=C8=A1=B5=BD=B5=B1=C7=B0=C5=FA=B4=CERDD=B5=C4=C6=AB=D2=C6=C1=
=BF</p><p>&nbsp;&nbsp;&nbsp; val transform: DStream[(String, Int)=
] =3D kafkaStream.transform { rdd =3D&gt;</p><p>&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp; //=B5=C3=B5=BD=B8=C3 rdd =B6=D4=D3=A6 kafka =B5=C4=CF=
=FB=CF=A2=B5=C4 offset</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //=B8=
=C3RDD=CA=C7=D2=BB=B8=F6KafkaRDD=A3=AC=BF=C9=D2=D4=BB=F1=B5=C3=C6=
=AB=D2=C6=C1=BF=B5=C4=B7=B6=CE=A7</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp; offsetRanges =3D rdd.asInstanceOf[HasOffsetRanges].offsetRa=
nges</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rdd</p><p>&nbsp;&nbsp;&=
nbsp; }.map(_._2).flatMap(_.split(" ")).map((_, 1)).reduceByKey(_=
+_)</p><p>&nbsp;&nbsp;&nbsp; val messages: DStream[(String, Int)]=
 =3D transform</p><p>&nbsp;&nbsp;&nbsp; //=D2=C0=B4=CE=B5=FC=B4=FA=
DStream=D6=D0=B5=C4RDD</p><p>&nbsp;&nbsp;&nbsp; messages.foreachR=
DD { rdd =3D&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //=B6=D4RDD=
=BD=F8=D0=D0=B2=D9=D7=F7=A3=AC=B4=A5=B7=A2Action</p><p>&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; rdd.foreachPartition(partition =3D&gt;</p><p=
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; partition.foreach(x =3D=
&gt; {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p; println(x)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })=
</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )</p><p>&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp; for (o &lt;- offsetRanges) {</p><p>&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp; val zkPath =3D s"${topicDirs.consumerOff=
setDir}/${o.partition}"</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp; //=BD=AB=B8=C3 partition =B5=C4 offset =B1=A3=B4=E6=B5=BD=
 zookeeper</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ZkUti=
ls.updatePersistentPath(zkClient, zkPath,o.fromOffset.toString)</=
p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p><p>&nbsp;&nbsp;&nbsp; }<=
/p><p>&nbsp;&nbsp;&nbsp; ssc.start()</p><p>&nbsp;&nbsp;&nbsp; ssc=
.awaitTermination()</p><p>&nbsp; }</p><p>}</p></td></tr></tbody><=
/table></div></div><p style=3D"color: rgb(77, 77, 77);">&nbsp;</p=
><p style=3D"color: rgb(77, 77, 77);">=CE=E5=A1=A2Kafka0.10=B0=E6=
=B1=BE=B0=B2=D7=B0</p><div class=3D"wiz-table-container" style=3D=
"color:rgb(51, 51, 51);font-size:0.875rem;position:relative;paddi=
ng:0px"><div class=3D"table-box wiz-table-body"><table border=3D"=
1" style=3D"width:962px;"><tbody><tr><td valign=3D"top" style=3D"=
color: rgb(79, 79, 79);"><p>kafka=BC=AF=C8=BA=B2=BF=CA=F0</p><p>b=
roker.id=3D1</p><p>delete.topic.enable=3Dtrue</p><p>log.dirs=3D/b=
igdata/kafka_2.11-0.10.2.1/data</p><p>zookeeper.connect=3Dnode-1.=
xiaoniu.com:2181,node-2.xiaoniu.com:2181,node-3.xiaoniu.com:2181<=
/p><p>&nbsp;</p><p>=C6=F4=B6=AFkafka</p><p>/bigdata/kafka_2.11-0.=
10.2.1/bin/kafka-server-start.sh -daemon /bigdata/kafka_2.11-0.10=
.2.1/config/server.properties</p><p>&nbsp;</p><p>=CD=A3=D6=B9kafk=
a</p><p>/bigdata/kafka_2.11-0.10.2.1/bin/kafka-server-stop.sh</p>=
<p>&nbsp;</p><p>=B4=B4=BD=A8topic</p><p>/bigdata/kafka_2.11-0.10.=
2.1/bin/kafka-topics.sh --create --zookeeper node-1.xiaoniu.com:2=
181,node-2.xiaoniu.com:2181,node-3.xiaoniu.com:2181 --replication=
-factor 3 --partitions 3 --topic my-topic</p><p>&nbsp;</p><p>&nbs=
p;</p><p>=C1=D0=B3=F6=CB=F9=D3=D0topic</p><p>/bigdata/kafka_2.11-=
0.10.2.1/bin/kafka-topics.sh --list --zookeeper node-1.xiaoniu.co=
m:2181,node-2.xiaoniu.com:2181,node-3.xiaoniu.com:2181</p><p>&nbs=
p;</p><p>=B2=E9=BF=B4=C4=B3=B8=F6topic=D0=C5=CF=A2</p><p>/bigdata=
/kafka_2.11-0.10.2.1/bin/kafka-topics.sh --describe --zookeeper n=
ode-1.xiaoniu.com:2181,node-2.xiaoniu.com:2181,node-3.xiaoniu.com=
:2181 --topic my-topic</p><p>&nbsp;</p><p>=C6=F4=B6=AF=D2=BB=B8=F6=
=C3=FC=C1=EE=D0=D0=B5=C4=C9=FA=B2=FA=D5=DF</p><p>/bigdata/kafka_2=
.11-0.10.2.1/bin/kafka-console-producer.sh --broker-list node-1.x=
iaoniu.com:9092,node-1.xiaoniu.xom:9092,node-3.xiaoniu.com:9092 -=
-topic xiaoniu</p><p>&nbsp;</p><p>=C6=F4=B6=AF=D2=BB=B8=F6=C3=FC=C1=
=EE=D0=D0=B5=C4=CF=FB=B7=D1=D5=DF</p><p>/bigdata/kafka_2.11-0.10.=
2.1/bin/kafka-console-consumer.sh --zookeeper node-1.xiaoniu.com:=
2181,node-2.xiaoniu.com:2181,node-3.xiaoniu.com:2181 --topic my-t=
opic --from-beginning</p><p>&nbsp;</p><p># =CF=FB=B7=D1=D5=DF=C1=AC=
=BD=D3=B5=BDborker=B5=C4=B5=D8=D6=B7</p><p>/bigdata/kafka_2.11-0.=
10.2.1/bin/kafka-console-consumer.sh --bootstrap-server node-1.xi=
aoniu.com:9092,node-2.xiaoniu.com:9092,node-3.xiaoniu.com:9092 --=
topic xiaoniu --from-beginning</p><p>&nbsp;</p><p>Kafka Connect:<=
/p><p>https://kafka.apache.org/documentation/#connect</p><p>http:=
//docs.confluent.io/2.0.0/connect/connect-jdbc/docs/index.html</p=
><p>&nbsp;</p><p>Kafka Stream:</p><p>https://kafka.apache.org/doc=
umentation/streams</p><p>https://spark.apache.org/docs/1.6.1/stre=
aming-kafka-integration.html</p><p>&nbsp;</p><p>kafka monitor:</p=
><p>https://kafka.apache.org/documentation/#monitoring</p><p>http=
s://github.com/quantifind/KafkaOffsetMonitor</p><p>https://github=
.com/yahoo/kafka-manager</p><p>&nbsp;</p><p>kafka=C9=FA=CC=AC=C8=A6=
=A3=BA</p><p>https://cwiki.apache.org/confluence/display/KAFKA/Ec=
osystem</p></td></tr></tbody></table></div></div><p style=3D"colo=
r: rgb(77, 77, 77);">&nbsp;</p><p style=3D"color: rgb(77, 77, 77)=
;">=C1=F9=A1=A2sparkStreaming=D6=B1=C1=AC=B7=BD=CA=BD=D5=FB=BA=CF=
Kafka0.10</p><div class=3D"wiz-table-container" style=3D"color:rg=
b(51, 51, 51);font-size:0.875rem;position:relative;padding:0px"><=
div class=3D"table-box wiz-table-body"><table border=3D"1" style=3D=
"width:962px;"><tbody><tr><td valign=3D"top" style=3D"color: rgb(=
79, 79, 79);"><p>object DirectStream {</p><p>&nbsp;</p><p>&nbsp;=20=
def main(args: Array[String]): Unit =3D {</p><p>&nbsp;</p><p>&nbs=
p;&nbsp;&nbsp; //=B4=B4=BD=A8SparkConf=A3=AC=C8=E7=B9=FB=BD=AB=C8=
=CE=CE=F1=CC=E1=BD=BB=B5=BD=BC=AF=C8=BA=D6=D0=A3=AC=C4=C7=C3=B4=D2=
=AA=C8=A5=B5=F4.setMaster("local[2]")</p><p>&nbsp;&nbsp;&nbsp; va=
l conf =3D new SparkConf().setAppName("DirectStream").setMaster("=
local[2]")</p><p>&nbsp;&nbsp;&nbsp; //=B4=B4=BD=A8=D2=BB=B8=F6Str=
eamingContext=A3=AC=C6=E4=C0=EF=C3=E6=B0=FC=BA=AC=C1=CB=D2=BB=B8=F6=
SparkContext</p><p>&nbsp;&nbsp;&nbsp; val streamingContext =3D ne=
w StreamingContext(conf, Seconds(5))</p><p>&nbsp;</p><p>&nbsp;&nb=
sp;&nbsp; //=C5=E4=D6=C3kafka=B5=C4=B2=CE=CA=FD</p><p>&nbsp;&nbsp=
;&nbsp; val kafkaParams =3D Map[String, Object](</p><p>&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; "bootstrap.servers" -&gt; "node-1.xiaoniu.co=
m:9092,node-2.xiaoniu.com:9092,node-3.xiaoniu.com:9092",</p><p>&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp; "key.deserializer" -&gt; classOf[Str=
ingDeserializer],</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "value.des=
erializer" -&gt; classOf[StringDeserializer],</p><p>&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; "group.id" -&gt; "test123",</p><p>&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; "auto.offset.reset" -&gt; "earliest", // lastes=
t</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "enable.auto.commit" -&gt;=
 (false: java.lang.Boolean)</p><p>&nbsp;&nbsp;&nbsp; )</p><p>&nbs=
p;</p><p>&nbsp;&nbsp;&nbsp; val topics =3D Array("xiaoniu")</p><p=
>&nbsp;&nbsp;&nbsp; //=D4=DAKafka=D6=D0=BC=C7=C2=BC=B6=C1=C8=A1=C6=
=AB=D2=C6=C1=BF</p><p>&nbsp;&nbsp;&nbsp; val stream =3D KafkaUtil=
s.createDirectStream[String, String](</p><p>&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp; streamingContext,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20=
//=CE=BB=D6=C3=B2=DF=C2=D4=A3=A8=BF=C9=D3=C3=B5=C4Executor=C9=CF=BE=
=F9=D4=C8=B7=D6=C5=E4=B7=D6=C7=F8=A3=A9</p><p>&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp; LocationStrategies.PreferConsistent,</p><p>&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; //=CF=FB=B7=D1=B2=DF=C2=D4=A3=A8=B6=A9=D4=C4=
=B9=CC=B6=A8=B5=C4=D6=F7=CC=E2=BC=AF=BA=CF=A3=A9</p><p>&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; ConsumerStrategies.Subscribe[String, String]=
(topics, kafkaParams)</p><p>&nbsp;&nbsp;&nbsp; )</p><p>&nbsp;</p>=
<p>&nbsp;&nbsp;&nbsp; //=B5=FC=B4=FADStream=D6=D0=B5=C4RDD(KafkaR=
DD)=A3=AC=BD=AB=C3=BF=D2=BB=B8=F6=CA=B1=BC=E4=B5=E3=B6=D4=D3=DA=B5=
=C4RDD=C4=C3=B3=F6=C0=B4</p><p>&nbsp;&nbsp;&nbsp; stream.foreachR=
DD { rdd =3D&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //=BB=F1=C8=
=A1=B8=C3RDD=B6=D4=D3=DA=B5=C4=C6=AB=D2=C6=C1=BF</p><p>&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; val offsetRanges =3D rdd.asInstanceOf[HasOff=
setRanges].offsetRanges</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //=C4=
=C3=B3=F6=B6=D4=D3=A6=B5=C4=CA=FD=BE=DD</p><p>&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp; rdd.foreach{ line =3D&gt;</p><p>&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp; println(line.key() + " " + line.value())</p=
><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p><p>&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp; //=D2=EC=B2=BD=B8=FC=D0=C2=C6=AB=D2=C6=C1=BF=B5=BDkafka=D6=
=D0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // some time later, afte=
r outputs have completed</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str=
eam.asInstanceOf[CanCommitOffsets].commitAsync(offsetRanges)</p><=
p>&nbsp;&nbsp;&nbsp; }</p><p>&nbsp;&nbsp;&nbsp; streamingContext.=
start()</p><p>&nbsp;&nbsp;&nbsp; streamingContext.awaitTerminatio=
n()</p><p>&nbsp; }</p><p>}</p></td></tr></tbody></table></div></d=
iv><p style=3D"color: rgb(77, 77, 77);">&nbsp;</p><p style=3D"col=
or: rgb(77, 77, 77);">=C6=DF=A1=A2spark on yarn cluster=C4=A3=CA=BD=
</p><div class=3D"wiz-table-container" style=3D"color:rgb(51, 51,=
 51);font-size:0.875rem;position:relative;padding:0px"><div class=
=3D"table-box wiz-table-body"><table border=3D"1" style=3D"width:=
962px;"><tbody><tr><td valign=3D"top" style=3D"color: rgb(79, 79,=
 79);"><h2 style=3D"font-size: 1.5rem;">1.&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp; =B9=D9=B7=BD=CE=C4=B5=B5</h2><p><a href=3D"http://spark.a=
pache.org/docs/latest/running-on-yarn.html" data-token=3D"8462f95=
055af3efe887e9d490ce22681" style=3D"color: rgb(103, 149, 181); te=
xt-decoration: none;">http://spark.apache.org/docs/latest/running=
-on-yarn.html</a></p><h2 style=3D"font-size: 1.5rem;">2.&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp; =C5=E4=D6=C3=B0=B2=D7=B0</h2><p>1.<strong>=B0=
=B2=D7=B0hadoop=A3=BA</strong>=D0=E8=D2=AA=B0=B2=D7=B0HDFS=C4=A3=BF=
=E9=BA=CDYARN=C4=A3=BF=E9=A3=ACHDFS=B1=D8=D0=EB=B0=B2=D7=B0=A3=AC=
spark=D4=CB=D0=D0=CA=B1=D2=AA=B0=D1jar=B0=FC=B4=E6=B7=C5=B5=BDHDF=
S=C9=CF=A1=A3</p><p>2.<strong>=B0=B2=D7=B0Spark=A3=BA</strong>=BD=
=E2=D1=B9Spark=B0=B2=D7=B0=B3=CC=D0=F2=B5=BD=D2=BB=CC=A8=B7=FE=CE=
=F1=C6=F7=C9=CF=A3=AC=D0=DE=B8=C4spark-env.sh=C5=E4=D6=C3=CE=C4=BC=
=FE=A3=ACspark=B3=CC=D0=F2=BD=AB=D7=F7=CE=AAYARN=B5=C4=BF=CD=BB=A7=
=B6=CB=D3=C3=D3=DA=CC=E1=BD=BB=C8=CE=CE=F1</p><p><span style=3D"c=
olor: rgb(0, 0, 255);">export JAVA_HOME=3D/usr/local/jdk1.7.0_80<=
/span></p><p><span style=3D"color: rgb(0, 0, 255);">export HADOOP=
_CONF_DIR=3D/usr/local/hadoop-2.6.4/etc/hadoop</span></p><p><stro=
ng>3.=C6=F4=B6=AFHDFS=BA=CDYARN</strong></p><h2 style=3D"font-siz=
e: 1.5rem;">3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =D4=CB=D0=D0=C4=A3=CA=
=BD=A3=A8cluster=C4=A3=CA=BD=BA=CDclient=C4=A3=CA=BD=A3=A9</h2><p=
><strong>1.cluster=C4=A3=CA=BD</strong></p><p><span style=3D"colo=
r: rgb(0, 0, 255);">./bin/spark-submit --class org.apache.spark.e=
xamples.SparkPi \</span></p><p><span style=3D"color: rgb(0, 0, 25=
5);">--master yarn \</span></p><p><span style=3D"color: rgb(0, 0,=
 255);">--deploy-mode cluster \</span></p><p><span style=3D"color=
: rgb(0, 0, 255);">--driver-memory 1g \</span></p><p><span style=3D=
"color: rgb(0, 0, 255);">--executor-memory 1g \</span></p><p><spa=
n style=3D"color: rgb(0, 0, 255);">--executor-cores 2 \</span></p=
><p><span style=3D"color: rgb(0, 0, 255);">--queue default \</spa=
n></p><p><span style=3D"color: rgb(0, 0, 255);">lib/spark-example=
s*.jar \</span></p><p><span style=3D"color: rgb(0, 0, 255);">10</=
span></p><p><span style=3D"color: rgb(0, 0, 255);">&nbsp;</span><=
/p><p><span style=3D"color: rgb(0, 0, 255);">--------------------=
-----------------------------------------------------------------=
--------------------------------------------</span></p><p><span s=
tyle=3D"color: rgb(0, 0, 255);">./bin/spark-submit --class cn.edu=
360.spark.day1.WordCount \</span></p><p><span style=3D"color: rgb=
(0, 0, 255);">--master yarn \</span></p><p><span style=3D"color:=20=
rgb(0, 0, 255);">--deploy-mode cluster \</span></p><p><span style=
=3D"color: rgb(0, 0, 255);">--driver-memory 1g \</span></p><p><sp=
an style=3D"color: rgb(0, 0, 255);">--executor-memory 1g \</span>=
</p><p><span style=3D"color: rgb(0, 0, 255);">--executor-cores 2=20=
\</span></p><p><span style=3D"color: rgb(0, 0, 255);">--queue def=
ault \</span></p><p><span style=3D"color: rgb(0, 0, 255);">/home/=
bigdata/hello-spark-1.0.jar \</span></p><p><span style=3D"color:=20=
rgb(0, 0, 255);">hdfs://node-1.edu360.cn:9000/wc hdfs://node-1.ed=
u360.cn:9000/out-yarn-1</span></p><p><span style=3D"color: rgb(0,=
 0, 255);">&nbsp;</span></p><p>&nbsp;</p><p><strong>2.client=C4=A3=
=CA=BD</strong></p><p><span style=3D"color: rgb(0, 0, 255);">./bi=
n/spark-submit --class org.apache.spark.examples.SparkPi \</span>=
</p><p><span style=3D"color: rgb(0, 0, 255);">--master yarn \</sp=
an></p><p><span style=3D"color: rgb(0, 0, 255);">--deploy-mode cl=
ient \</span></p><p><span style=3D"color: rgb(0, 0, 255);">--driv=
er-memory 1g \</span></p><p><span style=3D"color: rgb(0, 0, 255);=
">--executor-memory 1g \</span></p><p><span style=3D"color: rgb(0=
, 0, 255);">--executor-cores 2 \</span></p><p><span style=3D"colo=
r: rgb(0, 0, 255);">--queue default \</span></p><p><span style=3D=
"color: rgb(0, 0, 255);">lib/spark-examples*.jar \</span></p><p><=
span style=3D"color: rgb(0, 0, 255);">10</span></p><p><span style=
=3D"color: rgb(0, 0, 255);">&nbsp;</span></p><p><span style=3D"co=
lor: rgb(255, 0, 0);">spark-shell</span><span style=3D"color: rgb=
(255, 0, 0);">=B1=D8=D0=EB=CA=B9=D3=C3</span><span style=3D"color=
: rgb(255, 0, 0);">client</span><span style=3D"color: rgb(255, 0,=
 0);">=C4=A3=CA=BD</span></p><p><span style=3D"color: rgb(0, 0, 2=
55);">./bin/spark-shell --master yarn --deploy-mode client</span>=
</p><p>&nbsp;</p><p><strong>3.=C1=BD=D6=D6=C4=A3=CA=BD=B5=C4=C7=F8=
=B1=F0</strong></p><p><span style=3D"color: rgb(255, 0, 0);">clus=
ter</span><span style=3D"color: rgb(255, 0, 0);">=C4=A3=CA=BD=A3=BA=
</span>Driver=B3=CC=D0=F2=D4=DAYARN=D6=D0=D4=CB=D0=D0=A3=AC=D3=A6=
=D3=C3=B5=C4=D4=CB=D0=D0=BD=E1=B9=FB=B2=BB=C4=DC=D4=DA=BF=CD=BB=A7=
=B6=CB=CF=D4=CA=BE=A3=AC=CB=F9=D2=D4=D7=EE=BA=C3=D4=CB=D0=D0=C4=C7=
=D0=A9=BD=AB=BD=E1=B9=FB=D7=EE=D6=D5=B1=A3=B4=E6=D4=DA=CD=E2=B2=BF=
=B4=E6=B4=A2=BD=E9=D6=CA=A3=A8=C8=E7HDFS=A1=A2Redis=A1=A2Mysql=A3=
=A9=B6=F8=B7=C7stdout=CA=E4=B3=F6=B5=C4=D3=A6=D3=C3=B3=CC=D0=F2=A3=
=AC=BF=CD=BB=A7=B6=CB=B5=C4=D6=D5=B6=CB=CF=D4=CA=BE=B5=C4=BD=F6=CA=
=C7=D7=F7=CE=AAYARN=B5=C4job=B5=C4=BC=F2=B5=A5=D4=CB=D0=D0=D7=B4=BF=
=F6=A1=A3</p><p>&nbsp;</p><p><span style=3D"color: rgb(255, 0, 0)=
;">client</span><span style=3D"color: rgb(255, 0, 0);">=C4=A3=CA=BD=
=A3=BA</span>Driver=D4=CB=D0=D0=D4=DAClient=C9=CF=A3=AC=D3=A6=D3=C3=
=B3=CC=D0=F2=D4=CB=D0=D0=BD=E1=B9=FB=BB=E1=D4=DA=BF=CD=BB=A7=B6=CB=
=CF=D4=CA=BE=A3=AC=CB=F9=D3=D0=CA=CA=BA=CF=D4=CB=D0=D0=BD=E1=B9=FB=
=D3=D0=CA=E4=B3=F6=B5=C4=D3=A6=D3=C3=B3=CC=D0=F2=A3=A8=C8=E7spark=
-shell=A3=A9</p><p>&nbsp;</p><p><strong>4.=D4=AD=C0=ED</strong></=
p><p><span style=3D"color: rgb(255, 0, 0);">cluster</span><span s=
tyle=3D"color: rgb(255, 0, 0);">=C4=A3=CA=BD=A3=BA</span></p><p><=
span style=3D"color: rgb(255, 0, 0);">&nbsp;</span></p><p>Spark D=
river=CA=D7=CF=C8=D7=F7=CE=AA=D2=BB=B8=F6ApplicationMaster=D4=DAY=
ARN=BC=AF=C8=BA=D6=D0=C6=F4=B6=AF=A3=AC=BF=CD=BB=A7=B6=CB=CC=E1=BD=
=BB=B8=F8ResourceManager=B5=C4=C3=BF=D2=BB=B8=F6job=B6=BC=BB=E1=D4=
=DA=BC=AF=C8=BA=B5=C4NodeManager=BD=DA=B5=E3=C9=CF=B7=D6=C5=E4=D2=
=BB=B8=F6=CE=A8=D2=BB=B5=C4ApplicationMaster=A3=AC=D3=C9=B8=C3App=
licationMaster=B9=DC=C0=ED=C8=AB=C9=FA=C3=FC=D6=DC=C6=DA=B5=C4=D3=
=A6=D3=C3=A1=A3=BE=DF=CC=E5=B9=FD=B3=CC=A3=BA</p><p>&nbsp;</p><p>=
1. =D3=C9client=CF=F2ResourceManager=CC=E1=BD=BB=C7=EB=C7=F3=A3=AC=
=B2=A2=C9=CF=B4=ABjar=B5=BDHDFS=C9=CF</p><p>=D5=E2=C6=DA=BC=E4=B0=
=FC=C0=A8=CB=C4=B8=F6=B2=BD=D6=E8=A3=BA</p><p>a).=C1=AC=BD=D3=B5=BD=
RM</p><p>b).=B4=D3RM=B5=C4ASM=A3=A8ApplicationsManager =A3=A9=D6=D0=
=BB=F1=B5=C3metric=A1=A2queue=BA=CDresource=B5=C8=D0=C5=CF=A2=A1=A3=
</p><p>c). upload app jar and spark-assembly jar</p><p>d).=C9=E8=D6=
=C3=D4=CB=D0=D0=BB=B7=BE=B3=BA=CDcontainer=C9=CF=CF=C2=CE=C4=A3=A8=
launch-container.sh=B5=C8=BD=C5=B1=BE)</p><p>&nbsp;</p><p>2. Reso=
uceManager=CF=F2NodeManager=C9=EA=C7=EB=D7=CA=D4=B4=A3=AC=B4=B4=BD=
=A8Spark ApplicationMaster=A3=A8=C3=BF=B8=F6SparkContext=B6=BC=D3=
=D0=D2=BB=B8=F6ApplicationMaster=A3=A9</p><p>3. NodeManager=C6=F4=
=B6=AFApplicationMaster=A3=AC=B2=A2=CF=F2ResourceManager AsM=D7=A2=
=B2=E1</p><p>4. ApplicationMaster=B4=D3HDFS=D6=D0=D5=D2=B5=BDjar=CE=
=C4=BC=FE=A3=AC=C6=F4=B6=AFSparkContext=A1=A2DAGscheduler=BA=CDYA=
RN Cluster Scheduler</p><p>5. ResourceManager=CF=F2ResourceManage=
r AsM=D7=A2=B2=E1=C9=EA=C7=EBcontainer=D7=CA=D4=B4</p><p>6. Resou=
rceManager=CD=A8=D6=AANodeManager=B7=D6=C5=E4Container=A3=AC=D5=E2=
=CA=B1=BF=C9=D2=D4=CA=D5=B5=BD=C0=B4=D7=D4ASM=B9=D8=D3=DAcontaine=
r=B5=C4=B1=A8=B8=E6=A1=A3=A3=A8=C3=BF=B8=F6container=B6=D4=D3=A6=D2=
=BB=B8=F6executor=A3=A9</p><p>7. Spark ApplicationMaster=D6=B1=BD=
=D3=BA=CDcontainer=A3=A8executor=A3=A9=BD=F8=D0=D0=BD=BB=BB=A5=A3=
=AC=CD=EA=B3=C9=D5=E2=B8=F6=B7=D6=B2=BC=CA=BD=C8=CE=CE=F1=A1=A3</=
p><p><span style=3D"color: rgb(255, 0, 0);">&nbsp;</span></p><p><=
span style=3D"color: rgb(255, 0, 0);">client</span><span style=3D=
"color: rgb(255, 0, 0);">=C4=A3=CA=BD=A3=BA</span></p><p><span st=
yle=3D"color: rgb(255, 0, 0);">&nbsp;</span></p><p>=D4=DAclient=C4=
=A3=CA=BD=CF=C2=A3=ACDriver=D4=CB=D0=D0=D4=DAClient=C9=CF=A3=AC=CD=
=A8=B9=FDApplicationMaster=CF=F2RM=BB=F1=C8=A1=D7=CA=D4=B4=A1=A3=B1=
=BE=B5=D8Driver=B8=BA=D4=F0=D3=EB=CB=F9=D3=D0=B5=C4executor conta=
iner=BD=F8=D0=D0=BD=BB=BB=A5=A3=AC=B2=A2=BD=AB=D7=EE=BA=F3=B5=C4=BD=
=E1=B9=FB=BB=E3=D7=DC=A1=A3=BD=E1=CA=F8=B5=F4=D6=D5=B6=CB=A3=AC=CF=
=E0=B5=B1=D3=DAkill=B5=F4=D5=E2=B8=F6spark=D3=A6=D3=C3=A1=A3=D2=BB=
=B0=E3=C0=B4=CB=B5=A3=AC=C8=E7=B9=FB=D4=CB=D0=D0=B5=C4=BD=E1=B9=FB=
=BD=F6=BD=F6=B7=B5=BB=D8=B5=BDterminal=C9=CF=CA=B1=D0=E8=D2=AA=C5=
=E4=D6=C3=D5=E2=B8=F6=A1=A3</p><p>&nbsp;</p><p>=BF=CD=BB=A7=B6=CB=
=B5=C4Driver=BD=AB=D3=A6=D3=C3=CC=E1=BD=BB=B8=F8Yarn=BA=F3=A3=ACY=
arn=BB=E1=CF=C8=BA=F3=C6=F4=B6=AFApplicationMaster=BA=CDexecutor=A3=
=AC=C1=ED=CD=E2ApplicationMaster=BA=CDexecutor=B6=BC =CA=C7=D7=B0=
=D4=D8=D4=DAcontainer=C0=EF=D4=CB=D0=D0=A3=ACcontainer=C4=AC=C8=CF=
=B5=C4=C4=DA=B4=E6=CA=C71G=A3=ACApplicationMaster=B7=D6=C5=E4=B5=C4=
=C4=DA=B4=E6=CA=C7driver- memory=A3=ACexecutor=B7=D6=C5=E4=B5=C4=C4=
=DA=B4=E6=CA=C7executor-memory=A1=A3=CD=AC=CA=B1=A3=AC=D2=F2=CE=AA=
Driver=D4=DA=BF=CD=BB=A7=B6=CB=A3=AC=CB=F9=D2=D4=B3=CC=D0=F2=B5=C4=
=D4=CB=D0=D0=BD=E1=B9=FB=BF=C9=D2=D4=D4=DA=BF=CD=BB=A7=B6=CB=CF=D4=
 =CA=BE=A3=ACDriver=D2=D4=BD=F8=B3=CC=C3=FB=CE=AASparkSubmit=B5=C4=
=D0=CE=CA=BD=B4=E6=D4=DA=A1=A3</p><p>&nbsp;</p></td></tr></tbody>=
</table></div></div><br></div></body></html>=0A=0A=0A=0A=0A=0A=0A=
=0A=0A=0A=0A=0A

------=_Next_Part_0000466078.596--

------=_Next_Part_0001398234.493--

