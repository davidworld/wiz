From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?U3BhcmvRp8+wscq8xyg3KS0tLVNwYXJrIFNRTNGnz7CxyrzH?=
Date: Date: Fri, 23 Jul 2021 05:55:10 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0001370529.178"

This is a multi-part message in MIME format.

------=_Next_Part_0001370529.178
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000456843.220"


------=_Next_Part_0000456843.220
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000456843.220
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A=0A=0A=
<title>Spark=D1=A7=CF=B0=B1=CA=BC=C7(7)---Spark SQL=D1=A7=CF=B0=B1=
=CA=BC=C7</title>=0A    =0A<style id=3D"wiz_custom_css">html, .wi=
z-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: He=
lvetica, 'Hiragino Sans GB', '=E5=BE=AE=E8=BD=AF=E9=9B=85=E9=BB=91=
', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;line-h=
eight: 1.7;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1re=
m;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.w=
iz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin=
:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bo=
ld;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-e=
ditor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body=20=
h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-s=
ize:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;f=
ont-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem=
;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-=
body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body d=
l,.wiz-editor-body li {margin:8px 0;}.wiz-editor-body blockquote,=
.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code=
 {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-=
editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-lef=
t:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type=
:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-ty=
pe:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-st=
yle-type:lower-roman;}.wiz-editor-body blockquote {padding: 0 12p=
x;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz=
-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-edit=
or-body img {border:0;max-width:100%;height:auto !important;margi=
n:2px 0;}.wiz-editor-body table {border-collapse:collapse;border:=
1px solid #bbbbbb;}.wiz-editor-body td,.wiz-editor-body th {paddi=
ng:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-=
height:28px;word-break:break-word;box-sizing: border-box;}.wiz-hi=
de {display:none !important;}</style></head>=0A=0A<body class=3D"=
wiz-editor-body" spellcheck=3D"false" ><div></div><h1 class=3D"po=
stTitle" style=3D"font-size: 0.975rem;"><a id=3D"cb_post_title_ur=
l" class=3D"postTitle2" href=3D"https://www.cnblogs.com/yangtong/=
p/7146086.html" style=3D"color:rgb(33, 117, 155);text-decoration:=
none;">Spark=D1=A7=CF=B0=B1=CA=BC=C7(7)---Spark SQL=D1=A7=CF=B0=B1=
=CA=BC=C7</a></h1><div class=3D"clear" style=3D"font-size: 0.833r=
em;"></div><div id=3D"cnblogs_post_body" class=3D"blogpost-body c=
nblogs-markdown" style=3D"font-size:0.875rem"><h1 id=3D"spark-sql=
=D1=A7=CF=B0=B1=CA=BC=C7" style=3D"font-size:1.75rem;">Spark SQL=D1=
=A7=CF=B0=B1=CA=BC=C7</h1></div><p style=3D"font-size:0.875rem">S=
park SQL=D1=A7=CF=B0=B1=CA=BC=C7=C9=E8=BC=C6=B5=BD=BA=DC=B6=E0=B4=
=FA=C2=EB=B2=D9=D7=F7=A3=AC=CB=F9=D2=D4=BE=CD=B7=C5=D4=DA<a href=3D=
"https://github.com/yangtong123/RoadOfStudySpark/blob/master/src/=
com/spark/sql/Readme.md" style=3D"text-decoration: underline;">gi=
thub</a>,<span class=3D"Apple-converted-space">&nbsp;</span><a hr=
ef=3D"https://github.com/yangtong123/RoadOfStudySpark/blob/master=
/src/com/spark/sql/Readme.md" class=3D"uri" style=3D"text-decorat=
ion: underline;">https://github.com/yangtong123/RoadOfStudySpark/=
blob/master/src/com/spark/sql/Readme.md</a>=C6=E4=D6=D0=B0=FC=C0=A8=
=C1=CB=B6=D4Spark2.0=B5=C4=D0=C2=CC=D8=D0=D4=B5=C4=BD=E9=C9=DC=A3=
=AC=B0=FC=C0=A8SparkSession, DataSet=B5=C8<br></p><div style=3D"f=
ont-size:0.875rem"><br></div><h1 style=3D"font-size: 2rem; color:=
 rgb(36, 41, 46);">sparkSQL=D1=A7=CF=B0=B1=CA=BC=C7<span>=C4=BF=C2=
=BC</span></h1><ul style=3D"color: rgb(36, 41, 46);"><li><a href=3D=
"https://github.com/yangtong123/RoadOfStudySpark/blob/master/src/=
com/spark/sql/Readme.md#sparksql%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD=
%9C" style=3D"color:rgb(3, 102, 214);text-decoration:none;">spark=
SQL=BB=F9=B4=A1=B2=D9=D7=F7</a><ul><li><a href=3D"https://github.=
com/yangtong123/RoadOfStudySpark/blob/master/src/com/spark/sql/Re=
adme.md#rdd-dataframe-dataset-sparksession" style=3D"color:rgb(3,=
 102, 214);text-decoration:none;">RDD, DataFrame, DataSet, SparkS=
ession</a><ul><li><a href=3D"https://github.com/yangtong123/RoadO=
fStudySpark/blob/master/src/com/spark/sql/Readme.md#dataset-api%E=
6%9C%89%E5%93%AA%E4%BA%9B%E4%BC%98%E7%82%B9" style=3D"color:rgb(3=
, 102, 214);text-decoration:none;">DataSet API=D3=D0=C4=C4=D0=A9=D3=
=C5=B5=E3</a></li><li><a href=3D"https://github.com/yangtong123/R=
oadOfStudySpark/blob/master/src/com/spark/sql/Readme.md#dataset%E=
6%93%8D%E4%BD%9C" style=3D"color:rgb(3, 102, 214);text-decoration=
:none;">DataSet=B2=D9=D7=F7</a></li></ul></li><li><a href=3D"http=
s://github.com/yangtong123/RoadOfStudySpark/blob/master/src/com/s=
park/sql/Readme.md#rdd%E8%BD%AC%E4%B8%BAdataframe" style=3D"color=
:rgb(3, 102, 214);text-decoration:none;">RDD=D7=AA=CE=AADataFrame=
</a></li><li><a href=3D"https://github.com/yangtong123/RoadOfStud=
ySpark/blob/master/src/com/spark/sql/Readme.md#sparksql-udf%E5%92=
%8Cudaf" style=3D"color:rgb(3, 102, 214);text-decoration:none;">s=
parkSQL udf=BA=CDudaf</a></li></ul></li><li><a href=3D"https://gi=
thub.com/yangtong123/RoadOfStudySpark/blob/master/src/com/spark/s=
ql/Readme.md#sparksql%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E6%BA%9=
0" style=3D"color:rgb(3, 102, 214);text-decoration:none;">sparkSQ=
L=B8=F7=D6=D6=CA=FD=BE=DD=D4=B4</a><ul><li><a href=3D"https://git=
hub.com/yangtong123/RoadOfStudySpark/blob/master/src/com/spark/sq=
l/Readme.md#%E6%96%87%E4%BB%B6" style=3D"color:rgb(3, 102, 214);t=
ext-decoration:none;">=CE=C4=BC=FE</a></li><li><a href=3D"https:/=
/github.com/yangtong123/RoadOfStudySpark/blob/master/src/com/spar=
k/sql/Readme.md#hive" style=3D"color:rgb(3, 102, 214);text-decora=
tion:none;">Hive</a></li><li><a href=3D"https://github.com/yangto=
ng123/RoadOfStudySpark/blob/master/src/com/spark/sql/Readme.md#jd=
bc" style=3D"color:rgb(3, 102, 214);text-decoration:none;">JDBC</=
a></li></ul></li><li><a href=3D"https://github.com/yangtong123/Ro=
adOfStudySpark/blob/master/src/com/spark/sql/Readme.md#thrift-jdb=
c-odbc-server" style=3D"color:rgb(3, 102, 214);text-decoration:no=
ne;">Thrift JDBC ODBC Server</a></li><li><a href=3D"https://githu=
b.com/yangtong123/RoadOfStudySpark/blob/master/src/com/spark/sql/=
Readme.md#%E4%B8%80%E4%B8%AA%E5%AE%9E%E6%88%98%E7%9A%84%E6%A1%88%=
E4%BE%8B" style=3D"color:rgb(3, 102, 214);text-decoration:none;">=
=D2=BB=B8=F6=CA=B5=D5=BD=B5=C4=B0=B8=C0=FD</a></li></ul><h2 style=
=3D"font-size: 1.5rem; color: rgb(36, 41, 46);">sparkSQL=BB=F9=B4=
=A1=B2=D9=D7=F7</h2><h3 style=3D"font-size: 1.25rem; color: rgb(3=
6, 41, 46);">RDD, DataFrame, DataSet, SparkSession</h3><ul style=3D=
"color: rgb(36, 41, 46);"><li>=B4=D3spark2.0=BF=AA=CA=BC=A3=ACDat=
aset=D3=D0=C1=BD=D6=D6=B1=ED=CF=D6=D0=CE=CA=BD=A3=BAtype API=BA=CD=
untyped API=A1=A3=CE=D2=C3=C7=BF=C9=D2=D4=C8=CF=CE=AADataFrame=BE=
=CD=CA=C7DataSet[Row]=B5=C4=B1=F0=C3=FB=A3=AC Row=BE=CD=CA=C7=D2=BB=
=B8=F6untyped=C0=E0=D0=CD=B5=C4=B6=D4=CF=F3=A3=AC=D2=F2=CE=AARow=CA=
=C7=C0=E0=CB=C6=D3=DA=CA=FD=BE=DD=BF=E2=D6=D0=B5=C4=D2=BB=D0=D0=A3=
=AC=CE=D2=C3=C7=D6=BB=D6=AA=B5=C0=D3=D0=C4=C4=D0=A9=C1=D0=A3=AC=B5=
=AB=CA=C7=D3=D0=D0=A9=C1=D0=BC=B4=CA=B9=B2=BB=B4=E6=D4=DA=A3=AC=CE=
=D2=C3=C7=D2=B2=BF=C9=D2=D4=B6=D4=D5=E2=D0=A9=B2=BB=B4=E6=D4=DA=B5=
=C4=C1=D0=BD=F8=D0=D0=B2=D9=D7=F7=A1=A3 =D2=F2=B4=CB=C6=E4=B1=BB=B6=
=A8=D2=E5=CE=AAuntyped, =BE=CD=CA=C7=C8=F5=C0=E0=D0=CD<br></li><l=
i>=B6=F8DataSet[T]=B1=BE=C9=ED=A3=AC=CA=C7=D2=BB=D6=D6typed=C0=E0=
=D0=CD=B5=C4API=A3=AC=C6=E4=D6=D0=B5=C4Object=CD=A8=B3=A3=B6=BC=CA=
=C7=CE=D2=C3=C7=D7=D4=BC=BA=D7=D4=B6=A8=D2=E5=B5=C4=A3=AC=CB=F9=D2=
=D4=B0=FC=C0=A8=D7=D6=B6=CE=C3=FC=C3=FB=D2=D4=BC=B0=D7=D6=B6=CE=C0=
=E0=D0=CD=B6=BC=CA=C7=C7=BF=C0=E0=D0=CD=B5=C4=A1=A3</li></ul><h4=20=
style=3D"color: rgb(36, 41, 46);">DataSet API=D3=D0=C4=C4=D0=A9=D3=
=C5=B5=E3<br></h4><ol style=3D"color: rgb(36, 41, 46);" class=3D"=
wiz-list-level1"><li>=BE=B2=CC=AC=C0=E0=D0=CD=D2=D4=BC=B0=D4=CB=D0=
=D0=CA=B1=B5=C4=C0=E0=D0=CD=B0=B2=C8=AB=D0=D4<br></li></ol><block=
quote style=3D"color: rgb(106, 115, 125);"><p>SQL=D3=EF=D1=D4=BE=DF=
=D3=D0=D7=EE=B2=BB=D1=CF=B8=F1=B5=C4=CF=DE=D6=C6=A3=AC=B6=F8Datas=
et=BE=DF=D3=D0=D7=EE=D1=CF=B8=F1=B5=C4=CF=DE=D6=C6=A1=A3SQL=D3=EF=
=D1=D4=D4=DA=D6=BB=D3=D0=D4=DA=D4=CB=D0=D0=CA=B1=B2=C5=C4=DC=B7=A2=
=CF=D6=D2=BB=D0=A9=B4=ED=CE=F3=A3=AC=B1=C8=C8=E7=C0=E0=D0=CD=B4=ED=
=CE=F3=A3=AC=B5=AB=CA=C7=D3=C9=D3=DADataframe/Dataset=C4=BF=C7=B0=
=B6=BC=CA=C7=D2=AA=C7=F3=C0=E0=D0=CD=D6=B8=B6=A8=B5=C4=A3=A8=BE=B2=
=CC=AC=C0=E0=D0=CD=A3=A9=A3=AC=D2=F2=B4=CB=D4=DA=B1=E0=D2=EB=CA=B1=
=BE=CD=BF=C9=D2=D4=B7=A2=CF=D6=C0=E0=D0=CD=B4=ED=CE=F3=A3=AC=B2=A2=
=CC=E1=B9=A9=D4=CB=D0=D0=CA=B1=B5=C4=C0=E0=D0=CD=B0=B2=C8=AB=A1=A3=
=B1=C8=C8=E7=CB=B5=A3=AC=C8=E7=B9=FB=CE=D2=C3=C7=B5=F7=D3=C3=C1=CB=
=D2=BB=B8=F6=B2=BB=CA=F4=D3=DADataframe=B5=C4API=A3=AC=B1=E0=D2=EB=
=CA=B1=BE=CD=BB=E1=B1=A8=B4=ED=A1=A3=B5=AB=CA=C7=C8=E7=B9=FB=C4=E3=
=CA=B9=D3=C3=C1=CB=D2=BB=B8=F6=B2=BB=B4=E6=D4=DA=B5=C4=C1=D0=A3=AC=
=C4=C7=C3=B4=D2=B2=D6=BB=C4=DC=B5=BD=D4=CB=D0=D0=CA=B1=B2=C5=C4=DC=
=B7=A2=CF=D6=C1=CB=A1=A3=B6=F8=D7=EE=D1=CF=B8=F1=B5=C4=BE=CD=CA=C7=
Dataset=C1=CB=A3=AC=D2=F2=CE=AADataset=CA=C7=CD=EA=C8=AB=BB=F9=D3=
=DAtyped API=C0=B4=C9=E8=BC=C6=B5=C4=A3=AC=C0=E0=D0=CD=B6=BC=CA=C7=
=D1=CF=B8=F1=B6=F8=C7=D2=C7=BF=C0=E0=D0=CD=B5=C4=A3=AC=D2=F2=B4=CB=
=C8=E7=B9=FB=C4=E3=CA=B9=D3=C3=C1=CB=B4=ED=CE=F3=B5=C4=C0=E0=D0=CD=
=A3=AC=BB=F2=D5=DF=B6=D4=B2=BB=B4=E6=D4=DA=B5=C4=C1=D0=BD=F8=D0=D0=
=C1=CB=B2=D9=D7=F7=A3=AC=B6=BC=C4=DC=D4=DA=B1=E0=D2=EB=CA=B1=BE=CD=
=B7=A2=CF=D6=A1=A3<br></p></blockquote><div class=3D"wiz-table-co=
ntainer" style=3D"position: relative; padding: 0px;"><div class=3D=
"wiz-table-body"><table style=3D"width: 866px; color: rgb(36, 41,=
 46);"><thead><tr><th align=3D"center"></th><th align=3D"center">=
SQL</th><th align=3D"center">DataFrame</th><th align=3D"center">D=
ataSet</th></tr></thead><tbody><tr><td align=3D"center">Syntax Er=
ror</td><td align=3D"center">Runtime</td><td align=3D"center">Com=
pile Time</td><td align=3D"center">Compile Time</td></tr><tr styl=
e=3D"background-color:rgb(246, 248, 250);"><td align=3D"center">A=
nalysis Error</td><td align=3D"center">Runtime</td><td align=3D"c=
enter">Runtime</td><td align=3D"center">Compile Time</td></tr></t=
body></table></div></div><ol style=3D"color: rgb(36, 41, 46);" cl=
ass=3D"wiz-list-level1"><li>=BD=AB=B0=EB=BD=E1=B9=B9=BB=AF=B5=C4=CA=
=FD=BE=DD=D7=AA=BB=BB=CE=AAtyped=D7=D4=B6=A8=D2=E5=C0=E0=D0=CD<br=
></li></ol><blockquote style=3D"color: rgb(106, 115, 125);"><p>=BE=
=D9=C0=FD=C0=B4=CB=B5=A3=AC=C8=E7=B9=FB=CE=D2=C3=C7=CF=D6=D4=DA=D3=
=D0=D2=BB=B7=DD=B0=FC=BA=AC=C1=CB=D1=A7=D0=A3=D6=D0=CB=F9=D3=D0=D1=
=A7=C9=FA=B5=C4=D0=C5=CF=A2=A3=AC=CA=C7=D2=D4JSON=D7=D6=B7=FB=B4=AE=
=B8=F1=CA=BD=B6=A8=D2=E5=B5=C4=A3=AC=B1=C8=C8=E7<code style=3D"fo=
nt-size: 0.85rem; background-color: rgba(27, 31, 35, 0.0470588);"=
>{=A1=B0name=A1=B1: =A1=B0leo=A1=B1, =A1=B0age=A1=B1, 19, =A1=B0c=
lassNo=A1=B1: 1}</code>=A1=A3=CE=D2=C3=C7=BF=C9=D2=D4=D7=D4=BC=BA=
=B6=A8=D2=E5=D2=BB=B8=F6=C0=E0=D0=CD=A3=AC=B1=C8=C8=E7<code style=
=3D"font-size: 0.85rem; background-color: rgba(27, 31, 35, 0.0470=
588);">case class Student(name: String, age: Integer, classNo: In=
teger)</code>=A1=A3=BD=D3=D7=C5=CE=D2=C3=C7=BE=CD=BF=C9=D2=D4=BC=D3=
=D4=D8=D6=B8=B6=A8=B5=C4json=CE=C4=BC=FE=A3=AC=B2=A2=BD=AB=C6=E4=D7=
=AA=BB=BB=CE=AAtyped=C0=E0=D0=CD=B5=C4<code style=3D"font-size: 0=
.85rem; background-color: rgba(27, 31, 35, 0.0470588);">Dataset[S=
tudent]</code>=A3=AC=B1=C8=C8=E7<code style=3D"font-size: 0.85rem=
; background-color: rgba(27, 31, 35, 0.0470588);">val ds =3D spar=
k.read.json("students.json").as[Student]</code>=A1=A3</p></blockq=
uote><p style=3D"color: rgb(36, 41, 46);">=D4=DA=D5=E2=C0=EF=A3=AC=
Spark=BB=E1=D6=B4=D0=D0=C8=FD=B8=F6=B2=D9=D7=F7=A3=BA</p><ol styl=
e=3D"color: rgb(36, 41, 46);" class=3D"wiz-list-level1"><li>Spark=
=CA=D7=CF=C8=BB=E1=B6=C1=C8=A1json=CE=C4=BC=FE=A3=AC=B2=A2=C7=D2=D7=
=D4=B6=AF=CD=C6=B6=CF=C6=E4schema=A3=AC=C8=BB=BA=F3=B8=F9=BE=DDsc=
hema=B4=B4=BD=A8=D2=BB=B8=F6DataFrame=A1=A3</li><li>=D4=DA=D5=E2=C0=
=EF=A3=AC=BB=E1=B4=B4=BD=A8=D2=BB=B8=F6DataFrame=3DDataSet[Row]=A3=
=AC=CA=B9=D3=C3Row=C0=B4=B4=E6=B7=C5=C4=E3=B5=C4=CA=FD=BE=DD=A3=AC=
=D2=F2=CE=AA=B4=CB=CA=B1=BB=B9=B2=BB=D6=AA=B5=C0=BE=DF=CC=E5=C8=B7=
=C7=D0=B5=C4=C0=E0=D0=CD=A1=A3</li><li>=BD=D3=D7=C5=BD=ABDatafram=
e=D7=AA=BB=BB=CE=AADataSet[Student]=A3=AC=D2=F2=CE=AA=B4=CB=CA=B1=
=D2=D1=BE=AD=D6=AA=B5=C0=BE=DF=CC=E5=B5=C4=C0=E0=D0=CD=CA=C7Stude=
nt=C1=CB=A1=A3</li></ol><p style=3D"color: rgb(36, 41, 46);">=D5=E2=
=D1=F9=A3=AC=CE=D2=C3=C7=BE=CD=BF=C9=D2=D4=BD=AB=B0=EB=BD=E1=B9=B9=
=BB=AF=B5=C4=CA=FD=BE=DD=A3=AC=D7=AA=BB=BB=CE=AA=D7=D4=B6=A8=D2=E5=
=B5=C4typed=BD=E1=B9=B9=BB=AF=C7=BF=C0=E0=D0=CD=CA=FD=BE=DD=BC=AF=
=A1=A3=B2=A2=BB=F9=D3=DA=B4=CB=A3=AC=B5=C3=B5=BD=D6=AE=C7=B0=CB=B5=
=B5=C4=B1=E0=D2=EB=CA=B1=BA=CD=D4=CB=D0=D0=CA=B1=B5=C4=C0=E0=D0=CD=
=B0=B2=C8=AB=B1=A3=D5=CF=A1=A3</p><ol style=3D"color: rgb(36, 41,=
 46);" class=3D"wiz-list-level1"><li>API=B5=C4=D2=D7=D3=C3=D0=D4<=
/li></ol><blockquote style=3D"color: rgb(106, 115, 125);"><p>Data=
frame/Dataset=D2=FD=C8=EB=C1=CB=BA=DC=B6=E0=B5=C4high-level API=A3=
=AC=B2=A2=CC=E1=B9=A9=C1=CBdomain-specific language=B7=E7=B8=F1=B5=
=C4=B1=E0=B3=CC=BD=D3=BF=DA=A1=A3=D5=E2=D1=F9=B5=C4=BB=B0=A3=AC=B4=
=F3=B2=BF=B7=D6=B5=C4=BC=C6=CB=E3=B2=D9=D7=F7=A3=AC=B6=BC=BF=C9=D2=
=D4=CD=A8=B9=FDDataset=B5=C4high-level API=C0=B4=CD=EA=B3=C9=A1=A3=
=CD=A8=B9=FDtyped=C0=E0=D0=CD=B5=C4Dataset=A3=AC=CE=D2=C3=C7=BF=C9=
=D2=D4=C7=E1=CB=C9=B5=D8=D6=B4=D0=D0agg=A1=A2select=A1=A2sum=A1=A2=
avg=A1=A2map=A1=A2filter=A1=A2groupBy=B5=C8=B2=D9=D7=F7=A1=A3=CA=B9=
=D3=C3domain-specific language=D2=B2=C4=DC=B9=BB=C7=E1=CB=C9=B5=D8=
=CA=B5=CF=D6=BA=DC=B6=E0=BC=C6=CB=E3=B2=D9=D7=F7=A3=AC=B1=C8=C8=E7=
=C0=E0=CB=C6RDD=CB=E3=D7=D3=B7=E7=B8=F1=B5=C4map()=A1=A2filter()=B5=
=C8=A1=A3</p></blockquote><p style=3D"color: rgb(36, 41, 46);">=B9=
=D8=D3=DADataFrame DataSet=B5=C4=B2=D9=D7=F7=B0=B8=C0=FD=A3=AC=D2=
=D4=BC=B0=B6=D4hive=B5=C4=D6=A7=B3=D6=B2=CE=BC=FB=B4=FA=C2=EB<a h=
ref=3D"https://github.com/yangtong123/RoadOfStudySpark/blob/maste=
r/src/com/spark/sql/SparkSQLDemo.scala" style=3D"color:rgb(3, 102=
, 214);text-decoration:none;">SparkSQLDemo</a></p><h4 style=3D"co=
lor: rgb(36, 41, 46);">DataSet=B2=D9=D7=F7</h4><ul style=3D"color=
: rgb(36, 41, 46);"><li><p>action=B2=D9=D7=F7=A3=BA<br>=B4=A5=B7=A2=
job=B5=C4=B2=D9=D7=F7: collect, count, foreach, reduce=B5=C8<span=
 class=3D"Apple-converted-space">&nbsp;</span><a href=3D"https://=
github.com/yangtong123/RoadOfStudySpark/blob/master/src/com/spark=
/sql/ActionOperation.scala" style=3D"color:rgb(3, 102, 214);text-=
decoration:none;">ActionOperation</a></p></li><li><p>=BB=F9=B4=A1=
=B2=D9=D7=F7<br>=B3=D6=BE=C3=BB=AF=A3=AC=C1=D9=CA=B1=CA=D3=CD=BC=A3=
=ACdf=D3=EBds=CF=E0=BB=A5=D7=AA=BB=BB=A3=AC=D0=B4=CA=FD=BE=DD=B5=C8=
<a href=3D"https://github.com/yangtong123/RoadOfStudySpark/blob/m=
aster/src/com/spark/sql/BasicOperation.scala" style=3D"color:rgb(=
3, 102, 214);text-decoration:none;">BasicOperation</a></p></li><l=
i><p>typed=B2=D9=D7=F7<a href=3D"https://github.com/yangtong123/R=
oadOfStudySpark/blob/master/src/com/spark/sql/TypedOperation.scal=
a" style=3D"color:rgb(3, 102, 214);text-decoration:none;">TypedOp=
eration</a></p><ul><li>coalesce=BA=CDrepartition</li></ul><pre st=
yle=3D"font-size: 0.85rem; background-color: rgb(246, 248, 250);"=
><code>=B6=BC=CA=C7=D3=C3=C0=B4=D6=D8=D0=C2=B6=A8=D2=E5=B7=D6=C7=F8=
=B5=C4=0A=C7=F8=B1=F0=D4=DA=D3=DA=A3=BAcoalesce=A3=AC=D6=BB=C4=DC=
=D3=C3=D3=DA=BC=F5=C9=D9=B7=D6=C7=F8=CA=FD=C1=BF=A3=AC=B6=F8=C7=D2=
=BF=C9=D2=D4=D1=A1=D4=F1=B2=BB=B7=A2=C9=FAshuffle=0Arepartiton=A3=
=AC=BF=C9=D2=D4=D4=F6=BC=D3=B7=D6=C7=F8=A3=AC=D2=B2=BF=C9=D2=D4=BC=
=F5=C9=D9=B7=D6=C7=F8=A3=AC=B1=D8=D0=EB=BB=E1=B7=A2=C9=FAshuffle=A3=
=AC=CF=E0=B5=B1=D3=DA=CA=C7=BD=F8=D0=D0=C1=CB=D2=BB=B4=CE=D6=D8=B7=
=D6=C7=F8=B2=D9=D7=F7=0A</code></pre><ul><li>distinct=BA=CDdropDu=
plicates</li></ul><pre style=3D"font-size: 0.85rem; background-co=
lor: rgb(246, 248, 250);"><code>=B6=BC=CA=C7=D3=C3=C0=B4=BD=F8=D0=
=D0=C8=A5=D6=D8=B5=C4=A3=AC=C7=F8=B1=F0=D4=DA=C4=C4=B6=F9=C4=D8=A3=
=BF=0Adistinct=A3=AC=CA=C7=B8=F9=BE=DD=C3=BF=D2=BB=CC=F5=CA=FD=BE=
=DD=A3=AC=BD=F8=D0=D0=CD=EA=D5=FB=C4=DA=C8=DD=B5=C4=B1=C8=B6=D4=BA=
=CD=C8=A5=D6=D8=0AdropDuplicates=A3=AC=BF=C9=D2=D4=B8=F9=BE=DD=D6=
=B8=B6=A8=B5=C4=D7=D6=B6=CE=BD=F8=D0=D0=C8=A5=D6=D8=0A</code></pr=
e><ul><li>except filter intersect</li></ul><pre style=3D"font-siz=
e: 0.85rem; background-color: rgb(246, 248, 250);"><code>except=A3=
=BA=BB=F1=C8=A1=D4=DA=B5=B1=C7=B0DataSet=D6=D0=D3=D0=A3=AC=B5=AB=CA=
=C7=D4=DA=C1=ED=CD=E2=D2=BB=B8=F6DataSet=D6=D0=C3=BB=D3=D0=B5=C4=D4=
=AA=CB=D8=0Afilter=A3=BA=B8=F9=BE=DD=CE=D2=C3=C7=D7=D4=BC=BA=B5=C4=
=C2=DF=BC=AD=A3=AC=C8=E7=B9=FB=B7=B5=BB=D8true=A3=AC=C4=C7=C3=B4=BE=
=CD=B1=A3=C1=F4=B8=C3=D4=AA=CB=D8=A3=AC=B7=F1=D4=F2=BE=CD=B9=FD=C2=
=CB=B5=F4=B8=C3=D4=AA=CB=D8=0Aintersect=A3=BA=BB=F1=C8=A1=C1=BD=B8=
=F6=CA=FD=BE=DD=BC=AF=B5=C4=BD=BB=BC=AF=0A</code></pre><ul><li>ma=
p flatMap mapPartitions</li></ul><pre style=3D"font-size: 0.85rem=
; background-color: rgb(246, 248, 250);"><code>map=A3=BA=BD=AB=CA=
=FD=BE=DD=BC=AF=D6=D0=B5=C4=C3=BF=CC=F5=CA=FD=BE=DD=B6=BC=D7=F6=D2=
=BB=B8=F6=D3=B3=C9=E4=A3=AC=B7=B5=BB=D8=D2=BB=CC=F5=D0=C2=CA=FD=BE=
=DD=0AflatMap=A3=BA=CA=FD=BE=DD=BC=AF=D6=D0=B5=C4=C3=BF=CC=F5=CA=FD=
=BE=DD=B6=BC=BF=C9=D2=D4=B7=B5=BB=D8=B6=E0=CC=F5=CA=FD=BE=DD=0Ama=
pPartitions=A3=BA=D2=BB=B4=CE=D0=D4=B6=D4=D2=BB=B8=F6partition=D6=
=D0=B5=C4=CA=FD=BE=DD=BD=F8=D0=D0=B4=A6=C0=ED=0A</code></pre><ul>=
<li>joinWith</li><li>sort</li><li>randomSplit=BA=CDsample</li></u=
l><div class=3D"highlight highlight-source-scala"><pre style=3D"f=
ont-size: 0.85rem; background-color: rgb(246, 248, 250);"><span c=
lass=3D"pl-c" style=3D"color:rgb(106, 115, 125);"><span class=3D"=
pl-c">//</span> =B8=F9=BE=DD=C8=A8=D6=D8=C7=D0=B7=D6=B3=C9=BC=B8=B7=
=DD</span>=0AemployeeDS.randomSplit(<span class=3D"pl-en" style=3D=
"color:rgb(111, 66, 193);">Array</span>(<span class=3D"pl-c1" sty=
le=3D"color:rgb(0, 92, 197);">3</span>, <span class=3D"pl-c1" sty=
le=3D"color:rgb(0, 92, 197);">10</span>, <span class=3D"pl-c1" st=
yle=3D"color:rgb(0, 92, 197);">20</span>))=0A<span class=3D"pl-c"=
 style=3D"color:rgb(106, 115, 125);"><span class=3D"pl-c">//</spa=
n> =B8=F9=BE=DD=B1=C8=C0=FD=CB=E6=BB=FA=B3=E9=C8=A1</span>=0Aempl=
oyeeDS.sample(<span class=3D"pl-c1" style=3D"color:rgb(0, 92, 197=
);">false</span>, <span class=3D"pl-c1" style=3D"color:rgb(0, 92,=
 197);">0.3</span>)</pre></div></li><li><p>untyped=B2=D9=D7=F7<a=20=
href=3D"https://github.com/yangtong123/RoadOfStudySpark/blob/mast=
er/src/com/spark/sql/DepartmentAvgSalaryAndAgeStat.scala" style=3D=
"color:rgb(3, 102, 214);text-decoration:none;">DepartmentAvgSalar=
yAndAgeStat</a><br>select where groupBy agg col join<span class=3D=
"Apple-converted-space">&nbsp;</span><br></p></li><li><p>=BE=DB=BA=
=CF=BA=AF=CA=FD<a href=3D"https://github.com/yangtong123/RoadOfSt=
udySpark/blob/master/src/com/spark/sql/AggregateFunction.scala" s=
tyle=3D"color:rgb(3, 102, 214);text-decoration:none;">AggregateFu=
nction</a></p><ul><li>avg sum max min count countDistinct</li><li=
>collect_list collect_set</li></ul></li><li><p>=C6=E4=CB=FC=BA=AF=
=CA=FD<a href=3D"https://github.com/yangtong123/RoadOfStudySpark/=
blob/master/src/com/spark/sql/OtherFunction.scala" style=3D"color=
:rgb(3, 102, 214);text-decoration:none;">OtherFunction</a></p><ul=
><li>=C8=D5=C6=DA=BA=AF=CA=FD=A3=BAcurrent_date=A1=A2current_time=
stamp</li><li>=CA=FD=D1=A7=BA=AF=CA=FD=A3=BAround</li><li>=CB=E6=BB=
=FA=BA=AF=CA=FD=A3=BArand</li><li>=D7=D6=B7=FB=B4=AE=BA=AF=CA=FD=A3=
=BAconcat=A1=A2concat_ws</li><li>=BE=DB=BA=CF=BA=AF=CA=FD: countD=
istinct<span class=3D"Apple-converted-space">&nbsp;</span><a href=
=3D"https://github.com/yangtong123/RoadOfStudySpark/blob/master/s=
rc/com/spark/sql/DailyUV.scala" style=3D"color:rgb(3, 102, 214);t=
ext-decoration:none;">DailyUV</a></li><li>=BF=AA=B4=B0=BA=AF=CA=FD=
=A3=BArow_number<span class=3D"Apple-converted-space">&nbsp;</spa=
n><a href=3D"https://github.com/yangtong123/RoadOfStudySpark/blob=
/master/src/com/spark/sql/RowNumberWindowFunction.scala" style=3D=
"color:rgb(3, 102, 214);text-decoration:none;">RowNumberWindowFun=
ction</a></li><li>=D7=D4=B6=A8=D2=E5udf=BA=CDudaf=BA=AF=CA=FD,=B2=
=CE=BC=FB<a href=3D"https://github.com/yangtong123/RoadOfStudySpa=
rk/blob/master/src/com/spark/sql/Readme.md###sparksql-udf%E5%92%8=
Cudaf" style=3D"color:rgb(3, 102, 214);text-decoration:none;">spa=
rkSQL udf=BA=CDudaf</a><br></li></ul></li></ul><p style=3D"color:=
 rgb(36, 41, 46);">=C6=E4=CB=FC=BA=AF=CA=FD=BF=C9=D2=D4=B2=CE=BF=BC=
=A3=BA<a href=3D"http://spark.apache.org/docs/latest/api/scala/in=
dex.html#org.apache.spark.sql.functions$" style=3D"color:rgb(3, 1=
02, 214);text-decoration:none;">spark=CE=C4=B5=B5</a></p><h3 styl=
e=3D"font-size: 1.25rem; color: rgb(36, 41, 46);">RDD=D7=AA=CE=AA=
DataFrame</h3><ol style=3D"color: rgb(36, 41, 46);" class=3D"wiz-=
list-level1"><li>=CA=B9=D3=C3=B7=B4=C9=E4=B5=C4=B7=BD=CA=BD</li><=
/ol><p style=3D"color: rgb(36, 41, 46);">=CA=B9=D3=C3=B7=B4=C9=E4=
=C0=B4=CD=C6=B6=CF=B0=FC=BA=AC=C1=CB=CC=D8=B6=A8=CA=FD=BE=DD=C0=E0=
=D0=CD=B5=C4RDD=B5=C4=D4=AA=CA=FD=BE=DD=A1=A3=D5=E2=D6=D6=BB=F9=D3=
=DA=B7=B4=C9=E4=B5=C4=B7=BD=CA=BD=A3=AC=B4=FA=C2=EB=B1=C8=BD=CF=BC=
=F2=BD=E0=A3=AC=B5=B1=C4=E3=D2=D1=BE=AD=D6=AA=B5=C0=C4=E3=B5=C4RD=
D=B5=C4=D4=AA=CA=FD=BE=DD=CA=B1=A3=AC=CA=C7=D2=BB=D6=D6=B7=C7=B3=A3=
=B2=BB=B4=ED=B5=C4=B7=BD=CA=BD=A1=A3<span class=3D"Apple-converte=
d-space">&nbsp;</span><a href=3D"https://github.com/yangtong123/R=
oadOfStudySpark/blob/master/src/com/spark/sql/RDD2DataFrameReflec=
tion.scala" style=3D"color:rgb(3, 102, 214);text-decoration:none;=
">RDD2DataFrameReflection</a></p><ol style=3D"color: rgb(36, 41,=20=
46);" class=3D"wiz-list-level1"><li>=CA=B9=D3=C3=B6=AF=CC=AC=BC=D3=
=D4=D8=B5=C4=B7=BD=CA=BD</li></ol><p style=3D"color: rgb(36, 41,=20=
46);">=CA=C7=CD=A8=B9=FD=B1=E0=B3=CC=BD=D3=BF=DA=C0=B4=B4=B4=BD=A8=
DataFrame=A3=AC=C4=E3=BF=C9=D2=D4=D4=DA=B3=CC=D0=F2=D4=CB=D0=D0=CA=
=B1=B6=AF=CC=AC=B9=B9=BD=A8=D2=BB=B7=DD=D4=AA=CA=FD=BE=DD=A3=AC=C8=
=BB=BA=F3=BD=AB=C6=E4=D3=A6=D3=C3=B5=BD=D2=D1=BE=AD=B4=E6=D4=DA=B5=
=C4RDD=C9=CF=A1=A3=D5=E2=D6=D6=B7=BD=CA=BD=B5=C4=B4=FA=C2=EB=B1=C8=
=BD=CF=C8=DF=B3=A4=A3=AC=B5=AB=CA=C7=C8=E7=B9=FB=D4=DA=B1=E0=D0=B4=
=B3=CC=D0=F2=CA=B1=A3=AC=BB=B9=B2=BB=D6=AA=B5=C0RDD=B5=C4=D4=AA=CA=
=FD=BE=DD=A3=AC=D6=BB=D3=D0=D4=DA=B3=CC=D0=F2=D4=CB=D0=D0=CA=B1=A3=
=AC=B2=C5=C4=DC=B6=AF=CC=AC=B5=C3=D6=AA=C6=E4=D4=AA=CA=FD=BE=DD=A3=
=AC=C4=C7=C3=B4=D6=BB=C4=DC=CD=A8=B9=FD=D5=E2=D6=D6=B6=AF=CC=AC=B9=
=B9=BD=A8=D4=AA=CA=FD=BE=DD=B5=C4=B7=BD=CA=BD=A1=A3<span class=3D=
"Apple-converted-space">&nbsp;</span><a href=3D"https://github.co=
m/yangtong123/RoadOfStudySpark/blob/master/src/com/spark/sql/RDD2=
DataFrameProgramatically.scala" style=3D"color:rgb(3, 102, 214);t=
ext-decoration:none;">RDD2DataFrameProgramatically</a></p><h3 sty=
le=3D"font-size: 1.25rem; color: rgb(36, 41, 46);">sparkSQL udf=BA=
=CDudaf</h3><ol style=3D"color: rgb(36, 41, 46);" class=3D"wiz-li=
st-level1"><li>UDF(User Define Function)</li></ol><p style=3D"col=
or: rgb(36, 41, 46);">spark=C4=DA=D6=C3=B5=C4=BA=AF=CA=FD=B2=BB=C4=
=DC=C2=FA=D7=E3=CE=D2=C3=C7=B5=C4=D2=AA=C7=F3=B5=C4=CA=B1=BA=F2=A3=
=AC=CE=D2=C3=C7=CD=A8=B3=A3=D0=E8=D2=AA=D7=D4=B6=A8=D2=E5=BA=AF=CA=
=FD=C0=B4=CA=B5=CF=D6=CE=D2=C3=C7=B5=C4=D0=E8=C7=F3=A1=A3<a href=3D=
"https://github.com/yangtong123/RoadOfStudySpark/blob/master/src/=
com/spark/sql/UDF.scala" style=3D"color:rgb(3, 102, 214);text-dec=
oration:none;">UDF</a></p><ol style=3D"color: rgb(36, 41, 46);" c=
lass=3D"wiz-list-level1"><li>UDAF(User Defined Aggregate Function=
)</li></ol><p style=3D"color: rgb(36, 41, 46);">UDAF=BF=C9=D2=D4=D5=
=EB=B6=D4=B6=E0=D0=D0=CA=E4=C8=EB=A3=AC=BD=F8=D0=D0=BE=DB=BA=CF=BC=
=C6=CB=E3=A3=AC=B7=B5=BB=D8=D2=BB=B8=F6=CA=E4=B3=F6=A3=AC=B9=A6=C4=
=DC=B8=FC=BC=D3<a href=3D"https://github.com/yangtong123/RoadOfSt=
udySpark/blob/master/src/com/spark/sql/UDAFStringCount.scala" sty=
le=3D"color:rgb(3, 102, 214);text-decoration:none;">UDAFStringCou=
nt</a>=BA=CD<a href=3D"https://github.com/yangtong123/RoadOfStudy=
Spark/blob/master/src/com/spark/sql/UDAF.scala" style=3D"color:rg=
b(3, 102, 214);text-decoration:none;">UDAF</a></p><h2 style=3D"fo=
nt-size: 1.5rem; color: rgb(36, 41, 46);">sparkSQL=B8=F7=D6=D6=CA=
=FD=BE=DD=D4=B4</h2><h3 style=3D"font-size: 1.25rem; color: rgb(3=
6, 41, 46);">=CE=C4=BC=FE</h3><p style=3D"color: rgb(36, 41, 46);=
"><strong>1. JSON</strong></p><p style=3D"color: rgb(36, 41, 46);=
">Spark SQL=BF=C9=D2=D4=D7=D4=B6=AF=CD=C6=B6=CFJSON=CE=C4=BC=FE=B5=
=C4=D4=AA=CA=FD=BE=DD=A3=AC=B2=A2=C7=D2=BC=D3=D4=D8=C6=E4=CA=FD=BE=
=DD=A3=AC=B4=B4=BD=A8=D2=BB=B8=F6DataFrame=A1=A3=BF=C9=D2=D4=CA=B9=
=D3=C3SQLContext.read.json()=B7=BD=B7=A8=A3=AC=D5=EB=B6=D4=D2=BB=B8=
=F6=D4=AA=CB=D8=C0=E0=D0=CD=CE=AAString=B5=C4RDD=A3=AC=BB=F2=D5=DF=
=CA=C7=D2=BB=B8=F6JSON=CE=C4=BC=FE=A1=A3</p><p style=3D"color: rg=
b(36, 41, 46);">=B5=AB=CA=C7=D2=AA=D7=A2=D2=E2=B5=C4=CA=C7=A3=AC=D5=
=E2=C0=EF=CA=B9=D3=C3=B5=C4JSON=CE=C4=BC=FE=D3=EB=B4=AB=CD=B3=D2=E2=
=D2=E5=C9=CF=B5=C4JSON=CE=C4=BC=FE=CA=C7=B2=BB=D2=BB=D1=F9=B5=C4=A1=
=A3=C3=BF=D0=D0=B6=BC=B1=D8=D0=EB=A3=AC=D2=B2=D6=BB=C4=DC=B0=FC=BA=
=AC=D2=BB=B8=F6=A3=AC=B5=A5=B6=C0=B5=C4=A3=AC=D7=D4=B0=FC=BA=AC=B5=
=C4=A3=AC=D3=D0=D0=A7=B5=C4JSON=B6=D4=CF=F3=A1=A3=B2=BB=C4=DC=C8=C3=
=D2=BB=B8=F6JSON=B6=D4=CF=F3=B7=D6=C9=A2=D4=DA=B6=E0=D0=D0=A1=A3=B7=
=F1=D4=F2=BB=E1=B1=A8=B4=ED=A1=A3</p><p style=3D"color: rgb(36, 4=
1, 46);"><a href=3D"https://github.com/yangtong123/RoadOfStudySpa=
rk/blob/master/src/com/spark/sql/JSONDataSource.scala" style=3D"c=
olor:rgb(3, 102, 214);text-decoration:none;">JSONDataSource</a></=
p><p style=3D"color: rgb(36, 41, 46);"><strong>2. Parquet</strong=
></p><p style=3D"color: rgb(36, 41, 46);">Parquet=CA=C7=C3=E6=CF=F2=
=B7=D6=CE=F6=D0=CD=D2=B5=CE=F1=B5=C4=C1=D0=CA=BD=B4=E6=B4=A2=B8=F1=
=CA=BD=A3=AC<br>=C1=D0=CA=BD=B4=E6=B4=A2=BA=CD=D0=D0=CA=BD=B4=E6=B4=
=A2=CF=E0=B1=C8=D3=D0=C4=C4=D0=A9=D3=C5=CA=C6=C4=D8=A3=BF</p><pre=
 style=3D"font-size: 0.85rem; color: rgb(36, 41, 46); background-=
color: rgb(246, 248, 250);"><code>1=A1=A2=BF=C9=D2=D4=CC=F8=B9=FD=
=B2=BB=B7=FB=BA=CF=CC=F5=BC=FE=B5=C4=CA=FD=BE=DD=A3=AC=D6=BB=B6=C1=
=C8=A1=D0=E8=D2=AA=B5=C4=CA=FD=BE=DD=A3=AC=BD=B5=B5=CDIO=CA=FD=BE=
=DD=C1=BF=A1=A3 =0A2=A1=A2=D1=B9=CB=F5=B1=E0=C2=EB=BF=C9=D2=D4=BD=
=B5=B5=CD=B4=C5=C5=CC=B4=E6=B4=A2=BF=D5=BC=E4=A1=A3=D3=C9=D3=DA=CD=
=AC=D2=BB=C1=D0=B5=C4=CA=FD=BE=DD=C0=E0=D0=CD=CA=C7=D2=BB=D1=F9=B5=
=C4=A3=AC=BF=C9=D2=D4=CA=B9=D3=C3=B8=FC=B8=DF=D0=A7=B5=C4=D1=B9=CB=
=F5=B1=E0=C2=EB=A3=A8=C0=FD=C8=E7Run Length Encoding=BA=CDDelta E=
ncoding=A3=A9=BD=F8=D2=BB=B2=BD=BD=DA=D4=BC=B4=E6=B4=A2=BF=D5=BC=E4=
=A1=A3 =0A3=A1=A2=D6=BB=B6=C1=C8=A1=D0=E8=D2=AA=B5=C4=C1=D0=A3=AC=
=D6=A7=B3=D6=CF=F2=C1=BF=D4=CB=CB=E3=A3=AC=C4=DC=B9=BB=BB=F1=C8=A1=
=B8=FC=BA=C3=B5=C4=C9=A8=C3=E8=D0=D4=C4=DC=A1=A3 =0A</code></pre>=
<p style=3D"color: rgb(36, 41, 46);"><strong>2.1 =CA=B9=D3=C3=B1=E0=
=B3=CC=B5=C4=B7=BD=CA=BD=BC=D3=D4=D8Parquet=CE=C4=BC=FE=D6=D0=B5=C4=
=CA=FD=BE=DD</strong><br>=BA=CDJSON=D2=BB=D1=F9</p><pre style=3D"=
font-size: 0.85rem; color: rgb(36, 41, 46); background-color: rgb=
(246, 248, 250);"><code>val usersDF =3D sqlContext.read.parquet("=
hdfs://spark1:9000/spark-study/users.parquet")  =0AusersDF.regist=
erTempTable("users")=0Aval userNamesDF =3D sqlContext.sql("select=
 name from users")  =0AuserNamesDF.rdd.map { row =3D&gt; "Name: "=
 + row(0) }.collect()=0A    .foreach { userName =3D&gt; println(u=
serName) }   =0A</code></pre><p style=3D"color: rgb(36, 41, 46);"=
><strong>2.2 =D7=D4=B6=AF=B7=D6=C7=F8=CD=C6=B6=CF</strong><br>Spa=
rk SQL=D6=D0=B5=C4Parquet=CA=FD=BE=DD=D4=B4=A3=AC=D6=A7=B3=D6=D7=D4=
=B6=AF=B8=F9=BE=DD=C4=BF=C2=BC=C3=FB=CD=C6=B6=CF=B3=F6=B7=D6=C7=F8=
=D0=C5=CF=A2=A1=A3=C0=FD=C8=E7=A3=AC=C8=E7=B9=FB=BD=AB=C8=CB=BF=DA=
=CA=FD=BE=DD=B4=E6=B4=A2=D4=DA=B7=D6=C7=F8=B1=ED=D6=D0=A3=AC=B2=A2=
=C7=D2=CA=B9=D3=C3=D0=D4=B1=F0=BA=CD=B9=FA=BC=D2=D7=F7=CE=AA=B7=D6=
=C7=F8=C1=D0=A1=A3=C4=C7=C3=B4=C4=BF=C2=BC=BD=E1=B9=B9=BF=C9=C4=DC=
=C8=E7=CF=C2=CB=F9=CA=BE=A3=BA</p><pre style=3D"font-size: 0.85re=
m; color: rgb(36, 41, 46); background-color: rgb(246, 248, 250);"=
><code>tableName=0A  |- gender=3Dmale=0A    |- country=3DUS=0A  =20=
   ...=0A      ...=0A      ...=0A    |- country=3DCN=0A      ...=0A=
  |- gender=3Dfemale=0A    |- country=3DUS=0A      ...=0A    |- c=
ountry=3DCH=0A      ... =0A</code></pre><p style=3D"color: rgb(36=
, 41, 46);">=C8=E7=B9=FB=BD=AB/tableName=B4=AB=C8=EBSQLContext.re=
ad.parquet()=BB=F2=D5=DFSQLContext.read.load()=B7=BD=B7=A8=A3=AC=C4=
=C7=C3=B4Spark SQL=BE=CD=BB=E1=D7=D4=B6=AF=B8=F9=BE=DD=C4=BF=C2=BC=
=BD=E1=B9=B9=A3=AC=CD=C6=B6=CF=B3=F6=B7=D6=C7=F8=D0=C5=CF=A2=A3=AC=
=CA=C7gender=BA=CDcountry=A1=A3=BC=B4=CA=B9=CA=FD=BE=DD=CE=C4=BC=FE=
=D6=D0=D6=BB=B0=FC=BA=AC=C1=CB=C1=BD=C1=D0=D6=B5=A3=ACname=BA=CDa=
ge=A3=AC=B5=AB=CA=C7Spark SQL=B7=B5=BB=D8=B5=C4DataFrame=A3=AC=B5=
=F7=D3=C3printSchema()=B7=BD=B7=A8=CA=B1=A3=AC=BB=E1=B4=F2=D3=A1=B3=
=F6=CB=C4=B8=F6=C1=D0=B5=C4=D6=B5=A3=BAname=A3=ACage=A3=ACcountry=
=A3=ACgender=A1=A3=D5=E2=BE=CD=CA=C7=D7=D4=B6=AF=B7=D6=C7=F8=CD=C6=
=B6=CF=B5=C4=B9=A6=C4=DC=A1=A3</p><p style=3D"color: rgb(36, 41,=20=
46);">=B4=CB=CD=E2=A3=AC=B7=D6=C7=F8=C1=D0=B5=C4=CA=FD=BE=DD=C0=E0=
=D0=CD=A3=AC=D2=B2=CA=C7=D7=D4=B6=AF=B1=BB=CD=C6=B6=CF=B3=F6=C0=B4=
=B5=C4=A1=A3=C4=BF=C7=B0=A3=ACSpark SQL=BD=F6=D6=A7=B3=D6=D7=D4=B6=
=AF=CD=C6=B6=CF=B3=F6=CA=FD=D7=D6=C0=E0=D0=CD=BA=CD=D7=D6=B7=FB=B4=
=AE=C0=E0=D0=CD=A1=A3=D3=D0=CA=B1=A3=AC=D3=C3=BB=A7=D2=B2=D0=ED=B2=
=BB=CF=A3=CD=FBSpark SQL=D7=D4=B6=AF=CD=C6=B6=CF=B7=D6=C7=F8=C1=D0=
=B5=C4=CA=FD=BE=DD=C0=E0=D0=CD=A1=A3=B4=CB=CA=B1=D6=BB=D2=AA=C9=E8=
=D6=C3=D2=BB=B8=F6=C5=E4=D6=C3=BC=B4=BF=C9=A3=AC spark.sql.source=
s.partitionColumnTypeInference.enabled=A3=AC=C4=AC=C8=CF=CE=AAtru=
e=A3=AC=BC=B4=D7=D4=B6=AF=CD=C6=B6=CF=B7=D6=C7=F8=C1=D0=B5=C4=C0=E0=
=D0=CD=A3=AC=C9=E8=D6=C3=CE=AAfalse=A3=AC=BC=B4=B2=BB=BB=E1=D7=D4=
=B6=AF=CD=C6=B6=CF=C0=E0=D0=CD=A1=A3=BD=FB=D6=B9=D7=D4=B6=AF=CD=C6=
=B6=CF=B7=D6=C7=F8=C1=D0=B5=C4=C0=E0=D0=CD=CA=B1=A3=AC=CB=F9=D3=D0=
=B7=D6=C7=F8=C1=D0=B5=C4=C0=E0=D0=CD=A3=AC=BE=CD=CD=B3=D2=BB=C4=AC=
=C8=CF=B6=BC=CA=C7String=A1=A3</p><p style=3D"color: rgb(36, 41,=20=
46);">=CA=B5=CF=D6=B4=FA=C2=EB=C8=E7=CF=C2=A3=BA</p><div class=3D=
"highlight highlight-source-scala" style=3D"color: rgb(36, 41, 46=
);"><pre style=3D"font-size: 0.85rem; background-color: rgb(246,=20=
248, 250);"><span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);=
">val</span> <span class=3D"pl-smi">usersDF</span> <span class=3D=
"pl-k" style=3D"color:rgb(215, 58, 73);">=3D</span> sqlContext.re=
ad().parquet(<span class=3D"pl-s" style=3D"color:rgb(3, 47, 98);"=
><span class=3D"pl-pds">"</span>hdfs://spark1:9000/spark-study/us=
ers/gender=3Dmale/country=3DUS/users.parquet<span class=3D"pl-pds=
">"</span></span>)=0AusersDF.printSchema()=0AusersDF.show()</pre>=
</div><p style=3D"color: rgb(36, 41, 46);"><strong>2.3 =BA=CF=B2=A2=
=D4=AA=CA=FD=BE=DD</strong><br>=C8=E7=CD=ACProtocolBuffer=A3=ACAv=
ro=A3=ACThrift=D2=BB=D1=F9=A3=ACParquet=D2=B2=CA=C7=D6=A7=B3=D6=D4=
=AA=CA=FD=BE=DD=BA=CF=B2=A2=B5=C4=A1=A3=D3=C3=BB=A7=BF=C9=D2=D4=D4=
=DA=D2=BB=BF=AA=CA=BC=BE=CD=B6=A8=D2=E5=D2=BB=B8=F6=BC=F2=B5=A5=B5=
=C4=D4=AA=CA=FD=BE=DD=A3=AC=C8=BB=BA=F3=CB=E6=D7=C5=D2=B5=CE=F1=D0=
=E8=D2=AA=A3=AC=D6=F0=BD=A5=CD=F9=D4=AA=CA=FD=BE=DD=D6=D0=CC=ED=BC=
=D3=B8=FC=B6=E0=B5=C4=C1=D0=A1=A3=D4=DA=D5=E2=D6=D6=C7=E9=BF=F6=CF=
=C2=A3=AC=D3=C3=BB=A7=BF=C9=C4=DC=BB=E1=B4=B4=BD=A8=B6=E0=B8=F6Pa=
rquet=CE=C4=BC=FE=A3=AC=D3=D0=D7=C5=B6=E0=B8=F6=B2=BB=CD=AC=B5=C4=
=B5=AB=CA=C7=C8=B4=BB=A5=CF=E0=BC=E6=C8=DD=B5=C4=D4=AA=CA=FD=BE=DD=
=A1=A3Parquet=CA=FD=BE=DD=D4=B4=D6=A7=B3=D6=D7=D4=B6=AF=CD=C6=B6=CF=
=B3=F6=D5=E2=D6=D6=C7=E9=BF=F6=A3=AC=B2=A2=C7=D2=BD=F8=D0=D0=B6=E0=
=B8=F6Parquet=CE=C4=BC=FE=B5=C4=D4=AA=CA=FD=BE=DD=B5=C4=BA=CF=B2=A2=
=A1=A3</p><p style=3D"color: rgb(36, 41, 46);">=D2=F2=CE=AA=D4=AA=
=CA=FD=BE=DD=BA=CF=B2=A2=CA=C7=D2=BB=D6=D6=CF=E0=B6=D4=BA=C4=CA=B1=
=B5=C4=B2=D9=D7=F7=A3=AC=B6=F8=C7=D2=D4=DA=B4=F3=B6=E0=CA=FD=C7=E9=
=BF=F6=CF=C2=B2=BB=CA=C7=D2=BB=D6=D6=B1=D8=D2=AA=B5=C4=CC=D8=D0=D4=
=A3=AC=B4=D3Spark 1.5.0=B0=E6=B1=BE=BF=AA=CA=BC=A3=AC=C4=AC=C8=CF=
=CA=C7=B9=D8=B1=D5Parquet=CE=C4=BC=FE=B5=C4=D7=D4=B6=AF=BA=CF=B2=A2=
=D4=AA=CA=FD=BE=DD=B5=C4=CC=D8=D0=D4=B5=C4=A1=A3=BF=C9=D2=D4=CD=A8=
=B9=FD=D2=D4=CF=C2=C1=BD=D6=D6=B7=BD=CA=BD=BF=AA=C6=F4Parquet=CA=FD=
=BE=DD=D4=B4=B5=C4=D7=D4=B6=AF=BA=CF=B2=A2=D4=AA=CA=FD=BE=DD=B5=C4=
=CC=D8=D0=D4=A3=BA</p><pre style=3D"font-size: 0.85rem; color: rg=
b(36, 41, 46); background-color: rgb(246, 248, 250);"><code>1=A1=A2=
=B6=C1=C8=A1Parquet=CE=C4=BC=FE=CA=B1=A3=AC=BD=AB=CA=FD=BE=DD=D4=B4=
=B5=C4=D1=A1=CF=EE=A3=ACmergeSchema=A3=AC=C9=E8=D6=C3=CE=AAtrue =20=
=0A2=A1=A2=CA=B9=D3=C3SQLContext.setConf()=B7=BD=B7=A8=A3=AC=BD=AB=
spark.sql.parquet.mergeSchema=B2=CE=CA=FD=C9=E8=D6=C3=CE=AAtrue =20=
=0A</code></pre><p style=3D"color: rgb(36, 41, 46);">=B0=B8=C0=FD=
=B4=FA=C2=EB=A3=BA<a href=3D"https://github.com/yangtong123/RoadO=
fStudySpark/blob/master/src/com/spark/sql/ParquetMergeSchema.scal=
a" style=3D"color:rgb(3, 102, 214);text-decoration:none;">Parquet=
MergeSchema</a></p><h3 style=3D"font-size: 1.25rem; color: rgb(36=
, 41, 46);">Hive</h3><p style=3D"color: rgb(36, 41, 46);">Spark S=
QL=D6=A7=B3=D6=B6=D4Hive=D6=D0=B4=E6=B4=A2=B5=C4=CA=FD=BE=DD=BD=F8=
=D0=D0=B6=C1=D0=B4=A1=A3=BF=C9=D2=D4=D6=B4=D0=D0Hive=B5=C4=B4=F3=B2=
=BF=B7=D6=B9=A6=C4=DC=A3=AC=B0=FC=C0=A8=B4=B4=BD=A8=B1=ED=A1=A2=CD=
=F9=B1=ED=C0=EF=B5=BC=C8=EB=CA=FD=BE=DD=D2=D4=BC=B0=D3=C3SQL=D3=EF=
=BE=E4=B2=E9=D1=AF=B1=ED=D6=D0=B5=C4=CA=FD=BE=DD=A1=A3=B2=E9=D1=AF=
=B3=F6=C0=B4=B5=C4=CA=FD=BE=DD=CA=C7=D2=BB=B8=F6Row=CA=FD=D7=E9=A1=
=A3<br>=BD=ABhive-site.xml=BF=BD=B1=B4=B5=BDspark/conf=C4=BF=C2=BC=
=CF=C2=A3=AC=BD=ABmysql connector=BF=BD=B1=B4=B5=BDspark/lib=C4=BF=
=C2=BC=CF=C2<span class=3D"Apple-converted-space">&nbsp;</span><a=
 href=3D"https://github.com/yangtong123/RoadOfStudySpark/blob/mas=
ter/src/com/spark/sql/HiveDataSource.scala" style=3D"color:rgb(3,=
 102, 214);text-decoration:none;">HiveDataSource</a></p><h3 style=
=3D"font-size: 1.25rem; color: rgb(36, 41, 46);">JDBC</h3><p styl=
e=3D"color: rgb(36, 41, 46);">Spark SQL=D6=A7=B3=D6=CA=B9=D3=C3JD=
BC=B4=D3=B9=D8=CF=B5=D0=CD=CA=FD=BE=DD=BF=E2=A3=A8=B1=C8=C8=E7MyS=
QL=A3=A9=D6=D0=B6=C1=C8=A1=CA=FD=BE=DD=A1=A3=B6=C1=C8=A1=B5=C4=CA=
=FD=BE=DD=A3=AC=D2=C0=C8=BB=D3=C9DataFrame=B1=ED=CA=BE=A3=AC=BF=C9=
=D2=D4=BA=DC=B7=BD=B1=E3=B5=D8=CA=B9=D3=C3Spark Core=CC=E1=B9=A9=B5=
=C4=B8=F7=D6=D6=CB=E3=D7=D3=BD=F8=D0=D0=B4=A6=C0=ED=A1=A3<span cl=
ass=3D"Apple-converted-space">&nbsp;</span><a href=3D"https://git=
hub.com/yangtong123/RoadOfStudySpark/blob/master/src/com/spark/sq=
l/JDBCDataSource.scala" style=3D"color:rgb(3, 102, 214);text-deco=
ration:none;">JDBCDataSource</a></p><h2 style=3D"font-size: 1.5re=
m; color: rgb(36, 41, 46);">Thrift JDBC ODBC Server</h2><p style=3D=
"color: rgb(36, 41, 46);">Spark SQL=B5=C4Thrift JDBC/ODBC server=CA=
=C7=BB=F9=D3=DAHive 0.13=B5=C4HiveServer2=CA=B5=CF=D6=B5=C4=A1=A3=
=D5=E2=B8=F6=B7=FE=CE=F1=C6=F4=B6=AF=D6=AE=BA=F3=A3=AC=D7=EE=D6=F7=
=D2=AA=B5=C4=B9=A6=C4=DC=BE=CD=CA=C7=BF=C9=D2=D4=C8=C3=CE=D2=C3=C7=
=CD=A8=B9=FD Java JDBC=C0=B4=D2=D4=B1=E0=B3=CC=B5=C4=B7=BD=CA=BD=B5=
=F7=D3=C3Spark SQL=A1=A3=B4=CB=CD=E2=A3=AC=D4=DA=C6=F4=B6=AF=B8=C3=
=B7=FE=CE=F1=D6=AE=BA=F3=A3=AC=BF=C9=D2=D4=CD=A8=B9=FDSpark=BB=F2=
Hive 0.13=D7=D4=B4=F8=B5=C4beeline=B9=A4=BE=DF=C0=B4=BD=F8=D0=D0=B2=
=E2=CA=D4=A1=A3</p><p style=3D"color: rgb(36, 41, 46);">start-thr=
iftserver.sh=C3=FC=C1=EE=BF=C9=D2=D4=BD=D3=CA=D5=CB=F9=D3=D0spark=
-submit=C3=FC=C1=EE=BF=C9=D2=D4=BD=D3=CA=D5=B5=C4=B2=CE=CA=FD=A3=AC=
=B6=EE=CD=E2=D4=F6=BC=D3=B5=C4=D2=BB=B8=F6=B2=CE=CA=FD=CA=C7--hiv=
econf=A3=AC=BF=C9=D2=D4=D3=C3=D3=DA=D6=B8=B6=A8=D2=BB=D0=A9 Hive=B5=
=C4=C5=E4=D6=C3=CA=F4=D0=D4=A1=A3=BF=C9=D2=D4=CD=A8=B9=FD=D6=B4=D0=
=D0./sbin/start-thriftserver.sh --help=C0=B4=B2=E9=BF=B4=CB=F9=D3=
=D0=BF=C9=D3=C3=B2=CE=CA=FD=B5=C4=C1=D0=B1=ED=A1=A3=C4=AC=C8=CF=C7=
=E9=BF=F6=CF=C2=A3=AC=C6=F4=B6=AF=B5=C4=B7=FE=CE=F1=BB=E1=D4=DA l=
ocalhost:10000=B5=D8=D6=B7=C9=CF=BC=E0=CC=FD=C7=EB=C7=F3=A1=A3<br=
></p><p style=3D"color: rgb(36, 41, 46);">=BF=C9=D2=D4=CA=B9=D3=C3=
=C1=BD=D6=D6=B7=BD=CA=BD=C0=B4=B8=C4=B1=E4=B7=FE=CE=F1=BC=E0=CC=FD=
=B5=C4=B5=D8=D6=B7</p><ul style=3D"color: rgb(36, 41, 46);"><li>=B5=
=DA=D2=BB=D6=D6</li></ul><div class=3D"highlight highlight-source=
-shell" style=3D"color: rgb(36, 41, 46);"><pre style=3D"font-size=
: 0.85rem; background-color: rgb(246, 248, 250);"><span class=3D"=
pl-k" style=3D"color:rgb(215, 58, 73);">export</span> HIVE_SERVER=
2_THRIFT_PORT=3D<span class=3D"pl-k" style=3D"color:rgb(215, 58,=20=
73);">&lt;</span>listening-port<span class=3D"pl-k" style=3D"colo=
r:rgb(215, 58, 73);">&gt;</span>=0A<span class=3D"pl-k" style=3D"=
color:rgb(215, 58, 73);">export</span> HIVE_SERVER2_THRIFT_BIND_H=
OST=3D<span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);">&lt;=
</span>listening-host<span class=3D"pl-k" style=3D"color:rgb(215,=
 58, 73);">&gt;</span>=0A./sbin/start-thriftserver.sh \=0A  --mas=
ter <span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);">&lt;</=
span>master-uri<span class=3D"pl-k" style=3D"color:rgb(215, 58, 7=
3);">&gt;</span> \=0A  ...</pre></div><ul style=3D"color: rgb(36,=
 41, 46);"><li>=B5=DA=B6=FE=D6=D6</li></ul><div class=3D"highligh=
t highlight-source-shell" style=3D"color: rgb(36, 41, 46);"><pre=20=
style=3D"font-size: 0.85rem; background-color: rgb(246, 248, 250)=
;">./sbin/start-thriftserver.sh \=0A  --hiveconf hive.server2.thr=
ift.port=3D<span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);"=
>&lt;</span>listening-port<span class=3D"pl-k" style=3D"color:rgb=
(215, 58, 73);">&gt;</span> \=0A  --hiveconf hive.server2.thrift.=
bind.host=3D<span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);=
">&lt;</span>listening-host<span class=3D"pl-k" style=3D"color:rg=
b(215, 58, 73);">&gt;</span> \=0A  --master <span class=3D"pl-k"=20=
style=3D"color:rgb(215, 58, 73);">&lt;</span>master-uri<span clas=
s=3D"pl-k" style=3D"color:rgb(215, 58, 73);">&gt;</span>=0A  ...<=
/pre></div><div class=3D"highlight highlight-source-shell" style=3D=
"color: rgb(36, 41, 46);"><pre style=3D"font-size: 0.85rem; backg=
round-color: rgb(246, 248, 250);"><span class=3D"pl-c" style=3D"c=
olor:rgb(106, 115, 125);"><span class=3D"pl-c">#</span> =C6=F4=B6=
=AF=B5=C4=CA=B1=BA=F2=BF=C9=C4=DC=BB=E1=D3=D0=CE=CA=CC=E2</span>=0A=
hdfs dfs -chmod 777 /tmp/hive-root <span class=3D"pl-c" style=3D"=
color:rgb(106, 115, 125);"><span class=3D"pl-c">#</span> =B2=BB=C8=
=BB=BB=E1=B1=A8=B4=ED</span>=0A=0A./sbin/start-thriftserver.sh \=0A=
--jars /usr/local/hive/lib/mysql-connector-java-5.1.17.jar</pre><=
/div><p style=3D"color: rgb(36, 41, 46);">=D5=E2=C1=BD=D6=D6=B7=BD=
=CA=BD=B5=C4=C7=F8=B1=F0=BE=CD=D4=DA=D3=DA=A3=AC=B5=DA=D2=BB=D6=D6=
=CA=C7=D5=EB=B6=D4=D5=FB=B8=F6=BB=FA=C6=F7=C9=CF=C3=BF=B4=CE=C6=F4=
=B6=AF=B7=FE=CE=F1=B6=BC=C9=FA=D0=A7=B5=C4; =B5=DA=B6=FE=D6=D6=BD=
=F6=BD=F6=D5=EB=B6=D4=B1=BE=B4=CE=C6=F4=B6=AF=C9=FA=D0=A7</p><p s=
tyle=3D"color: rgb(36, 41, 46);">=BD=D3=D7=C5=BE=CD=BF=C9=D2=D4=CD=
=A8=B9=FDSpark=BB=F2Hive=B5=C4beeline=B9=A4=BE=DF=C0=B4=B2=E2=CA=D4=
Thrift JDBC/ODBC server =D4=DASpark=B5=C4bin=C4=BF=C2=BC=D6=D0=A3=
=AC=D6=B4=D0=D0beeline=C3=FC=C1=EE=A3=A8=B5=B1=C8=BB=A3=AC=CE=D2=C3=
=C7=D2=B2=BF=C9=D2=D4=CA=B9=D3=C3Hive=D7=D4=B4=F8=B5=C4beeline=B9=
=A4=BE=DF=A3=A9=A3=BA<code style=3D"font-size: 0.85rem; backgroun=
d-color: rgba(27, 31, 35, 0.0470588);">./bin/beeline</code><span=20=
class=3D"Apple-converted-space">&nbsp;</span><br>=BD=F8=C8=EBbeel=
ine=C3=FC=C1=EE=D0=D0=D6=AE=BA=F3=A3=AC=C1=AC=BD=D3=B5=BDJDBC/ODB=
C server=C9=CF=C8=A5=A3=BA<br></p><div class=3D"highlight highlig=
ht-source-shell" style=3D"color: rgb(36, 41, 46);"><pre style=3D"=
font-size: 0.85rem; background-color: rgb(246, 248, 250);">beelin=
e<span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);">&gt;</spa=
n> <span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);">!</span=
>connect jdbc:hive2://localhost:10000</pre></div><p style=3D"colo=
r: rgb(36, 41, 46);">=C8=E7=B9=FB=CE=D2=C3=C7=CF=EB=D2=AA=D6=B1=BD=
=D3=CD=A8=B9=FDJDBC/ODBC=B7=FE=CE=F1=B7=C3=CE=CASpark SQL=A3=AC=B2=
=A2=D6=B1=BD=D3=B6=D4Hive=D6=B4=D0=D0SQL=D3=EF=BE=E4=A3=AC=C4=C7=C3=
=B4=BE=CD=D0=E8=D2=AA=BD=ABHive=B5=C4hive-site.xml=C5=E4=D6=C3=CE=
=C4=BC=FE=B7=C5=D4=DASpark=B5=C4conf=C4=BF=C2=BC=CF=C2=A1=A3</p><=
p style=3D"color: rgb(36, 41, 46);">Thrift JDBC/ODBC server=D2=B2=
=D6=A7=B3=D6=CD=A8=B9=FDHTTP=B4=AB=CA=E4=D0=AD=D2=E9=B7=A2=CB=CDt=
hrift RPC=CF=FB=CF=A2=A1=A3=CA=B9=D3=C3=D2=D4=CF=C2=B7=BD=CA=BD=B5=
=C4=C5=E4=D6=C3=BF=C9=D2=D4=C6=F4=B6=AFHTTP=C4=A3=CA=BD=A3=BA<br>=
</p><p style=3D"color: rgb(36, 41, 46);">=C3=FC=C1=EE=B2=CE=CA=FD=
</p><div class=3D"highlight highlight-source-shell" style=3D"colo=
r: rgb(36, 41, 46);"><pre style=3D"font-size: 0.85rem; background=
-color: rgb(246, 248, 250);">./sbin/start-thriftserver.sh \=0A  -=
-hive.server2.transport.mode=3Dhttp \=0A  --hive.server2.thrift.h=
ttp.port=3D10001 \=0A  --hive.server2.http.endpoint=3Dcliservice=20=
\=0A  --master <span class=3D"pl-k" style=3D"color:rgb(215, 58, 7=
3);">&lt;</span>master-uri<span class=3D"pl-k" style=3D"color:rgb=
(215, 58, 73);">&gt;</span>=0A  ...=0A  =0A./sbin/start-thriftser=
ver.sh \=0A  --jars /usr/local/hive/lib/mysql-connector-java-5.1.=
17.jar \=0A  --hiveconf hive.server2.transport.mode=3Dhttp \=0A =20=
--hiveconf hive.server2.thrift.http.port=3D10001 \=0A  --hiveconf=
 hive.server2.http.endpoint=3Dcliservice </pre></div><p style=3D"=
color: rgb(36, 41, 46);">beeline=C1=AC=BD=D3=B7=FE=CE=F1=CA=B1=D6=
=B8=B6=A8=B2=CE=CA=FD</p><div class=3D"highlight highlight-source=
-shell" style=3D"color: rgb(36, 41, 46);"><pre style=3D"font-size=
: 0.85rem; background-color: rgb(246, 248, 250);">beeline<span cl=
ass=3D"pl-k" style=3D"color:rgb(215, 58, 73);">&gt;</span> <span=20=
class=3D"pl-k" style=3D"color:rgb(215, 58, 73);">!</span>connect=20=
jdbc:hive2://localhost:10001/default<span class=3D"pl-k" style=3D=
"color:rgb(215, 58, 73);">?</span>hive.server2.transport.mode=3Dh=
ttp<span class=3D"pl-k" style=3D"color:rgb(215, 58, 73);">;</span=
>hive.server2.thrift.http.path=3Dcliservice</pre></div><p style=3D=
"color: rgb(36, 41, 46);">=CA=BE=C0=FD=B4=FA=C2=EB=A3=BA<a href=3D=
"https://github.com/yangtong123/RoadOfStudySpark/blob/master/src/=
com/spark/sql/ThriftJDBCServerTest.scala" style=3D"color:rgb(3, 1=
02, 214);text-decoration:none;">ThriftJDBCServerTest</a></p><h2 s=
tyle=3D"font-size: 1.5rem; color: rgb(36, 41, 46);">=D2=BB=B8=F6=CA=
=B5=D5=BD=B5=C4=B0=B8=C0=FD</h2><p style=3D"color: rgb(36, 41, 46=
);">=BE=CD=D4=DA=B1=BE=CE=C4=BC=FE=BC=D0=CF=C2=D3=D0=B8=F6<a href=
=3D"https://github.com/yangtong123/RoadOfStudySpark/blob/master/s=
rc/com/spark/sql/news" style=3D"color:rgb(3, 102, 214);text-decor=
ation:none;">news</a>=CE=C4=BC=FE=BC=D0,<span class=3D"Apple-conv=
erted-space">&nbsp;</span><a href=3D"https://github.com/yangtong1=
23/RoadOfStudySpark/blob/master/src/com/spark/sql/news/OfflineDat=
aGenerator.scala" style=3D"color:rgb(3, 102, 214);text-decoration=
:none;">OfflineDataGenerator</a>=CA=C7=C4=A3=C4=E2=CA=FD=BE=DD=B5=
=C4=A3=AC<a href=3D"https://github.com/yangtong123/RoadOfStudySpa=
rk/blob/master/src/com/spark/sql/news/NewsOfflineStatSpark.scala"=
 style=3D"color:rgb(3, 102, 214);text-decoration:none;">NewsOffli=
neStatSpark</a>=CA=C7=D6=F7=D2=AA=D2=B5=CE=F1=CA=B5=CF=D6</p><div=
 class=3D"postBody" style=3D"font-size: 0.875rem;"><br><div id=3D=
"BlogPostCategory" style=3D"color:rgb(102, 102, 102);">=B7=D6=C0=E0=
:<span class=3D"Apple-converted-space">&nbsp;</span><a href=3D"ht=
tps://www.cnblogs.com/yangtong/category/978570.html" target=3D"_b=
lank" style=3D"text-decoration: none; background: rgb(231, 231, 2=
31);">spark</a></div><br></div><div style=3D"font-size:0.875rem;c=
olor:gray"><small>=C0=B4=D4=B4=A3=BA&nbsp;<a href=3D"https://www.=
cnblogs.com/yangtong/p/7146086.html">https://www.cnblogs.com/yang=
tong/p/7146086.html</a></small></div></body></html>=0A=0A=0A=0A=0A=
=0A=0A=0A=0A=0A=0A=0A

------=_Next_Part_0000456843.220--

------=_Next_Part_0001370529.178--

