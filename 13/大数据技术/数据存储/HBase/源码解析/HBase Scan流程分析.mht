From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?SEJhc2UgU2NhbsH3s8y31s72?=
Date: Date: Fri, 23 Jul 2021 05:53:16 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0001029138.753"

This is a multi-part message in MIME format.

------=_Next_Part_0001029138.753
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0000343046.104"


------=_Next_Part_0000343046.104
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0000343046.104
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A=0A=0A=0A=0A=0A=0A=
=0A<title>HBase Scan=C1=F7=B3=CC=B7=D6=CE=F6</title>=0A    =0A<st=
yle id=3D"wiz_custom_css">html, .wiz-editor-body {font-size: 12pt=
;}.wiz-editor-body {font-family: Helvetica, 'Hiragino Sans GB', '=
=E5=BE=AE=E8=BD=AF=E9=9B=85=E9=BB=91', 'Microsoft YaHei UI', SimS=
un, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;pad=
ding: 20px 16px;padding: 1.25rem 1rem;}.wiz-editor-body h1,.wiz-e=
ditor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor=
-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0=
 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font=
-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt=
;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:=
1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.=
wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-bo=
dy h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem=20=
0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.w=
iz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin=
:8px 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-e=
ditor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-b=
ody .CodeMirror pre {margin:0;}.wiz-editor-body ul,.wiz-editor-bo=
dy ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.w=
iz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol=
.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-b=
ody ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-ed=
itor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquot=
e > :first-child {margin-top:0;}.wiz-editor-body blockquote > :la=
st-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-wid=
th:100%;height:auto !important;margin:2px 0;}.wiz-editor-body tab=
le {border-collapse:collapse;border:1px solid #bbbbbb;}.wiz-edito=
r-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:co=
llapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-=
word;box-sizing: border-box;}.wiz-hide {display:none !important;}=
</style></head>=0A=0A<body class=3D"wiz-editor-body"  spellcheck=3D=
"false"><div><div id=3D"cnblogs_post_body" class=3D"blogpost-body=
 cnblogs-markdown" style=3D"color:rgb(51, 51, 51);font-size:0.833=
rem"><h2 id=3D"hbase-scan=C1=F7=B3=CC=B7=D6=CE=F6" style=3D"color=
:rgb(0, 0, 0);font-size:1.313rem;">HBase Scan=C1=F7=B3=CC=B7=D6=CE=
=F6</h2><p>HBase=B5=C4=B6=C1=C1=F7=B3=CC=C4=BF=C7=B0=BF=B4=C0=B4=B1=
=C8=BD=CF=B8=B4=D4=D3=A3=AC=D6=F7=D2=AA=D3=C9=D3=DA=A3=BA</p><ul>=
<li>HBase=B5=C4=B1=ED=CA=FD=BE=DD=B7=D6=CE=AA=B6=E0=B8=F6=B2=E3=B4=
=CE,HRegion-&gt;HStore-&gt;[HFile,HFile,...,MemStore]</li><li>Reg=
ionServer=B5=C4LSM-Like=B4=E6=B4=A2=D2=FD=C7=E6=A3=AC=B2=BB=B6=CF=
flush=B2=FA=C9=FA=D0=C2=B5=C4HFile=A3=AC=CD=AC=CA=B1=B2=FA=C9=FA=D0=
=C2=B5=C4MemStore=D3=C3=D3=DA=BA=F3=D0=F8=CA=FD=BE=DD=D0=B4=C8=EB=
=A3=AC=B2=A2=C7=D2=CE=AA=C1=CB=B7=C0=D6=B9=D3=C9=D3=DAHFile=B9=FD=
=B6=E0=B6=F8=B5=BC=D6=C2Scan=CA=B1=D0=E8=D2=AA=C9=A8=C3=E8=B5=C4=CE=
=C4=BC=FE=B9=FD=B6=E0=B6=F8=B5=BC=D6=C2=B5=C4=D0=D4=C4=DC=CF=C2=BD=
=B5=A3=AC=BA=F3=CC=A8=CF=DF=B3=CC=BB=E1=CA=CA=CA=B1=B5=C4=BD=F8=D0=
=D0Compaction=A3=ACCompaction=B5=C4=B9=FD=B3=CC=BB=E1=B2=FA=C9=FA=
=D0=C2=B5=C4HFile=A3=AC=B2=A2=C7=D2=BB=E1=C9=BE=B3=FDCompact=CD=EA=
=B3=C9=B5=C4HFile</li><li>=BE=DF=CC=E5=CA=B5=CF=D6=D6=D0=B5=C4=B8=
=F7=D6=D6=D3=C5=BB=AF=A3=AC=B1=C8=C8=E7<a href=3D"https://issues.=
apache.org/jira/browse/HBASE-4465" style=3D"text-decoration:none;=
color:rgb(0, 0, 0);">lazy seek=D3=C5=BB=AF</a>=A3=AC=B5=BC=D6=C2=B4=
=FA=C2=EB=B1=C8=BD=CF=B8=B4=D4=D3</li></ul><p>=B6=C1=C1=F7=B3=CC=D6=
=D0=B3=E4=B3=E2=D7=C5=B8=F7=D6=D6Scanner=A3=AC=C8=E7=CF=C2=CD=BC=A3=
=BA</p><pre><code class=3D"hljs ruby" style=3D"font-size: 0.75rem=
; color: rgb(0, 0, 0); background: rgb(255, 255, 255);">        =20=
                        +--------------+=0A                     =20=
           <span class=3D"hljs-params">|              |</span>=0A=
                     +-----------+ RegionScanner+----------+=0A =20=
                   <span class=3D"hljs-params">|           +-----=
-+-------+          |</span>=0A                     <span class=3D=
"hljs-params">|                  |</span>                  <span=20=
class=3D"hljs-params">|=0A                     |</span>         =20=
        <span class=3D"hljs-params">|                  |</span>=0A=
               +-----v+-------+  +------v-------+   +------v+----=
--+=0A               <span class=3D"hljs-params">|              |=
</span>  <span class=3D"hljs-params">|              |</span>   <s=
pan class=3D"hljs-params">|              |</span>=0A            =20=
  <span class=3D"hljs-params">| StoreScanner |</span>  <span clas=
s=3D"hljs-params">| StoreScanner |</span>   <span class=3D"hljs-p=
arams">| StoreScanner |</span>=0A               <span class=3D"hl=
js-params">|              |</span>  <span class=3D"hljs-params">|=
              |</span>   <span class=3D"hljs-params">|          =20=
   |</span>=0A               +--------------+  +--+---+-----+-+ =20=
 +--------------+=0A                                    <span cla=
ss=3D"hljs-params">|   |</span>     <span class=3D"hljs-params">|=
=0A            +-----------------------+   |</span>     +--------=
--+=0A            <span class=3D"hljs-params">|                 =20=
         |</span>                <span class=3D"hljs-params">|=0A=
            |</span>                           <span class=3D"hlj=
s-params">|                |</span>=0A    +-------v---------+   +=
-------------v----+ +---------v------+=0A    <span class=3D"hljs-=
params">|                 |</span>   <span class=3D"hljs-params">=
|                  |</span> <span class=3D"hljs-params">|       =20=
        |</span>=0A    <span class=3D"hljs-params">|StoreFileScan=
ner |</span>   <span class=3D"hljs-params">|StoreFileScanner  |</=
span> <span class=3D"hljs-params">| MemStoreScanner|</span>=0A  =20=
 <span class=3D"hljs-params">|                 |</span>   <span c=
lass=3D"hljs-params">|                  |</span> <span class=3D"h=
ljs-params">|                |</span>=0A    +-------+---------+ =20=
 +--------+---------+ +-------+--------+=0A            <span clas=
s=3D"hljs-params">|                      |</span>               =20=
   <span class=3D"hljs-params">|=0A            |</span>         =20=
            <span class=3D"hljs-params">|                   |</sp=
an>=0A            <span class=3D"hljs-params">|                 =20=
    |</span>                   <span class=3D"hljs-params">|=0A =20=
          |</span>                      <span class=3D"hljs-param=
s">|                   |</span>=0A    +-------v---------+   +----=
----v---------+ +-------v--------+=0A    <span class=3D"hljs-para=
ms">|                 |</span>   <span class=3D"hljs-params">|  =20=
               |</span> <span class=3D"hljs-params">|           =20=
    |</span>=0A    <span class=3D"hljs-params">|  HFileScanner  =20=
|</span>   <span class=3D"hljs-params">|  HFileScanner    |</span=
> <span class=3D"hljs-params">| HFileScanner   |</span>=0A    <sp=
an class=3D"hljs-params">|                 |</span>   <span class=
=3D"hljs-params">|                  |</span> <span class=3D"hljs-=
params">|                |</span>=0A    +-----------------+   +--=
----------------+ +----------------+</code></pre><p>=D4=DAHBase=D6=
=D0=A3=AC=D2=BB=D5=C5=B1=ED=BF=C9=D2=D4=D3=D0=B6=E0=B8=F6Column F=
amily=A3=AC=D4=DA=D2=BB=B4=CEScan=B5=C4=C1=F7=B3=CC=D6=D0=A3=AC=C3=
=BF=B8=F6Column Family(=BA=F3=D0=F8=BD=D0Store)=B5=C4=CA=FD=BE=DD=
=B6=C1=C8=A1=D3=C9=D2=BB=B8=F6StoreScanner=B6=D4=CF=F3=B8=BA=D4=F0=
=A1=A3=C3=BF=B8=F6Store=B5=C4=CA=FD=BE=DD=D3=C9=D2=BB=B8=F6=C4=DA=
=B4=E6=D6=D0=B5=C4MemStore=BA=CD=B4=C5=C5=CC=C9=CF=B5=C4HFile=CE=C4=
=BC=FE=D7=E9=B3=C9=A3=AC=CF=E0=B6=D4=D3=A6=B5=C4=A3=ACStoreScanne=
r=B6=D4=CF=F3=B9=CD=D3=B6=D2=BB=B8=F6MemStoreScanner=BA=CDN=B8=F6=
StoreFileScanner=C0=B4=BD=F8=D0=D0=CA=B5=BC=CA=B5=C4=CA=FD=BE=DD=B6=
=C1=C8=A1=A1=A3</p><p>=B4=D3=C2=DF=BC=AD=C9=CF=BF=B4=A3=AC=B6=C1=C8=
=A1=D2=BB=D0=D0=B5=C4=CA=FD=BE=DD=D0=E8=D2=AA</p><ol class=3D"wiz=
-list-level1"><li>=B0=B4=D5=D5=CB=B3=D0=F2=B6=C1=C8=A1=B3=F6=C3=BF=
=B8=F6Store</li><li>=B6=D4=D3=DA=C3=BF=B8=F6Store=A3=AC=BA=CF=B2=A2=
Store=CF=C2=C3=E6=B5=C4=CF=E0=B9=D8=B5=C4HFile=BA=CD=C4=DA=B4=E6=D6=
=D0=B5=C4MemStore</li></ol><p>=CA=B5=CF=D6=C9=CF=A3=AC=D5=E2=C1=BD=
=B2=BD=B6=BC=CA=C7=CD=A8=B9=FD=B6=D1=CD=EA=B3=C9=A1=A3RegionScann=
er=B5=C4=B6=C1=C8=A1=CD=A8=B9=FD=CF=C2=C3=E6=B5=C4=B6=E0=B8=F6Sto=
reScanner=D7=E9=B3=C9=B5=C4=B6=D1<br>=CD=EA=B3=C9=A3=AC=CA=B9=D3=C3=
RegionScanner=B5=C4=B3=C9=D4=B1=B1=E4=C1=BFKeyValueHeap storeHeap=
=B1=ED=CA=BE</p><p>=D7=E9=B3=C9StoreScanner=B5=C4=B6=E0=B8=F6Scan=
ner=D4=DARegionScannerImpl=B9=B9=D4=EC=BA=AF=CA=FD=D6=D0=BB=F1=B5=
=C3=A3=BA</p><pre><code class=3D"hljs cs" style=3D"font-size: 0.7=
5rem; color: rgb(0, 0, 0); background: rgb(255, 255, 255);"><span=
 class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">for</span=
> (Map.Entry&lt;<span class=3D"hljs-keyword" style=3D"color:rgb(0=
, 0, 255);">byte</span>[], NavigableSet&lt;<span class=3D"hljs-ke=
yword" style=3D"color:rgb(0, 0, 255);">byte</span>[]&gt;&gt; entr=
y :=0A          scan.getFamilyMap().entrySet()) {=0A        Store=
 store =3D stores.<span class=3D"hljs-keyword" style=3D"color:rgb=
(0, 0, 255);">get</span>(entry.getKey());=0A        <span class=3D=
"hljs-comment" style=3D"color:green;">// =CA=B5=BC=CA=CA=C7StoreS=
canner=C0=E0=D0=CD</span>=0A        KeyValueScanner scanner =3D s=
tore.getScanner(scan, entry.getValue(), <span class=3D"hljs-keywo=
rd" style=3D"color:rgb(0, 0, 255);">this</span>.readPt);=0A     =20=
  <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">if=
</span> (<span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 25=
5);">this</span>.filter =3D=3D <span class=3D"hljs-literal" style=
=3D"color:rgb(163, 21, 21);">null</span> || !scan.doLoadColumnFam=
iliesOnDemand()=0A          || <span class=3D"hljs-keyword" style=
=3D"color:rgb(0, 0, 255);">this</span>.filter.isFamilyEssential(e=
ntry.getKey())) {=0A          scanners.<span class=3D"hljs-keywor=
d" style=3D"color:rgb(0, 0, 255);">add</span>(scanner);=0A      =20=
 } <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">e=
lse</span> {=0A          joinedScanners.<span class=3D"hljs-keywo=
rd" style=3D"color:rgb(0, 0, 255);">add</span>(scanner);=0A     =20=
  }=0A}</code></pre><p>store.getScanner(scan, entry.getValue(), t=
his.readPt)=C4=DA=B2=BF=BE=CD=CA=C7new =D2=BB=B8=F6StoreScanner=A3=
=AC=C2=DF=BC=AD=B6=BC=D4=DAStoreScanner=B5=C4=B9=B9=D4=EC=BA=AF=CA=
=FD=D6=D0</p><p>=B9=B9=D4=EC=BA=AF=CA=FD=C4=DA=B2=BF=C6=E4=CA=B5=BE=
=CD=CA=C7=D5=D2=B5=BD=CF=E0=B9=D8=B5=C4HFile=BA=CDMemStore=A3=AC=C8=
=BB=BA=F3=BD=A8=B6=D1=A3=AC=D7=A2=D2=E2=A3=AC=D5=E2=B8=F6=B6=D1=CA=
=C7StoreScanner=BC=B6=B1=F0=B5=C4=A3=AC=D2=BB=B8=F6StoreScanner=D2=
=BB=B8=F6=B6=D1=A3=AC=B6=D1=D6=D0=B5=C4=D4=AA=CB=D8=BE=CD=CA=C7=B5=
=D7=CF=C2=B0=FC=BA=AC=B5=C4HFile=BA=CDMemStore=B6=D4=D3=A6=B5=C4S=
toreFileScanner=BA=CDMemStoreScanner<br>=B5=C3=B5=BD=CF=E0=B9=D8=B5=
=C4HFile=BA=CDMemStore=C2=DF=BC=AD=D4=DAStoreScanner::getScanners=
NoCompaction()=D6=D0=A3=AC=C4=DA=B2=BF=BB=E1=B8=F9=BE=DD=C7=EB=C7=
=F3=D6=B8=B6=A8=B5=C4TimeRange,KeyRange=B9=FD=C2=CB=B5=F4=B2=BB=D0=
=E8=D2=AA=B5=C4HFile=A3=AC=CD=AC=CA=B1=D2=B2=BB=E1=C0=FB=D3=C3blo=
om filter=B9=FD=C2=CB=B5=F4=B2=BB=D0=E8=D2=AA=B5=C4HFIle.=BD=D3=D7=
=C5=A3=AC=B5=F7=D3=C3</p><pre><code class=3D"hljs less" style=3D"=
font-size: 0.75rem; color: rgb(0, 0, 0); background: rgb(255, 255=
, 255);"><span class=3D"hljs-selector-tag" style=3D"color:rgb(0,=20=
0, 255);">seekScanners</span>(scanners, matcher.getStartKey(), ex=
plicitColumnQuery &amp;&amp; lazySeekEnabledGlobally,=0A        i=
sParallelSeekEnabled);</code></pre><p>=B6=D4=D5=E2=D0=A9StoreFile=
Scanner=BA=CDMemStoreScanner=B7=D6=B1=F0=BD=F8=D0=D0seek=A3=ACsee=
kKey=CA=C7matcher.getStartKey()=A3=AC<br>=C8=E7=CF=C2=B9=B9=D4=EC=
</p><pre><code class=3D"hljs dart" style=3D"font-size: 0.75rem; c=
olor: rgb(0, 0, 0); background: rgb(255, 255, 255);"> <span class=
=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">return</span> <=
span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">new</=
span> KeyValue(row, family, <span class=3D"hljs-keyword" style=3D=
"color:rgb(0, 0, 255);">null</span>, HConstants.LATEST_TIMESTAMP,=
=0A        <span class=3D"hljs-built_in" style=3D"color:rgb(0, 0,=
 255);">Type</span>.DeleteFamily);</code></pre><h3 id=3D"seek=D3=EF=
=D2=E5" style=3D"color:rgb(0, 0, 0);font-size:1rem;">Seek=D3=EF=D2=
=E5</h3><p>seek=CA=C7=D5=EB=B6=D4KeyValue=B5=C4=A3=ACseek=B5=C4=D3=
=EF=D2=E5=CA=C7seek=B5=BD=D6=B8=B6=A8KeyValue=A3=AC=C8=E7=B9=FB=D6=
=B8=B6=A8KeyValue=B2=BB=B4=E6=D4=DA=A3=AC=D4=F2seek=B5=BD=D6=B8=B6=
=A8KeyValue=B5=C4=CF=C2=D2=BB<br>=B8=F6=A1=A3=BE=D9=C0=FD=C0=B4=CB=
=B5=A3=AC=BC=D9=C9=E8=C3=FB=CE=AAX=B5=C4column family=C0=EF=D3=D0=
=C1=BD=C1=D0a=BA=CDb=A3=AC=CE=C4=BC=FE=D6=D0=D3=D0=C1=BD=D0=D0row=
key=B7=D6=B1=F0=CE=AAaaa=BA=CD<br>bbb=A3=AC=C8=E7=CF=C2=B1=ED=CB=F9=
=CA=BE.</p><div class=3D"wiz-table-container" style=3D"position:=20=
relative; padding: 0px;"><div class=3D"wiz-table-body"><table><tb=
ody><tr><td></td><td align=3D"center" colspan=3D"2">Column Family=
 X</td></tr><tr><td>rowkey</td><td>column a</td><td>column b</td>=
</tr><tr><td>aaa</td><td>1</td><td>abc</td></tr><tr><td>bbb</td><=
td>2</td><td>def</td></tr></tbody></table></div></div><p>HBase=BF=
=CD=BB=A7=B6=CB=C9=E8=D6=C3scan=C7=EB=C7=F3=B5=C4start key=CE=AAa=
aa=A3=AC=C4=C7=C3=B4matcher.getStartKey()=BB=E1=B1=BB=B3=F5=CA=BC=
=BB=AF=CE=AA(rowkey, family, qualifier,timestamp,type)=3D(aaa,X,n=
ull,LATEST_TIMESTAMP,Type.DeleteFamily)=A3=AC=B8=F9=BE=DDKeyValue=
=B5=C4=B1=C8=BD=CF=D4=AD=D4=F2=A3=AC=D5=E2=B8=F6KeyValue=B1=C8aaa=
=D0=D0=B5=C4=B5=DA=D2=BB=B8=F6=C1=D0a=B8=FC<br>=D0=A1(=D2=F2=CE=AA=
=C3=BB=D3=D0qualifier)=A3=AC=CB=F9=D2=D4=B6=D4=D5=E2=B8=F6StoreFi=
leScanner seek=CA=B1=A3=AC=BB=E1seek=B5=BDaaa=D5=E2=D0=D0=B5=C4=B5=
=DA=D2=BB=C1=D0a</p><p>=CA=B5=BC=CA=C9=CF</p><pre><code class=3D"=
hljs less" style=3D"font-size: 0.75rem; color: rgb(0, 0, 0); back=
ground: rgb(255, 255, 255);"><span class=3D"hljs-selector-tag" st=
yle=3D"color:rgb(0, 0, 255);">seekScanners</span>(scanners, match=
er.getStartKey(), explicitColumnQuery &amp;&amp; lazySeekEnabledG=
lobally,=0A        isParallelSeekEnabled);</code></pre><p>=D3=D0=BF=
=C9=C4=DC=B2=BB=BB=E1=B6=D4StoreFileScanner=BD=F8=D0=D0=CA=B5=BC=CA=
=B5=C4seek=A3=AC=B6=F8=CA=C7=BD=F8=D0=D0lazy seek=A3=ACseek=B5=C4=
=B9=A4=D7=F7=B7=C5=B5=BD=B2=BB=B5=C3=B2=BB=D7=F6=B5=C4=CA=B1=BA=F2=
=A1=A3=BA=F3=D0=F8=BB=E1=D7=A8=C3=C5=CB=B5lazy seek</p><p>=C9=CF=C3=
=E6=B5=C3=B5=BD=C1=CB=C7=EB=C7=F3scan=C9=E6=BC=B0=B5=BD=B5=C4=CB=F9=
=D3=D0=B5=C4column family=B6=D4=D3=A6=B5=C4StoreScanner=A3=AC=CB=E6=
=BA=F3=B5=F7=D3=C3=C8=E7=CF=C2=BA=AF=CA=FD=BD=F8=D0=D0=BD=A8=B6=D1=
:</p><pre><code class=3D"hljs java" style=3D"font-size: 0.75rem;=20=
color: rgb(0, 0, 0); background: rgb(255, 255, 255);">     <span=20=
class=3D"hljs-function"><span class=3D"hljs-keyword" style=3D"col=
or:rgb(0, 0, 255);">protected</span> <span class=3D"hljs-keyword"=
 style=3D"color:rgb(0, 0, 255);">void</span> <span class=3D"hljs-=
title" style=3D"color:rgb(163, 21, 21);">initializeKVHeap</span><=
span class=3D"hljs-params">(List&lt;KeyValueScanner&gt; scanners,=
=0A        List&lt;KeyValueScanner&gt; joinedScanners, HRegion re=
gion)</span>=0A        <span class=3D"hljs-keyword" style=3D"colo=
r:rgb(0, 0, 255);">throws</span> IOException </span>{=0A      <sp=
an class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">this</s=
pan>.storeHeap =3D <span class=3D"hljs-keyword" style=3D"color:rg=
b(0, 0, 255);">new</span> KeyValueHeap(scanners, region.comparato=
r);=0A      <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0,=
 255);">if</span> (!joinedScanners.isEmpty()) {=0A        <span c=
lass=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">this</span>=
.joinedHeap =3D <span class=3D"hljs-keyword" style=3D"color:rgb(0=
, 0, 255);">new</span> KeyValueHeap(joinedScanners, region.compar=
ator);=0A      }=0A    }</code></pre><p>KeyValueScanner=CA=C7=D2=BB=
=B8=F6=BD=D3=BF=DA=A3=AC=B1=ED=CA=BE=D2=BB=B8=F6=BF=C9=D2=D4=CF=F2=
=CD=E2=B5=FC=B4=FA=B3=F6KeyValue<br>=B5=C4Scanner=A3=ACStoreFileS=
canner,MemStoreScanner=BA=CDStoreScanner=B6=BC=CA=B5=CF=D6=C1=CB=B8=
=C3=BD=D3=BF=DA=A1=A3=D5=E2=C0=EF=B5=C4comparator=C0=E0=D0=CD=CE=AA=
KVScannerComparator=A3=AC=D3=C3=D3=DA=B1=C8=BD=CF=C1=BD=B8=F6KeyV=
alueScanner=A3=AC=CA=B5=BC=CA=C9=CF=C4=DA=B2=BF=CA=B9=D3=C3=C1=CB=
KVComparator=A3=AC=CB=FC=CA=C7=D3=C3=C0=B4=B1=C8=BD=CF=C1=BD=B8=F6=
KeyValue=B5=C4=A1=A3=B4=D3=BA=F3=C3=E6=BF=C9=D2=D4=BF=B4=B3=F6=A3=
=AC=CA=B5=BC=CA=C9=CF=A3=AC=D5=E2=B8=F6=D3=C9KeyValueScanner=D7=E9=
=B3=C9=B5=C4=B6=D1=A3=AC=B6=D1=B6=A5KeyValueScanner=C2=FA=D7=E3=B5=
=C4=CC=D8=D5=F7=CA=C7=A3=BA =CB=FC=B5=C4=B6=D1=B6=A5(KeyValue)=D7=
=EE=D0=A1</p><p>=B6=D1=D3=C3=C0=E0KeyValueHeap=B1=ED=CA=BE,=BF=B4=
KeyValueHeap=B9=B9=D4=EC=BA=AF=CA=FD=D7=F6=C1=CB=CA=B2=C3=B4</p><=
pre><code class=3D"hljs dart" style=3D"font-size: 0.75rem; color:=
 rgb(0, 0, 0); background: rgb(255, 255, 255);">    KeyValueHeap(=
<span class=3D"hljs-built_in" style=3D"color:rgb(0, 0, 255);">Lis=
t</span>&lt;? <span class=3D"hljs-keyword" style=3D"color:rgb(0,=20=
0, 255);">extends</span> KeyValueScanner&gt; scanners,=0A      KV=
ScannerComparator comparator) throws IOException {=0A    <span cl=
ass=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">this</span>.=
comparator =3D comparator;=0A        <span class=3D"hljs-keyword"=
 style=3D"color:rgb(0, 0, 255);">if</span> (!scanners.isEmpty())=20=
{=0A          <span class=3D"hljs-comment" style=3D"color:green;"=
>// =B8=F9=BE=DD=B4=AB=C8=EB=B5=C4KeyValueScanner=B9=B9=D4=EC=B3=F6=
=D2=BB=B8=F6=D3=C5=CF=C8=BC=B6=B6=D3=C1=D0(=C4=DA=B2=BF=CA=B5=CF=D6=
=BE=CD=CA=C7=B6=D1)</span>=0A          <span class=3D"hljs-keywor=
d" style=3D"color:rgb(0, 0, 255);">this</span>.heap =3D <span cla=
ss=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">new</span> Pr=
iorityQueue&lt;KeyValueScanner&gt;(scanners.size(),=0A          =20=
   <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">t=
his</span>.comparator);=0A          <span class=3D"hljs-keyword"=20=
style=3D"color:rgb(0, 0, 255);">for</span> (KeyValueScanner scann=
er : scanners) {=0A            <span class=3D"hljs-keyword" style=
=3D"color:rgb(0, 0, 255);">if</span> (scanner.peek() !=3D <span c=
lass=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">null</span>=
) {=0A              <span class=3D"hljs-keyword" style=3D"color:r=
gb(0, 0, 255);">this</span>.heap.add(scanner);=0A            } <s=
pan class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">else</=
span> {=0A              scanner.close();=0A            }=0A     =20=
    }=0A        <span class=3D"hljs-comment" style=3D"color:green=
;">//=D2=D4=C9=CF=BD=AB=D4=AA=CB=D8=BC=D3=C8=EB=B6=D1=D6=D0</span=
>=0A        <span class=3D"hljs-comment" style=3D"color:green;">/=
/ =B4=D3=B6=D1=B6=A5pop=B3=F6=D2=BB=B8=F6KeyValueScanner=B7=C5=C8=
=EB=B3=C9=D4=B1=B1=E4=C1=BFcurrent,=C4=C7=C3=B4=D5=E2=B8=F6=B6=D1=
=B5=C4=B6=D1=B6=A5</span>=0A        <span class=3D"hljs-comment"=20=
style=3D"color:green;">// =BE=CD=CA=C7current=D5=E2=B8=F6KeyValue=
Scanner=B5=C4=B6=D1=B6=A5=A3=ACKeyValueHeap=B5=C4peek()=C8=A1=B6=D1=
=B6=A5</span>=0A        <span class=3D"hljs-comment" style=3D"col=
or:green;">// =B2=D9=D7=F7=D6=B1=BD=D3=B7=B5=BB=D8current.peek()<=
/span>=0A          <span class=3D"hljs-keyword" style=3D"color:rg=
b(0, 0, 255);">this</span>.current =3D pollRealKV();=0A        }=0A=
    }</code></pre><p>=D4=DA=BF=B4pollRealKV()=D4=F5=C3=B4=D7=F6=B5=
=C4=D6=AE=C7=B0=D0=E8=D2=AA=CF=C8=BF=B4=BF=B4HBase 0.94=D2=FD=C8=EB=
=B5=C4Lazy Seek</p><h3 id=3D"lazy-seek=D3=C5=BB=AF" style=3D"colo=
r:rgb(0, 0, 0);font-size:1rem;"><a href=3D"https://issues.apache.=
org/jira/browse/HBASE-4465" style=3D"text-decoration: none;">Lazy=
 Seek=D3=C5=BB=AF</a></h3><p>=D4=DA=D5=E2=B8=F6=D3=C5=BB=AF=D6=AE=
=C7=B0=A3=AC=B6=C1=C8=A1=D2=BB=B8=F6column family(Store)=A3=AC=D0=
=E8=D2=AAseek=C6=E4=CF=C2=B5=C4=CB=F9=D3=D0HFile=BA=CDMemStore=B5=
=BD=D6=B8=B6=A8=B5=C4=B2=E9=D1=AFKeyValue(seek=B5=C4=D3=EF=D2=E5=CE=
=AA=C8=E7=B9=FBKeyValue=B4=E6=D4=DA=D4=F2seek=B5=BD=B6=D4=D3=A6=CE=
=BB=D6=C3=A3=AC=C8=E7=B9=FB=B2=BB=B4=E6=D4=DA=A3=AC=D4=F2seek=B5=BD=
=D5=E2=B8=F6KeyValue=B5=C4=BA=F3=D2=BB=B8=F6KeyValue=A3=AC=BC=D9=C9=
=E8Store=CF=C2=D3=D03=B8=F6HFile=BA=CD=D2=BB=B8=F6MemStore=A3=AC=B0=
=B4=D5=D5=CA=B1=D0=F2=B5=DD=D4=F6=BC=C7=CE=AA[HFile1, HFile2, HFi=
le3, MemStore],=D4=DAlazy seek=D3=C5=BB=AF=D6=AE=C7=B0=A3=AC=D0=E8=
=D2=AA=B6=D4=CB=F9=D3=D0=B5=C4HFile=BA=CDMemStore=BD=F8=D0=D0seek=
=A3=AC=B6=D4HFile=CE=C4=BC=FE=B5=C4seek=B1=C8=BD=CF=C2=FD=A3=AC=CD=
=F9=CD=F9=D0=E8=D2=AA=BD=ABHFile=CF=E0=D3=A6=B5=C4block=BC=D3=D4=D8=
=B5=BD=C4=DA=B4=E6=A3=AC=C8=BB=BA=F3=B6=A8=CE=BB=A1=A3=D4=DA=D3=D0=
=C1=CBlazy seek=D3=C5=BB=AF=D6=AE=BA=F3=A3=AC=C8=E7=B9=FB=D0=E8=D2=
=AA=B5=C4KeyValue=D4=DAHFile3=D6=D0=BE=CD=B4=E6=D4=DA=A3=AC=C4=C7=
=C3=B4HFIle1=BA=CDHFile2=B6=BC=B2=BB=D0=E8=D2=AA=BD=F8=D0=D0seek=A3=
=AC=B4=F3=B4=F3=CC=E1=B8=DF=CB=D9=B6=C8=A1=A3=B4=F3=CC=E5=C0=B4=CB=
=B5=A3=AC=CB=BC=C2=B7=CA=C7=C7=EB=C7=F3seek=C4=B3=B8=F6KeyValue=CA=
=B1=CA=B5=BC=CA=C9=CF=C3=BB=D3=D0=B6=D4StoreFileScanner=BD=F8=D0=D0=
=D5=E6=D5=FD=B5=C4seek=A3=AC=B6=F8=CA=C7=B6=D4=D3=DA=C3=BF=B8=F6S=
toreFileScanner=A3=AC=C9=E8=D6=C3=CB=FC=B5=C4peek=CE=AA(rowkey,fa=
mily,qualifier,lastTimestampInStoreFile)</p><p>KeyValueHeap=D3=D0=
=C1=BD=B8=F6=D6=D8=D2=AA=B5=C4=BD=D3=BF=DA=A3=ACpeek()=BA=CDnext(=
)=A3=AC=CB=FB=C3=C7=B6=BC=CA=C7=B7=B5=BB=D8=B6=D1=B6=A5=A3=AC=C7=F8=
=B1=F0=D4=DA=D3=DAnext()=BB=E1=BD=AB=B6=D1=B6=A5=B3=F6=B6=D1=A3=AC=
=C8=BB=BA=F3=D6=D8=D0=C2=B5=F7=D5=FB=B6=D1=A3=AC=B6=D4=CD=E2=C0=B4=
=CB=B5=BE=CD=CA=C7=B5=FC=B4=FA=C6=F7=CF=F2=C7=B0=D2=C6=B6=AF=A3=AC=
=B6=F8peek()=B2=BB=BB=E1=BD=AB=B6=D1=B6=A5=B3=F6=B6=D1=A3=AC=B6=D1=
=B6=A5=B2=BB=B1=E4=A1=A3=CA=B5=CF=D6=D6=D0=A3=AC<br>peek()=B2=D9=D7=
=F7=B7=C7=B3=A3=BC=F2=B5=A5=A3=AC=D6=BB=D0=E8=D2=AA=B5=F7=D3=C3=B6=
=D1=B5=C4=B3=C9=D4=B1=B1=E4=C1=BFcurrent=B5=C4peek()=B7=BD=B7=A8=B2=
=D9=D7=F7=BC=B4=BF=C9.=C4=C3StoreScanner=B6=D1=BE=D9=C0=FD=A3=ACc=
urrent=D2=AA=C3=B4=CA=C7StoreFileScanner=C0=E0=D0=CD=D2=AA=C3=B4=CA=
=C7MemStore=A3=AC=C4=C7=C3=B4=B5=BD=B5=D7current=CA=C7=C8=E7=BA=CE=
=D1=A1=D4=F1=B3=F6=C0=B4=B5=C4=D2=D4=BC=B0Lazy Seek=CA=C7=C8=E7=BA=
=CE=CA=B5=CF=D6=B5=C4?</p><p>=CF=C2=C3=E6=BE=D9=B8=F6=C0=FD=D7=D3=
=CB=B5=C3=F7=A1=A3</p><h5 id=3D"=C7=B0=CC=E1" style=3D"color:rgb(=
0, 0, 0);font-size:0.75rem;">=C7=B0=CC=E1=A3=BA</h5><p>HBase=BF=AA=
=C6=F4=C1=CBLazy Seek=D3=C5=BB=AF(=CA=B5=BC=CA=C9=CF=C4=AC=C8=CF=BF=
=AA=C6=F4)</p><h5 id=3D"=BC=D9=C9=E8" style=3D"color:rgb(0, 0, 0)=
;font-size:0.75rem;">=BC=D9=C9=E8=A3=BA</h5><p>Store=CF=C2=D3=D0=C8=
=FD=B8=F6HFile=BA=CDMemStore=A3=AC=B0=B4=D5=D5=CA=B1=BC=E4=CB=B3=D0=
=F2=BC=C7=D7=F7[HFile1,HFile2,HFile3,MemStore],seek KeyValue=CE=AA=
(rowkey,family,qualifier,timestamp)=A3=AC=BC=C7=D7=F7seekKV.<br>=B2=
=A2=C7=D2=CB=FC=D6=BB=D4=DAHFile3=D6=D0=B4=E6=D4=DA=A3=AC=B2=BB=D4=
=DA=C6=E4=CB=FBHFile=BA=CDMemStore=D6=D0=B4=E6=D4=DA</p><h5 id=3D=
"lazy-seek=B9=FD=B3=CC" style=3D"color:rgb(0, 0, 0);font-size:0.7=
5rem;">Lazy Seek=B9=FD=B3=CC</h5><p>seekScanner()=B5=C4=C2=DF=BC=AD=
=A3=AC=C8=E7=B9=FB=CA=C7lazy seek=A3=AC=D4=F2=B6=D4=D3=DA=C3=BF=B8=
=F6Scanner=B6=BC=B5=F7<br>=D3=C3requestSeek(seekKV)=B7=BD=B7=A8=A3=
=AC=B7=BD=B7=A8=C4=DA=B2=BF=CA=D7=CF=C8=BD=F8=D0=D0rowcol=C0=E0=D0=
=CD=B5=C4bloom filter=B9=FD=C2=CB</p><ol class=3D"wiz-list-level1=
"><li>=C8=E7=B9=FB=BD=E1=B9=FB=C5=D0=B6=A8seekKV=D4=DAStoreFile=D6=
=D0=BF=CF=B6=A8=B2=BB=B4=E6=D4=DA=A3=AC=D4=F2=D6=B1=BD=D3=C9=E8=D6=
=C3StoreFileScanner=B5=C4peek(=CA=B5=BC=CA=C9=CFStoreFileScanner=B2=
=BB=CA=C7=D2=BB=B8=F6<br>=B6=D1=D6=BB=CA=C7=CE=AA=C1=CB=CD=B3=D2=BB=
=B4=FA=C2=EB)=CE=AA kv.createLastOnRowCol()=A3=AC=B2=A2=C7=D2=BD=AB=
realSeekDone=C9=E8=D6=C3true=A3=AC=B1=ED=CA=BE=CA=B5=BC=CA=B5=C4s=
eek=CD=EA=B3=C9.</li></ol><pre><code class=3D"hljs java" style=3D=
"font-size: 0.75rem; color: rgb(0, 0, 0); background: rgb(255, 25=
5, 255);"><span class=3D"hljs-function"><span class=3D"hljs-keywo=
rd" style=3D"color:rgb(0, 0, 255);">public</span> KeyValue <span=20=
class=3D"hljs-title" style=3D"color:rgb(163, 21, 21);">createLast=
OnRowCol</span><span class=3D"hljs-params">()</span> </span>{=0A=20=
   <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">r=
eturn</span> <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0=
, 255);">new</span> KeyValue(=0A        bytes, getRowOffset(), ge=
tRowLength(),=0A        bytes, getFamilyOffset(), getFamilyLength=
(),=0A        bytes, getQualifierOffset(), getQualifierLength(),=0A=
        HConstants.OLDEST_TIMESTAMP, Type.Minimum, <span class=3D=
"hljs-keyword" style=3D"color:rgb(0, 0, 255);">null</span>, <span=
 class=3D"hljs-number">0</span>, <span class=3D"hljs-number">0</s=
pan>);=0A  }</code></pre><p>=BF=C9=D2=D4=BF=B4=B3=F6ts=C9=E8=D6=C3=
=CE=AA=D7=EE=D0=A1=A3=AC=CB=B5=C3=F7=D5=E2=B8=F6KeyValue=C5=C5=D4=
=DA=CB=F9=D3=D0=B5=C4=CD=ACrowkey=CD=ACcolumn family=CD=ACqualifi=
er=B5=C4KeyValue=D7=EE=BA=F3=A1=A3=CF=D4=C8=BB=A3=AC=B5=B1=C9=CF=B2=
=E3StoreScanner=C8=A1=B6=D1=B6=A5=CA=B1=A3=AC<br>=C8=E7=B9=FB=C6=E4=
=CB=FCStoreFileScanner/MemStoreScanner=D6=D0=B4=E6=D4=DA=CD=ACrow=
key=CD=ACcolumn family=CD=ACqualifier=B5=C4=D5=E6=CA=B5=B5=C4KeyV=
alue=D4=F2=BB=E1=D3=C5=CF=C8=B5=AF=B3=F6=A1=A3</p><ol class=3D"wi=
z-list-level1"><li>=C8=E7=B9=FBseekKV=D4=DAStoreFile=D6=D0=A3=AC=C4=
=C7=C3=B4=BB=E1=D6=B4=D0=D0=C8=E7=CF=C2=C2=DF=BC=AD=A3=BA</li></o=
l><pre><code class=3D"hljs groovy" style=3D"font-size: 0.75rem; c=
olor: rgb(0, 0, 0); background: rgb(255, 255, 255);"> realSeekDon=
e =3D <span class=3D"hljs-literal" style=3D"color:rgb(163, 21, 21=
);">false</span>;=0A <span class=3D"hljs-keyword" style=3D"color:=
rgb(0, 0, 255);">long</span> maxTimestampInFile =3D reader.getMax=
Timestamp();=0A <span class=3D"hljs-keyword" style=3D"color:rgb(0=
, 0, 255);">long</span> seekTimestamp =3D kv.getTimestamp();=0A <=
span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">if</s=
pan> (seekTimestamp &gt; maxTimestampInFile) {=0A     <span class=
=3D"hljs-comment" style=3D"color:green;">// Create a fake key tha=
t is not greater than the real next key.</span>=0A     <span clas=
s=3D"hljs-comment" style=3D"color:green;">// (Lower timestamps co=
rrespond to higher KVs.)</span>=0A     <span class=3D"hljs-commen=
t" style=3D"color:green;">// To understand this better, consider=20=
that we are asked to seek</span>=0A     <span class=3D"hljs-comme=
nt" style=3D"color:green;">// to</span>=0A     <span class=3D"hlj=
s-comment" style=3D"color:green;">// a higher timestamp than the=20=
max timestamp in this file. We</span>=0A     <span class=3D"hljs-=
comment" style=3D"color:green;">// know that</span>=0A     <span=20=
class=3D"hljs-comment" style=3D"color:green;">// the next point w=
hen we have to consider this file again is</span>=0A     <span cl=
ass=3D"hljs-comment" style=3D"color:green;">// when we</span>=0A=20=
    <span class=3D"hljs-comment" style=3D"color:green;">// pass t=
he max timestamp of this file (with the same</span>=0A     <span=20=
class=3D"hljs-comment" style=3D"color:green;">// row/column).</sp=
an>=0A     cur =3D kv.createFirstOnRowColTS(maxTimestampInFile);=0A=
  } <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">=
else</span> {=0A     enforceSeek();=0A  }</code></pre><p>=CF=D4=C8=
=BB=A3=AC=B5=B1kv=B5=C4ts=B1=C8HFile=D6=D0=D7=EE=B4=F3=B5=C4ts=B6=
=BC=B8=FC=B4=F3=CA=B1=A3=AC=C4=C7=C3=B4=D5=E2=B8=F6HFile=D6=D0=CF=
=D4=C8=BB=B2=BB=B4=E6=D4=DAseekKV=A3=AC=B5=AB=CA=C7=BF=C9=C4=DC=B4=
=E6=D4=DA<br>=CF=E0=CD=ACrowkey,family,qualifier=B5=C4=B2=BB=CD=AC=
ts=B5=C4KeyValue,=C4=C7=C3=B4=D5=E2=C0=EF=C9=E8=D6=C3=B6=D1=B6=A5=
=CA=B1=D2=AA=D7=A2=D2=E2=A3=AC=B2=BB=C4=DC=B0=D1=B6=D1=B6=A5=C9=E8=
=D6=C3=CE=AA=B1=C8=B5=B1=C7=B0HFile=CE=C4=BC=FE=D6=D0=B5=C4=BF=C9=
=C4=DC=D5=E6=CA=B5=B4=E6=D4=DA=B5=C4=CF=E0=CD=ACrowkey,family,qua=
lifier=B5=C4KeyValue=B4=F3=A3=AC=C8=E7=CF=C2=A3=BA</p><pre><code=20=
class=3D"hljs java" style=3D"font-size: 0.75rem; color: rgb(0, 0,=
 0); background: rgb(255, 255, 255);"><span class=3D"hljs-functio=
n"><span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">p=
ublic</span> KeyValue <span class=3D"hljs-title" style=3D"color:r=
gb(163, 21, 21);">createFirstOnRowColTS</span><span class=3D"hljs=
-params">(<span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 2=
55);">long</span> ts)</span> </span>{=0A    <span class=3D"hljs-k=
eyword" style=3D"color:rgb(0, 0, 255);">return</span> <span class=
=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">new</span> KeyV=
alue(=0A        bytes, getRowOffset(), getRowLength(),=0A       =20=
bytes, getFamilyOffset(), getFamilyLength(),=0A        bytes, get=
QualifierOffset(), getQualifierLength(),=0A        ts, Type.Maxim=
um, bytes, getValueOffset(), getValueLength());=0A  }</code></pre=
><p>Type=B5=C4=B1=C8=BD=CF=D6=D0=A3=ACType.Maximum=D7=EE=D0=A1=A3=
=AC=D5=E2=D1=F9=B2=FA=C9=FA=B5=C4KeyValue=B1=A3=D6=A4=C1=CB=B2=BB=
=BB=E1=B4=F3=D3=DA=B5=B1=C7=B0HFile=CE=C4=BC=FE=D6=D0=B5=C4=BF=C9=
=C4=DC=B4=E6=D4=DA=B5=C4=CF=E0=CD=ACrowkey=A3=ACfamily=A3=ACquali=
fier=B5=C4KeyValue=A3=AC=CD=AC=CA=B1=BD=ABseekKV=B1=A3=B4=E6=B5=BD=
StoreFileScanner=B3=C9=D4=B1=B1=E4=C1=BFdelayedSeekKV=D6=D0=A3=AC=
=D2=D4=B1=E3=BA=F3=D0=F8=D5=E6=D5=FDseek=B5=C4=CA=B1=BA=F2=BB=F1=C8=
=A1.<br>=BF=BC=C2=C7=D2=BB=CF=C2=C8=E7=B9=FBseekKV=B5=C4ts=B1=C8=B5=
=B1=C7=B0HFile=D6=D0=B5=C4maxTimestamp=B8=FC=D0=A1=D4=F5=C3=B4=B0=
=EC?=BF=C9=D2=D4=C9=E8=D6=C3=D2=BB=B8=F6ts=CE=AAlatest_timestamp<=
br>=B5=C4KeyValue=C3=B4?=C8=E7=B9=FB=C9=E8=D6=C3=C1=CB=A3=AC=CB=FC=
=BB=E1=B1=C8=C6=E4=CB=FCHFile=D6=D0=B4=E6=D4=DA=CA=B5=BC=CA=B5=C4=
KeyValue=CF=C8=B5=AF=B3=F6=A3=AC=D5=E2=D1=F9=CB=B3=D0=F2=BE=CD=C2=
=D2=C1=CB,=CB=F9=D2=D4=D5=E2=D6=D6=C7=E9=BF=F6=CF=C2=A3=AC=D6=BB=C4=
=DC=BD=F8=D0=D0=CA=B5=BC=CA=B5=C4seek=A3=ACenforceSeek()=BA=AF=CA=
=FD=D6=D0=BD=F8=D0=D0=CA=B5=BC=CA=B5=C4seek=BA=F3=A3=AC=BD=ABreal=
SeekDone=C9=E8=D6=C3=CE=AA<br>true.</p><h5 id=3D"=C8=A1storescann=
er=B6=D1=B6=A5=C2=DF=BC=AD" style=3D"color:rgb(0, 0, 0);font-size=
:0.75rem;">=C8=A1StoreScanner=B6=D1=B6=A5=C2=DF=BC=AD</h5><p>=D2=F2=
=CE=AAHFile3=B5=C4latestTimestampInStoreFile=D7=EE=B4=F3=A3=AC=CB=
=F9=D2=D4=BB=E1=CA=D7=CF=C8=C8=A1=B5=BDHFile3=B6=D4=D3=A6=B5=C4St=
oreFileScanner=B5=C4pee<br>k(<strong>KeyValue=B5=C4=B1=C8=BD=CF=D4=
=AD=D4=F2=CA=C7timestamp=B4=F3=B5=C4KeyValue=B8=FC=D0=A1</strong>=
)=A3=AC<br>=D5=E2=B8=F6=CA=B1=BA=F2=BB=E1=BC=EC=B2=E9=D5=E2=B8=F6=
KeyValueScanner=CA=C7=B7=F1=BD=F8=D0=D0=C1=CB=CA=B5=BC=CA=B5=C4se=
ek(=B6=D4=D3=DAStoreFileScanner=C0=B4=CB=B5=A3=AC=CD=A8=B9=FD=B2=BC=
=B6=FB=B1=E4=C1=BFrealSeekDone=BD=F8=D0=D0=B1=EA=BC=C7=A3=AC=B6=D4=
=D3=DAMemStoreScanner=C0=B4=CB=B5=A3=AC=CA=BC=D6=D5=B7=B5=BB=D8tr=
ue)=A3=AC=D4=DA=D5=E2=C0=EF=A3=AC=C3=BB=D3=D0=BD=F8=D0=D0real see=
k<br>=A3=AC=BD=D3=D7=C5=BD=F8=D0=D0=CA=B5=BC=CA=B5=C4seek=B2=D9=D7=
=F7=A3=ACseek=B5=BDHFile3=D6=D0=B4=E6=D4=DA=B5=C4seekKV=A3=AC=BD=D3=
=D7=C5=C4=C3=D7=C5seekKV=C8=A5=BA=CDHFile2=B5=C4peek=BD=F8=D0=D0=B1=
=C8=BD=CF=A3=AC=CF=D4=C8=BBseekKV=B1=C8HFile2=B5=C4peek=D0=A1(=D3=
=C9=D3=DAtimestamp &gt; lastTimestampInStoreFile2),=B9=CA<br>Stor=
eScanner=B5=C4peek=B2=D9=D7=F7=B7=B5=BB=D8seekKV=A1=A3</p><p>=CA=B5=
=CF=D6=D6=D0=A3=ACKeyValueHeap=D3=D0=C1=BD=B8=F6=D6=D8=D2=AA=B5=C4=
=BD=D3=BF=DA=A3=ACpeek()=BA=CDnext()=A3=AC=CB=FB=C3=C7=B6=BC=CA=C7=
=B7=B5=BB=D8=B6=D1=B6=A5=A3=AC=C7=F8=B1=F0=D4=DA=D3=DAnext()=BB=E1=
=BD=AB=B6=D1=B6=A5=B3=F6=B6=D1=A3=AC=C8=BB=BA=F3=D6=D8=D0=C2=B5=F7=
=D5=FB=B6=D1=A3=AC=B6=D4=CD=E2=C0=B4=CB=B5=BE=CD=CA=C7=B5=FC=B4=FA=
=C6=F7=CF=F2=C7=B0=D2=C6=B6=AF=A3=AC=B6=F8peek()=B2=BB=BB=E1=BD=AB=
=B6=D1=B6=A5=B3=F6=B6=D1=A3=AC=B6=D1=B6=A5=B2=BB=B1=E4=A1=A3=CA=B5=
=CF=D6=D6=D0=A3=AC<br>peek()=B2=D9=D7=F7=B7=C7=B3=A3=BC=F2=B5=A5=A3=
=AC=D6=BB=D0=E8=D2=AA=B5=F7=D3=C3=B6=D1=B5=C4=B3=C9=D4=B1=B1=E4=C1=
=BFcurrent=B5=C4peek()=B7=BD=B7=A8=B2=D9=D7=F7=BC=B4=BF=C9.=C4=C3=
StoreScanner=B6=D1=BE=D9=C0=FD=A3=ACcurrent=D2=AA=C3=B4=CA=C7Stor=
eFileScanner=C0=E0=D0=CD=D2=AA=C3=B4=CA=C7MemStore=A3=AC=B6=F8cur=
rent=B5=C4=D1=A1=D4=F1=D4=F2=CA=C7pollRealKV()<br>=CD=EA=B3=C9=B5=
=C4=A3=AC=D5=E2=B8=F6=BA=AF=CA=FD=D6=AE=CB=F9=D2=D4=C4=DA=B2=BF=D3=
=D0while=D1=AD=BB=B7=BE=CD=CA=C7=D2=F2=CE=AA=BF=BC=C2=C7=C1=CBLaz=
y Seek=D3=C5=BB=AF=A3=AC=CA=B5=BC=CA=C9=CF=A3=ACpollRealKV()=B4=FA=
=C2=EB=B5=C4=C2=DF=BC=AD=BE=CD=CA=C7=C0=FD=D7=D3=D6=D0"=C8=A1Stor=
eScanner=B6=D1=B6=A5=C2=DF=BC=AD"=A1=A3pollRealKV()=B5=C4=B7=B5=BB=
=D8=D6=B5=BB=E1=B8=B3=B8=F8current</p><pre><code class=3D"hljs ja=
va" style=3D"font-size: 0.75rem; color: rgb(0, 0, 0); background:=
 rgb(255, 255, 255);">  <span class=3D"hljs-function"><span class=
=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">protected</span=
> KeyValueScanner <span class=3D"hljs-title" style=3D"color:rgb(1=
63, 21, 21);">pollRealKV</span><span class=3D"hljs-params">()</sp=
an> <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">=
throws</span> IOException </span>{=0A    KeyValueScanner kvScanne=
r =3D heap.poll();=0A    <span class=3D"hljs-keyword" style=3D"co=
lor:rgb(0, 0, 255);">if</span> (kvScanner =3D=3D <span class=3D"h=
ljs-keyword" style=3D"color:rgb(0, 0, 255);">null</span>) {=0A  =20=
   <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">r=
eturn</span> <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0=
, 255);">null</span>;=0A    }=0A=0A    <span class=3D"hljs-keywor=
d" style=3D"color:rgb(0, 0, 255);">while</span> (kvScanner !=3D <=
span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">null<=
/span> &amp;&amp; !kvScanner.realSeekDone()) {=0A      <span clas=
s=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">if</span> (kvS=
canner.peek() !=3D <span class=3D"hljs-keyword" style=3D"color:rg=
b(0, 0, 255);">null</span>) {=0A        kvScanner.enforceSeek();=0A=
        KeyValue curKV =3D kvScanner.peek();=0A        <span clas=
s=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">if</span> (cur=
KV !=3D <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255=
);">null</span>) {=0A          KeyValueScanner nextEarliestScanne=
r =3D heap.peek();=0A          <span class=3D"hljs-keyword" style=
=3D"color:rgb(0, 0, 255);">if</span> (nextEarliestScanner =3D=3D=20=
<span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">null=
</span>) {=0A            <span class=3D"hljs-comment" style=3D"co=
lor:green;">// The heap is empty. Return the only possible scanne=
r.</span>=0A            <span class=3D"hljs-keyword" style=3D"col=
or:rgb(0, 0, 255);">return</span> kvScanner;=0A          }=0A=0A=20=
         <span class=3D"hljs-comment" style=3D"color:green;">// C=
ompare the current scanner to the next scanner. We try to avoid</=
span>=0A          <span class=3D"hljs-comment" style=3D"color:gre=
en;">// putting the current one back into the heap if possible.</=
span>=0A          KeyValue nextKV =3D nextEarliestScanner.peek();=
=0A          <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0=
, 255);">if</span> (nextKV =3D=3D <span class=3D"hljs-keyword" st=
yle=3D"color:rgb(0, 0, 255);">null</span> || comparator.compare(c=
urKV, nextKV) &lt; <span class=3D"hljs-number">0</span>) {=0A   =20=
        <span class=3D"hljs-comment" style=3D"color:green;">// We=
 already have the scanner with the earliest KV, so return it.</sp=
an>=0A            <span class=3D"hljs-keyword" style=3D"color:rgb=
(0, 0, 255);">return</span> kvScanner;=0A          }=0A=0A      =20=
   <span class=3D"hljs-comment" style=3D"color:green;">// Otherwi=
se, put the scanner back into the heap and let it compete</span>=0A=
          <span class=3D"hljs-comment" style=3D"color:green;">//=20=
against all other scanners (both those that have done a "real</sp=
an>=0A          <span class=3D"hljs-comment" style=3D"color:green=
;">// seek" and a "lazy seek").</span>=0A          heap.add(kvSca=
nner);=0A        } <span class=3D"hljs-keyword" style=3D"color:rg=
b(0, 0, 255);">else</span> {=0A          <span class=3D"hljs-comm=
ent" style=3D"color:green;">// Close the scanner because we did a=
 real seek and found out there</span>=0A          <span class=3D"=
hljs-comment" style=3D"color:green;">// are no more KVs.</span>=0A=
          kvScanner.close();=0A        }=0A      } <span class=3D=
"hljs-keyword" style=3D"color:rgb(0, 0, 255);">else</span> {=0A =20=
      <span class=3D"hljs-comment" style=3D"color:green;">// Clos=
e the scanner because it has already run out of KVs even before</=
span>=0A        <span class=3D"hljs-comment" style=3D"color:green=
;">// we had to do a real seek on it.</span>=0A        kvScanner.=
close();=0A      }=0A      kvScanner =3D heap.poll();=0A    }=0A=0A=
    <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">=
return</span> kvScanner;=0A  }</code></pre><h3 id=3D"store=CF=C2h=
file=BC=AF=BA=CF=B7=A2=C9=FA=B1=E4=BB=AF=C8=E7=BA=CE=B4=A6=C0=ED"=
 style=3D"color:rgb(0, 0, 0);font-size:1rem;">Store=CF=C2HFile=BC=
=AF=BA=CF=B7=A2=C9=FA=B1=E4=BB=AF=C8=E7=BA=CE=B4=A6=C0=ED</h3><p>=
=C4=DA=B4=E6=D6=D0=B5=C4Memstore=B1=BBflush=B5=BD=CE=C4=BC=FE=CF=B5=
=CD=B3=BB=F2=D5=DFcompaction=CD=EA=B3=C9=B6=BC=BB=E1=B8=C4=B1=E4S=
tore=B5=C4HFile=CE=C4=BC=FE=BC=AF=BA=CF=A1=A3<br>=D4=DA=C3=BF=B4=CE=
=D7=F6=CD=EA=D2=BB=C5=FAmutate=B2=D9=D7=F7=BA=F3=A3=AC=BB=E1=CD=A8=
=B9=FDHRegion::isFlushSize(newSize)=BC=EC=B2=E9=CA=C7=B7=F1=D0=E8=
=D2=AA=B6=D4=B5=B1=C7=B0HRegion=C4=DA=B5=C4memstore=BD=F8=D0=D0fl=
ush<br>=C6=E4=CA=B5=BE=CD=CA=C7=C5=D0=B6=CFHRegion=C4=DA=B5=C4=CB=
=F9=D3=D0=B5=C4memstore=B4=F3=D0=A1=BA=CD=CA=C7=B7=F1=B4=F3=D3=DA=
hbase.hregion.memstore.flush.size=A3=AC=C4=AC=C8=CF128MB=A3=AC=C8=
=E7=B9=FB=D0=E8=D2=AAflush=A3=AC=BB=E1=BD=AB=C7=EB=C7=F3=B7=C5=C8=
=EB=BA=F3=CC=A8flush=CF=DF=B3=CC(MemStoreFlusher)=B5=C4=B6=D3=C1=D0=
=D6=D0=A3=AC=D3=C9=BA=F3=CC=A8flush=CF=DF=B3=CC=B4=A6=C0=ED=A3=AC=
=B5=F7=D3=C3=C2=B7=BE=B6HRegion::flushcache()-&gt;internalFlushca=
che(...)=A3=AD&gt;StoreFlushContext.flushCache(...)-&gt;StoreFlus=
hContext.commit(...)=3D&gt;HStore::updateStorefiles()=A3=AC=D5=E2=
=BF=E9=C2=DF=BC=AD=D4=DA<a href=3D"http://www.cnblogs.com/foxmail=
ed/p/3914117.html" style=3D"text-decoration:none;color:rgb(0, 0,=20=
0);">HBase Snapshot=D4=AD=C0=ED=BA=CD=CA=B5=CF=D6</a>=D6=D0=D3=D0=
=BD=B2=B5=BD=A3=AC=D5=E2=C0=EF=B2=BB=D7=B8=CA=F6=A1=A3=D6=BB=CB=B5=
=D2=BB=CF=C2=D7=EE=BA=F3=D2=BB=B2=BD=B5=C4updateStorefiles()=B2=D9=
=D7=F7=A3=AC=B8=C3=BA=AF=CA=FD=D6=F7=D2=AA=B9=A4=D7=F7=CA=C7=C4=C3=
=D7=A1HStore=BC=B6=B1=F0=B5=C4=D0=B4=CB=F8=A3=AC=C8=BB=BA=F3=BD=AB=
=D0=C2=B2=FA=C9=FA=B5=C4HFile=CE=C4=BC=FE=B2=E5=C8=EB=B5=BDStoreE=
ngine=D6=D0=A3=AC=BD=E2=D0=B4=CB=F8=A3=AC=C8=BB=BA=F3=CA=CD=B7=C5=
snapshot=A3=AC=D7=EE=BA=F3=B5=F7=D3=C3<br>notifyChangedReadersObs=
ervers()=A3=AC=C8=E7=CF=C2=A3=BA</p><pre><code class=3D"hljs cs"=20=
style=3D"font-size: 0.75rem; color: rgb(0, 0, 0); background: rgb=
(255, 255, 255);"> <span class=3D"hljs-keyword" style=3D"color:rg=
b(0, 0, 255);">this</span>.<span class=3D"hljs-keyword" style=3D"=
color:rgb(0, 0, 255);">lock</span>.writeLock().<span class=3D"hlj=
s-keyword" style=3D"color:rgb(0, 0, 255);">lock</span>();=0A <spa=
n class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">try</spa=
n> {=0A   <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 2=
55);">this</span>.storeEngine.getStoreFileManager().insertNewFile=
s(sfs);=0A   <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0=
, 255);">this</span>.memstore.clearSnapshot(<span class=3D"hljs-k=
eyword" style=3D"color:rgb(0, 0, 255);">set</span>);=0A } <span c=
lass=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">finally</sp=
an> {=0A   <span class=3D"hljs-comment" style=3D"color:green;">//=
 We need the lock, as long as we are updating the storeFiles</spa=
n>=0A   <span class=3D"hljs-comment" style=3D"color:green;">// or=
 changing the memstore. Let us release it before calling</span>=0A=
   <span class=3D"hljs-comment" style=3D"color:green;">// notifyC=
hangeReadersObservers. See HBASE-4485 for a possible</span>=0A  =20=
<span class=3D"hljs-comment" style=3D"color:green;">// deadlock s=
cenario that could have happened if continue to hold</span>=0A  =20=
<span class=3D"hljs-comment" style=3D"color:green;">// the lock.<=
/span>=0A   <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0,=
 255);">this</span>.<span class=3D"hljs-keyword" style=3D"color:r=
gb(0, 0, 255);">lock</span>.writeLock().unlock();=0A }=0A <span c=
lass=3D"hljs-comment" style=3D"color:green;">// Tell listeners of=
 the change in readers.</span>=0A notifyChangedReadersObservers()=
;</code></pre><p>=D6=D8=B5=E3=D4=DA=D3=DAnotifyChangedReadersObse=
rvers()=A3=AC=BF=B4=BF=B4=B4=FA=C2=EB=A3=BA</p><pre><code class=3D=
"hljs groovy" style=3D"font-size: 0.75rem; color: rgb(0, 0, 0); b=
ackground: rgb(255, 255, 255);">  <span class=3D"hljs-keyword" st=
yle=3D"color:rgb(0, 0, 255);">private</span> <span class=3D"hljs-=
keyword" style=3D"color:rgb(0, 0, 255);">void</span> notifyChange=
dReadersObservers() <span class=3D"hljs-keyword" style=3D"color:r=
gb(0, 0, 255);">throws</span> IOException {=0A    <span class=3D"=
hljs-keyword" style=3D"color:rgb(0, 0, 255);">for</span> (Changed=
ReadersObserver <span class=3D"hljs-string" style=3D"color:rgb(16=
3, 21, 21);">o:</span> <span class=3D"hljs-keyword" style=3D"colo=
r:rgb(0, 0, 255);">this</span>.changedReaderObservers) {=0A     =20=
o.updateReaders();=0A    }=0A  }</code></pre><p>=CA=B5=BC=CA=C9=CF=
=A3=AC=C3=BF=B8=F6observer=C0=E0=D0=CD=B6=BC=CA=C7StoreScanner=A3=
=AC=C3=BF=B4=CE=D0=C2=BF=AA=D2=BB=B8=F6StoreScanner=B6=BC=BB=E1=D7=
=A2=B2=E1=D4=DAStore=C4=DA=B2=BF=B5=C4=D5=E2=B8=F6observer=BC=AF=BA=
=CF=D6=D0=A3=AC=B5=B1Store=CF=C2=C3=E6=B5=C4HFile=BC=AF=BA=CF=B1=E4=
=BB=AF=CA=B1=A3=AC=CD=A8=D6=AA=D5=E2=D0=A9=D7=A2=B2=E1=C9=CF=C0=B4=
=B5=C4StoreScanner=BC=B4=BF=C9=A1=A3<br>=BE=DF=CC=E5=B5=C4=CD=A8=D6=
=AA=B7=BD=CA=BD=BE=CD=CA=C7=CA=D7=CF=C8=C4=C3=D7=A1StoreScanner=B5=
=C4=CB=F8=A3=AC=BD=AB=D5=E2=B8=F6=CA=B1=BA=F2=B5=C4=B6=D1=B6=A5=B1=
=A3=B4=E6=D4=DA=B3=C9=D4=B1=B1=E4=C1=BFlastTop=D6=D0=A3=AC<br>=C8=
=BB=BA=F3=BD=ABStoreScanner=C4=DA=B2=BF=B5=C4=B6=D1=D6=C3=CE=AAnu=
ll(this.heap=3Dnull)=D7=EE=BA=F3=BD=E2=CB=F8=A3=AC=B6=F8StoreScan=
ner=C4=C7=B1=DFnext/seek/reseek=CA=B1=A3=AC=B6=BC=BB=E1=CA=D7=CF=C8=
=CD=A8=B9=FD=BA=AF=CA=FDcheckReseek()=BA=AF=CA=FD=C0=B4=BC=EC=B2=E9=
=CA=C7=B7=F1this.heap=CE=AAnull=A3=AC=CE=AAnull<br>=A3=AC=CE=AAnu=
ll=CB=B5=C3=F7=B5=B1=C7=B0Store=CF=C2=B5=C4HFile=BC=AF=BA=CF=B8=C4=
=B1=E4=C1=CB=A3=AC=C4=C7=C3=B4=B5=F7=D3=C3resetScannerStack(lastT=
op)=A3=AC=BD=AB=B5=B1=C7=B0<br>Store=CF=C2=B5=C4=CB=F9=D3=D0Store=
FileScanner/MemStoreScanner=B6=BCseek=B5=BDlastTop=A3=AC=C8=BB=BA=
=F3=D6=D8=D0=C2=BD=A8StoreScanner=B6=D4=D3=A6=B5=C4=B6=D1=A1=A3ch=
eckReseek()=B4=FA=C2=EB=C8=E7=CF=C2:</p><pre><code class=3D"hljs=20=
java" style=3D"font-size: 0.75rem; color: rgb(0, 0, 0); backgroun=
d: rgb(255, 255, 255);">  <span class=3D"hljs-function"><span cla=
ss=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">protected</sp=
an> <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">=
boolean</span> <span class=3D"hljs-title" style=3D"color:rgb(163,=
 21, 21);">checkReseek</span><span class=3D"hljs-params">()</span=
> <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">th=
rows</span> IOException </span>{=0A    <span class=3D"hljs-keywor=
d" style=3D"color:rgb(0, 0, 255);">if</span> (<span class=3D"hljs=
-keyword" style=3D"color:rgb(0, 0, 255);">this</span>.heap =3D=3D=
 <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">nul=
l</span> &amp;&amp; <span class=3D"hljs-keyword" style=3D"color:r=
gb(0, 0, 255);">this</span>.lastTop !=3D <span class=3D"hljs-keyw=
ord" style=3D"color:rgb(0, 0, 255);">null</span>) {=0A      reset=
ScannerStack(<span class=3D"hljs-keyword" style=3D"color:rgb(0, 0=
, 255);">this</span>.lastTop);=0A      <span class=3D"hljs-keywor=
d" style=3D"color:rgb(0, 0, 255);">if</span> (<span class=3D"hljs=
-keyword" style=3D"color:rgb(0, 0, 255);">this</span>.heap.peek()=
 =3D=3D <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255=
);">null</span>=0A          || store.getComparator().compareRows(=
<span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">this=
</span>.lastTop, <span class=3D"hljs-keyword" style=3D"color:rgb(=
0, 0, 255);">this</span>.heap.peek()) !=3D <span class=3D"hljs-nu=
mber">0</span>) {=0A        LOG.debug(<span class=3D"hljs-string"=
 style=3D"color:rgb(163, 21, 21);">"Storescanner.peek() is change=
d where before =3D "</span> + <span class=3D"hljs-keyword" style=3D=
"color:rgb(0, 0, 255);">this</span>.lastTop.toString()=0A       =20=
    + <span class=3D"hljs-string" style=3D"color:rgb(163, 21, 21)=
;">",and after =3D "</span> + <span class=3D"hljs-keyword" style=3D=
"color:rgb(0, 0, 255);">this</span>.heap.peek());=0A        <span=
 class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);">this</spa=
n>.lastTop =3D <span class=3D"hljs-keyword" style=3D"color:rgb(0,=
 0, 255);">null</span>;=0A        <span class=3D"hljs-keyword" st=
yle=3D"color:rgb(0, 0, 255);">return</span> <span class=3D"hljs-k=
eyword" style=3D"color:rgb(0, 0, 255);">true</span>;=0A      }=0A=
      <span class=3D"hljs-keyword" style=3D"color:rgb(0, 0, 255);=
">this</span>.lastTop =3D <span class=3D"hljs-keyword" style=3D"c=
olor:rgb(0, 0, 255);">null</span>; <span class=3D"hljs-comment" s=
tyle=3D"color:green;">// gone!</span>=0A    }=0A    <span class=3D=
"hljs-comment" style=3D"color:green;">// else dont need to reseek=
</span>=0A    <span class=3D"hljs-keyword" style=3D"color:rgb(0,=20=
0, 255);">return</span> <span class=3D"hljs-keyword" style=3D"col=
or:rgb(0, 0, 255);">false</span>;=0A  }</code></pre><h4 id=3D"=B2=
=CE=BF=BC=D7=CA=C1=CF" style=3D"color:rgb(0, 0, 0);font-size:0.87=
5rem;">=B2=CE=BF=BC=D7=CA=C1=CF</h4></div><p style=3D"color:rgb(5=
1, 51, 51);font-size:0.833rem"><a href=3D"https://github.com/apac=
he/hbase/tree/0.98" class=3D"uri" style=3D"text-decoration:none;c=
olor:rgb(0, 0, 0);">https://github.com/apache/hbase/tree/0.98</a>=
</p><p style=3D"color:rgb(51, 51, 51);font-size:0.833rem"><a href=
=3D"https://issues.apache.org/jira/browse/HBASE-4465" class=3D"ur=
i" style=3D"text-decoration:none;color:rgb(0, 0, 0);">https://iss=
ues.apache.org/jira/browse/HBASE-4465</a></p><div class=3D"postBo=
dy" style=3D"color: rgb(51, 51, 51); font-size: 0.833rem;"><br></=
div><div id=3D"blog_post_info_block" style=3D"color:rgb(51, 51, 5=
1);font-size:0.833rem"><br></div><br class=3D"Apple-interchange-n=
ewline"><br><div style=3D"color:gray;"><small>=C0=B4=D4=B4=A3=BA&=
nbsp;<a href=3D"http://www.cnblogs.com/foxmailed/p/3958546.html">=
http://www.cnblogs.com/foxmailed/p/3958546.html</a></small></div>=
<br></div></body></html>=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=0A=


------=_Next_Part_0000343046.104--

------=_Next_Part_0001029138.753--

